<!doctype html>
<html lang="zh-CN" version="1.75.91188-hotfix-v1-75-zju-13b37e21" host="https://courses.zju.edu.cn:443/" delivery-org="ZJU">
<head>
<script>
    let sentryClientKey = "";
    let CONFIGS = {};
    let MULTIMEDIA = {};
    if (!window?.isConfigLoaded) {
        window.isConfigLoaded = false;
    }
    const getConfig = function(){
        fetch('/org/global-config')
            .then(response => response.json())
            .then((res) => {
                    sentryClientKey = res.sentry_client_key;
                    CONFIGS = {
                        "sentryClientKey": res.sentry_client_key,
                        "assetsPath": res.assets_path,
                        "apm": res.apm,
                    }
                    MULTIMEDIA = {
                        "supportedConvertDocumentFormats": res.supported_convert_document_formats,
                        "uploadExtensionFormatAllowlist": res.upload_extension_format_allowlist,
                    }
                    window.isConfigLoaded = true;
                    // 为解决偶发性时序问题，下发事件通知到对应调用组件
                    window.dispatchEvent(new Event("global-config-loaded"));
                }
            )
            .catch(error => console.error('Fail fetching config, err:', error));
    };
    if (!window.isConfigLoaded) {
        getConfig();
    }
</script>        <link ref="preload" href="/static/runtime~js/lms-main-d3856864.js" as=script>
<link ref="preload" href="/static/js/lms-main-a6ea8381.js" as=script>
<link ref="preload" href="/static/js/lms-main-b0ee4156.css" as=style>
<style>body{display: none}</style><meta http-equiv="content-type" content="text/html" charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="format-detection" content="telephone=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="renderer" content="webkit">
<meta name="robots" content="index, follow">
<meta http-equiv="Cache-Control" content="no-transform">    <title>首页 - 学在浙大</title>
    <link rel="shortcut icon" href="https://course.zju.edu.cn/static/image/xzzd.eabda522cbd5.png">
    <!-- Global site tag (gtag.js) - Google Analytics 4 -->
    <script async src="https://www.googletagmanager.com/gtag/js"></script>


        <link rel="stylesheet" href="/static/styles-base-743ec83a.css" media="none" onload="if(media!='all')media='all'"></link>
<link rel="stylesheet" href="/static/47633-d02c1e59.css" media="none" onload="if(media!='all')media='all'"></link>
<link rel="stylesheet" href="/static/13195-f34ec02b.css" media="none" onload="if(media!='all')media='all'"></link>
<link rel="stylesheet" href="/static/styles-lms-main-29c146c3.css" media="none" onload="if(media!='all')media='all'"></link>
<link rel="stylesheet" href="/static/99480-2a74fba6.css" media="none" onload="if(media!='all')media='all'"></link>
<link rel="stylesheet" href="/static/72840-275dc0c6.css" media="none" onload="if(media!='all')media='all'"></link>
<link rel="stylesheet" href="/static/styles-course-30349872-5bae0fb7.css" media="none" onload="if(media!='all')media='all'"></link>
<link rel="stylesheet" href="/static/styles-course-f15203a0-e807ec74.css" media="none" onload="if(media!='all')media='all'"></link>
<link rel="stylesheet" href="/static/styles-course-127037c2-3a538ac2.css" media="none" onload="if(media!='all')media='all'"></link>
<link rel="stylesheet" href="/static/styles-course-9e1ec98d-6ce3533b.css" media="none" onload="if(media!='all')media='all'"></link>
<link rel="stylesheet" href="/static/styles-user-a8986632.css" media="none" onload="if(media!='all')media='all'"></link>
<link rel="stylesheet" href="/static/38785-4667364a.css" media="none" onload="if(media!='all')media='all'"></link>
<link rel="stylesheet" href="/static/js/lms-main-b0ee4156.css" media="none" onload="if(media!='all')media='all'"></link>
<link rel="stylesheet" href="/static/styles-iview-294f1a4b.css" media="none" onload="if(media!='all')media='all'"></link>

    <link rel="dns-prefetch" href="https://bam.nr-data.net">
    <link rel="dns-prefetch" href="https://www.google-analytics.com">

</head>
<body -ng-app="user-index" ng-strict-di on-modal-state-change ng-init="isInstructorView = false;
                                                 org_plan_trial='None';
                                                 storageType='CHINAMCLOUD';
                                                 isIE9CannotUploadFileMsg='您的浏览器版本过低，无法上传文件。请升级浏览器，或者使用其他浏览器上传文件';
                                                 weekDayIso={1: '一',2: '二',3: '三',4: '四',5: '五',6: '六', 7: '日'};"
      class=' mathjax-ignore'>


    <div class="wrapper ">
<!--[if IE 9]>
<div class="header-warning unsupport-browser">
    <div class="icon icon-unsupport-browser"></div>
    <span>
        您的浏览器版本过低，访问中可能会出现问题。请升级浏览器或使用其他浏览器访问
    </span>
</div>
<![endif]--><div id="announcement">
    <vue-announcement v-for="i in announcements" :announcement="i" :key="i.id"></vue-announcement>
</div><div id="alertMessages">
    <vue-alert-messages @close-modal="closeModal" v-if="allMessages" v-for="modal of modals" :key="modal.index" :messages="modal.messages" :modal="!modal.index"></vue-alert-messages>
</div><div ng-controller="HeaderWarningController"
     ng-init="warningVersionExpire='页面数据已经过期，请刷新浏览器获取最新版本。'">
        <div class="header-warning ng-cloak" ng-if="ui.showNoMailWarning">
            <i class="font font-warning"></i>
            <span>
            暂未填写邮箱信息，忘记密码将无法找回。请前去“个人设置”进行填写。
        </span>
            <a class="close-button" ng-click="dismissNoMailWarning()">
                <i class="icon icon-verification-email-close icon-verification-email-close-active"></i>
            </a>
        </div>
</div>

<root-scope-variable name="avatarBigUrl"
                     value="">
</root-scope-variable>
<root-scope-variable name="avatarSmallUrl" value=""></root-scope-variable>
<root-scope-variable name="currentUserName" value="黄浩旸"></root-scope-variable>
<root-scope-variable name="firstChildTeachingClassesPage"
                     value="">
</root-scope-variable>
<div id="wg-apps-panel" data-effect="pure-effect-push" ng-show="'False' == 'False' && !managingCampusSubjectLib"></div>
<div class="header header-autocollapse gtm-category" data-category="tronclass-header" ng-controller="HeaderCtrl" ng-show="'False' == 'False' && !managingCampusSubjectLib"
     ng-init="userCurrentName='黄浩旸'; orgName='学在浙大'; deliveryOrg='ZJU';
              orgLogoUrl='https://courses.zju.edu.cn:443/api/uploads/57/modified-image?thumbnail=0x272'; orgShowName='False'; orgShowLogo='True';
              orgNamesI18n={};
              langNames={'zh-TW': '繁體中文', 'zh-CN': '简体中文', 'zh-MO': '繁體中文(澳門)', 'en-US': 'English(US)', 'en-GB': 'English(UK)', 'th-TH': 'ภาษาไทย', 'id-ID': 'Bahasa Indonesia', 'ms-MY': 'Bahasa Malaysia', 'vi-VN': 'Tiếng Việt'};" ng-cloak>

        <div class="layout-row default-layout">
                <span class="application-center small-font">应用中心</span>
        <a href="http://course.zju.edu.cn" class="logo-padding" ng-cloak>
<img class="logo" ng-src="[[ getOrgLogo() ]]" ng-if="getOrgShowLogo() == 'True' && getOrgLogo()"/>
<i class="logo default" ng-if="getOrgShowLogo() == 'True' && !getOrgLogo()"></i>
<div class="school-name truncate-text" ng-show="getOrgShowName() == 'True'" ng-class="{'not-logo': !(getOrgShowLogo() == 'True' && getOrgLogo())}">
    <span tipsy="getOrgName()" ng-bind="getOrgName()"></span>
</div>        </a>
    <li class="public-course autocollapse-item" ng-class="{'margin-left-shorter': lang.indexOf('en') == 0}">
        <a class="resources header-item" ng-href="/public-course#/all">
            公开课
        </a>
    </li>

    <li class="public-course autocollapse-item" ng-class="{'margin-left-shorter': lang.indexOf('en') == 0}">
        <a class="resources header-item" ng-href="/public-studio#/all">名师工作室</a>
    </li>

        <li class="shared-resource autocollapse-item" ng-class="{'margin-left-shorter': lang.indexOf('en') == 0}">
            <a class="header-item" href="/shared-resource/search">资源</a>
        </li>
    <li class="shared-resource autocollapse-item" ng-class="{'margin-left-shorter': lang.indexOf('en') == 0}">
        <a class="header-item" href="/campus-subject-lib/">题库</a>
    </li>






    <li class="shared-resource a/public-courseutocollapse-item hide-in-middle-size"
         ng-class="{'margin-left-shorter': lang.indexOf('en') == 0}">
        <a class="header-item" href="https://classroom.zju.edu.cn/"
           target="_blank" ng-click="trackZhiyunHome()">课堂直录播</a>
    </li>






            <ul class="menu layout-menu">





<li class="header-item hide-in-small-size hide-in-middle-size navigation"
    ng-class="{'margin-left-shorter': lang.indexOf('en') == 0}">
    <a ng-click="showNavigationList()" href="javascript:void(0)" onclick="return false;" class="entry" ng-blur="hideNavigationList()">
        我的主页
        <i class="icon font font-down-arrow"></i>
    </a>

<div class="dropdown-list ng-cloak gtm-category" data-category="顶部导航" ng-show="ui.showNavigationList">
    <ul ng-mouseleave="ui.inNavigationList=false" ng-mouseenter="ui.inNavigationList=true">
        <li class="gtm-label" data-label="首页">
            <a href="/user/index" target="_self">首页</a>
        </li>

        <li class="gtm-label" data-label="我的课程">
            <a href="/user/courses" target="_self">我的课程</a>
        </li>

        <li class="gtm-label" data-label="我的资源">
            <a href="/user/resources/files" target="_self">
                我的资源
            </a>
        </li>
            <li class="gtm-label" data-label="我的小組">
                <a href="/user/resource-groups" target="_self">
                        我的小组
                </a>
            </li>
    </ul>
</div></li>
<li class="header-item hide-in-small-size hide-in-middle-size text-title"
    ng-class="{'margin-left-shorter': lang.indexOf('en') == 0}" ng-if="firstChildTeachingClassesPage">
    <a class="dashboard" ng-href="[[firstChildTeachingClassesPage]]">我的主页</a>
</li>
<li class="header-vertical-split-line  header-item"></li>
<li class="autocollapse-item header-item text-title hide-in-small-size hide-in-middle-size"
    ng-class="{'margin-left-shorter': lang.indexOf('en') == 0}">

    <a ng-click="toggleCalendar()">
        <i class="icon font font-header-calendar" style="font-size: 17px;"></i>
    </a>
</li>


<li class="notifications header-item" ng-class="{'margin-left-shorter': lang.indexOf('en') == 0}">
<script id="notification-list-server-data" type="application/json">
    {
        "teachingUnitNames": {
            "course": "课程",
            "teaching_class": "班级"
        },
        "teachingUnitRoleNames": {
            "student": "学生",
            "instructor": "教师",
            "instructor_assistant": "助教"
        },
        "notificationTypesAndText": {
            "material": "参考资料",
            "web_link": "线上链接",
            "online_video": "音视频教材",
            "slide": "微课",
            "lesson": "录播教材",
            "homework": "作业",
            "forum": "讨论区",
            "chatroom": "iSlide 直播",
            "questionnaire": "调查问卷",
            "page": "页面",
            "course_invite": "課程邀請",
            "scorm": "SCORM"
        },
        "weeklyDayTranslateForEnglish": {
            "一": "Mon",
            "二": "Tue",
            "三": "Wed",
            "四": "Thu",
            "五": "Fri",
            "六": "Sat",
            "日": "Sun"
        }
    }
</script>

<div id="notification_container">
    <translation :keys="{'view_all': '查看全部',
                        'no_notification': '暂无动态'}">
    </translation>
    <notification-container></notification-container>
</div></li>
    <li class="manual header-item autocollapse-item hide-in-middle-size"
         ng-class="{'margin-left-shorter': lang.indexOf('en') == 0}"
         ng-controller="ManualListController" ng-init="manualUrlDict={
                 'sysadmin': 'http://media.tronclass.com.cn/doc/%E9%AB%98%E6%A0%A1%E7%89%88%E7%95%85%E8%AF%BE%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C%EF%BC%88%E8%B6%85%E7%BA%A7%E7%AE%A1%E7%90%86%E5%91%98%EF%BC%89.pdf',
                 'admin': 'http://media.tronclass.com.cn/doc/%E9%AB%98%E6%A0%A1%E7%89%88%E7%95%85%E8%AF%BE%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C%EF%BC%88%E6%95%99%E5%8A%A1%E4%BA%BA%E5%91%98%EF%BC%89.pdf',
                 'instructor': 'http://media.tronclass.com.cn/doc/TronClass%E5%BF%AB%E9%80%9F%E6%8C%87%E5%BC%95%E6%89%8B%E5%86%8C%5B%E6%95%99%E5%B8%88%E7%AE%80%E4%BD%93%E7%89%88%5D_201904_v2.pdf',
                 'student': 'http://media.tronclass.com.cn/doc/TronClass%E5%BF%AB%E9%80%9F%E6%8C%87%E5%BC%95%E6%89%8B%E5%86%8C%5B%E5%AD%A6%E7%94%9F%E7%AE%80%E4%BD%93%E7%89%88%5D_201904_v2.pdf',
                 'app': 'https://tronclass.com.tw/public-manual/TronclassManual_App.pdf',
                 'tutorial_video': 'http://media.tronclass.com.cn/doc/%E6%95%99%E5%AD%A6%E8%A7%86%E9%A2%91%E6%B8%85%E5%8D%95.pdf',
                 'faq': 'https://help.tronclass.com.cn'};">

<div id="manual-viewer-popup" class="manual-viewer popup-1080 reveal-modal popup-area" resetable data-reveal popup-center-location>
    <div class="popup-content" ng-if="manualType">
        <div class="popup-header">
            <span ng-if="manualType=='sysadmin'">管理员版</span>
            <span ng-if="manualType=='admin'">教务版</span>
            <span ng-if="manualType=='instructor'">教师版</span>
            <span ng-if="manualType=='student'">学生版</span>
            <span ng-if="manualType=='app'">App</span>
            <span ng-if="manualType=='tutorial_video'">教学视频</span>
            <a class="right" close-popup="manual-viewer-popup">
                <i class="font font-close"></i>
            </a>
        </div>

        <div id="manual-viewer" class="main-area file-previewer" ng-if='manualUrl'>
            <div class="reader-wrapper">
                <iframe id='pdf-viewer' width="100%" height='100%' frameborder="0"
                        ng-src="[[trustAsResourceUrl(manualUrl)]]">
                </iframe>
<div class="toolbar-buttons"
     ng-class="{'pdf-view': upload.type == 'document', 'none-border-toolbar':upload.status != 'ready' || isIE9 || upload.isTextFile }">
    <a title="缩小" ng-click="zoomOut()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-zoom-out"></i>
    </a>
    <span class="separator" ng-if="upload.type == 'image'"></span>
    <a title="放大" ng-click="zoomIn()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-zoom-in"></i>
    </a>
    <a title="逆时针旋转" ng-click="rotateImg()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-rotate"></i>
    </a>
    <a title="复原" ng-click="restoreImg()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-restore"></i>
    </a>
    <a ng-if="forceShowDownloadButton && upload.id && upload.type != 'link' && !upload.isFromKnowledgeGraph"
       ng-href="[['/api/uploads/'+upload.id+'/blob']]" title="下载" target="_blank">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="upload.from_project && upload.allow_download"
       ng-href="[[ '/api/project/'+upload.project_id+'/share-resource/blob?upload_id='+upload.id+'&node_ids='+upload.node_ids+'&reference_id='+upload.ref_id ]]" title="下载"  target="_blank">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="!resource && !manualUrl && !canGuestPreview && upload.id && upload.type != 'link' && upload.status != 'cliping' && upload.status != 'clip_failed' && upload.status != 'uploading' && upload.status !='failed' && (upload.allow_download || (isInMyFileListPage && upload.owner_id == currentUserId)) && !upload.isFromKnowledgeGraph && !upload.from_project"
       ng-href="[[ '/api/uploads/'+upload.id+'/blob' ]]" title="下载" ng-click="downloadBlob(activity, upload)" target="_blank">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.open_scope != 'group' && !resource.share_to_id && resource.allow_download && resource.upload.status != 'uploading'" ng-click="download(resource)" title="下载">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.open_scope == 'group' && resource.allow_download && resource.upload.status != 'uploading'" ng-href="/api/shared-resources/[[resource.id]]/blob" target="_self" title="下载">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.share_to_id && resource.allow_download && resource.upload.status != 'uploading'" ng-href="/api/shared-resources-to/[[resource.id]]/blob" target="_self" title="下载">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a id="downloadManual" ng-if="!resource && manualUrl " ng-href="[[manualUrl]]"
       target="_blank" title="下载" download="manual.pdf">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="(upload.type == 'image' || upload.type == 'document' || upload.type == 'scorm') && upload.status != 'uploading' && upload.status !='failed'" ng-hide="ui.fullScreen" ng-click="enterFullScreen('.file-previewer .reader-wrapper')"
       title="进入全屏">
        <i class="icon icon-file-preview-enter-full-screen"></i>
    </a>
    <a ng-if="(upload.type == 'image' || upload.type == 'document' || upload.type == 'scorm') && upload.status != 'uploading'" ng-show="ui.fullScreen" ng-click="exitFullScreen()"
       title="退出全屏">
        <i class="icon icon-file-preview-exit-full-screen"></i>
    </a>
     <a class="open-in-browser" ng-if="upload.type == 'link'" ng-href="[[ upload.link.url ]]" target="_blank" title="在浏览器中打开">
        <i class="font font-open-in-browser-min"></i>
    </a>
</div>            </div>
        </div>

    </div>
</div>
        <a class="entry" ng-click="showManualList()" href="javascript:void(0)" onclick="return false;"
           ng-blur="hideManualList()">
            <i class="icon font font-header-help" style="font-size: 17px;"></i>
        </a>
        <div class="dropdown-list ng-cloak" ng-show="ui.showManualList"
             ng-mouseleave="ui.inManualList=false" ng-mouseenter="ui.inManualList=true">
            <ul>

                    <li>
                        <a ng-click="selectManual('instructor')" reveal-modal="manual-viewer-popup"
                           ng-if="!isHtmlManual('instructor')">教师版</a>
                        <a target="_blank" href="[[manualUrlDict.instructor]]"
                           ng-if="isHtmlManual('instructor')">教师版</a>
                    </li>
                    <li>
                        <a ng-click="selectManual('student')" reveal-modal="manual-viewer-popup"
                           ng-if="!isHtmlManual('student')">学生版</a>
                        <a target="_blank" href="[[manualUrlDict.student]]"
                           ng-if="isHtmlManual('student')">学生版</a>
                    </li>

                    <li>
                        <a ng-click="selectManual('tutorial_video')" reveal-modal="manual-viewer-popup"
                           ng-if="!isHtmlManual('tutorial_video')">教学视频</a>
                        <a target="_blank" href="[[manualUrlDict.tutorial_video]]"
                           ng-if="isHtmlManual('tutorial_video')">教学视频</a>
                    </li>
                <li ng-if="false">
                    <a ng-click="selectManual('app')" reveal-modal="manual-viewer-popup"
                       ng-if="!isHtmlManual('app')">App</a>
                    <a target="_blank" href="[[manualUrlDict.app]]"
                       ng-if="isHtmlManual('app')">App</a>
                </li>
                    <li>
                        <a target="_blank" href="[[manualUrlDict.faq]]">帮助中心</a>
                    </li>
            </ul>
        </div>
    </li>
<li class="header-vertical-split-line  header-item"></li>

<li class="profile header-item hide-in-small-size hide-in-middle-size"
    ng-class="{'margin-left-shorter': lang.indexOf('en') == 0}">
    <a href="javascript:void(0)" onclick="return false;" class="entry profile-item"
        ng-click="showUserOperationList($event)" ng-blur="hideUserOperationList()">
        <div class="avatar">
            <avatar src="avatarSmallUrl"></avatar>
        </div>
        <div class="current-user-name truncate-text">
            <span id="userCurrentName" tipsy="currentUserName" ng-bind="currentUserName"></span>
        </div>
        <i class="icon font font-down-arrow"></i>
    </a>

    <div class="dropdown-list ng-cloak" ng-show="ui.showOperList">
        <div class="user-dropdown-detail">
            <div class="avatar">
                <avatar src="avatarSmallUrl"></avatar>
            </div>
            <div class="user-info">
                <div class="user-name" ng-bind="currentUserName"></div>
                <div class="user-no">3240100106</div>
            </div>
        </div>

        <ul ng-mouseleave="ui.inOperList=false" ng-mouseenter="ui.inOperList=true" class="autocollapse-container"
            has-second-level-menu expand-left="1">
                <li class="operation operation-view-profile dropdown-item">
                    <a ng-href="/user/settings" target="_self">个人设置</a>
                </li>
            <li class="operation operation-view-profile dropdown-item">
                    <a href="javascript:void(0)" onclick="return false;" class="entry">
                        APP
                    </a>
                    <i class="icon font font-arrow-right"></i>
                    <ul class="second-level">
                        <div class="app-QRCode ng-cloak" ng-class="{'app-zju': 'ZJU' == 'ZJU' }"
                            ng-init="cloudType='private'; locale = 'zh-CN'">
                                <img src="/static/assets/images/mobile/zju-app-18b66aa3.png" />
                        </div>
                    </ul>
            </li>
            <li class="operation dropdown-item" >
                <a>简体中文</a>
                <i class="icon font font-arrow-right"></i>
                <ul class="second-level">
                    <li class="language" ng-repeat="lang in ui.langList">
                        <a ng-click="changeLanguage(lang)" ng-bind="langNames[lang]"></a>
                    </li>
                </ul>
            </li>
            <li class="split-line"></li>
            <li class="operation operation-logout dropdown-item">
                <a ng-href="/logout">退出</a>
            </li>
        </ul>
    </div>
</li>
<div ng-if="isShowCalendar">
    <div ng-controller="CalendarController"
        before-controller="weekDayMap={0: '周日', 1: '周一', 2: '周二', 3: '周三', 4: '周四', 5: '周五', 6: '周六', 7: '周日'};">
<div id="event-popup" class="reveal-modal popup-area popup-900" data-reveal resetable before-controller="calendarEventToAllCourses=false" ng-controller="CalendarEventController">
    <div class="popup-content" ng-if="popupState.popupOpened">
        <div class="popup-header">
            <span ng-if="!event.id">添加日程</span>
            <span ng-if="event.id">编辑日程</span>
            <a class="right" close-popup="event-popup">
                <i class="font font-close"></i>
            </a>
        </div>
        <div class="main-area">
            <form name="event_form" server-validated class="event-form">
                <div class="form-items [[lang]]">
                    <div class="item">
                        <div class="label">
                            <label class="required">标题</label>
                        </div>
                        <div class="input">
                            <input type="text" name="title" ng-model="event.title" server-validated/>
                        </div>
                        <span error-for="title"></span>
                    </div>
                    <div class="item">
                        <div class="label">
                            <label class="required">时间</label>
                        </div>
                        <div class="input event-time-settings">
                            <div class="datetimepicker-wrapper">
                                <input type="text" name="start_time" ng-attr-id="event-start-time"
                                       ng-model="event.start_time"
                                       server-validated datetimepicker no-time readonly ng-if="event.all_day"/>
                                <input type="text" name="start_time" ng-attr-id="event-start-time"
                                       ng-model="event.start_time"
                                       server-validated datetimepicker readonly ng-if="!event.all_day"/>
                                <label for="event-start-time" class="calendar-icon"><i class="icon icon-date-picker"></i></label>
                            </div>
                            <i class="font font-tree-collapsed"></i>
                            <div class="datetimepicker-wrapper">
                                <input type="text" name="end_time" ng-attr-id="event-end-time"
                                       ng-model="event.end_time"
                                       server-validated datetimepicker no-time readonly ng-if="event.all_day"/>
                                <input type="text" name="end_time" ng-attr-id="event-end-time"
                                       ng-model="event.end_time"
                                       server-validated datetimepicker readonly ng-if="!event.all_day"/>
                                <label for="event-end-time" class="calendar-icon"><i class="icon icon-date-picker"></i></label>
                            </div>
                            <label>
                                <input type="checkbox" name="all_day" ng-model="event.all_day" server-validated
                                       ng-change="changeAllDay()"/>
                                全天
                            </label>
                        </div>
                        <span error-for="start_time"></span>
                        <span error-for="end_time"></span>
                    </div>
                    <div class="item">
                        <div class="label">
                            <label>地点</label>
                        </div>
                        <div class="input">
                            <input type="text" name="location" ng-model="event.location" server-validated/>
                        </div>
                        <span error-for="location"></span>
                    </div>
                    <div class="item">
                        <div class="label">
                            <label>说明</label>
                        </div>
                        <div class="input">
                            <textarea sim-editor name="description"
                                      ng-model="event.description"
                                      rows="6" maxlength="2000"
                                      server-validated>
                            </textarea>
                        </div>
                        <span error-for="description"></span>
                    </div>
                    <div class="item">
                        <div class="label">
                            <label>附件</label>
                        </div>
                        <div class="input upload-wrapper" name="uploads" ng-model="uploads" server-validated>

    <div class="file-upload">
        <div class="select-file"  ng-class="{'select-file': !ui.hideAttachmentList, 'picture-select-file': ui.hideAttachmentList}">
            <button type="button" ng-click="openFileSelectModal(fileSelectContext)" on-file-selected="addFiles" file-select-scope-id="[[ fileSelectScopeId ]]">
                <i class="font font-file-select"></i><span>添加文件</span>
            </button>
        </div>
        <div ng-if="!ui.hideAttachmentList">
<div class="attachments-wrapper" ng-if="uploads.length" stop-propagation check-upload-status>

<div class="attachment-header clearfix">
    <div class="attachment-column column" ng-class="{'large-11': true, 'large-15': !true}">
        附件名
    </div>
    <div class="attachment-column column" ng-if="ui.videoType !=='sobey'"
        ng-class="{'large-7': true, 'large-10': !true}">
        大小
    </div>
        <div ng-if="airHelper.canShowAttachmentQuestion(activity) === true" class="attachment-column column large-2">题目</div>
    <div class="attachment-column column large-3">&nbsp;</div>
</div>    <div class="attachment-body">
        <div ng-repeat="upload in uploads">
        <div class="attachment-row preview-able clearfix" ng-if="canPreview(upload) && !upload.deleted && canShowResource(upload, isInstructorView)"
             previewer="{uploads: uploads, currentFile: upload, activity: activity, isAttachment: isAttachment}" reveal-modal="file-previewer" ng-click="downloadBlob(activity, upload, 'view')">



    <div class="attachment-column column large-10" ng-if="upload.type != 'slide'" ng-class="{'large-20':upload.source === 'sobey'}">
        <div ng-if="upload.source == 'auto-generated-pdf'">
            <svg class="file-text-content left">
                <use xlink:href="#file-text-content"></use>
            </svg>
            <span class="file-name-wrapper truncate-text left">
                <span class="file-name" title="[[ upload.name.split('.')[0] ]]">[[ upload.name.split('.')[0] ]]</span>
            </span>
        </div>
        <div ng-if="upload.source !== 'auto-generated-pdf'" class="w-full flex">
            <i class="font font-file-[[fileTypeByExtension(upload)]] left"></i>
            <span class="file-name-wrapper truncate-text left">
                <span class="file-name" title="[[ upload.name ]]" ng-bind="upload.name|fileName"></span>
            </span>
            <span class="file-extension left" ng-bind="upload.name|fileExtension"></span>
        </div>
    </div>
    <div class="attachment-column column large-10" ng-if="upload.type == 'slide'">
        <i class="font font-slide left"></i>
        <span class="file-name-wrapper truncate-text left">
            <span class="file-name" title="[[ upload.title ]]" ng-bind="upload.title|fileName"></span>
        </span>
    </div>
        <div class="attachment-column column attachment-state" ng-if="!upload.deleted && upload.source !== 'sobey'"
            ng-class="{'large-1': true, 'large-5': !true}">
        <span ng-if="!upload.status || upload.status === 'ready' || (upload.status === 'processing' && (upload.type === 'video' || upload.videos)) || upload.status === 'none' || upload.deleted || wpsPreview(upload)">&nbsp;</span>
        <span ng-if="(upload.status === 'failed' || uploadsStatus[upload.id] === 'failed') && !upload.deleted">&nbsp;</span>
        <span ng-if="(upload.status === 'processing' || uploadsStatus[upload.id] === 'processing') && (upload.type != 'video' || !upload.videos) && !upload.deleted && !wpsPreview(upload)">&nbsp;</span>
    </div>
    <div class="attachment-column column attachment-deleted large-5" ng-if="upload.deleted">
        <span>文件已删除</span>
    </div>
    <div class="attachment-column column attachment-size attachment-marked"
         ng-class="{'large-7': true, 'large-10': !true}"
         ng-init="isUploadFailed = (upload.status || uploadsStatus[upload.id]) == 'failed';
                  isUploadProcessing = (upload.status || uploadsStatus[upload.id]) == 'processing';
                  isNotVideo = upload.type != 'video' || !upload.videos;
                  showFileSize = !isUploadFailed && !isUploadProcessing && upload.size >= 0">
        <span ng-if="upload.source == 'LARK'" style="height: 1px;">——</span>
        <span ng-if="upload.source != 'LARK' && showFileSize" ng-bind="upload.size|humanizeBytes"></span>
        <span ng-if="upload.source != 'LARK' && !showFileSize && !upload.deleted">
            <span ng-if="isUploadFailed" class="attachment-state-failed">
                    转码失败
            </span>
            <span ng-if="isUploadProcessing && isNotVideo && !wpsPreview(upload)" class="attachment-state-processing">
                    正在转码中
            </span>
        </span>
        <div ng-if="upload.type=='scorm' && upload.scorm">
            教材大小:<span ng-bind="upload.scorm.files_size|humanizeBytes"></span>
        </div>
        <div ng-if="upload.type=='slide' && upload.duration">
            时长:<span ng-bind="upload.duration | formatTime"></span>
        </div>
    </div>



        <div ng-if="airHelper.canShowAttachmentQuestion(activity) === true" class="attachment-column column large-2">
            <span class="aiQuiz-content">
                [[upload.aiQuiz.subjectsCount || "--"]]
            </span>
        </div>

    <div class="attachment-column column"
         ng-class="{'large-7': true, 'large-5': !true}">
<span class="attachment-operations">
        <div class="horizon">



            <a ng-if="canCheckMarked(upload.id)" class="marked-details" ng-click="openMarkedDetail(upload)" stop-propagation>
                查看批注
            </a>
            <a target="_blank" ng-if="upload.source == 'LARK'" ng-href="[[upload.url]]" title="预览">
                <i class="font font-table-edit-view-2"></i>
            </a>
            <a stop-propagation previewer="{uploads: uploads, currentFile: upload, activity: activity, isAttachment: isAttachment}" reveal-modal="file-previewer"
                title="预览" ng-click="downloadBlob(activity, upload, 'view')"
                ng-if="upload.source != 'LARK' && canPreview(upload) && !upload.deleted && canShowResource(upload, isInstructorView) && upload.id > 0">
                <i class="font font-table-edit-view-2"></i>
            </a>
        <a ng-click="openSobeyVideo()" ng-if="upload.source==='sobey'">
            <i class="font font-table-edit-view-2"></i>
        </a>
        <a stop-propagation ng-click="deleteFile(upload, subject)" title="删除" ng-hide="['auditing', 'agree'].includes(upload.audit_status)" ng-class="{'delete-btn-disabled': upload.viewCount > 0}">
            <i class="font font-delete"></i>
            <span class="dropdown-item dropdown-item-hide">删除</span>
        </a>
        </div>
</span>    </div>

</div>

<div class="attachment-row clearfix" ng-if="!canPreview(upload) || upload.deleted || !canShowResource(upload, isInstructorView)" ng-click="downloadWeDrive(upload)">


    <div class="attachment-column column large-10" ng-if="upload.type != 'slide'" ng-class="{'large-20':upload.source === 'sobey'}">
        <div ng-if="upload.source == 'auto-generated-pdf'">
            <svg class="file-text-content left">
                <use xlink:href="#file-text-content"></use>
            </svg>
            <span class="file-name-wrapper truncate-text left">
                <span class="file-name" title="[[ upload.name.split('.')[0] ]]">[[ upload.name.split('.')[0] ]]</span>
            </span>
        </div>
        <div ng-if="upload.source !== 'auto-generated-pdf'" class="w-full flex">
            <i class="font font-file-[[fileTypeByExtension(upload)]] left"></i>
            <span class="file-name-wrapper truncate-text left">
                <span class="file-name" title="[[ upload.name ]]" ng-bind="upload.name|fileName"></span>
            </span>
            <span class="file-extension left" ng-bind="upload.name|fileExtension"></span>
        </div>
    </div>
    <div class="attachment-column column large-10" ng-if="upload.type == 'slide'">
        <i class="font font-slide left"></i>
        <span class="file-name-wrapper truncate-text left">
            <span class="file-name" title="[[ upload.title ]]" ng-bind="upload.title|fileName"></span>
        </span>
    </div>
        <div class="attachment-column column attachment-state" ng-if="!upload.deleted && upload.source !== 'sobey'"
            ng-class="{'large-1': true, 'large-5': !true}">
        <span ng-if="!upload.status || upload.status === 'ready' || (upload.status === 'processing' && (upload.type === 'video' || upload.videos)) || upload.status === 'none' || upload.deleted || wpsPreview(upload)">&nbsp;</span>
        <span ng-if="(upload.status === 'failed' || uploadsStatus[upload.id] === 'failed') && !upload.deleted">&nbsp;</span>
        <span ng-if="(upload.status === 'processing' || uploadsStatus[upload.id] === 'processing') && (upload.type != 'video' || !upload.videos) && !upload.deleted && !wpsPreview(upload)">&nbsp;</span>
    </div>
    <div class="attachment-column column attachment-deleted large-5" ng-if="upload.deleted">
        <span>文件已删除</span>
    </div>
    <div class="attachment-column column attachment-size attachment-marked"
         ng-class="{'large-7': true, 'large-10': !true}"
         ng-init="isUploadFailed = (upload.status || uploadsStatus[upload.id]) == 'failed';
                  isUploadProcessing = (upload.status || uploadsStatus[upload.id]) == 'processing';
                  isNotVideo = upload.type != 'video' || !upload.videos;
                  showFileSize = !isUploadFailed && !isUploadProcessing && upload.size >= 0">
        <span ng-if="upload.source == 'LARK'" style="height: 1px;">——</span>
        <span ng-if="upload.source != 'LARK' && showFileSize" ng-bind="upload.size|humanizeBytes"></span>
        <span ng-if="upload.source != 'LARK' && !showFileSize && !upload.deleted">
            <span ng-if="isUploadFailed" class="attachment-state-failed">
                    转码失败
            </span>
            <span ng-if="isUploadProcessing && isNotVideo && !wpsPreview(upload)" class="attachment-state-processing">
                    正在转码中
            </span>
        </span>
        <div ng-if="upload.type=='scorm' && upload.scorm">
            教材大小:<span ng-bind="upload.scorm.files_size|humanizeBytes"></span>
        </div>
        <div ng-if="upload.type=='slide' && upload.duration">
            时长:<span ng-bind="upload.duration | formatTime"></span>
        </div>
    </div>



        <div ng-if="airHelper.canShowAttachmentQuestion(activity) === true" class="attachment-column column large-2">
            <span class="aiQuiz-content">
                [[upload.aiQuiz.subjectsCount || "--"]]
            </span>
        </div>

    <div class="attachment-column column"
         ng-class="{'large-7': true, 'large-5': !true}">
<span class="attachment-operations">
        <div class="horizon">



            <a ng-if="canCheckMarked(upload.id)" class="marked-details" ng-click="openMarkedDetail(upload)" stop-propagation>
                查看批注
            </a>
            <a target="_blank" ng-if="upload.source == 'LARK'" ng-href="[[upload.url]]" title="预览">
                <i class="font font-table-edit-view-2"></i>
            </a>
            <a stop-propagation previewer="{uploads: uploads, currentFile: upload, activity: activity, isAttachment: isAttachment}" reveal-modal="file-previewer"
                title="预览" ng-click="downloadBlob(activity, upload, 'view')"
                ng-if="upload.source != 'LARK' && canPreview(upload) && !upload.deleted && canShowResource(upload, isInstructorView) && upload.id > 0">
                <i class="font font-table-edit-view-2"></i>
            </a>
        <a ng-click="openSobeyVideo()" ng-if="upload.source==='sobey'">
            <i class="font font-table-edit-view-2"></i>
        </a>
        <a stop-propagation ng-click="deleteFile(upload, subject)" title="删除" ng-hide="['auditing', 'agree'].includes(upload.audit_status)" ng-class="{'delete-btn-disabled': upload.viewCount > 0}">
            <i class="font font-delete"></i>
            <span class="dropdown-item dropdown-item-hide">删除</span>
        </a>
        </div>
</span>    </div>

</div>        </div>
    </div>
</div>        </div>
    </div>
                        </div>
                        <div class="error">
                            <span error-for="uploads"></span>
                        </div>
                    </div>
                    <div class="item" ng-show="showTargetType()">
                        <div class="label">
                            <label>发布到</label>
                        </div>
                        <div class="input">
                            <div class="select2-wrapper target-type">
                                <select ui-select2="{dropdownCssClass: 'select2-drop-without-search'}"
                                        ng-model="event.target_type"
                                        ng-change="changeTargetType()">
                                    <option value="self">自己</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="item">
                        <div class="label">
                            <label>提醒</label>
                        </div>
                        <div class="input">
                            <div class="choice">
                                <label>
                                    <input type="radio" name="hasAlert"
                                           ng-model="ui.hasAlert"
                                           ng-change="changeHasAlert()"
                                           ng-value="0"/>
                                    无
                                </label>
                                <label>
                                    <input type="radio" name="hasAlert"
                                           ng-model="ui.hasAlert"
                                           ng-change="changeHasAlert()"
                                           ng-value="1"/>
                                    到期提醒
                                </label>
                            </div>
                            <div class="select2-wrapper alert" ng-show="ui.hasAlert">
                                <select ui-select2="{dropdownCssClass: 'select2-drop-without-search'}"
                                        ng-model="event.alert_id">
                                    <option ng-repeat="alert in ui.alerts"
                                            ng-value="alert.id" ng-bind="alert.text"></option>
                                </select>
                            </div>
                            <label ng-if="ui.hasAlert">
                                <input type="checkbox" name="send_alert_email" ng-model="event.send_alert_email" server-validated/>
                                同时 Email 通知
                            </label>
                        </div>
                    </div>
                    <div class="item">
                        <div class="label">
                            <label class="required">类型</label>
                        </div>
                        <div class="input">
                            <calendar-color-select ng-prop-tags="ui.tags" ng-prop-value="event.tag_id" name="tag_id"></calendar-color-select>
                        </div>
                    </div>
                </div>
                <div class="form-buttons text-center">
<div class="loading-spinner" ng-show="loading">
    <div class="spinner">
        <div class="mask">
            <div class="maskedCircle"></div>
        </div>
    </div>
</div>                    <button class="button button-green medium" ng-hide="loading" ng-click="save()"
                            type="button">保存</button>
                    <button type="button" class="button button-grey medium" ng-hide="loading"
                            close-popup="event-popup">取消</button>
                </div>
            </form>
        </div>
    </div>
<div class="hide">
    <span id="selected-text">已选择 # 个&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span id="selected-text-all">全部&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span id="filter-placeholder">请输入关键字</span>
</div></div><div id="timetable-popup" class="reveal-modal popup-area popup-600" data-reveal resetable
     ng-controller="CalendarTimetableController">
    <div class="popup-content" ng-if="popupState.popupOpened">
        <div class="popup-header">
            <span ng-if="!timetable.id">添加课程</span>
            <span ng-if="timetable.id">编辑课程</span>
            <a class="right" close-popup="timetable-popup">
                <i class="font font-close"></i>
            </a>
        </div>
        <div class="main-area">
            <form name="timetableForm" server-validated>
                <div class="form-items [[lang]]">
                    <div class="item" ng-if="!timetable.id">
                        <div class="label">
                            <label class="required">选择课程</label>
                        </div>
                        <div class="input">
                            <div class="select2-wrapper course">
                                <select ui-select2="{placeholder: '选择课程'}"
                                        ng-model="timetable.course_id"
                                        ng-change="changeCourse()"
                                        name="course_id">
                                    <option value=""></option>
                                    <option ng-repeat="course in courses"
                                            ng-value="course.id" ng-bind="course.display_text"></option>
                                </select>
                            </div>
                        </div>
                        <span error-for="course_id"></span>
                    </div>
                    <div class="item flex" ng-if="timetable.course_id &&!timetable.id">
                        <div class="label">
                        </div>
                        <div class="course-info">
                            <div>
                                <span>课程名称</span>:
                                <span>[[timetable.course_title]]</span>
                            </div>
                            <div>
                                <span>授课教师</span>:
                                <span>[[timetable.instructors_names]]</span>
                            </div>
                        </div>
                    </div>
                    <div class="item">
                        <div class="label">
                            <label class="required">上课时间</label>
                        </div>
                        <div class="input time-settings">
                            <div class="datetimepicker-wrapper">
                                <input type="text" name="start_time" id="timetable-start-time" datetimepicker
                                       ng-model="timetable.start_time" server-validated />
                                <label for="timetable-start-time" class="calendar-icon"><i class="icon icon-date-picker"></i></label>
                            </div>
                            <i class="font font-tree-collapsed"></i>
                            <div class="datetimepicker-wrapper">
                                <input type="text" name="end_time" id="timetable-end-time" datetimepicker
                                       ng-model="timetable.end_time" server-validated />
                                <label for="timetable-end-time" class="calendar-icon"><i class="icon icon-date-picker"></i></label>
                            </div>
                        </div>
                        <span error-for="start_time"></span>
                        <span error-for="end_time"></span>
                    </div>
                    <div class="item" ng-if="timetable.id">
                        <div class="label">
                            <label>范围</label>
                        </div>
                        <div class="input">
                            <div class="choice">
                                <label>
                                    <input type="radio" name="scope" ng-model="timetable.update_scope" value="current"/>
                                    本节次
                                </label>
                                <label>
                                    <input type="radio" name="scope" ng-model="timetable.update_scope" value="current_and_after"/>
                                    本节次及后续节次
                                </label>
                                <label>
                                    <input type="radio" name="scope" ng-model="timetable.update_scope" value="all"/>
                                    所有节次
                                </label>
                            </div>
                        </div>
                    </div>
                    <div ng-if="!timetable.id || timetable.update_scope != 'current'">
                        <div class="item">
                            <div class="label">
                                <label>重复频率</label>
                            </div>
                            <div class="input frequency">
                                <div class="select2-wrapper repeat-type">
                                    <select ui-select2="{dropdownCssClass: 'select2-drop-without-search'}"
                                            ng-model="timetable.repeat_type">
                                        <option value="no_repeat">不重复</option>
                                        <option value="day">每天</option>
                                        <option value="week">每周</option>
                                        <option value="custom">自定义</option>
                                    </select>
                                </div>
                                <div ng-if="timetable.repeat_type=='custom'">
                                    <input type="text" name="repeat_frequency" ng-model="timetable.repeat_frequency"
                                           data-min="1" integer-limit server-validated />
                                    <span>周</span>
                                    <span class="frequency-error" error-for="repeat_frequency"></span>
                                </div>
                            </div>
                        </div>
                        <div class="item" ng-if="timetable.repeat_type=='week' || timetable.repeat_type=='custom'">
                            <div class="label">
                                <label class="required">重复时间</label>
                            </div>
                            <div class="input">
                                <div class="weekly-day" ng-repeat="day in weeklyDays">
                                    <input type="checkbox" name="days" ng-checked="timetable.repeat_weekly_days.indexOf(day.val) > -1">
                                    <span ng-bind="day.name" ng-click="toggleSelectDay(day.val)"></span>
                                </div>
                            </div>
                            <div ng-if="showWeeklyDaysError" class="error">该字段是必填字段。</div>
                        </div>
                        <div class="item" ng-if="timetable.repeat_type!='no_repeat'">
                            <div class="label">
                                <label class="required">结束时间</label>
                            </div>
                            <div class="input course-end-date">
                                <div class="datetimepicker-wrapper">
                                    <input type="text" name="repeat_end_date" id="repeat-end-date" datepicker
                                           ng-model="timetable.repeat_end_date" server-validated />
                                    <label for="repeat-end-date" class="calendar-icon"><i class="icon icon-date-picker"></i></label>
                                </div>
                            </div>
                            <span ng-if="timetable.course_end_date">课程结束日期：<span ng-bind="timetable.course_end_date"></span></span>
                            <span error-for="repeat_end_date"></span>
                        </div>
                    </div>
                    <div class="item">
                        <div class="label">
                            <label>地点</label>
                        </div>
                        <div class="input">
                            <input class="location" type="text" name="location" ng-model="timetable.location" maxlength="255" server-validated/>
                        </div>
                        <span error-for="location"></span>
                    </div>
                    <div class="item">
                        <div class="label">
                            <label>说明</label>
                        </div>
                        <div class="input">
                            <textarea class="description" name="description" ng-model="timetable.description"
                                      maxlength="500" server-validated></textarea>
                        </div>
                        <span error-for="description"></span>
                    </div>
                    <div class="item" ng-if="timetable.id">
                        <div class="label">
                            <label>发调课通知</label>
                        </div>
                        <div class="input">
                            <div class="choice send-ntf-choice">
                                <label>
                                    <input type="radio" name="sendNtf" ng-model="timetable.send_ntf" ng-value="false">
                                    否
                                </label>
                                <label>
                                    <input type="radio" name="sendNtf" ng-model="timetable.send_ntf" ng-value="true">
                                    是
                                </label>
                            </div>
                        </div>
                        <div class="input ntf-content-wrapper" ng-if="timetable.send_ntf">
                            <textarea class="ntf-content" name="ntf_content" ng-model="timetable.ntf_content" server-validated></textarea>
                        </div>
                        <span error-for="ntf_content"></span>
                    </div>
                </div>
                <div class="form-buttons text-center">
<div class="loading-spinner" ng-show="loading">
    <div class="spinner">
        <div class="mask">
            <div class="maskedCircle"></div>
        </div>
    </div>
</div>                    <button class="button button-green medium" ng-hide="loading" ng-click="save()"
                            type="button">保存</button>
                    <button type="button" class="button button-grey medium" ng-hide="loading"
                            close-popup="timetable-popup">取消</button>
                </div>
            </form>
        </div>
    </div>
</div><div id="calendar-detail-popup">
    <div class="title-container" ng-style="{'background-color': currentCalendar.backgroundColor}">
        <div class="operations right" ng-init="userId=281121;">
            <a ng-if="currentCalendar.editable" ng-hide="currentCalendar.data.audit_status === 'auditing'"
               ng-click="editCalendar(currentCalendar)">
                <i class="font font-edit"></i>
            </a>
            <a ng-if="currentCalendar.editable" ng-hide="['auditing', 'agree'].includes(currentCalendar.data.audit_status)"
               ng-click="deleteCalendar(currentCalendar)">
                <i class="font font-delete"></i>
            </a>
            <a ng-click="closeCalendarDetailPopover()">
                <i class="font font-close"></i>
            </a>
        </div>
        <div class="event-title title">
            <span class="tag" ng-bind="currentCalendar.data.tag.name" ng-if="currentCalendar.data.tag" ng-style="{'background-color': currentCalendar.backgroundColor,'color':currentCalendar.data.tag.color,'border-color':currentCalendar.data.tag.color}"></span>
            <span class="tag" ng-if="currentCalendar.type === 'timetable'" ng-style="{'background-color': currentCalendar.backgroundColor,'color':currentCalendar.data.color,'border-color':currentCalendar.data.color}">
                课程
            </span>
            <span ng-bind="currentCalendar.title"></span>
        </div>
    </div>
    <div class="form-items [[lang]]">
        <div class="item">
            <div class="item-name">
                <i class="font font-calendar-clock"></i>时间
            </div>
            <div class="item-value">
                <div class="time-range"><span ng-bind="currentCalendar.timeRange"></span></div>
                <div class="all-day" ng-if="currentCalendar.allDay">全天</div>
            </div>
        </div>
        <div class="item" ng-if="currentCalendar.data.instructors_names">
            <div class="item-name">
                <i class="font font-calendar-teacher"></i>教师
            </div>
            <div class="item-value">
                <span class="instructors" ng-bind="currentCalendar.data.instructors_names"></span>
            </div>
        </div>
        <div class="item" ng-if="currentCalendar.data.location">
            <div class="item-name">
                <i class="font font-calendar-location"></i>地点
            </div>
            <div class="item-value truncate-text">
                <span class="location" ng-bind-html="currentCalendar.data.location | linkify: '_blank'"></span>
            </div>
        </div>
        <div class="item" ng-if="currentCalendar.course && currentCalendar.course.name">
            <div class="item-name">
                <i class="font font-course"></i>课程
            </div>
            <div class="item-value truncate-text">
                <span class="course" ng-bind="currentCalendar.course.name"></span>
            </div>
        </div>
        <div class="item" ng-if="currentCalendar.room && currentCalendar.room.room_name">
            <div class="item-name">
                <i class="font font-room"></i>教室
            </div>
            <div class="item-value">
               <span class="room" ng-bind="currentCalendar.room.room_name"></span>
            </div>
        </div>
        <div class="item" ng-if="currentCalendar.alertTime">
            <div class="item-name">
                <i class="font font-unmute"></i>提醒
            </div>
            <div class="item-value">
                <span>[[currentCalendar.alertTime]]</span>
                <span ng-if="currentCalendar.data.send_alert_email">
                    (同时 Email 通知)
                </span>
            </div>
        </div>
        <div class="item" ng-if="currentCalendar.data.created_by && !currentCalendar.isOwner">
            <div class="item-name">
                <i class="font font-user-group"></i>组织者
            </div>
            <div class="item-value">
                <span>[[currentCalendar.data.created_by.name]]([[currentCalendar.data.created_by.user_no]])</span>
            </div>
        </div>
        <div class="item" ng-if="currentCalendar.type === 'event'">
            <div class="item-name">
                <i class="font font-publish-course"></i>发布到
            </div>
            <div class="item-value">
                <span ng-if="currentCalendar.data.target_data.department_ids">院系</span>
                <span ng-if="currentCalendar.data.target_data.course_id || currentCalendar.data.target_data.course_ids">课程</span>
                <span ng-if="!currentCalendar.data.target_data.department_ids && !currentCalendar.data.target_data.course_id && !currentCalendar.data.target_data.course_ids"> 自己 </span>
            </div>
        </div>
        <div class="item" ng-if="currentCalendar.data.description">
            <div class="item-name">
                <i class="font font-calendar-remark"></i>描述
            </div>
            <div class="item-value description mobile-scrollbar">
                <span ng-bind-html="currentCalendar.data.description | sanitizeHtml" ng-if="currentCalendar.type == 'event'"></span>
                <span ng-bind-html="currentCalendar.data.description | linkify: '_blank'" ng-if="currentCalendar.type == 'timetable'"></span>
            </div>
        </div>
        <div class="item attachment-list">
                <div class="activity-attribute" ng-if="uploads.length">
<div class="attachments-wrapper" ng-if="uploads.length" stop-propagation check-upload-status>

<div class="attachment-header clearfix">
    <div class="attachment-column column" ng-class="{'large-11': true, 'large-15': !true}">
        附件名
    </div>
    <div class="attachment-column column" ng-if="ui.videoType !=='sobey'"
        ng-class="{'large-7': true, 'large-10': !true}">
        大小
    </div>
        <div ng-if="airHelper.canShowAttachmentQuestion(activity) === true" class="attachment-column column large-2">题目</div>
    <div class="attachment-column column large-3">&nbsp;</div>
</div>    <div class="attachment-body">
        <div ng-repeat="upload in uploads">
        <div class="attachment-row preview-able clearfix" ng-if="canPreview(upload) && !upload.deleted && canShowResource(upload, isInstructorView)"
             previewer="{uploads: uploads, currentFile: upload, activity: activity, isAttachment: isAttachment}" reveal-modal="file-previewer" ng-click="downloadBlob(activity, upload, 'view')">

    <!-- Transcoding failed or transcoding in progress -->
    <div ng-if="((upload.status === 'failed' || uploadsStatus[upload.id] === 'failed') && !upload.deleted) || ((upload.status === 'processing' || uploadsStatus[upload.id] === 'processing') && (upload.type != 'video' || !upload.videos) && !upload.deleted && !wpsPreview(upload))">


    <div class="attachment-column column large-10" ng-if="upload.type != 'slide'" ng-class="{'large-20':upload.source === 'sobey'}">
        <div ng-if="upload.source == 'auto-generated-pdf'">
            <svg class="file-text-content left">
                <use xlink:href="#file-text-content"></use>
            </svg>
            <span class="file-name-wrapper truncate-text left">
                <span class="file-name" title="[[ upload.name.split('.')[0] ]]">[[ upload.name.split('.')[0] ]]</span>
            </span>
        </div>
        <div ng-if="upload.source !== 'auto-generated-pdf'" class="w-full flex">
            <i class="font font-file-[[fileTypeByExtension(upload)]] left"></i>
            <span class="file-name-wrapper truncate-text left">
                <span class="file-name" title="[[ upload.name ]]" ng-bind="upload.name|fileName"></span>
            </span>
            <span class="file-extension left" ng-bind="upload.name|fileExtension"></span>
        </div>
    </div>
    <div class="attachment-column column large-10" ng-if="upload.type == 'slide'">
        <i class="font font-slide left"></i>
        <span class="file-name-wrapper truncate-text left">
            <span class="file-name" title="[[ upload.title ]]" ng-bind="upload.title|fileName"></span>
        </span>
    </div>
    <div class="attachment-column column attachment-state large-5" style="margin-left:55px;">
        <span ng-if="!upload.status || upload.status === 'ready' || (upload.status === 'processing' && (upload.type === 'video' || upload.videos)) || upload.status === 'none' || upload.deleted || wpsPreview(upload)">&nbsp;</span>
        <span ng-if="(upload.status === 'failed' || uploadsStatus[upload.id] === 'failed') && !upload.deleted">&nbsp;</span>
        <span ng-if="(upload.status === 'processing' || uploadsStatus[upload.id] === 'processing') && (upload.type != 'video' || !upload.videos) && !upload.deleted && !wpsPreview(upload)">&nbsp;</span>
    </div>
    <div class="attachment-column column attachment-deleted large-5" ng-if="upload.deleted">
        <span>文件已删除</span>
    </div>



        <div ng-if="airHelper.canShowAttachmentQuestion(activity) === true" class="attachment-column column large-2">
            <span class="aiQuiz-content">
                [[upload.aiQuiz.subjectsCount || "--"]]
            </span>
        </div>

    <div class="attachment-column column"
         ng-class="{'large-7': true, 'large-5': !true}">
<span class="attachment-operations calender-right">
        <div class="horizon">



            <a ng-if="canCheckMarked(upload.id)" class="marked-details" ng-click="openMarkedDetail(upload)" stop-propagation>
                查看批注
            </a>
            <a target="_blank" ng-if="upload.source == 'LARK'" ng-href="[[upload.url]]" title="预览">
                <i class="font font-table-edit-view-2"></i>
            </a>
            <a stop-propagation previewer="{uploads: uploads, currentFile: upload, activity: activity, isAttachment: isAttachment}" reveal-modal="file-previewer"
                title="预览" ng-click="downloadBlob(activity, upload, 'view')"
                ng-if="upload.source != 'LARK' && canPreview(upload) && !upload.deleted && canShowResource(upload, isInstructorView) && upload.id > 0">
                <i class="font font-table-edit-view-2"></i>
            </a>
        <a ng-click="openSobeyVideo()" ng-if="upload.source==='sobey'">
            <i class="font font-table-edit-view-2"></i>
        </a>
                <a stop-propagation ng-href="/api/uploads/reference/[[upload.reference_id]]/blob" target="_blank"
                    title="下载" ng-click="downloadBlob(activity, upload)"
                    ng-if="upload.reference_id && !upload.deleted && upload.allow_download && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
                <a stop-propagation ng-href="/api/uploads/[[upload.id]]/blob?preview=true&activity_type=[[activity.type]]" target="_blank"
                    title="下载" ng-click="downloadBlob(activity, upload)"
                    ng-if="!upload.reference_id && !upload.deleted && upload.allow_download && !upload.source && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
                <a stop-propagation ng-href="[[upload.url]]/download" target="_blank"
                    title="下载" ng-click="downloadBlob(activity, upload)"
                    ng-if="upload.source && !['LARK', 'auto-generated-pdf', 'WEDRIVE'].includes(upload.source) && !upload.reference_id && !upload.deleted && upload.allow_download && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
                <!-- 针对特殊source类型 -->
                <a stop-propagation ng-href="/api/uploads/[[upload.id]]/blob"
                    title="下载" ng-click="downloadBlob(activity, upload)"
                    ng-if="!upload.reference_id && !upload.deleted && upload.allow_download && ['auto-generated-pdf'].includes(upload.source) && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
                <a stop-propagation ng-href="/api/wedrive/file/[[upload.fileid]]"
                    title="下载"
                    ng-if="!upload.deleted && upload.allow_download && upload.source == 'WEDRIVE' && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
        </div>
</span>    </div>

    </div>
    <div ng-if="!(((upload.status === 'failed' || uploadsStatus[upload.id] === 'failed') && !upload.deleted) || ((upload.status === 'processing' || uploadsStatus[upload.id] === 'processing') && (upload.type != 'video' || !upload.videos) && !upload.deleted && !wpsPreview(upload)))">


    <div class="attachment-column column large-10" ng-if="upload.type != 'slide'" ng-class="{'large-20':upload.source === 'sobey'}">
        <div ng-if="upload.source == 'auto-generated-pdf'">
            <svg class="file-text-content left">
                <use xlink:href="#file-text-content"></use>
            </svg>
            <span class="file-name-wrapper truncate-text left">
                <span class="file-name" title="[[ upload.name.split('.')[0] ]]">[[ upload.name.split('.')[0] ]]</span>
            </span>
        </div>
        <div ng-if="upload.source !== 'auto-generated-pdf'" class="w-full flex">
            <i class="font font-file-[[fileTypeByExtension(upload)]] left"></i>
            <span class="file-name-wrapper truncate-text left">
                <span class="file-name" title="[[ upload.name ]]" ng-bind="upload.name|fileName"></span>
            </span>
            <span class="file-extension left" ng-bind="upload.name|fileExtension"></span>
        </div>
    </div>
    <div class="attachment-column column large-10" ng-if="upload.type == 'slide'">
        <i class="font font-slide left"></i>
        <span class="file-name-wrapper truncate-text left">
            <span class="file-name" title="[[ upload.title ]]" ng-bind="upload.title|fileName"></span>
        </span>
    </div>
        <div class="attachment-column column attachment-state" ng-if="!upload.deleted && upload.source !== 'sobey'"
            ng-class="{'large-1': true, 'large-5': !true}">
        <span ng-if="!upload.status || upload.status === 'ready' || (upload.status === 'processing' && (upload.type === 'video' || upload.videos)) || upload.status === 'none' || upload.deleted || wpsPreview(upload)">&nbsp;</span>
        <span ng-if="(upload.status === 'failed' || uploadsStatus[upload.id] === 'failed') && !upload.deleted">&nbsp;</span>
        <span ng-if="(upload.status === 'processing' || uploadsStatus[upload.id] === 'processing') && (upload.type != 'video' || !upload.videos) && !upload.deleted && !wpsPreview(upload)">&nbsp;</span>
    </div>
    <div class="attachment-column column attachment-deleted large-5" ng-if="upload.deleted">
        <span>文件已删除</span>
    </div>
    <div class="attachment-column column attachment-size attachment-marked"
         ng-class="{'large-7': true, 'large-10': !true}"
         ng-init="isUploadFailed = (upload.status || uploadsStatus[upload.id]) == 'failed';
                  isUploadProcessing = (upload.status || uploadsStatus[upload.id]) == 'processing';
                  isNotVideo = upload.type != 'video' || !upload.videos;
                  showFileSize = !isUploadFailed && !isUploadProcessing && upload.size >= 0">
        <span ng-if="upload.source == 'LARK'" style="height: 1px;">——</span>
        <span ng-if="upload.source != 'LARK' && showFileSize" ng-bind="upload.size|humanizeBytes"></span>
        <span ng-if="upload.source != 'LARK' && !showFileSize && !upload.deleted">
            <span ng-if="isUploadFailed" class="attachment-state-failed">
                    转码失败
            </span>
            <span ng-if="isUploadProcessing && isNotVideo && !wpsPreview(upload)" class="attachment-state-processing">
                    正在转码中
            </span>
        </span>
        <div ng-if="upload.type=='scorm' && upload.scorm">
            教材大小:<span ng-bind="upload.scorm.files_size|humanizeBytes"></span>
        </div>
        <div ng-if="upload.type=='slide' && upload.duration">
            时长:<span ng-bind="upload.duration | formatTime"></span>
        </div>
    </div>



        <div ng-if="airHelper.canShowAttachmentQuestion(activity) === true" class="attachment-column column large-2">
            <span class="aiQuiz-content">
                [[upload.aiQuiz.subjectsCount || "--"]]
            </span>
        </div>

    <div class="attachment-column column"
         ng-class="{'large-7': true, 'large-5': !true}">
<span class="attachment-operations calender-right">
        <div class="horizon">



            <a ng-if="canCheckMarked(upload.id)" class="marked-details" ng-click="openMarkedDetail(upload)" stop-propagation>
                查看批注
            </a>
            <a target="_blank" ng-if="upload.source == 'LARK'" ng-href="[[upload.url]]" title="预览">
                <i class="font font-table-edit-view-2"></i>
            </a>
            <a stop-propagation previewer="{uploads: uploads, currentFile: upload, activity: activity, isAttachment: isAttachment}" reveal-modal="file-previewer"
                title="预览" ng-click="downloadBlob(activity, upload, 'view')"
                ng-if="upload.source != 'LARK' && canPreview(upload) && !upload.deleted && canShowResource(upload, isInstructorView) && upload.id > 0">
                <i class="font font-table-edit-view-2"></i>
            </a>
        <a ng-click="openSobeyVideo()" ng-if="upload.source==='sobey'">
            <i class="font font-table-edit-view-2"></i>
        </a>
                <a stop-propagation ng-href="/api/uploads/reference/[[upload.reference_id]]/blob" target="_blank"
                    title="下载" ng-click="downloadBlob(activity, upload)"
                    ng-if="upload.reference_id && !upload.deleted && upload.allow_download && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
                <a stop-propagation ng-href="/api/uploads/[[upload.id]]/blob?preview=true&activity_type=[[activity.type]]" target="_blank"
                    title="下载" ng-click="downloadBlob(activity, upload)"
                    ng-if="!upload.reference_id && !upload.deleted && upload.allow_download && !upload.source && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
                <a stop-propagation ng-href="[[upload.url]]/download" target="_blank"
                    title="下载" ng-click="downloadBlob(activity, upload)"
                    ng-if="upload.source && !['LARK', 'auto-generated-pdf', 'WEDRIVE'].includes(upload.source) && !upload.reference_id && !upload.deleted && upload.allow_download && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
                <!-- 针对特殊source类型 -->
                <a stop-propagation ng-href="/api/uploads/[[upload.id]]/blob"
                    title="下载" ng-click="downloadBlob(activity, upload)"
                    ng-if="!upload.reference_id && !upload.deleted && upload.allow_download && ['auto-generated-pdf'].includes(upload.source) && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
                <a stop-propagation ng-href="/api/wedrive/file/[[upload.fileid]]"
                    title="下载"
                    ng-if="!upload.deleted && upload.allow_download && upload.source == 'WEDRIVE' && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
        </div>
</span>    </div>

    </div>
</div>

<div class="attachment-row clearfix" ng-if="!canPreview(upload) || upload.deleted || !canShowResource(upload, isInstructorView)" ng-click="downloadWeDrive(upload)">


    <div class="attachment-column column large-10" ng-if="upload.type != 'slide'" ng-class="{'large-20':upload.source === 'sobey'}">
        <div ng-if="upload.source == 'auto-generated-pdf'">
            <svg class="file-text-content left">
                <use xlink:href="#file-text-content"></use>
            </svg>
            <span class="file-name-wrapper truncate-text left">
                <span class="file-name" title="[[ upload.name.split('.')[0] ]]">[[ upload.name.split('.')[0] ]]</span>
            </span>
        </div>
        <div ng-if="upload.source !== 'auto-generated-pdf'" class="w-full flex">
            <i class="font font-file-[[fileTypeByExtension(upload)]] left"></i>
            <span class="file-name-wrapper truncate-text left">
                <span class="file-name" title="[[ upload.name ]]" ng-bind="upload.name|fileName"></span>
            </span>
            <span class="file-extension left" ng-bind="upload.name|fileExtension"></span>
        </div>
    </div>
    <div class="attachment-column column large-10" ng-if="upload.type == 'slide'">
        <i class="font font-slide left"></i>
        <span class="file-name-wrapper truncate-text left">
            <span class="file-name" title="[[ upload.title ]]" ng-bind="upload.title|fileName"></span>
        </span>
    </div>
        <div class="attachment-column column attachment-state" ng-if="!upload.deleted && upload.source !== 'sobey'"
            ng-class="{'large-1': true, 'large-5': !true}">
        <span ng-if="!upload.status || upload.status === 'ready' || (upload.status === 'processing' && (upload.type === 'video' || upload.videos)) || upload.status === 'none' || upload.deleted || wpsPreview(upload)">&nbsp;</span>
        <span ng-if="(upload.status === 'failed' || uploadsStatus[upload.id] === 'failed') && !upload.deleted">&nbsp;</span>
        <span ng-if="(upload.status === 'processing' || uploadsStatus[upload.id] === 'processing') && (upload.type != 'video' || !upload.videos) && !upload.deleted && !wpsPreview(upload)">&nbsp;</span>
    </div>
    <div class="attachment-column column attachment-deleted large-5" ng-if="upload.deleted">
        <span>文件已删除</span>
    </div>
    <div class="attachment-column column attachment-size attachment-marked"
         ng-class="{'large-7': true, 'large-10': !true}"
         ng-init="isUploadFailed = (upload.status || uploadsStatus[upload.id]) == 'failed';
                  isUploadProcessing = (upload.status || uploadsStatus[upload.id]) == 'processing';
                  isNotVideo = upload.type != 'video' || !upload.videos;
                  showFileSize = !isUploadFailed && !isUploadProcessing && upload.size >= 0">
        <span ng-if="upload.source == 'LARK'" style="height: 1px;">——</span>
        <span ng-if="upload.source != 'LARK' && showFileSize" ng-bind="upload.size|humanizeBytes"></span>
        <span ng-if="upload.source != 'LARK' && !showFileSize && !upload.deleted">
            <span ng-if="isUploadFailed" class="attachment-state-failed">
                    转码失败
            </span>
            <span ng-if="isUploadProcessing && isNotVideo && !wpsPreview(upload)" class="attachment-state-processing">
                    正在转码中
            </span>
        </span>
        <div ng-if="upload.type=='scorm' && upload.scorm">
            教材大小:<span ng-bind="upload.scorm.files_size|humanizeBytes"></span>
        </div>
        <div ng-if="upload.type=='slide' && upload.duration">
            时长:<span ng-bind="upload.duration | formatTime"></span>
        </div>
    </div>



        <div ng-if="airHelper.canShowAttachmentQuestion(activity) === true" class="attachment-column column large-2">
            <span class="aiQuiz-content">
                [[upload.aiQuiz.subjectsCount || "--"]]
            </span>
        </div>

    <div class="attachment-column column"
         ng-class="{'large-7': true, 'large-5': !true}">
<span class="attachment-operations calender-right">
        <div class="horizon">



            <a ng-if="canCheckMarked(upload.id)" class="marked-details" ng-click="openMarkedDetail(upload)" stop-propagation>
                查看批注
            </a>
            <a target="_blank" ng-if="upload.source == 'LARK'" ng-href="[[upload.url]]" title="预览">
                <i class="font font-table-edit-view-2"></i>
            </a>
            <a stop-propagation previewer="{uploads: uploads, currentFile: upload, activity: activity, isAttachment: isAttachment}" reveal-modal="file-previewer"
                title="预览" ng-click="downloadBlob(activity, upload, 'view')"
                ng-if="upload.source != 'LARK' && canPreview(upload) && !upload.deleted && canShowResource(upload, isInstructorView) && upload.id > 0">
                <i class="font font-table-edit-view-2"></i>
            </a>
        <a ng-click="openSobeyVideo()" ng-if="upload.source==='sobey'">
            <i class="font font-table-edit-view-2"></i>
        </a>
                <a stop-propagation ng-href="/api/uploads/reference/[[upload.reference_id]]/blob" target="_blank"
                    title="下载" ng-click="downloadBlob(activity, upload)"
                    ng-if="upload.reference_id && !upload.deleted && upload.allow_download && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
                <a stop-propagation ng-href="/api/uploads/[[upload.id]]/blob?preview=true&activity_type=[[activity.type]]" target="_blank"
                    title="下载" ng-click="downloadBlob(activity, upload)"
                    ng-if="!upload.reference_id && !upload.deleted && upload.allow_download && !upload.source && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
                <a stop-propagation ng-href="[[upload.url]]/download" target="_blank"
                    title="下载" ng-click="downloadBlob(activity, upload)"
                    ng-if="upload.source && !['LARK', 'auto-generated-pdf', 'WEDRIVE'].includes(upload.source) && !upload.reference_id && !upload.deleted && upload.allow_download && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
                <!-- 针对特殊source类型 -->
                <a stop-propagation ng-href="/api/uploads/[[upload.id]]/blob"
                    title="下载" ng-click="downloadBlob(activity, upload)"
                    ng-if="!upload.reference_id && !upload.deleted && upload.allow_download && ['auto-generated-pdf'].includes(upload.source) && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
                <a stop-propagation ng-href="/api/wedrive/file/[[upload.fileid]]"
                    title="下载"
                    ng-if="!upload.deleted && upload.allow_download && upload.source == 'WEDRIVE' && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
        </div>
</span>    </div>

</div>        </div>
    </div>
</div>                </div>
        </div>
    </div>
</div><div id="calendar-confirmation-popup" class="reveal-modal popup-area popup-480" data-reveal resetable>
    <div class="popup-content">
        <div class="popup-header">
            <span ng-bind="ui.titleBind"></span>
            <a class="right" close-popup="calendar-confirmation-popup">
                <i class="font font-close"></i>
            </a>
        </div>
        <div class="main-area">
            <div ng-if="ui.messageBind"><span ng-bind="ui.messageBind"></span></div>
            <div ng-if="!ui.messageBind">
                <div class="scope-label">范围</div>
                <div class="scope-choice">
                    <label>
                        <input type="radio" name="scope" ng-model="ui.update_scope" value="current"/>本节次
                    </label>
                    <label>
                        <input type="radio" name="scope" ng-model="ui.update_scope" value="current_and_after"/>本节次及后续节次
                    </label>
                    <label>
                        <input type="radio" name="scope" ng-model="ui.update_scope" value="all"/>所有节次
                    </label>
                </div>
            </div>
        </div>
        <div class="popup-footer">
            <div class="form-buttons">
<div class="loading-spinner" ng-show="loading">
    <div class="spinner">
        <div class="mask">
            <div class="maskedCircle"></div>
        </div>
    </div>
</div>                <button class="button button-green medium" ng-click="confirm()"
                        type="submit" ng-hide="loading">确认</button>
                <button class="button button-grey medium" close-popup="calendar-confirmation-popup"
                        type="button" ng-hide="loading">取消</button>
            </div>
        </div>
    </div>
</div>    <wg-calendar
        first-day="1"
        show-teaching-week="false"
        ng-prop-is_show_calendar="isShowCalendar"
    ></wg-calendar>    </div>
</div>            </ul>
        </div>
<div class="file-select popup-area reveal-modal" id="file-select" data-reveal resetable
     data-options="multiple_opened:true"
     before-controller="
     usePublicResourceScope='activity';
     uploadZeroSizeFileErrorMessage='请勿上传 0 Bytes 文件';
     uploadSizeLimitErrorMessage='抱歉，文件大小超出限制';
     uploadFileFormatLimitErrorMessage='抱歉，不支持此文件类型';"
     ng-init="
        fileSelectScopeIds=[];
        is_lark_docs_open=false;
        isWeDriveEnable=false;
        useClientUploadFile=false;
        maxUploadSize={&#39;AUDIO&#39;: 3221225472, &#39;IMAGE&#39;: 3221225472, &#39;VIDEO&#39;: 3221225472, &#39;DOCUMENT&#39;: 3221225472, &#39;COMPRESSED_DOCUMENT&#39;: 3221225472, &#39;CONFIGURABLE&#39;: 2147483648, &#39;DEFAULT&#39;: 2147483648};
        userFreeSpace=-358252764;
        hasStorageCapacity= true;
        isFileExtensionCheckEnable=true;">
    <div class="popup-content" ng-if="popupState.popupOpened" ng-controller="FileSelectController" ng-init="loadComponents();">

        <div class="popup-header">
            <span>选择附件</span>
            <a class="right" ng-click="closePopup()">
                <i class="font font-close"></i>
            </a>
        </div>
        <div class="main-area">
            <div class="tabs row">
                <li class="tab-title" ng-if="!model.context.lesson_resource_only && !model.context.repositoryOnly">
                    <a ng-class="{'active': model.tab == 'local'}" ng-click="changeTab('local')">本地上传</a>
                </li>
                <li class="tab-title" ng-if="model.context.showLinkForm">
                    <a ng-class="{'active': model.tab == 'link'}"
                       ng-click="changeTab('link')">视频链接</a>
                </li>
                <li ng-if="model.showMaterialTab" class="tab-title">
                    <a ng-class="{'active': model.tab == 'material'}" ng-click="changeTab('material')">参考资料</a>
                </li>
                <li class="tab-title">
                    <a ng-class="{'active': model.tab == 'repository'}" ng-click="changeTab('repository')">
                            <span ng-if="showPublicResource || showGroupResource">
                                个人资源库
                            </span>
                            <span ng-if="!showPublicResource && !showGroupResource">
                                资源库
                            </span>
                    </a>
                </li>
                <li class="tab-title" ng-if="isShowLarkSpace() && is_lark_docs_open">
                    <a ng-class="{'active': model.tab == 'lark'}"
                       ng-click="changeTab('lark')">飞书空间</a>
                </li>
                <li class="tab-title" ng-if="isShowWeDriveSpace() && isWeDriveEnable">
                    <a ng-class="{'active': model.tab == 'wedrive'}" ng-click="changeTab('wedrive')">企微空间</a>
                </li>

                    <li class="tab-title" ng-if="showGroupResource">
                        <a ng-class="{'active': model.tab == 'group_resource'}"
                        ng-click="changeTab('group_resource')">小组资源库</a>
                    </li>
            </div>
            <div class="tabs-content" ng-controller="FolderUploadController">
<div id="folders-upload-confirmation-popup" class="reveal-modal popup-area popup-480" data-reveal data-options="multiple_opened:true">
    <div class="popup-content" ng-if="popupState.popupOpened">
        <div class="popup-header">
            <span>上传提示</span>
            <a class="right" ng-click="closePopup('folders-upload-confirmation-popup')">
                <i class="font font-close"></i>
            </a>
        </div>
        <div class="main-area">
                <i class="font font-circle-wrong"></i>
                <div class="message">
                    <div style="font-weight: 600;">上传失败</div>
                    <div ng-bind="errMessage"></div>
                </div>
        </div>
        <div class="popup-footer">
            <div class="form-buttons">
                <button class="button button-green medium" ng-click="closePopup('folders-upload-confirmation-popup')" type="submit">
                    <p>确认</p>
                </button>

                <button class="button button-grey medium" ng-click="closePopup('folders-upload-confirmation-popup')" type="button">
                    <span>取消</span>
                </button>
            </div>
        </div>
    </div>
</div>                    <div class="select-local-content select-content"
                         ng-if="model.tab == 'local' && !isIE9">
                        <div class="upload-area"
                             multiple="true"
                             ng-if="!folderUploadEnabled(model.unSupportFolderUpload, model.getSupportFormatString(model.limitTypes))"
                             ngf-drop="onFileSelect($files, {&#39;AUDIO&#39;: 3221225472, &#39;IMAGE&#39;: 3221225472, &#39;VIDEO&#39;: 3221225472, &#39;DOCUMENT&#39;: 3221225472, &#39;COMPRESSED_DOCUMENT&#39;: 3221225472, &#39;CONFIGURABLE&#39;: 2147483648, &#39;DEFAULT&#39;: 2147483648})"
                             ngf-drag-over-class="'dragover'">
                            <div class="select-file">
                                    <button class="button-select-file"
                                            ngf-select="onFileSelect($files, {&#39;AUDIO&#39;: 3221225472, &#39;IMAGE&#39;: 3221225472, &#39;VIDEO&#39;: 3221225472, &#39;DOCUMENT&#39;: 3221225472, &#39;COMPRESSED_DOCUMENT&#39;: 3221225472, &#39;CONFIGURABLE&#39;: 2147483648, &#39;DEFAULT&#39;: 2147483648})"
                                            multiple accept="[[ model.getSupportFormatString(model.limitTypes) ]]">
                                        <i class="font font-file-select"></i>
                                        <span>添加文件</span>
                                    </button>
                                <button class="button-open-client"
                                        ng-if="useClientUploadFile"
                                        ng-click="openClient()">
                                    <i class="font font-chinamcloud"></i>
                                    <span>客户端上传</span>
                                    <i class="icon icon-tip" tipsy-html='yes'
                                       tipsy-literal="大视频建议使用客户端上传<br/>上传后请到资源库选取文件"></i>
                                </button>
                            </div>
<div class="size-limit">
    <span>支持多个文件拖拽或点击上传，上传档案为加密文件时，将无法进行预览</span>
</div>
<div class="size-limit" ng-if="isFileExtensionCheckEnable">
    当前系统支持的文件格式
    <div class="icon icon-tip" tipsy-class="upload-gray" tipsy-html='yes' tipsy-follow-element-width="true"
       tipsy-literal="
       <div>
        <div class='tip-item'>
          <div class='paragraph-left'>视频格式：<br>
            <span class= 'paragraph-left-size'> ([[ '{0}以内' | format:[humanizeBytes(maxUploadSize['VIDEO'])] ]])</span>
          </div>
          <div class='paragraph-right'>avi, flv, m4v, mkv, mov, mp4, 3gp, 3gpp, mpg, rm, rmvb, swf, webm, wmv</div>
        </div>
        <hr class='file-select-divider'>
        <div class='tip-item'>
          <div class='paragraph-left'>音频格式：<br>
            <span class= 'paragraph-left-size'>([[ '{0}以内' | format:[humanizeBytes(maxUploadSize['AUDIO'])] ]])</span>
          </div>
          <div class='paragraph-right'>mp3, m4a, wav, wma</div>
        </div>
        <hr class='file-select-divider'>
        <div class='tip-item'>
          <div class='paragraph-left'>图片格式：<br>
            <span class= 'paragraph-left-size'> ([[ '{0}以内' | format:[humanizeBytes(maxUploadSize['IMAGE'])] ]])</span>
          </div>
          <div class='paragraph-right'>jpeg, jpg, png, gif, bmp, heic, webp</div>
        </div>
        <hr class='file-select-divider'>
        <div class='tip-item'>
          <div class='paragraph-left'>文档格式：<br>
            <span class= 'paragraph-left-size'>([[ '{0}以内' | format:[humanizeBytes(maxUploadSize['DOCUMENT'])] ]])</span>
          </div>
          <div class='paragraph-right'>txt, pdf, csv, xls, xlsx, doc, ppt, pptx, docx, odp, ods, odt, rtf</div>
        </div>
        <hr class='file-select-divider'>
        <div class='tip-item'>
          <div class='paragraph-left'>压缩文档格式：<br>
            <span class= 'paragraph-left-size'> ([[ '{0}以内' | format:[humanizeBytes(maxUploadSize['COMPRESSED_DOCUMENT'])] ]])</span>
          </div>
          <div class='paragraph-right'>zip, rar, tar</div>
        </div>
        <hr class='file-select-divider'>
        <div class='tip-item'>
          <div class='paragraph-left'>其他格式：<br>
            <span class= 'paragraph-left-size'>([[ '{0}以内' | format:[humanizeBytes(maxUploadSize['CONFIGURABLE'])] ]])</span>
        </div>
          <div class='paragraph-right'>mat, dwg, m, mlapp, slx, mlx</div>
        </div>
       </div>
    ">
    </div>
</div>                        </div>
                        <div class="upload-area"
                            multiple="true"
                            ng-if="folderUploadEnabled(model.unSupportFolderUpload, model.getSupportFormatString(model.limitTypes))"
                            ngf-drop="getfileAndfolderStructure($files, {&#39;AUDIO&#39;: 3221225472, &#39;IMAGE&#39;: 3221225472, &#39;VIDEO&#39;: 3221225472, &#39;DOCUMENT&#39;: 3221225472, &#39;COMPRESSED_DOCUMENT&#39;: 3221225472, &#39;CONFIGURABLE&#39;: 2147483648, &#39;DEFAULT&#39;: 2147483648})"
                            ngf-drag-over-class="'dragover'">

                            <div class="select-file upload-types">
                                <div class="upload-local">
                                    <a class="upload-select-area" ng-click="showUploadList()" href="javascript:void(0)" onclick="return false;" ng-blur="hideUploadList()">
                                        <i class="font font-upload-alt"></i>
                                        <span>上传</span>
                                        <i class="font font-arrow-collapse"></i>
                                    </a>
                                    <div class="dropdown-list dropdown" ng-show="showUploadOptions">
                                        <ul ng-mouseleave="ui.inUploadList=false" ng-mouseenter="ui.inUploadList=true">
                                            <li>
                                                <div ngf-select="onFileSelect($files, {&#39;AUDIO&#39;: 3221225472, &#39;IMAGE&#39;: 3221225472, &#39;VIDEO&#39;: 3221225472, &#39;DOCUMENT&#39;: 3221225472, &#39;COMPRESSED_DOCUMENT&#39;: 3221225472, &#39;CONFIGURABLE&#39;: 2147483648, &#39;DEFAULT&#39;: 2147483648})" multiple
                                                    accept="[[ ui.acceptedExtension ]]">
                                                    <span>上传文件</span>
                                                </div>
                                            </li>
                                            <li>
                                                <div ngf-select="getfileAndfolderStructure($files, {&#39;AUDIO&#39;: 3221225472, &#39;IMAGE&#39;: 3221225472, &#39;VIDEO&#39;: 3221225472, &#39;DOCUMENT&#39;: 3221225472, &#39;COMPRESSED_DOCUMENT&#39;: 3221225472, &#39;CONFIGURABLE&#39;: 2147483648, &#39;DEFAULT&#39;: 2147483648})" multiple webkitdirectory>
                                                    <span>上传文件夹</span>
                                                </div>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                                <button class="upload-client button-open-client"
                                    ng-if="useClientUploadFile"
                                    ng-click="openClient()">
                                    <i class="font font-chinamcloud"></i>
                                    <span>客户端上传</span>
                                    <i class="icon icon-tip" tipsy-html='yes'
                                    tipsy-literal="大视频建议使用客户端上传<br/>上传后请到资源库选取文件"></i>
                                </button>
                            </div>
<div class="size-limit">
    <span>支持多个文件拖拽或点击上传，上传档案为加密文件时，将无法进行预览</span>
</div>
<div class="size-limit" ng-if="isFileExtensionCheckEnable">
    当前系统支持的文件格式
    <div class="icon icon-tip" tipsy-class="upload-gray" tipsy-html='yes' tipsy-follow-element-width="true"
       tipsy-literal="
       <div>
        <div class='tip-item'>
          <div class='paragraph-left'>视频格式：<br>
            <span class= 'paragraph-left-size'> ([[ '{0}以内' | format:[humanizeBytes(maxUploadSize['VIDEO'])] ]])</span>
          </div>
          <div class='paragraph-right'>avi, flv, m4v, mkv, mov, mp4, 3gp, 3gpp, mpg, rm, rmvb, swf, webm, wmv</div>
        </div>
        <hr class='file-select-divider'>
        <div class='tip-item'>
          <div class='paragraph-left'>音频格式：<br>
            <span class= 'paragraph-left-size'>([[ '{0}以内' | format:[humanizeBytes(maxUploadSize['AUDIO'])] ]])</span>
          </div>
          <div class='paragraph-right'>mp3, m4a, wav, wma</div>
        </div>
        <hr class='file-select-divider'>
        <div class='tip-item'>
          <div class='paragraph-left'>图片格式：<br>
            <span class= 'paragraph-left-size'> ([[ '{0}以内' | format:[humanizeBytes(maxUploadSize['IMAGE'])] ]])</span>
          </div>
          <div class='paragraph-right'>jpeg, jpg, png, gif, bmp, heic, webp</div>
        </div>
        <hr class='file-select-divider'>
        <div class='tip-item'>
          <div class='paragraph-left'>文档格式：<br>
            <span class= 'paragraph-left-size'>([[ '{0}以内' | format:[humanizeBytes(maxUploadSize['DOCUMENT'])] ]])</span>
          </div>
          <div class='paragraph-right'>txt, pdf, csv, xls, xlsx, doc, ppt, pptx, docx, odp, ods, odt, rtf</div>
        </div>
        <hr class='file-select-divider'>
        <div class='tip-item'>
          <div class='paragraph-left'>压缩文档格式：<br>
            <span class= 'paragraph-left-size'> ([[ '{0}以内' | format:[humanizeBytes(maxUploadSize['COMPRESSED_DOCUMENT'])] ]])</span>
          </div>
          <div class='paragraph-right'>zip, rar, tar</div>
        </div>
        <hr class='file-select-divider'>
        <div class='tip-item'>
          <div class='paragraph-left'>其他格式：<br>
            <span class= 'paragraph-left-size'>([[ '{0}以内' | format:[humanizeBytes(maxUploadSize['CONFIGURABLE'])] ]])</span>
        </div>
          <div class='paragraph-right'>mat, dwg, m, mlapp, slx, mlx</div>
        </div>
       </div>
    ">
    </div>
</div>                        </div>
                    </div>
                    <div class="select-local-content select-content"
                         ng-if="model.tab == 'local' && isIE9">
                        <div class="select-file">
                            <button ngf-select="onFileSelect($files, {&#39;AUDIO&#39;: 3221225472, &#39;IMAGE&#39;: 3221225472, &#39;VIDEO&#39;: 3221225472, &#39;DOCUMENT&#39;: 3221225472, &#39;COMPRESSED_DOCUMENT&#39;: 3221225472, &#39;CONFIGURABLE&#39;: 2147483648, &#39;DEFAULT&#39;: 2147483648})" ng-disabled="isIE9CannotUploadFile()"
                                    multiple>选择文件</button>
                            <button class="button-open-client"
                                    ng-if="useClientUploadFile"
                                    ng-click="openClient()">
                                <i class="font font-chinamcloud"></i>
                                <span>客户端上传</span>
                                <i class="icon icon-tip" tipsy-html='yes'
                                   tipsy-literal="大视频建议使用客户端上传<br/>上传后请到资源库选取文件"></i>
                            </button>
                        </div>
                        <div class="size-limit">
                            <span>单个文件最大上传文件大小</span>
                            <span ng-bind="{&#39;AUDIO&#39;: 3221225472, &#39;IMAGE&#39;: 3221225472, &#39;VIDEO&#39;: 3221225472, &#39;DOCUMENT&#39;: 3221225472, &#39;COMPRESSED_DOCUMENT&#39;: 3221225472, &#39;CONFIGURABLE&#39;: 2147483648, &#39;DEFAULT&#39;: 2147483648}|humanizeBytes"></span>
                        </div>
                        <div class="html-msg" ng-show="isIE9CannotUploadFile()">
                            您的浏览器版本过低，无法上传文件。请升级浏览器，或者使用其他浏览器上传文件
                        </div>
                    </div>
                <div ng-if="model.tab==='material'" class="select-repository-content upload-content">
                    <material-file-select-list ng-prop-module_id="model.moduleId" ng-prop-course_id="model.courseId"></material-file-select-list>
                </div>
                <div class="select-repository-content upload-content"
                     ng-if="['repository', 'group_resource', 'third_part_resource', 'academic_learning_platform', 'public_resource', 'virtual_classroom', 'vtrs_resource'].includes(model.tab)"
                     ng-init="toggleAuditCourseResource = false">
<div class="file-type row" ng-if="model.context.lesson_resource_only">
    <li ng-class="active">录播教材</li>
    <li class="search-section right">
        <div class="search-key">
            <input type="text" name="key" ng-model="model.keyword" enter-press="search()" wg-placeholder="关键字">
        </div>
        <div class="search-btn">
            <a class="button search" ng-click="search()">
                <span>搜索</span>
            </a>
        </div>
    </li>
</div>

<div class="file-type row" ng-if="!model.context.lesson_resource_only">
    <li ng-class="{'active': model.fileType == 'all'}"
        ng-click="changeFileType('all')"
        ng-if="isAllowedFileType('all')">全部</li>
    <li ng-class="{'active': model.fileType == 'image', 'limited-file-type': isOnlyLimitedFileType('image')}"
        ng-click="changeFileType('image')"
        ng-if="isAllowedFileType('image')">图片</li>
    <li ng-class="{'active': model.fileType == 'document', 'limited-file-type': isOnlyLimitedFileType('document')}"
        ng-click="changeFileType('document')"
        ng-if="isAllowedFileType('document') && (isOnlyLimitedFileType('document') ? model.context.showTypeTabWhenOnly !== false : true)">文档</li>

    <li ng-class="{'active': model.fileType == 'video', 'limited-file-type': isOnlyLimitedFileType('video')}"
        ng-click="changeFileType('video')"
        ng-if="isAllowedFileType('video')">视频</li>
        <li ng-class="{'active': model.fileType == 'video-quiz', 'limited-file-type': isOnlyLimitedFileType('video-quiz')}"
            ng-click="changeFileType('video-quiz')"
            ng-if="isAllowedFileType('video-quiz')">互动教材</li>

    <li ng-class="{'active': model.fileType == 'audio', 'limited-file-type': isOnlyLimitedFileType('audio')}"
        ng-click="changeFileType('audio')"
        ng-if="isAllowedFileType('audio')">音频</li>
    <li ng-class="{'active': model.fileType == 'swf', 'limited-file-type': isOnlyLimitedFileType('swf')}"
        ng-click="changeFileType('swf')"
        ng-if="isAllowedFileType('swf') && !isVtrsTab()">Flash</li>
    <li ng-class="{'active': model.fileType == 'subject-lib'}"
        ng-click="changeFileType('subject-lib')"
        ng-if="isAllowedFileType('subject-lib')">题库</li>
        <li ng-class="{'active': model.fileType == 'scorm'}"
            ng-if="isAllowedFileType('scorm')"
            ng-click="changeFileType('scorm')">
            SCORM
        </li>
     <li ng-class="{'active': model.fileType == 'link', 'limited-file-type': isOnlyLimitedFileType('link')}"
        ng-click="changeFileType('link')"
        ng-if="isAllowedFileType('link')">链接</li>
    <li ng-class="{'active': model.fileType == 'file', 'limited-file-type': isOnlyLimitedFileType('file')}"
        ng-click="changeFileType('file')"
        ng-if="isVtrsTab()">其他</li>
    <li class="vtrs-filter" ng-if="isVtrsTab()">
        <div class="filter">
            <span class="name">教研室</span>
            <select ui-select2="{dropdownCssClass: 'select2-drop-without-search'}"
                    ng-model="vtrs.id"
                    ng-change="changeVtrs(vtrs.id)"
                    class="activity-type">
                <option value="">全部</option>
                <option ng-repeat="vtrs in vtrses" value="[[vtrs.id]]" ng-init="selectedId = vtrs.id" title="[[vtrs.name]]">[[vtrs.name]]</option>
            </select>
        </div>
    </li>
    <li class="search-section right">
        <div class="search-key">
            <input type="text" name="key" ng-model="model.keyword" enter-press="search()" wg-placeholder="关键字">
        </div>
        <div class="search-btn">
            <a class="button search" ng-click="search()">
                <span>搜索</span>
            </a>
        </div>
    </li>
</div>
<div class="go_to_prev_folder" ng-if="isAllowedFileType('all') && model.path.length > 0">
    <a ng-click="gotoPrev()">返回上一层</a>
</div>
<div class="row file-summary" ng-if="!(model.fileType == 'image' && model.mode == 'thumbnail')">
    <div class="large-1 column">
        <input type="checkbox" ng-checked="checkAllSelected()" ng-change="switchAll()" ng-model="model.isSelectAll"
               ng-if="!model.singleSelect" ng-disabled="!model.canSelectAll"/>
    </div>
    <div class="large-3 columns file-name-label">
        资源名
    </div>
    <div class="columns" ng-if="model.singleSelect" ng-class="{'large-13': !toggleAuditCourseResource, 'large-9': toggleAuditCourseResource}"><span>&nbsp;</span></div>
    <div ng-if="!model.singleSelect" class="columns selected-count" ng-class="{'large-12': !toggleAuditCourseResource, 'large-8': toggleAuditCourseResource}">
        <span >（[["已选:  文件夹 {0}, 资源 {1}" | format:selectedCount() ]]）</span>
    </div>
        <div class="columns large-5" ng-if="model.tab == 'group_resource'">所属小组</div>
    <div class="large-5 columns">
        <div class="view-mode right" ng-if="model.fileType == 'image'">
            <a ng-class="{'selected': model.mode == 'list'}" ng-click="model.mode = 'thumbnail'">
                <i class="font font-thumbnail-view"></i>
            </a>
            <a ng-class="{'selected': model.mode == 'thumbnail'}" ng-click="model.mode = 'list'">
                <i class="font font-list-view"></i>
            </a>
        </div>
    </div>
</div>
<div class="file-list" ng-if="!(model.fileType == 'image' && model.mode == 'thumbnail')"
     ng-class="{'folder-pagination-list': model.pagination.totalPage > 1 && isAllowedFileType('all') && model.path.length > 0,
                'folder-list': model.pagination.totalPage <= 1 && isAllowedFileType('all') && model.path.length > 0,
                'file': model.pagination.totalPage <= 1 && !(isAllowedFileType('all') && model.path.length > 0)}">
<div class="loading-bg-mask" ng-show="loadingFullPage"></div>
<div class="loading-gif" ng-show="loadingFullPage"></div>    <div ng-repeat="upload in model.pagination.currentList">
        <div class="row file-list-item" ng-if="upload.is_folder" data-ng-click="!upload.selectable || toggleUploadClick(upload)">
            <div class="large-1 column check">
                <input type="checkbox" ng-change="toggleUploadClick(upload);"
                       ng-model="upload.selected" ng-if="!model.singleSelect" ng-disabled="upload.failed || upload.failedWithAMessage || !upload.selectable || !upload.id"/>
                <input type="radio" name="upload" ng-value="upload"
                       ng-model="model.singleSelectedUpload" ng-if="model.singleSelect" ng-disabled="upload.failed || upload.failedWithAMessage || !upload.selectable || !upload.id"/>
            </div>
            <div class="large-1 column file-icon-wrapper">
                <i class="font font-file-[[fileTypeByExtension(upload)]]"></i>
            </div>
            <div class="columns file-name" ng-click="enterFolder(upload)" ng-class="{'large-14': !toggleAuditCourseResource, 'large-10': toggleAuditCourseResource}">
                <div class="name truncate-text">
                    <span ng-bind="upload.name" tipsy="upload.name"></span>
                </div>
                <div class="file-info">
                    <div class="created-at">
                        <span ng-bind="upload.created_at|datetime"></span>
                    </div>
                </div>
            </div>
                <div class="columns large-5" ng-if="model.tab === 'group_resource'">
                    <span ng-bind="upload.group_name"></span>
                </div>
            <div class="large-6 columns no-horizontal-padding" ng-class="{'text-center': upload.failed || upload.failedWithAMessage}">
                <div ng-show="!upload.is_upload_folder" ng-if="!upload.failed && !upload.failedWithAMessage && upload.progress >= 0"
                     class="progress radius">
                    <span class="meter" ng-style="{width: upload.progress + '%'}">
                        <span class="text"><span ng-bind="upload.progress"></span>%</span>
                    </span>
                </div>
                <div ng-show="upload.is_upload_folder" ng-if="upload.progressing && upload.progress > 0"
                    class="progress radius">
                   <span class="meter" ng-style="{width: upload.progress + '%'}">
                       <span class="text"><span ng-bind="upload.finishedCount"></span>/<span ng-bind="upload.filesCount"></span></span>
                   </span>
               </div>
                <div ng-show="!upload.is_upload_folder" ng-if="upload.failed || upload.failedWithAMessage" class="upload-failed">
                    <span ng-show="upload.failed">文件上传失败</span>
                    <span ng-show="upload.failedWithAMessage" ng-bind="upload.failedMessage"></span>
                </div>
                <div ng-show="upload.is_upload_folder" ng-if="!upload.progressing && !upload.failed && upload.failedFiles.length > 0" class="upload-failed-warning-area">
                    <span class="upload-failed-warning">
                        <i class="font font-alert-warning"></i>
                        <span> 部分文件上传失败 </span>
                    </span>
                    <span ng-click="showFailedFiles(upload)" class="view">
                        查看
                    </span>
                </div>
                <div ng-if="upload.failed" class="upload-failed-warning-area">
                    <span class="upload-failed-warning">
                        <i class="font font-alert-warning"></i>
                        <span> 全部文件上传失败 </span>
                    </span>
                </div>
                <div ng-if="!upload.id && model.tab == 'public_resource'" class="upload-failed text-center">
                    <span ng-show="!upload.id">文件不存在</span>
                </div>
            </div>
            <div class="large-4 columns">
                <div ng-if="upload.speed || upload.speed == 0" class="speed">
                    <span ng-bind="upload.speed|humanizeSpeed"></span>
                </div>
            </div>
            <div class="large-3 columns upload-buttons">
                <a class="delete-upload-button" ng-click="deleteUploadingUpload(upload)"
                ng-show="!upload.is_upload_folder" ng-if="!upload.failed && (!upload.finished && upload.finished == false)">
                    <i class="font font-delete" tipsy-literal="删除"></i>
                </a>
            </div>
        </div>
        <label class="row file-list-item" ng-if="!upload.is_folder">
            <div class="large-1 column check">
                <input type="checkbox" ng-change="toggleUploadClick(upload)"
                       ng-model="upload.selected" ng-if="!model.singleSelect" ng-disabled="upload.failed || upload.failedWithAMessage || !upload.selectable || !upload.id"/>
                <input type="radio" name="upload" ng-value="upload"
                       ng-model="model.singleSelectedUpload" ng-if="model.singleSelect" ng-disabled="upload.failed || upload.failedWithAMessage || !upload.selectable || !upload.id"/>
            </div>
            <div class="large-1 column file-icon-wrapper">
                <i ng-if="upload.type != 'slide' && upload.type != 'subject-lib'"
                   class="font font-file-[[fileTypeByExtension(upload)]]"></i>
                <i ng-if="upload.type == 'slide'" class="font font-slide"></i>
                <i ng-if="upload.type == 'subject-lib'" class="font font-resource-subject-lib"></i>
            </div>
            <div class="columns file-name" ng-class="{'large-14': !toggleAuditCourseResource, 'large-10': toggleAuditCourseResource}">
                <div>
                    <span class="name truncate-text">
                        <span ng-if="upload.type != 'slide' && upload.type != 'subject-lib'"
                              ng-bind="upload.name|fileName" tipsy="upload.name"></span>
                        <span ng-if="upload.type == 'slide' || upload.type == 'subject-lib'"
                              ng-bind="upload.title" tipsy="upload.title"></span>
                    </span>
                    <span class="video-quiz-mark" ng-if="upload.type == 'video-quiz'">互动教材</span>
                    <span ng-if="upload.type != 'slide'" class="extension" ng-bind="upload.name|fileExtension"></span>
                    <span class="video-quiz-warning" ng-if="upload.type == 'video-quiz' && upload.uploads[0].deleted">视频已删除</span>
                </div>
                <div class="file-info">
                    <div class="created-at">
                        <span ng-bind="upload.created_at|datetime"></span>
                    </div>
                    <div ng-if="upload.type != 'slide' && upload.type != 'subject-lib' && upload.type != 'link'" class="size">
                        <span>大小：</span>
                        <span ng-bind="upload.size|humanizeBytes"></span>
                    </div>
                    <div ng-if="upload.type == 'slide'">
                        <span>
                            时长:
                            <span ng-bind="upload.duration | formatTime"></span>
                        </span>
                    </div>
                    <div ng-if="upload.type == 'video-quiz' || upload.type == 'subject-lib'">
                        <span>
                            题目数量:
                            <span ng-bind="upload.num_of_subjects"></span>
                        </span>
                    </div>
                </div>
            </div>
                <div class="columns large-5" ng-if="model.tab === 'group_resource'">
                    <span ng-bind="upload.group_name"></span>
                </div>
            <div class="large-6 columns no-horizontal-padding" ng-class="{'text-center': upload.failed || upload.failedWithAMessage}">
                <div ng-if="!upload.failed && !upload.failedWithAMessage && upload.progress >= 0"
                     class="progress radius">
                    <span class="meter" ng-style="{width: upload.progress + '%'}">
                        <span class="text"><span ng-bind="upload.progress"></span>%</span>
                    </span>
                </div>
                <div ng-if="upload.failed || upload.failedWithAMessage" class="upload-failed">
                    <span ng-show="upload.failed">文件上传失败</span>
                    <span ng-show="upload.failedWithAMessage" ng-bind="upload.failedMessage"></span>
                </div>
                <div ng-if="!upload.id && model.tab == 'public_resource'" class="upload-failed text-center">
                    <span ng-show="!upload.id">文件不存在</span>
                </div>
            </div>
            <div class="large-4 columns">
                <div ng-if="upload.speed || upload.speed == 0" class="speed">
                    <span ng-bind="upload.speed|humanizeSpeed"></span>
                </div>
            </div>
            <div class="large-3 columns upload-buttons">
                <a class="delete-upload-button" ng-click="deleteUploadingUpload(upload)"
                   ng-if="!upload.failed && (!upload.finished && upload.finished == false)">
                    <i class="font font-delete" tipsy-literal="删除"></i>
                </a>
            </div>
        </label>
    </div>
    <div class="blank-info" ng-if="model.pagination.currentList.length == 0 && !model.searching" ng-cloak>
        您还没有任何文件
    </div>
    <div class="blank-info" ng-if="model.pagination.currentList.length == 0 && model.searching" ng-cloak>
        未找到符合条件的文件
    </div>
</div>
<div class="thumbnail-list" ng-if="model.fileType == 'image' && model.mode == 'thumbnail'">
<div class="loading-bg-mask" ng-show="loadingFullPage"></div>
<div class="loading-gif" ng-show="loadingFullPage"></div>    <div class="thumbnail-block">
        <div class="row file-summary clear">
            <div class="large-6 column">
                <input type="checkbox" ng-checked="checkAllSelected()" ng-change="switchAll()" ng-model="model.isSelectAll"
                       ng-if="!model.singleSelect"/>
                <span ng-if="model.singleSelect">&nbsp</span>
            </div>
            <div class="large-26 columns">
                <div class="view-mode right">
                    <a ng-class="{'selected': model.mode == 'list'}" ng-click="model.mode = 'thumbnail'">
                        <i class="font font-thumbnail-view"></i>
                    </a>
                    <a ng-class="{'selected': model.mode == 'thumbnail'}" ng-click="model.mode = 'list'">
                        <i class="font font-list-view"></i>
                    </a>
                </div>
            </div>
        </div>
        <div class="clear">
            <div class="thumbnail-label left" ng-repeat="upload in model.pagination.currentList | orderBy: '-created_at'">
                <label>
                    <div class="thumbnail" ng-class="{'selected': upload.selected || upload.id == model.singleSelectedUpload.id, 'single-select': model.singleSelect}">
                        <input type="checkbox" class="thumbnail-input" ng-if="!model.singleSelect" ng-change="toggleUploadClick(upload)" ng-model="upload.selected" ng-disabled="upload.failed || upload.failedWithAMessage || !upload.selectable">
                        <input type="radio" class="thumbnail-input" name="upload" ng-value="upload"
                               ng-model="model.singleSelectedUpload" ng-if="model.singleSelect" ng-disabled="upload.failed || upload.failedWithAMessage || !upload.selectable"/>
                        <img ng-src="/api/third-part/uploads/[[upload.thumbnail.id]]/thumbnail" ng-if="upload.isThirdPartResource && upload.thumbnail && upload.thumbnail.id">
                        <img class="fade" ng-src="/api/third-part/uploads/[[upload.id]]/preview" ng-if="upload.isThirdPartResource && !(upload.thumbnail && upload.thumbnail.id)">
                        <img class="fade" ng-src="/api/uploads/[[upload.thumbnail.id]]/thumbnail?preview=true" ng-if="!upload.isThirdPartResource && upload.thumbnail && upload.thumbnail.id">
                        <img class="fade" ng-src="/api/uploads/[[upload.id]]/blob?preview=true" ng-if="!upload.isThirdPartResource && !(upload.thumbnail && upload.thumbnail.id)">
                    </div>
                </label>
                <div class="file-name truncate-text">
                    <span ng-bind="upload.name" tipsy="upload.name"></span>
                </div>
            </div>
        </div>
    </div>
    <div class="blank-info" ng-if="model.pagination.currentList.length == 0 && !model.searching" ng-cloak>
        您还没有任何文件
    </div>
    <div class="blank-info" ng-if="model.pagination.currentList.length == 0 && model.searching" ng-cloak>
        未找到符合条件的文件
    </div>
</div>
<div class="row list-pager" ng-if="model.pagination.totalPage > 1">
    <ul>
        <li ng-show="model.pagination.currentPage > 1" class="previous-page-button">
            <a class="small pager-button button-white" ng-click="changePage(model.pagination.currentPage - 1)">
                <span>< 上一页</span>
            </a>
        </li>
        <li class="first-page" ng-hide="model.pagination.currentPage <= 1">
            <a class="small pager-button button-white" ng-bind="1" ng-click="changePage(1)"></a>
        </li>
        <li class="ellipsis-pages" ng-hide="model.pagination.currentPage <= 3">
            <span>...</span>
        </li>
        <li class="preview-page" ng-hide="model.pagination.currentPage <= 2">
            <a class="small pager-button button-white" ng-bind="model.pagination.currentPage - 1" ng-click="changePage(model.pagination.currentPage - 1)"></a>
        </li>
        <li class="current-page">
            <a class="small pager-button button-white active" ng-bind="model.pagination.currentPage"></a>
        </li>
        <li class="next-page" ng-hide="model.pagination.currentPage >= model.pagination.totalPage - 1">
            <a class="small pager-button button-white" ng-bind="model.pagination.currentPage + 1" ng-click="changePage(model.pagination.currentPage + 1)"></a>
        </li>
        <li class="ellipsis-pages" ng-hide="model.pagination.currentPage >= model.pagination.totalPage - 2">
            <span>...</span>
        </li>
        <li class="last-page" ng-hide="model.pagination.currentPage >= model.pagination.totalPage">
            <a class="small pager-button button-white" ng-bind="model.pagination.totalPage" ng-click="changePage(model.pagination.totalPage)"></a>
        </li>
        <li ng-show="model.pagination.currentPage < model.pagination.totalPage" class="next-page-button">
            <a class="small pager-button button-white" ng-click="changePage(model.pagination.currentPage+1)">
                <span>下一页 ></span>
            </a>
        </li>
        <li class="custom-pager">
            <span>页码:</span>
            <input type="text" name='page' ng-model="model.pagination.inputPage" ng-change="model.verifyPageIndexInput" enter-press="changePage(model.pagination.inputPage)"/>
            <a class="button button-white" ng-click="changePage(model.pagination.inputPage)" ng-disabled="!model.pagination.inputPage">Go</a>
        </li>
    </ul>
</div>                </div>
                <div class="select-repository-content upload-content" ng-if="model.tab == 'lark'">
<div class="file-type row" ng-if="model.context.lesson_resource_only">
    <li ng-class="active">录播教材</li>
    <li class="search-section right">
        <div class="search-key">
            <input type="text" name="key" ng-model="model.keyword" enter-press="search()" wg-placeholder="关键字">
        </div>
        <div class="search-btn">
            <a class="button search" ng-click="search()">
                <span>搜索</span>
            </a>
        </div>
    </li>
</div>

<div class="go_to_prev_folder" ng-if="isAllowedFileType('all') && model.path.length > 0">
    <a ng-click="gotoPrev()">返回上一层</a>
</div>
<div class="row file-summary" ng-if="!(model.fileType == 'image' && model.mode == 'thumbnail')">
    <div class="large-1 column">
        <input type="checkbox" ng-checked="checkAllSelected()" ng-change="switchAll()" ng-model="model.isSelectAll"
               ng-if="!model.singleSelect"/>
    </div>
    <div class="large-3 columns file-name-label">
        资源名
    </div>
    <div class="columns selected-count" ng-class="{'large-12': !toggleAuditCourseResource, 'large-8': toggleAuditCourseResource}">
        <span ng-if="!model.singleSelect">（[["已选:  文件夹 {0}, 资源 {1}" | format:selectedCount() ]]）</span>
    </div>
    <div class="large-5 columns">
        <div class="view-mode right" ng-if="model.fileType == 'image'">
            <a ng-class="{'selected': model.mode == 'list'}" ng-click="model.mode = 'thumbnail'">
                <i class="font font-thumbnail-view"></i>
            </a>
            <a ng-class="{'selected': model.mode == 'thumbnail'}" ng-click="model.mode = 'list'">
                <i class="font font-list-view"></i>
            </a>
        </div>
    </div>
</div>
<div class="file-list lark-file-list" ng-if="!(model.fileType == 'image' && model.mode == 'thumbnail')"
     ng-class="{'folder-pagination-list': model.pagination.totalPage > 1 && isAllowedFileType('all') && model.path.length > 0,
                'folder-list': model.pagination.totalPage <= 1 && isAllowedFileType('all') && model.path.length > 0,
                'file': model.pagination.totalPage <= 1 && !(isAllowedFileType('all') && model.path.length > 0)}">
<div class="loading-bg-mask" ng-show="loadingFullPage"></div>
<div class="loading-gif" ng-show="loadingFullPage"></div>    <div ng-repeat="upload in model.pagination.currentList">
        <div class="row file-list-item" ng-if="upload.is_folder" data-ng-click="!upload.selectable || toggleUploadClick(upload)">
            <div class="large-1 column check">
                <input type="checkbox" ng-change="toggleUploadClick(upload);"
                       ng-model="upload.selected" ng-if="!model.singleSelect" ng-disabled="true"/>
                <input type="radio" name="upload" ng-value="upload"
                       ng-model="model.singleSelectedUpload" ng-if="model.singleSelect" ng-disabled="upload.failed || upload.failedWithAMessage || !upload.selectable"/>
            </div>
            <div class="large-1 column file-icon-wrapper">
                <i class="font font-file-[[fileTypeByExtension(upload)]]"></i>
            </div>
            <div class="columns file-name" ng-click="enterFolder(upload)" ng-class="{'large-14': !toggleAuditCourseResource, 'large-10': toggleAuditCourseResource}">
                <div class="name truncate-text">
                    <span ng-bind="upload.name" tipsy="upload.name"></span>
                </div>
            </div>
            <div class="large-6 columns no-horizontal-padding" ng-class="{'text-center': upload.failed || upload.failedWithAMessage}">
                <div ng-if="!upload.failed && !upload.failedWithAMessage && upload.progress >= 0"
                     class="progress radius">
                    <span class="meter" ng-style="{width: upload.progress + '%'}">
                        <span class="text"><span ng-bind="upload.progress"></span>%</span>
                    </span>
                </div>
                <div ng-if="upload.failed || upload.failedWithAMessage" class="upload-failed">
                    <span ng-show="upload.failed">文件上传失败</span>
                    <span ng-show="upload.failedWithAMessage" ng-bind="upload.failedMessage"></span>
                </div>
            </div>
            <div class="large-4 columns">
                <div ng-if="upload.speed || upload.speed == 0" class="speed">
                    <span ng-bind="upload.speed|humanizeSpeed"></span>
                </div>
            </div>
            <div class="large-3 columns upload-buttons">
                <a class="delete-upload-button" ng-click="deleteUploadingUpload(upload)"
                   ng-if="!upload.failed && (!upload.finished && upload.finished == false)">
                    <i class="font font-delete" tipsy-literal="删除"></i>
                </a>
            </div>
        </div>
        <label class="row file-list-item" ng-if="!upload.is_folder">
            <div class="large-1 column check">
                <input type="checkbox" ng-change="toggleUploadClick(upload)"
                       ng-model="upload.selected" ng-if="!model.singleSelect" ng-disabled="upload.failed || upload.failedWithAMessage || !upload.selectable"/>
                <input type="radio" name="upload" ng-value="upload"
                       ng-model="model.singleSelectedUpload" ng-if="model.singleSelect" ng-disabled="upload.failed || upload.failedWithAMessage || !upload.selectable"/>
            </div>
            <div class="large-1 column file-icon-wrapper">
                <i ng-if="upload.type != 'slide' && upload.type != 'subject-lib'"
                   class="font font-file-[[fileTypeByExtension(upload)]]"></i>
                <i ng-if="upload.type == 'slide'" class="font font-slide"></i>
                <i ng-if="upload.type == 'subject-lib'" class="font font-resource-subject-lib"></i>
            </div>
            <div class="columns file-name" ng-class="{'large-14': !toggleAuditCourseResource, 'large-10': toggleAuditCourseResource}">
                <div>
                    <span class="name truncate-text">
                        <span ng-if="upload.type != 'slide' && upload.type != 'subject-lib'"
                              ng-bind="upload.name|fileName" tipsy="upload.name"></span>
                        <span ng-if="upload.type == 'slide' || upload.type == 'subject-lib'"
                              ng-bind="upload.title" tipsy="upload.title"></span>
                    </span>
                    <span class="video-quiz-mark" ng-if="upload.type == 'video-quiz'">互动教材</span>
                    <span ng-if="upload.type != 'slide'" class="extension" ng-bind="upload.name|fileExtension"></span>
                    <span class="video-quiz-warning" ng-if="upload.type == 'video-quiz' && upload.uploads[0].deleted">视频已删除</span>
                </div>
            </div>
            <div class="large-3 columns upload-buttons">
                <a class="delete-upload-button" ng-click="deleteUploadingUpload(upload)"
                   ng-if="!upload.failed && (!upload.finished && upload.finished == false)">
                    <i class="font font-delete" tipsy-literal="删除"></i>
                </a>
            </div>
        </label>
    </div>
    <div class="blank-info" ng-if="model.pagination.currentList.length == 0 && !model.searching" ng-cloak>
        您还没有任何文件
    </div>
    <div class="blank-info" ng-if="model.pagination.currentList.length == 0 && model.searching" ng-cloak>
        未找到符合条件的文件
    </div>
</div>
<div class="thumbnail-list" ng-if="model.fileType == 'image' && model.mode == 'thumbnail'">
<div class="loading-bg-mask" ng-show="loadingFullPage"></div>
<div class="loading-gif" ng-show="loadingFullPage"></div>    <div class="thumbnail-block">
        <div class="row file-summary clear">
            <div class="large-6 column">
                <input type="checkbox" ng-checked="checkAllSelected()" ng-change="switchAll()" ng-model="model.isSelectAll"
                       ng-if="!model.singleSelect"/>
                <span ng-if="model.singleSelect">&nbsp</span>
            </div>
            <div class="large-26 columns">
                <div class="view-mode right">
                    <a ng-class="{'selected': model.mode == 'list'}" ng-click="model.mode = 'thumbnail'">
                        <i class="font font-thumbnail-view"></i>
                    </a>
                    <a ng-class="{'selected': model.mode == 'thumbnail'}" ng-click="model.mode = 'list'">
                        <i class="font font-list-view"></i>
                    </a>
                </div>
            </div>
        </div>
        <div class="clear">
            <div class="thumbnail-label left" ng-repeat="upload in model.pagination.currentList | orderBy: '-created_at'">
                <label>
                    <div class="thumbnail" ng-class="{'selected': upload.selected || upload.id == model.singleSelectedUpload.id, 'single-select': model.singleSelect}">
                        <input type="checkbox" class="thumbnail-input" ng-if="!model.singleSelect" ng-change="toggleUploadClick(upload)" ng-model="upload.selected">
                        <input type="radio" class="thumbnail-input" name="upload" ng-value="upload"
                               ng-model="model.singleSelectedUpload" ng-if="model.singleSelect"/>
                        <img ng-src="/api/third-part/uploads/[[upload.thumbnail.id]]/thumbnail" ng-if="upload.isThirdPartResource && upload.thumbnail && upload.thumbnail.id">
                        <img class="fade" ng-src="/api/third-part/uploads/[[upload.id]]/preview" ng-if="upload.isThirdPartResource && !(upload.thumbnail && upload.thumbnail.id)">
                        <img class="fade" ng-src="/api/uploads/[[upload.thumbnail.id]]/thumbnail?preview=true" ng-if="!upload.isThirdPartResource && upload.thumbnail && upload.thumbnail.id">
                        <img class="fade" ng-src="/api/uploads/[[upload.id]]/blob?preview=true" ng-if="!upload.isThirdPartResource && !(upload.thumbnail && upload.thumbnail.id)">
                    </div>
                </label>
                <div class="file-name truncate-text">
                    <span ng-bind="upload.name" tipsy="upload.name"></span>
                </div>
            </div>
        </div>
    </div>
    <div class="blank-info" ng-if="model.pagination.currentList.length == 0 && !model.searching" ng-cloak>
        您还没有任何文件
    </div>
    <div class="blank-info" ng-if="model.pagination.currentList.length == 0 && model.searching" ng-cloak>
        未找到符合条件的文件
    </div>
</div>
<div class="row list-pager" ng-if="model.pagination.totalPage > 1">
    <ul>
        <li ng-show="model.pagination.currentPage > 1" class="previous-page-button">
            <a class="small pager-button button-white" ng-click="changePage(model.pagination.currentPage - 1)">
                <span>< 上一页</span>
            </a>
        </li>
        <li class="first-page" ng-hide="model.pagination.currentPage <= 1">
            <a class="small pager-button button-white" ng-bind="1" ng-click="changePage(1)"></a>
        </li>
        <li class="ellipsis-pages" ng-hide="model.pagination.currentPage <= 3">
            <span>...</span>
        </li>
        <li class="preview-page" ng-hide="model.pagination.currentPage <= 2">
            <a class="small pager-button button-white" ng-bind="model.pagination.currentPage - 1" ng-click="changePage(model.pagination.currentPage - 1)"></a>
        </li>
        <li class="current-page">
            <a class="small pager-button button-white active" ng-bind="model.pagination.currentPage"></a>
        </li>
        <li class="next-page" ng-hide="model.pagination.currentPage >= model.pagination.totalPage - 1">
            <a class="small pager-button button-white" ng-bind="model.pagination.currentPage + 1" ng-click="changePage(model.pagination.currentPage + 1)"></a>
        </li>
        <li class="ellipsis-pages" ng-hide="model.pagination.currentPage >= model.pagination.totalPage - 2">
            <span>...</span>
        </li>
        <li class="last-page" ng-hide="model.pagination.currentPage >= model.pagination.totalPage">
            <a class="small pager-button button-white" ng-bind="model.pagination.totalPage" ng-click="changePage(model.pagination.totalPage)"></a>
        </li>
        <li ng-show="model.pagination.currentPage < model.pagination.totalPage" class="next-page-button">
            <a class="small pager-button button-white" ng-click="changePage(model.pagination.currentPage+1)">
                <span>下一页 ></span>
            </a>
        </li>
        <li class="custom-pager">
            <span>页码:</span>
            <input type="text" name='page' ng-model="model.pagination.inputPage" ng-change="model.verifyPageIndexInput" enter-press="changePage(model.pagination.inputPage)"/>
            <a class="button button-white" ng-click="changePage(model.pagination.inputPage)" ng-disabled="!model.pagination.inputPage">Go</a>
        </li>
    </ul>
</div>                </div>
                <div class="select-repository-content upload-content" ng-if="model.tab == 'wedrive'">
<div class="file-type row" ng-if="model.context.lesson_resource_only">
    <li ng-class="active">录播教材</li>
    <li class="search-section right">
        <div class="search-key">
            <input type="text" name="key" ng-model="model.keyword" enter-press="search()" wg-placeholder="关键字">
        </div>
        <div class="search-btn">
            <a class="button search" ng-click="search()">
                <span>搜索</span>
            </a>
        </div>
    </li>
</div>

<div class="go_to_prev_folder" ng-if="isAllowedFileType('all') && model.path.length > 0">
    <a ng-click="gotoPrev()">返回上一层</a>
</div>
<div class="row file-summary" ng-if="!(model.fileType == 'image' && model.mode == 'thumbnail')">
    <div class="large-1 column">
        <input type="checkbox" ng-checked="checkAllSelected()" ng-change="switchAll()" ng-model="model.isSelectAll"
               ng-if="!model.singleSelect"/>
    </div>
    <div class="large-3 columns file-name-label">
        资源名
    </div>
    <div class="columns selected-count" ng-class="{'large-12': !toggleAuditCourseResource, 'large-8': toggleAuditCourseResource}">
        <span ng-if="!model.singleSelect">（[["已选:  文件夹 {0}, 资源 {1}" | format:selectedCount() ]]）</span>
    </div>
    <div class="large-5 columns">
        <div class="view-mode right" ng-if="model.fileType == 'image'">
            <a ng-class="{'selected': model.mode == 'list'}" ng-click="model.mode = 'thumbnail'">
                <i class="font font-thumbnail-view"></i>
            </a>
            <a ng-class="{'selected': model.mode == 'thumbnail'}" ng-click="model.mode = 'list'">
                <i class="font font-list-view"></i>
            </a>
        </div>
    </div>
</div>
<div class="file-list" ng-if="!(model.fileType == 'image' && model.mode == 'thumbnail')"
     ng-class="{'folder-pagination-list': model.pagination.totalPage > 1 && isAllowedFileType('all') && model.path.length > 0,
                'folder-list': model.pagination.totalPage <= 1 && isAllowedFileType('all') && model.path.length > 0,
                'file': model.pagination.totalPage <= 1 && !(isAllowedFileType('all') && model.path.length > 0)}">
<div class="loading-bg-mask" ng-show="loadingFullPage"></div>
<div class="loading-gif" ng-show="loadingFullPage"></div>    <div ng-repeat="upload in model.pagination.currentList">
        <div class="row file-list-item" ng-if="upload.is_folder" data-ng-click="!upload.selectable || toggleUploadClick(upload)">
            <div class="large-1 column check">
                <input type="checkbox" ng-change="toggleUploadClick(upload);"
                       ng-model="upload.selected" ng-if="!model.singleSelect" ng-disabled="true"/>
                <input type="radio" name="upload" ng-value="upload"
                       ng-model="model.singleSelectedUpload" ng-if="model.singleSelect" ng-disabled="upload.failed || upload.failedWithAMessage || !upload.selectable"/>
            </div>
            <div class="large-1 column file-icon-wrapper">
                <i class="font font-file-[[fileTypeByExtension(upload)]]"></i>
            </div>
            <div class="columns file-name" ng-click="enterFolder(upload)" ng-class="{'large-14': !toggleAuditCourseResource, 'large-10': toggleAuditCourseResource}">
                <div class="name truncate-text">
                    <span ng-bind="upload.name" tipsy="upload.name"></span>
                </div>
            </div>
            <div class="large-6 columns no-horizontal-padding" ng-class="{'text-center': upload.failed || upload.failedWithAMessage}">
                <div ng-if="!upload.failed && !upload.failedWithAMessage && upload.progress >= 0"
                     class="progress radius">
                    <span class="meter" ng-style="{width: upload.progress + '%'}">
                        <span class="text"><span ng-bind="upload.progress"></span>%</span>
                    </span>
                </div>
                <div ng-if="upload.failed || upload.failedWithAMessage" class="upload-failed">
                    <span ng-show="upload.failed">文件上传失败</span>
                    <span ng-show="upload.failedWithAMessage" ng-bind="upload.failedMessage"></span>
                </div>
            </div>
            <div class="large-4 columns">
                <div ng-if="upload.speed || upload.speed == 0" class="speed">
                    <span ng-bind="upload.speed|humanizeSpeed"></span>
                </div>
            </div>
            <div class="large-3 columns upload-buttons">
                <a class="delete-upload-button" ng-click="deleteUploadingUpload(upload)"
                   ng-if="!upload.failed && (!upload.finished && upload.finished == false)">
                    <i class="font font-delete" tipsy-literal="删除"></i>
                </a>
            </div>
        </div>
        <label class="row file-list-item" ng-if="!upload.is_folder">
            <div class="large-1 column check">
                <input type="checkbox" ng-change="toggleUploadClick(upload)"
                       ng-model="upload.selected" ng-if="!model.singleSelect" ng-disabled="upload.failed || upload.failedWithAMessage || !upload.selectable"/>
                <input type="radio" name="upload" ng-value="upload"
                       ng-model="model.singleSelectedUpload" ng-if="model.singleSelect" ng-disabled="upload.failed || upload.failedWithAMessage || !upload.selectable"/>
            </div>
            <div class="large-1 column file-icon-wrapper">
                <i ng-if="upload.type != 'slide' && upload.type != 'subject-lib'"
                   class="font font-file-[[fileTypeByExtension(upload)]]"></i>
                <i ng-if="upload.type == 'slide'" class="font font-slide"></i>
                <i ng-if="upload.type == 'subject-lib'" class="font font-resource-subject-lib"></i>
            </div>
            <div class="columns file-name" ng-class="{'large-14': !toggleAuditCourseResource, 'large-10': toggleAuditCourseResource}">
                <div>
                    <span class="name truncate-text">
                        <span ng-if="upload.type != 'slide' && upload.type != 'subject-lib'"
                              ng-bind="upload.name|fileName" tipsy="upload.name"></span>
                        <span ng-if="upload.type == 'slide' || upload.type == 'subject-lib'"
                              ng-bind="upload.title" tipsy="upload.title"></span>
                    </span>
                    <span class="video-quiz-mark" ng-if="upload.type == 'video-quiz'">互动教材</span>
                    <span ng-if="upload.type != 'slide'" class="extension" ng-bind="upload.name|fileExtension"></span>
                    <span class="video-quiz-warning" ng-if="upload.type == 'video-quiz' && upload.uploads[0].deleted">视频已删除</span>
                </div>
            </div>
            <div class="large-3 columns upload-buttons">
                <a class="delete-upload-button" ng-click="deleteUploadingUpload(upload)"
                   ng-if="!upload.failed && (!upload.finished && upload.finished == false)">
                    <i class="font font-delete" tipsy-literal="删除"></i>
                </a>
            </div>
        </label>
    </div>
    <div class="blank-info" ng-if="model.pagination.currentList.length == 0 && !model.searching" ng-cloak>
        您还没有任何文件
    </div>
    <div class="blank-info" ng-if="model.pagination.currentList.length == 0 && model.searching" ng-cloak>
        未找到符合条件的文件
    </div>
</div>
<div class="thumbnail-list" ng-if="model.fileType == 'image' && model.mode == 'thumbnail'">
<div class="loading-bg-mask" ng-show="loadingFullPage"></div>
<div class="loading-gif" ng-show="loadingFullPage"></div>    <div class="thumbnail-block">
        <div class="row file-summary clear">
            <div class="large-6 column">
                <input type="checkbox" ng-checked="checkAllSelected()" ng-change="switchAll()" ng-model="model.isSelectAll"
                       ng-if="!model.singleSelect"/>
                <span ng-if="model.singleSelect">&nbsp</span>
            </div>
            <div class="large-26 columns">
                <div class="view-mode right">
                    <a ng-class="{'selected': model.mode == 'list'}" ng-click="model.mode = 'thumbnail'">
                        <i class="font font-thumbnail-view"></i>
                    </a>
                    <a ng-class="{'selected': model.mode == 'thumbnail'}" ng-click="model.mode = 'list'">
                        <i class="font font-list-view"></i>
                    </a>
                </div>
            </div>
        </div>
        <div class="clear">
            <div class="thumbnail-label left" ng-repeat="upload in model.pagination.currentList | orderBy: '-created_at'">
                <label>
                    <div class="thumbnail" ng-class="{'selected': upload.selected || upload.id == model.singleSelectedUpload.id, 'single-select': model.singleSelect}">
                        <input type="checkbox" class="thumbnail-input" ng-if="!model.singleSelect" ng-change="toggleUploadClick(upload)" ng-model="upload.selected">
                        <input type="radio" class="thumbnail-input" name="upload" ng-value="upload"
                               ng-model="model.singleSelectedUpload" ng-if="model.singleSelect"/>
                        <img ng-src="/api/third-part/uploads/[[upload.thumbnail.id]]/thumbnail" ng-if="upload.isThirdPartResource && upload.thumbnail && upload.thumbnail.id">
                        <img class="fade" ng-src="/api/third-part/uploads/[[upload.id]]/preview" ng-if="upload.isThirdPartResource && !(upload.thumbnail && upload.thumbnail.id)">
                        <img class="fade" ng-src="/api/uploads/[[upload.thumbnail.id]]/thumbnail?preview=true" ng-if="!upload.isThirdPartResource && upload.thumbnail && upload.thumbnail.id">
                        <img class="fade" ng-src="/api/uploads/[[upload.id]]/blob?preview=true" ng-if="!upload.isThirdPartResource && !(upload.thumbnail && upload.thumbnail.id)">
                    </div>
                </label>
                <div class="file-name truncate-text">
                    <span ng-bind="upload.name" tipsy="upload.name"></span>
                </div>
            </div>
        </div>
    </div>
    <div class="blank-info" ng-if="model.pagination.currentList.length == 0 && !model.searching" ng-cloak>
        您还没有任何文件
    </div>
    <div class="blank-info" ng-if="model.pagination.currentList.length == 0 && model.searching" ng-cloak>
        未找到符合条件的文件
    </div>
</div>
<div class="row list-pager" ng-if="model.pagination.totalPage > 1">
    <ul>
        <li ng-show="model.pagination.currentPage > 1" class="previous-page-button">
            <a class="small pager-button button-white" ng-click="changePage(model.pagination.currentPage - 1)">
                <span>< 上一页</span>
            </a>
        </li>
        <li class="first-page" ng-hide="model.pagination.currentPage <= 1">
            <a class="small pager-button button-white" ng-bind="1" ng-click="changePage(1)"></a>
        </li>
        <li class="ellipsis-pages" ng-hide="model.pagination.currentPage <= 3">
            <span>...</span>
        </li>
        <li class="preview-page" ng-hide="model.pagination.currentPage <= 2">
            <a class="small pager-button button-white" ng-bind="model.pagination.currentPage - 1" ng-click="changePage(model.pagination.currentPage - 1)"></a>
        </li>
        <li class="current-page">
            <a class="small pager-button button-white active" ng-bind="model.pagination.currentPage"></a>
        </li>
        <li class="next-page" ng-hide="model.pagination.currentPage >= model.pagination.totalPage - 1">
            <a class="small pager-button button-white" ng-bind="model.pagination.currentPage + 1" ng-click="changePage(model.pagination.currentPage + 1)"></a>
        </li>
        <li class="ellipsis-pages" ng-hide="model.pagination.currentPage >= model.pagination.totalPage - 2">
            <span>...</span>
        </li>
        <li class="last-page" ng-hide="model.pagination.currentPage >= model.pagination.totalPage">
            <a class="small pager-button button-white" ng-bind="model.pagination.totalPage" ng-click="changePage(model.pagination.totalPage)"></a>
        </li>
        <li ng-show="model.pagination.currentPage < model.pagination.totalPage" class="next-page-button">
            <a class="small pager-button button-white" ng-click="changePage(model.pagination.currentPage+1)">
                <span>下一页 ></span>
            </a>
        </li>
        <li class="custom-pager">
            <span>页码:</span>
            <input type="text" name='page' ng-model="model.pagination.inputPage" ng-change="model.verifyPageIndexInput" enter-press="changePage(model.pagination.inputPage)"/>
            <a class="button button-white" ng-click="changePage(model.pagination.inputPage)" ng-disabled="!model.pagination.inputPage">Go</a>
        </li>
    </ul>
</div>                </div>
                <div class="select-repository-content upload-content" ng-if="model.tab == 'link'">
<div class="link-tab-content">
    <form name="video_link_form" class="link-info" server-validated>
        <div class="section">
            <div class="item">
                <div class="label">
                    <label class="required">名称</label>
                </div>
                <div class="input">
                    <input type="text" ng-model="linkForm.name" name="name" server-validated>
                     <div class="error">
                        <span error-for="name"></span>
                    </div>
                </div>
            </div>
            <div class="item">
                <div class="label">
                    <label class="required">链接</label>
                    <div class="url-tips">
                        <i class="font font-question tips-icon" tipsy-class="gray"
                           tipsy-html='yes' tipsy-follow-element-width="false"
                           tipsy-literal="支持类型： YouTube、优酷、土豆、搜狐、网易、Microsoft、Vimeo"
                        ></i>
                    </div>
                </div>
                <div class="input">
                    <input type="text" ng-model="linkForm.url" name="url" server-validated>
                    <div class="error">
                        <span error-for="url"></span>
                    </div>
                </div>
            </div>
        </div>
    </form>
</div>                </div>
<div id="upload-not-support-popup" class="reveal-modal popup-area popup-600" data-reveal data-options="multiple_opened:true">
    <div class="popup-content" ng-if="popupState.popupOpened">
        <div class="popup-header">
            <span>上传提示</span>
            <a class="right" ng-click="closePopup('upload-not-support-popup')">
                <i class="font font-close"></i>
            </a>
        </div>
        <div class="main-area">
                <div class="message">
                    <div ng-bind="errMessage"></div>
                </div>
                <div class="not-support-upload-list">
                    <li class="list-item row" ng-repeat="file in unSupportedFiles">
                        <i class="font font-file-undefind"></i>
                        <span ng-bind="file.name"></span>
                    </li>
                </div>
        </div>
        <div class="popup-footer">
            <div class="form-buttons">
                <button class="button button-green medium" type="submit" ng-click="continueUpload()">
                    <p>继续上传</p>
                </button>

                <button class="button button-grey medium" type="button" ng-click="closePopup('upload-not-support-popup')">
                    <span>取消</span>
                </button>
            </div>
        </div>
    </div>
</div><div id="upload-failed-popup" class="reveal-modal popup-area popup-900" data-reveal data-options="multiple_opened:true">
    <div class="popup-content" ng-if="popupState.popupOpened">
        <div class="popup-header">
            <span>上传失败文件</span>
            <a class="right" ng-click="closePopup('upload-failed-popup')">
                <i class="font font-close"></i>
            </a>
        </div>
        <div class="main-area">
                <div class="not-support-upload-list">
                    <li class="list-item row" ng-repeat="file in currentFolderFailedFiles">
                        <div class="large-2 column no-horizontal-padding">
                            <i ng-class="fileClass(file)"></i>
                        </div>
                        <div class="large-14 columns file-name">
                            <div class="truncate-text">
                                <span ng-bind="file.name" tipsy="file.name"></span>
                            </div>
                            <div class="file-info">
                                <div class="created-at">
                                    <span ng-bind="file.created_at|datetime"></span>
                                </div>
                                <div class="size">
                                    <span>大小：</span>
                                    <span ng-bind="file.size|humanizeBytes"></span>
                                </div>
                            </div>
                        </div>
                        <div class="large-14 columns"></div>
                        <div class="large-6 columns message">
                            <span>文件上传失败 </span>
                        </div>
                    </li>
                </div>
        </div>
        <div class="popup-footer">
            <div class="form-buttons">
                <button class="button button-green medium" type="button" ng-click="closePopup('upload-failed-popup')">
                    <span>返回</span>
                </button>
            </div>
        </div>
    </div>
</div>            </div>
        </div>
        <div id="myFilesUpload">
             <div class="upload-hint in-file-select">
<div class="ipr-message" ng-init="twOrg = false;">
<div class="text-align-center">请尊重知识产权法，确保上传内容不侵犯他人知识产权。</div></div>
            </div>
            <div class='storage-info'>
            </div>
        </div>
        <div class="popup-footer">
<div class="loading-spinner" ng-show="loading">
    <div class="spinner">
        <div class="mask">
            <div class="maskedCircle"></div>
        </div>
    </div>
</div>            <button class="button button-green medium"
                    ng-if="model.tab == 'link'"
                    ng-click="createLink()"
                    ng-disabled="!(linkForm.url && linkForm.name)"
            >确认</button>
            <button class="button button-green medium" ng-if="model.tab != 'link'"
                    ng-click="save()" ng-disabled="isUploading() || model.getSelectedUploads().length <= 0 || !hasReadIPR">
                确认
            </button>
        </div>
    </div>
</div><div class="code-editor popup-area new-popup-area popup-1080 reveal-modal" id="code-editor" data-reveal resetable
     data-options="multiple_opened:true">
    <div class="popup-content" ng-if="popupState.popupOpened" ng-controller="CodeEditorController">
        <div class="popup-header">
            <span>代码编辑器</span>
            <a class="right" ng-click="close()">
                <i class="font font-close"></i>
            </a>
        </div>
        <div class="main-area">
            <div class="toolbar">
                <div class="mode-selector">
<select ui-select2="{'formatNoMatches': '没有匹配结果'}"
        ng-model="mode" ng-change="changeMode()">
    <option value="abap">ABAP</option>
    <option value="abc">ABC</option>
    <option value="actionscript">ActionScript</option>
    <option value="ada">ADA</option>
    <option value="alda">Alda</option>
    <option value="apache_conf">Apache Conf</option>
    <option value="apex">Apex</option>
    <option value="aql">AQL</option>
    <option value="asciidoc">AsciiDoc</option>
    <option value="asl">ASL</option>
    <option value="assembly_x86">Assembly x86</option>
    <option value="autohotkey">AutoHotkey / AutoIt</option>
    <option value="batchfile">BatchFile</option>
    <option value="c_cpp">C and C++</option>
    <option value="c9search">C9Search</option>
    <option value="cirru">Cirru</option>
    <option value="clojure">Clojure</option>
    <option value="cobol">Cobol</option>
    <option value="coffee">CoffeeScript</option>
    <option value="coldfusion">ColdFusion</option>
    <option value="crystal">Crystal</option>
    <option value="csharp">C#</option>
    <option value="csound_document">Csound Document</option>
    <option value="csound_orchestra">Csound</option>
    <option value="csound_score">Csound Score</option>
    <option value="css">CSS</option>
    <option value="curly">Curly</option>
    <option value="d">D</option>
    <option value="dart">Dart</option>
    <option value="diff">Diff</option>
    <option value="dockerfile">Dockerfile</option>
    <option value="dot">Dot</option>
    <option value="drools">Drools</option>
    <option value="edifact">Edifact</option>
    <option value="eiffel">Eiffel</option>
    <option value="ejs">EJS</option>
    <option value="elixir">Elixir</option>
    <option value="elm">Elm</option>
    <option value="erlang">Erlang</option>
    <option value="forth">Forth</option>
    <option value="fortran">Fortran</option>
    <option value="fsharp">FSharp</option>
    <option value="fsl">FSL</option>
    <option value="ftl">FreeMarker</option>
    <option value="gcode">Gcode</option>
    <option value="gherkin">Gherkin</option>
    <option value="gitignore">Gitignore</option>
    <option value="glsl">Glsl</option>
    <option value="gobstones">Gobstones</option>
    <option value="golang">Go</option>
    <option value="graphqlschema">GraphQLSchema</option>
    <option value="groovy">Groovy</option>
    <option value="haml">HAML</option>
    <option value="handlebars">Handlebars</option>
    <option value="haskell">Haskell</option>
    <option value="haskell_cabal">Haskell Cabal</option>
    <option value="haxe">haXe</option>
    <option value="hjson">Hjson</option>
    <option value="html">HTML</option>
    <option value="html_elixir">HTML (Elixir)</option>
    <option value="html_ruby">HTML (Ruby)</option>
    <option value="ini">INI</option>
    <option value="io">Io</option>
    <option value="jack">Jack</option>
    <option value="jade">Jade</option>
    <option value="java">Java</option>
    <option value="javascript">JavaScript</option>
    <option value="json">JSON</option>
    <option value="json5">JSON5</option>
    <option value="jsoniq">JSONiq</option>
    <option value="jsp">JSP</option>
    <option value="jssm">JSSM</option>
    <option value="jsx">JSX</option>
    <option value="julia">Julia</option>
    <option value="kotlin">Kotlin</option>
    <option value="latex">LaTeX</option>
    <option value="latte">Latte</option>
    <option value="less">LESS</option>
    <option value="liquid">Liquid</option>
    <option value="lisp">Lisp</option>
    <option value="livescript">LiveScript</option>
    <option value="logiql">LogiQL</option>
    <option value="lsl">LSL</option>
    <option value="lua">Lua</option>
    <option value="luapage">LuaPage</option>
    <option value="lucene">Lucene</option>
    <option value="makefile">Makefile</option>
    <option value="markdown">Markdown</option>
    <option value="mask">Mask</option>
    <option value="matlab">MATLAB</option>
    <option value="maze">Maze</option>
    <option value="mediawiki">MediaWiki</option>
    <option value="mel">MEL</option>
    <option value="mips">MIPS</option>
    <option value="mixal">MIXAL</option>
    <option value="mushcode">MUSHCode</option>
    <option value="mysql">MySQL</option>
    <option value="nginx">Nginx</option>
    <option value="nim">Nim</option>
    <option value="nix">Nix</option>
    <option value="nsis">NSIS</option>
    <option value="nunjucks">Nunjucks</option>
    <option value="objectivec">Objective-C</option>
    <option value="ocaml">OCaml</option>
    <option value="pascal">Pascal</option>
    <option value="perl">Perl</option>
    <option value="pgsql">pgSQL</option>
    <option value="php">PHP</option>
    <option value="php_laravel_blade">PHP (Blade Template)</option>
    <option value="pig">Pig</option>
    <option value="powershell">Powershell</option>
    <option value="praat">Praat</option>
    <option value="prisma">Prisma</option>
    <option value="prolog">Prolog</option>
    <option value="properties">Properties</option>
    <option value="protobuf">Protobuf</option>
    <option value="puppet">Puppet</option>
    <option value="python">Python</option>
    <option value="qml">QML</option>
    <option value="r">R</option>
    <option value="raku">Raku</option>
    <option value="razor">Razor</option>
    <option value="rdoc">RDoc</option>
    <option value="red">Red</option>
    <option value="rhtml">RHTML</option>
    <option value="rst">RST</option>
    <option value="ruby">Ruby</option>
    <option value="rust">Rust</option>
    <option value="sass">SASS</option>
    <option value="scad">SCAD</option>
    <option value="scala">Scala</option>
    <option value="scheme">Scheme</option>
    <option value="scss">SCSS</option>
    <option value="sh">SH</option>
    <option value="sjs">SJS</option>
    <option value="slim">Slim</option>
    <option value="smarty">Smarty</option>
    <option value="smithy">Smithy</option>
    <option value="snippets">snippets</option>
    <option value="soy_template">Soy Template</option>
    <option value="space">Space</option>
    <option value="sql">SQL</option>
    <option value="sqlserver">SQLServer</option>
    <option value="stylus">Stylus</option>
    <option value="svg">SVG</option>
    <option value="swift">Swift</option>
    <option value="tcl">Tcl</option>
    <option value="terraform">Terraform</option>
    <option value="tex">Tex</option>
    <option value="text">Text</option>
    <option value="textile">Textile</option>
    <option value="toml">Toml</option>
    <option value="tsx">TSX</option>
    <option value="twig">Twig</option>
    <option value="typescript">Typescript</option>
    <option value="vala">Vala</option>
    <option value="vbscript">VBScript</option>
    <option value="velocity">Velocity</option>
    <option value="verilog">Verilog</option>
    <option value="vhdl">VHDL</option>
    <option value="visualforce">Visualforce</option>
    <option value="wollok">Wollok</option>
    <option value="xml">XML</option>
    <option value="xquery">XQuery</option>
    <option value="yaml">YAML</option>
    <option value="zeek">Zeek</option>
    <option value="django">Django</option>
</select>                </div>
            </div>
            <pre id="editor"></pre>
        </div>
        <div class="popup-footer">
            <button class="button button-green medium" ng-click="save()"
                    >
                确认
            </button>
        </div>
    </div>
</div></div>
<span
  id="userId"
  data-id="281121"
  value="281121"
  class="ui-helper-hidden-accessible"
></span>
<span id="isVisitor" data-value="" class="ui-helper-hidden-accessible"></span>
<input type="hidden" id="dashboardTracking" value="True" />
<span
  id="notificationServerUrl"
  data-url="https://courses.zju.edu.cn/ntf"
  class="ui-helper-hidden-accessible"
></span>
<input type="hidden" id="courseId" value="" />
<input type="hidden" id="subCourseId" value="">
<input
  type="hidden"
  id="enrollmentIsInstructor"
  value=""
/>
<input
  type="hidden"
  id="enrollmentIsInstructorAssistant"
  value=""
/>

<input
  type="hidden"
  id="enrollmentIsStudent"
  value=""
/>
<input type="hidden" id="isSimulatingInCourse" value="False" />
<input type="hidden" id="showNickname" value="False" />

<input type="hidden" id="orgId" value="1" />
    <input type="hidden" id="userRole" value="Student">
 <input type="hidden" id="dotdotdotToggleCollapseI18n" ng-init="dotdotdotToggleCollapseI18n='收起'"> <input type="hidden" id="dotdotdotToggleExpandI18n" ng-init="dotdotdotToggleExpandI18n='更多...'">
<root-scope-variable name="lang" value="zh-CN"></root-scope-variable>
<root-scope-variable name="orgId" value="1"></root-scope-variable>
<root-scope-variable name="currentOrgTip" value="本平台"></root-scope-variable>
<script>
    var globalData = {
        user: {
            id: 281121,
            name: "黄浩旸",
            userNo: "3240100106",
            orgId: 1,
            mobile: "None",
            orgName: "学在浙大",
            orgCode: "1",
            role: "Student",
            hasAiAbility: false,
        },
        isSimulatingVisitor: false,
        courseRoles: [""],
        deliveryOrg: "ZJU",
        orgNames: {},
        faceServiceType: "None",
        enableLoginCheck: false,
        enableLoginRollcallCheck: false,
        hasJoinedVtrs: false,
        sobotSrc: "",
        hideGradeInfo: false,
        lang: "zh-CN"
    }
</script>
<script>
    var featureToggles = {
        "class_mode_casting": true,
        "single_user_session_constraint": false,
        "ongoing_course": false,
        "face_recognition_service": false,
        "face_photo_check_service": false,
        "inclass.user_action_track": true,
        "lesson_resource": false,
        "lesson": true,
        "cloud_classroom": false,
        "onlineTeaching": false,
        "customize_i18n": false,
        "course_end_date_filter": false,
        "vocabulary": false,
        "wps_preview": false,
        "yz_office_preview": false,
        "editorActivityRefer": false,
        "lazyLoadCourseSection": false,
        "courseIndexDateFilter": false,
        "outcomeBasedEducation": false,
        "water_mark_by_vue_multi_player": false,
        "enableProgram": false,
        "examInvigilation": true,
        "simditor_embed_video": false,
        "simditor_attachment": false,
        "course_module_required": true,
        "publishScoreOfPartialStudents": false,
        "courseNeedPublish": false,
        "sortVideoAnalysis": false,
        "zoom": true,
        "microsoftTeamsMeeting": false,
        "googleMeeting": false,
        "welink": false,
        "tencentMeeting": false,
        "tencentMeetingPersonal": false,
        "managementTencentMeeting": false,
        "scorePublishItems": false,
        "campusSubjectLib": true,
        "sharedResourceAudit": true,
        "scores": true,
        "alert": false,
        "managementLog": true,
        "classin": false,
        "dingtalkLive": true,
        "lectureLive": false,
        "webexMeeting": false,
        "enableAuditorCourseRole": false,
        "enableDingTalkChat": true,
        "homeworkDuplicateDetect": true,
        "homeworkCnkiDuplicateDetect": true,
        "homeworkMarkNew": true,
        "importExamSubjectByWord": true,
        "exportSubjectLibExcel": true,
        "canSubmitComment": true,
        "canSubmitQuestion": true,
        "danmu": true,
        "course.stat.online_video_view_detail": false,
        "excellentInstructorStudio": true,
        "create_course_sis": true,
        "scheduleCaptureAssociationDeletion": false,
        "ustcMode": false,
        "courseImportMoodle": false,
        "phaseTeachingModel": true,
        "courseImportCommonCartridge": false,
        "aliyun_office": false,
        "aliyun_office_edit": false,
        "teaching_calendar": false,
        "calendar_timetable": false,
        "join_course": true,
        "word_cloud": true,
        "enableSobot": false,
        "enable_howxm": false,
        "inclass_report": true,
        "enableTrainingLevelForAuthzRole": false,
        "enableHomework": true,
        "enableExam": true,
        "enableOnlineVideo": true,
        "enableLesson": true,
        "enableMaterial": true,
        "enableLink": true,
        "enableForum": true,
        "enableQuestionnaire": true,
        "enableSlide": false,
        "facebookLogin": false,
        "googleLogin": false,
        "analysisSubject": true,
        "fillInBlankSubject": true,
        "clozeSubject": false,
        "matchingSubject": false,
        "coursePackage": false,
        "examIPControl": true,
        "knowledgeGraph": true,
        "knowledgeGraphBatchImportXmind": true,
        "knowledgeGraphBatchImportExcel": true,
        "knowledgeGraphBatchImportCourse": true,
        "isCognitiveDimensionOpen": true,
        "wecomChat": false,
        "ccLicenseSetting": false,
        "larkMeeting": false,
        "wecomMeeting": false,
        "dingtalkMeeting": false,
        "chatRoom": false,
        "virtualClassroom": false,
        "enableCourseSubjectLib": false,
        "enablePlayer2": true,
        "enableIndependentCoTeachingPermission": false,
        "interaction": true,
        "airDocQuiz": true,
        "airVideoQuiz": true,
        "airClassroomQuiz": true,
        "airChatbot": true,
        "airGrading": true,
        "airCreditManage": true,
        "airQuizAnalyze": true,
        "airTextOptimization": true,
        "airExamQuiz": true,
        "airSubjectLibQuiz": true,
        "airCoursewareDiscussion": true,
        "airLessonQuiz": false,
        "airPlayerSyncTranslation": false,
        "enableKnowledgeReferenceCapture": false,
        "enableKnowledgeReferencePublicResource": false,
        "inclass.allow_download": false,
        "examSubjectGroup": false,
        "use_authz_role": true,
        "inclass.allow_download": false,
        "privateWpsOffice": true,
        "inclassModule": false,
        "askQuestion": false,
        "shareCourseTw": false,
        "aiPpt": false,
        "enableLecturerCourseRole": false,
        "relationCourses": false,
        "courseEstimate": true,
        "courseEstimateWithoutScore": false,
        "rollcallAbsenteesExcluded": false,
        "newCourseHome": false,
        "applicationCenter": true,
        "userHomepage": true,
        "newCourseHomeTeachingData": true,
    }
</script><script>
    var orgSettings = {
        "waterMarkCustomizationInfo": "",
        "orgStatsActivity":  false,
        "gpt": "",
        "conjure": "",
        "howxmAppId": "",
        "simditorMarkdown": {
            "enable": false,
            "defaultActive": false
        },
        "enableTextbook":false,
        "moduleNotificationConfig":{
            "days": [1, 3, 5, 7, 15],
            "time": "8:00",
        },
        "enableOffCampusUserFlag":false,
        "qrcodeRefreshInterval": 15.0,
        "tencentMeetingOnlyCloudRecord": false,
        "tencentMeetingRoomsEnabled": false,
        "maxFileCountInUploadFolder": 50.0,
        "maxLevelInUploadFolder": 5.0,
        "disableEditExternalScoreItemName": false,
        "enableAhmuGetStudentsScore": false,
        "xjtuKnowledgeMode": false,
        "h5CoursewareCompleteness": false,
        "isXjtuKnowledgeForestMode": false,
        "copyTemplateCourseSettings": {
            "enabledUpdateActivityDatetime": false,
            "dayOffset": 14.0,
            "minOffsetForStartTime": 5.0,
            "minOffsetForEndTime": 5.0,
        },
        "hiddenGroup": false,
        "hiddenRollcall": false,
        "hiddenQrcode": false,
        "hideStudentAssistant": false,
        "airTranslationSupportedLanguages": [],
        "bvChatbot": {},
        "allowFacetsAndFragments": false,
        "enableChinamCloudGraph": false,
        "enableTodayCourse": false,
        "enableDesignatedInspectCourse": false,
        "customizeTimetable": false,
        "enterpriseMode": false,
        "airOutputLocale": ['auto', 'zh-CN', 'en-US'],
        "aiPpt": {},
        "airChatbot": {'course_roles': ['student', 'instructor_assistant', 'instructor', 'student_assistant'], 'title': {'en-US': 'ZJU AIR', 'zh-CN': '学在浙大 AIR', 'zh-TW': '學在浙大 AIR'}, 'url': 'https://courses.zju.edu.cn/chatbot/chatbot.umd.js'},
        "plusSupportedMimeTypes": [],
        "enableTongjiCommunityLayout": false,
        "enableTeachingScheduleAndOthers": false,
    }
</script>

        <div class="main-content gtm-category " ng-class="{'has-footer-warning': org_plan_trial == 'True'}"
             auto-scroll-to-last-position data-category="tronclass-content">
    <div class="content-under-nav-1 with-loading"
         ng-init="indexMenuItem='index';
         useCard='false';
         orgId='1';
         szuPageMode=false;
         i18nMessages={'noData': '暂无统计数据'};
         weekDays=['周一', '周二', '周三', '周四', '周五', '周六', '周日'];
         summaryVisitTypes=['访问量', '访问人数'];
         has_avatar='False';
         associationCode='L7NFCL';">
        <div class="user-index row collapse">
            <div class="column collapse menu-side" ng-class="{'hide': szuPageMode}">
<div class="user-menu card gtm-category" data-category="左侧导航" ng-cloak>
    <div class="user-info">
        <div class="user-avatar">
            <avatar src="avatarBigUrl"></avatar>
        </div>
        <div class="user-name truncate-text">
            <span ng-bind="currentUserName" tipsy="currentUserName"></span>
        </div>

        <div class="user-role">
            <div ng-switch="currentUserRole" ng-cloak ng-if="currentUserRole">
                <span ng-switch-when="Student">学生</span>
                <span ng-switch-when="Instructor">教师</span>
            </div>
            <div ng-if="!currentUserRole">学生</div>
        </div>
    </div>
    <div class="menu zh-CN" ng-init="isJLU = 'ZJU' == 'JLU';">
        <div class="group" ng-if="isJLU">
            <a ng-class="{active: indexMenuItem == 'index'}" ng-href="/user/index" class="gtm-label"
               data-label="首页">
                <i class="icon icon-user-index-index"
                   ng-class="{'icon-user-index-index-selected': indexMenuItem == 'index'}"></i>
                <span>首页</span>
            </a>
        </div>
        <div class="group">
            <div class="group-name" ng-cloak
                 ng-if="currentUserRole && currentUserRole == 'Student'">我的学习
            </div>
            <div class="group-name" ng-cloak
                 ng-if="currentUserRole && currentUserRole != 'Student'">我的教学
            </div>
            <div class="group-name" ng-cloak ng-if="!currentUserRole">
                我的学习
            </div>

            <a ng-class="{active: indexMenuItem == 'index'}" ng-href="/user/index" class="gtm-label"
               data-label="首页" ng-if="!isJLU">
                <i class="icon icon-user-index-index"
                   ng-class="{'icon-user-index-index-selected': indexMenuItem == 'index'}"></i>
                <span>首页</span>
            </a>
            <a ng-class="{active: indexMenuItem == 'course'}" ng-href="/user/courses" class="gtm-label"
               data-label="我的课程">
                <i class="icon icon-user-index-course"
                   ng-class="{'icon-user-index-course-selected': indexMenuItem == 'course'}"></i>
                <span>我的课程</span>
            </a>
            <a ng-class="{active: indexMenuItem == 'note'}" ng-href="/user/notes" class="gtm-label"
               data-label="我的筆記">
                <i class="icon icon-my-note-not-selected"
                   ng-class="{'icon-my-note-selected': indexMenuItem == 'note'}">
                </i>
                <span>我的笔记</span>
            </a>
            <a ng-class="{active: indexMenuItem == 'bulletin'}" ng-href="/bulletin-list/" class="gtm-label"
               data-label="公告">
                <i class="font font-bulletin"
                   ng-class="{'selected': indexMenuItem == 'bulletin'}"></i>
                <span>公告</span>
            </a>
            <a ng-class="{active: indexMenuItem == 'student-profile'}" ng-href="/user/profile" class="gtm-label"
               data-label="我的档案">
                <i class="font font-student-profile"
                   ng-class="{'selected': indexMenuItem == 'student-profile'}"></i>
                <span>我的档案</span>
            </a>


            <!--  包含"我的直录播"等在内的plugins  -->

            <!-- LMS-5968: 吉大需要将公告导航栏放到最后-->
            <a ng-class="{active: indexMenuItem == 'studio'}" ng-href="/user/studios" class="gtm-label"
               data-label="名师工作室">
                <i class="font font-user-studio"
                   ng-class="{'selected': indexMenuItem == 'studio'}"></i>
                <span>名师工作室</span>
            </a>
        </div>

        <div class="group">
            <div class="group-name">我的资源</div>


            <a ng-class="{active: indexMenuItem == 'file'}" ng-href="/user/resources/files" class="gtm-label"
               data-label="文件">
                <i class="icon icon-user-index-resource-file"
                   ng-class="{'icon-user-index-resource-file-selected': indexMenuItem == 'file'}"></i>
                <span>文件</span>
            </a>
            <!--  互动教材  -->
            <a ng-class="{active: indexMenuItem == 'video-quiz'}" ng-href="/user/resources/video-quizzes"
               class="gtm-label" data-label="互动教材">
                <i class="font font-video-quiz"
                   ng-class="{'icon-user-index-resource-file-selected': indexMenuItem == 'video-quiz'}"></i>
                <span>互动教材</span>
            </a>


            <!--  个人题库  -->
            <a ng-class="{active: indexMenuItem == 'subject_lib'}" href="/user/resources/subject-libs"
               class="gtm-label" data-label="个人题库">
                <i class="icon icon-user-index-resource-subject-lib"
                   ng-class="{'icon-user-index-resource-subject-lib-selected': indexMenuItem == 'subject_lib'}"></i>
                <span>个人题库</span>
            </a>



            <a ng-class="{active: indexMenuItem == 'shared-resource'}" href="/user/resources/shared"
               class="gtm-label" data-label="我的分享">
                <i class="font font-shared-resources-menu-icon"
                   ng-class="{'active': indexMenuItem == 'shared-resource'}"></i>
                <span>我的分享</span>
            </a>

            <a ng-class="{active: indexMenuItem == 'track-user'}" href="/user/resources/track-user"
               class="gtm-label" data-label="我的追蹤">
                <i class="font font-track"
                   ng-class="{'active': indexMenuItem == 'track-user'}"></i>
                <span>我的关注</span>
            </a>

            <a ng-class="{active: indexMenuItem == 'collection'}" href="/user/resources/collection"
               class="gtm-label" data-label="我的追蹤">
                <i class="font font-mellow-empty-star mellow-empty-star"
                   ng-class="{'active': indexMenuItem == 'collection'}"></i>
                <span>我的收藏</span>
            </a>
        </div>



        <div class="group">
            <div class="group-name">账户管理</div>
            <a ng-class="{active: indexMenuItem == 'setting'}" ng-href="/user/settings" class="gtm-label"
               data-label="个人设置">
                <i class="icon icon-user-index-setting"
                   ng-class="{'icon-user-index-setting-selected': indexMenuItem == 'setting'}"></i>
                <span>个人设置</span>
            </a>
        </div>
    </div>
</div>            </div>

            <div class="column collapse right-side ng-cloak gtm-category" ng-class="{'card': useCard == 'true',
                'full-screen': szuPageMode}"
                 data-category="右侧内容">
    <div ng-init="currentDeptId = null;
                  enableCreateCourseForEducationalAdminOrAdmin=true;"
         class="gtm-category" data-category="首页">


<input id="is-toggle-prerequisite-opened" type="hidden" value="">
<div class="user-dashboard ng-cloak"
     before-controller="
        notificationTab = 'notification';
        isSGJX = 'ZJU' == 'SGJX';
        isOUYA = 'ZJU' == 'OUYA';
        isStudent = 'Student' == 'Student';"
     ng-controller="InstructorIndexController">
    <div class="content row">
<div class="sgjx-resource-container card" ng-if="isSGJX && isStudent"
    ng-controller="SGJXResourceController">
    <div class="resource-header">
        <i class="font font-related-resource"></i>
        <span ng-if="currentDeptId">专业相关资源</span>
        <span ng-if="!currentDeptId">推荐资源</span>
        <a class="more right" ng-if="ui.classificationResourceMap[ui.currentClassification].length > 10"
           ng-href="/shared-resource/search#?department=[[currentDeptId]]" target="_blank">更多资源 &gt;</a>
    </div>
    <div class="classifications">
        <a ng-class="{'active': ui.currentClassification == classification.id}"
           ng-repeat="classification in classifications" ng-click="getResources(classification.id)">
            <span ng-bind="classification.name"></span>
        </a>
    </div>
    <div class="resources">
        <div class="resource column-1-of-2" ng-if="ui.classificationResourceMap[ui.currentClassification].length > 0"
             ng-repeat="resource in ui.classificationResourceMap[ui.currentClassification]" ng-show="$index<10">
            <i class="font font-file-[[fileTypeByExtension(resource.upload)]]" ng-if="resource.referrer_type == 'upload'"></i>
            <i class="font font-resource-subject-lib" ng-if="resource.referrer_type == 'subject_library'"></i>
            <i class="font font-slide" ng-if="resource.referrer_type == 'slide'"></i>
            <div class="name truncate-text">
                <a ng-href="/shared-resource/[[resource.id]]/detail" ng-bind="resource.name" tipsy="resource.name"></a>
            </div>
        </div>
        <div class="blank-prompt-info" ng-if="ui.classificationResourceMap[ui.currentClassification].length == 0">
            <i class="font font-file-blank"></i>
            <span class="blank-message">暂无相关资源</span>
        </div>
    </div>
</div>        <div class="left-frame">
            <div class="dashboard-tabs card row">
                <div class="dashboard-tab gtm-label" ng-click="setCurrentTab('notification')"
                     ng-class="{'active': notificationTab == 'notification'}" data-label="动态">
                    <div>动态</div>
                    <div class="icon icon-notification-tab-arrow" ng-show="notificationTab == 'notification'"></div>
                </div>
                <div class="dashboard-tab gtm-label" ng-click="setCurrentTab('latestContent')"
                     ng-class="{'active': notificationTab == 'latestContent'}"  data-label="最新内容">
                    <div class="tab-name content-toggle-arrow-up-small">最新内容</div>
                    <div class="icon icon-notification-tab-arrow" ng-show="notificationTab == 'latestContent'"></div>
                </div>
            </div>
            <div class="notification-content gtm-label" ng-show="notificationTab == 'notification'" data-label="动态">
<script id="notification-report-remark" type="application/json">
    {
        "copyright": "盗版或侵权，未获得权利人的合法授权、侵犯个人隐私或泄露单位商业机密",
        "ad_or_spam": "广告或垃圾信息",
        "vulgar_info": "色情、淫秽、低俗信息",
        "reactionary_info": "反政府、反人类、反社会等反动信息",
        "crime_info": "散布赌博、暴力、凶杀、恐怖或者教唆犯罪等信息",
        "defamation": "侮辱、诽谤等人身攻击信息",
        "rumor": "散布谣言、扰乱社会秩序、破坏社会稳定等信息"
    }
</script><div class="notification-content" ng-controller="NotificationContentCtrl"
     ng-init="teachingUnitNames = {'course': '课程', 'teaching_class': '班级' };
        teachingUnitRoleNames = {'student': '学生', 'instructor': '教师', 'instructor_assistant': '助教' };">
    <div class="notification-list" ng-controller="NotificationListController"
         ng-init="notificationTypesAndText = {
                    'material': '参考资料',
                    'web_link': '线上链接',
                    'online_video': '音视频教材',
                    'slide': '微课',
                    'lesson': '录播教材',
                    'homework': '作业',
                    'forum': '讨论区',
                    'chatroom': 'iSlide 直播',
                    'questionnaire': '调查问卷',
                    'page': '页面',
                    'scorm': 'SCORM'
                };
                notificationHeaders = {
                    'activity_opened': '学习活动发布',
                    'activity_opening': '学习活动即将开放',
                    'activity_expiring': '学习活动即将截止',
                    'activity_expiring_today': '学习活动即将截止',
                    'activity_expiring_week': '学习活动即将截止',
                    'bulletin_created': '公告发布',
                    'bulletin_updated': {'update' : '公告更新', 'delete' : '公告删除'},
                    'homework_ended': '作业截止',
                    'homework_expiring': '作业即将截止',
                    'homework_expiring_today': '作业即将截止',
                    'homework_expiring_week': '作业即将截止',
                    'homework_opened_for_submission': '作业发布',
                    'homework_opening_for_submission': '作业即将开放交付',
                    'reply_created': '讨论回帖',
                    'score_published': '成绩公布',
                    'submission_submitted': '作业提交',
                    'course_homework_remind': '催交作业',
                    'course_homework_make_up': '补交作业',
                    'course_homework_resubmit': '补交作业',
                    'course_homework_review_remind': '作业互评',
                    'course_opening': '课程即将开始',
                    'course_deleted': '课程已被删除',
                    'course_outline_edit': '课程信息制定提醒',
                    'course_outline_closing_edit': '课程信息制定提醒',
                    'course_outline_updated': '课程信息更新',
                    'user_join_course': '班级成员加入',
                    'user_exit_course': '班级成员退出',
                    'exam_make_up': '补考测试',
                    'exam_submission': '在线测试提交',
                    'inter_score_ended': '作业互评已经截止',
                    'inter_score_expiring': '作业互评即将截止',
                    'inter_score_homework_submission': '分组互评作业提交',
                    'intra_score_ended': '组内作业互评已经截止',
                    'intra_score_expiring': '组内作业互评即将截止',
                    'score_publish_closing': '成绩送交即将截止',
                    'score_setting_changed': '课程成绩送交',
                    'score_publish_reject': '课程成绩被退回',
                    'has_recommend_homework_group': '作业推荐',
                    'has_recommend_homework': '作业推荐',
                    'homework_is_recommended_group': '作业推荐',
                    'homework_is_recommended': '作业推荐',
                    'course_started': '课程已经开始',
                    'warning_opened': '预警名单提交',
                    'recent_plan_expire': '套餐即将到期',
                    'plan_expired': '套餐到期',
                    'recent_storage_run_out': '容量不足',
                    'storage_run_out': '容量用完',
                    'recent_transfer_run_out': '流量不足',
                    'transfer_run_out': '流量用完',
                    'instructor_submit_course_public_audit': '公开课审核',
                    'course_public_audit_response': {'agree' : '公开课审核通过', 'reject' : '公开课审核不通过'},
                    'welcome': '欢迎加入！',
                    'course_estimate': '课程评论',
                    'group_recommend_homework_removed': '推荐作业',
                    'course_estimate_reply': '课程评论的回帖',
                    'homework_submitted': '作业提交',
                    'teaching_unit_invite': '邀请成员',
                    'exam_submission_info': '在线测试提交',
                    'exam_opened': '测试发布',
                    'exam_expiring': '在线测试即将截止',
                    'exam_expiring_today': '在线测试即将截止',
                    'exam_expiring_week': '在线测试即将截止',
                    'exam_ended': '测试已截止',
                    'exam_submit_started': '在线测试开放答题',
                    'exam_will_start': '线上测试即将开放答题',
                    'topic_replies': {'single_reply' : '回复了你的帖子', 'multi_replies' : '多人回复了你的讨论'},
                    'topic_secondary_replies': {'single_reply' : '评论了你的回帖', 'multi_replies' : '多人评论了你的回帖'},
                    'topic_like': {'single_reply': '赞了你的帖子', 'multi_replies': '多人赞了的帖子'},
                    'topic_create': '新帖子',
                    'discussion_create': '讨论区发布',
                    'exam_score_updated': '测试成绩',
                    'homework_score_updated': '作业成绩',
                    'discussion_score_updated': '讨论成绩',
                    'post_create': '帖子发布',
                    'shared_resource_audit_agree': '分享资源通过审核',
                    'shared_resource_audit_reject': '分享资源未通过审核',
                    'shared_resource_reported': '分享资源被举报',
                    'shared_resource_off_the_shelf': '分享资源被下架',
                    'shared_resource_to_other_orgs_audit_agree': '分享资源通过审核',
                    'shared_resource_to_other_orgs_audit_reject': '分享资源未通过审核',
                    'shared_resource_to_other_orgs_reported': '分享资源被举报',
                    'shared_resource_to_other_orgs_off_the_shelf': '分享资源被下架',
                    'campus_subject_lib_audit_agree': '发布试题通过审核',
                    'campus_subject_lib_audit_reject': '发布试题未通过审核',
                    'campus_subject_lib_off_the_shelf': '发布试题被下架',
                    'learning_progress_alert': '预警通知',
                    'learning_warning': '学习预警',
                    'homework_review_started': '作业互评开始',
                    'questionnaire_remind': '催交问卷',
                    'share_resource_to_user': '资源分享',
                    'calendar_event_publish': '事件通知',
                    'calendar_event_alert': '事件提醒通知',
                    'calendar_timetable_update': '调课通知',
                    'calendar_timetable_delete': '取消上课通知',
                    'new_resource_share_to_follower': '新资源上架通知',
                    'tracked_user_is_tracked': '关注通知',
                    'shared_course_audit_agree': '分享课程通过审核',
                    'shared_course_audit_reject': '分享课程未通过审核',
                    'shared_course_to_other_orgs_audit_agree': '分享课程通过审核',
                    'user_join_resource_group': '加入小组通知',
                    'user_leave_resource_group': '退出小组通知',
                    'resource_group_deleted': '小组解散通知',
                    'rollcall_alert': '考勤预警',
                    'learning_activity_alert': '学习活动预警',
                    'course_completeness_alert': '课程完整度预警',
                    'course_obe_unassociated_alert': '课程OBE预警',
                    'course_score_alert': '课程成绩预警',
                    'video_clipped': {'success' : '视频剪辑成功', 'failed' : '视频剪辑失败'},
                    'video_generated': {'success' : '视频合成成功', 'failed' : '视频合成失败'},
                    'create_research_meeting': '教学研讨(会议)通知',
                    'research_meeting_will_begin': '教学研讨(会议)通知',
                    'research_discussion_created': '教学研讨(讨论)通知',
                    'moodle_course_imported': '课程导入',
                    'resource_audit_rejected': '资源审核拒绝',
                    'questionnaire_submitted': '课程评价通知',
                    'book_live_will_begin': '直播通知',
                    'continuous_absence_alert': '连续缺勤预警',
                    'continuous_absence_teacher_alert': '连续缺勤预警',
                    'compulsory_not_taken_alert': '必修课修习预警',
                    'course_attendance_rate_alert': '课程到课率预警',
                    'resource_comment_at': '资源讨论被提及',
                    'homework_redo': '打回重做',
                    'vtrs_member_deleted': '虚拟教研室',
                    'vtrs_owner_transferred': '转移组长权限',
                    'notify_evaluation_ended': '考核评价已截止',
                    'notify_evaluation_started': '考核评价开启',
                    'project_apply_approved': '项目申请通过',
                    'project_apply_rejected': '项目申请拒绝',
                    'schedule_audit_agree': '活动申请通过',
                    'schedule_audit_rejected': '活动申请拒绝',
                    'schedule_audit_expired': '活动申请失效',
                    'low_user_air_credit': '点数不足',
                    'low_course_air_credit': '点数不足',
                    'air_user_credit_audit_approved': '申请通过',
                    'air_course_credit_audit_approved': '申请通过',
                    'air_user_credit_audit_rejected': '申请拒绝',
                    'air_course_credit_audit_rejected': '申请拒绝',
                };
                userCreatedAt = '2024-07-31T16:11:12Z';
                saved='已保存';
                folderSelectTitle='保存到&#34;我的资源&#34;'; ">
<div class="loading-in-element" ng-show="contentLoaded">
    <div class="spinner"></div>
</div>        <div class="notification-nav" fixable-nav></div>
        <div class="notification-t-item card notification-item-[[n.type]]" ng-class="{'top': n.top}"
             ng-repeat="n in notifications | orderBy:['-top', '-timestamp'] track by $index" ng-switch="n.type">
            <i class="font font-notification-top-triangle" ng-show="n.top"></i>
            <a href="javascript:void(0)" toggle-dropdown class="dropdown-list-wrapper" ng-if="n.id">
                <i class="font font-notification-top"></i>
            </a>
            <div class="top-notification-wrapper icon icon-notification-top-bg dropdown-list hide">
                <i ng-class="{'disabled': n.top}" ng-click="setTop(n, true)">置顶</i>
                <i ng-class="{'disabled': !n.top}" ng-click="setTop(n, false)">取消置顶</i>
            </div>
            <div class="notification-title-wrapper">
                <div class="notification-icon-wrapper" ng-init="n.iconType = n.type" ng-switch="n.iconType">
                    <img ng-switch-when="course_estimate"
                         ng-src="[['/anonymous-api/courses/' + n.payload.course_id + '/course-cover']]">
                    <img ng-switch-when="course_estimate_reply"
                         ng-src="[['/anonymous-api/courses/' + n.payload.course_id + '/course-cover']]">
                    <img ng-switch-when="course_opening"
                         ng-src="[['/anonymous-api/courses/' + n.payload.course_id + '/course-cover']]">
                    <img ng-switch-when="course_started"
                         ng-src="[['/anonymous-api/courses/' + n.payload.course_id + '/course-cover']]">

                    <i class="icon notification-icon font [[getIconForNtf(n)]]" ng-switch-default></i>
                </div>
                <div class="title-info">
                    <div class="notification-title" ng-bind="getTitle(n, notificationHeaders)"></div>
                    <div class="notification-time" ng-bind="n.payload.created_at | datetime"></div>
                </div>

            </div>
<span ng-switch-when="course_outline_edit" class="notification-item">
    教务<span ng-bind="n.payload.user_name"></span>提醒你完成课程
    <a ng-click="linkToTeachingUnit(n.payload)" ng-bind='n.payload.course_name'></a>
    的<a ng-href='/course/[[n.payload.course_id]]/outline'>课程信息</a>
</span>
<span ng-switch-when="course_outline_closing_edit" class="notification-item">
    课程 <a ng-click="linkToTeachingUnit(n.payload)" ng-bind='n.payload.course_name'></a>
    的 <a ng-href='/course/[[n.payload.course_id]]/outline'>课程信息</a>
    即将于<span ng-bind="n.payload.end_date"></span>截止
</span>
<span ng-switch-when="submission_submitted" class="notification-item">
    <span ng-if="n.payload.group_name">
        小组 <span ng-bind="n.payload.group_name"></span> 提交了作业
    </span>
    <span ng-if="!n.payload.group_name">
        <span ng-bind="n.payload.created_by"></span> 提交了作业
    </span>
    <a ng-bind='n.payload.homework_title' ng-click="linkToHomeworkActivity(n.payload)"></a>
</span>
<span ng-switch-when="course_homework_remind" class="notification-item">
    课程 <span ng-bind='n.payload.course_name'></span> 的老师通知你交付作业
    <a ng-bind='n.payload.homework_title' ng-click="linkToHomeworkActivity(n.payload)"></a>
</span>
<span ng-switch-when="course_homework_make_up" class="notification-item">
    课程 <span ng-bind='n.payload.course_name'></span> 的老师通知你补交作业
    <a ng-bind='n.payload.homework_title' ng-click="linkToHomeworkActivity(n.payload)"></a>
</span>
<span ng-switch-when="course_homework_resubmit" class="notification-item">
    课程 <span ng-bind='n.payload.course_name'></span> 的老师通知你补交作业
    <a ng-bind='n.payload.homework_title' ng-click="linkToHomeworkActivity(n.payload)"></a>
</span>
<span ng-switch-when="course_homework_review_remind" class="notification-item">
    课程 <a ng-bind='n.payload.course_name' ng-click="linkToTeachingUnit(n.payload)"></a> 的老师通知你参与作业
    <a ng-bind='n.payload.homework_title' ng-click="linkToHomeworkActivity(n.payload)"></a>
    的互评
</span>
<span ng-switch-when="questionnaire_remind" class="notification-item">
    课程 <span ng-bind='n.payload.course_name'></span> 的老师通知你交付问卷
    <a ng-bind='n.payload.questionnaire_title' ng-click="linkToQuestionnaireActivity(n.payload)"></a>
</span>
<span ng-switch-when="exam_make_up" class="notification-item">
    课程 <a ng-bind='n.payload.course_name' ng-click="linkToTeachingUnit(n.payload)"></a> 的老师通知你补考在线测试
    <a ng-bind='n.payload.exam_title' ng-click='linkToExam(n.payload)'></a> 补考于 <span
        ng-bind="n.payload.start_time|datetime"></span> 开始
</span>
<span ng-switch-when="exam_submission" class="notification-item">
    <span ng-bind='n.payload.student_name'></span>提交了在线测试
    <a ng-bind='n.payload.activity_title' ng-click="linkToActivity(n.payload)"></a>
</span>
<span ng-switch-when="activity_opening" class="notification-item">
    课程 <a ng-click="linkToTeachingUnit(n.payload)" ng-bind='n.payload.course_name'></a>
    的<span ng-bind='notificationTypesAndText[n.payload.activity_type]'></span>
    <a ng-click="linkToActivity(n.payload)" ng-bind='n.payload.activity_title'></a>
    即将于<span ng-bind='n.payload.start_time|datetime'></span>开放
</span>
<span ng-switch-when="activity_expiring" class="notification-item">
    <div class="notification-summary">
        课程 <a ng-click="linkToTeachingUnit(n.payload)" ng-bind='n.payload.course_name'></a>
        的<span ng-bind='notificationTypesAndText[n.payload.activity_type]'></span>
        <a ng-click="linkToActivity(n.payload)" ng-bind='n.payload.activity_title'></a>
        即将于<span ng-bind='n.payload.end_time|datetime'></span>截止
    </div>
<a class="notification-attachment notification-attachment-uploads"
   ng-if="['web_link', 'slide', 'lesson', 'online_video'].indexOf(n.payload.activity_type) == -1 && n.payload.uploads.length != 0"
   ng-click="link(n)">
    <i class="icon font font-file-[[fileTypeByExtension(n.payload.uploads[0])]]"></i>

    <div class="notification-attachment-name-wrapper">
        <div class="notification-attachment-name truncate-text"><span
                tipsy="n.payload.uploads[0].file_name || n.payload.uploads[0].name | fileName"
                ng-bind="n.payload.uploads[0].file_name || n.payload.uploads[0].name | fileName"></span></div>
        <div class="notification-attachment-extension truncate-text"><span
                tipsy="n.payload.uploads[0].file_name || n.payload.uploads[0].name | fileExtension"
                ng-bind="n.payload.uploads[0].file_name || n.payload.uploads[0].name | fileExtension"></span></div>
    </div>
    <span class="notification-attachment-count" ng-if="n.payload.activity_type != 'online_video'">[['共{0}份附件' | format: [n.payload.uploads.length] ]]</span>
</a><a class="notification-attachment notification-attachment-uploads" ng-click="linkToActivity(n.payload)"
   ng-if="['web_link', 'slide', 'lesson', 'online_video'].indexOf(n.payload.activity_type) != -1">
    <i class="icon font font-[[getActivityIcon(n.payload.activity_type)]]"></i>

    <div class="notification-attachment-name truncate-text">
        <span ng-bind="n.payload.activity_title" tipsy="n.payload.activity_title"></span>
    </div>
</a></span>
<span ng-switch-when="activity_expiring_today" class="notification-item">
    <div class="notification-summary">
        课程 <a ng-click="linkToTeachingUnit(n.payload)" ng-bind='n.payload.course_name'></a>
        的<span ng-bind='notificationTypesAndText[n.payload.activity_type]'></span>
        <a ng-click="linkToActivity(n.payload)" ng-bind='n.payload.activity_title'></a>
        即将于今天截止
    </div>
<a class="notification-attachment notification-attachment-uploads"
   ng-if="['web_link', 'slide', 'lesson', 'online_video'].indexOf(n.payload.activity_type) == -1 && n.payload.uploads.length != 0"
   ng-click="link(n)">
    <i class="icon font font-file-[[fileTypeByExtension(n.payload.uploads[0])]]"></i>

    <div class="notification-attachment-name-wrapper">
        <div class="notification-attachment-name truncate-text"><span
                tipsy="n.payload.uploads[0].file_name || n.payload.uploads[0].name | fileName"
                ng-bind="n.payload.uploads[0].file_name || n.payload.uploads[0].name | fileName"></span></div>
        <div class="notification-attachment-extension truncate-text"><span
                tipsy="n.payload.uploads[0].file_name || n.payload.uploads[0].name | fileExtension"
                ng-bind="n.payload.uploads[0].file_name || n.payload.uploads[0].name | fileExtension"></span></div>
    </div>
    <span class="notification-attachment-count" ng-if="n.payload.activity_type != 'online_video'">[['共{0}份附件' | format: [n.payload.uploads.length] ]]</span>
</a><a class="notification-attachment notification-attachment-uploads" ng-click="linkToActivity(n.payload)"
   ng-if="['web_link', 'slide', 'lesson', 'online_video'].indexOf(n.payload.activity_type) != -1">
    <i class="icon font font-[[getActivityIcon(n.payload.activity_type)]]"></i>

    <div class="notification-attachment-name truncate-text">
        <span ng-bind="n.payload.activity_title" tipsy="n.payload.activity_title"></span>
    </div>
</a></span>
<span ng-switch-when="activity_expiring_week" class="notification-item">
    <div class="notification-summary">
        课程 <a ng-click="linkToTeachingUnit(n.payload)" ng-bind='n.payload.course_name'></a>
        的<span ng-bind='notificationTypesAndText[n.payload.activity_type]'></span>
        <a ng-click="linkToActivity(n.payload)" ng-bind='n.payload.activity_title'></a>
        即将于<span ng-bind='n.payload.end_time|datetime'></span>截止
    </div>
<a class="notification-attachment notification-attachment-uploads"
   ng-if="['web_link', 'slide', 'lesson', 'online_video'].indexOf(n.payload.activity_type) == -1 && n.payload.uploads.length != 0"
   ng-click="link(n)">
    <i class="icon font font-file-[[fileTypeByExtension(n.payload.uploads[0])]]"></i>

    <div class="notification-attachment-name-wrapper">
        <div class="notification-attachment-name truncate-text"><span
                tipsy="n.payload.uploads[0].file_name || n.payload.uploads[0].name | fileName"
                ng-bind="n.payload.uploads[0].file_name || n.payload.uploads[0].name | fileName"></span></div>
        <div class="notification-attachment-extension truncate-text"><span
                tipsy="n.payload.uploads[0].file_name || n.payload.uploads[0].name | fileExtension"
                ng-bind="n.payload.uploads[0].file_name || n.payload.uploads[0].name | fileExtension"></span></div>
    </div>
    <span class="notification-attachment-count" ng-if="n.payload.activity_type != 'online_video'">[['共{0}份附件' | format: [n.payload.uploads.length] ]]</span>
</a><a class="notification-attachment notification-attachment-uploads" ng-click="linkToActivity(n.payload)"
   ng-if="['web_link', 'slide', 'lesson', 'online_video'].indexOf(n.payload.activity_type) != -1">
    <i class="icon font font-[[getActivityIcon(n.payload.activity_type)]]"></i>

    <div class="notification-attachment-name truncate-text">
        <span ng-bind="n.payload.activity_title" tipsy="n.payload.activity_title"></span>
    </div>
</a></span>
<div ng-switch-when="course_opening" class="notification-item">
    <div class="notification-course-activity-title">
        <span>课程
            <a ng-click="linkToTeachingUnit(n.payload)" ng-bind='n.payload.course_name'></a>
            即将于<span ng-bind='n.payload.start_date'></span>开始，敬请关注
        </span>
    </div>
    <div class="notification-course-activity" ng-if="n.payload.comment_chinese">
        <div class="notification-course_outline" dotdotdot max-lines="4" no-expand="true" extra-height=4
            ng-bind="n.payload.comment_chinese | truncateText:500:true">
        </div>
    </div>
</div>
<div ng-switch-when="course_started" class="notification-item">
    <div class="notification-course-activity-title">
        <span>课程
            <a ng-click="linkToTeachingUnit(n.payload)" ng-bind='n.payload.course_name'></a>
            已于<span ng-bind='n.payload.start_date'></span>开课
        </span>
    </div>
    <div class="notification-course-activity" ng-if="n.payload.comment_chinese">
        <div class="notification-course_outline" dotdotdot max-lines="4" no-expand="true" extra-height=4
            ng-bind="n.payload.comment_chinese | truncateText:500:true">
        </div>
    </div>
</div>
<span ng-switch-when="course_deleted" class="notification-item">
    您所在的课程 <span ng-bind='n.payload.course_name'></span> 已经被删除
</span>

<div ng-switch-when="activity_opened" class="notification-item">
    <div class="notification-item-summary">
        课程 <a ng-click="linkToTeachingUnit(n.payload)" ng-bind='n.payload.course_name'></a>
        的<span ng-bind='notificationTypesAndText[n.payload.activity_type]'></span>
        <a ng-click="linkToActivity(n.payload)" ng-bind='n.payload.activity_title'></a>
        已<span ng-if='n.payload.start_time|datetime'>于[[ n.payload.start_time|datetime ]]</span>开始
    </div>
<a class="notification-attachment notification-attachment-uploads"
   ng-if="['web_link', 'slide', 'lesson', 'online_video'].indexOf(n.payload.activity_type) == -1 && n.payload.uploads.length != 0"
   ng-click="link(n)">
    <i class="icon font font-file-[[fileTypeByExtension(n.payload.uploads[0])]]"></i>

    <div class="notification-attachment-name-wrapper">
        <div class="notification-attachment-name truncate-text"><span
                tipsy="n.payload.uploads[0].file_name || n.payload.uploads[0].name | fileName"
                ng-bind="n.payload.uploads[0].file_name || n.payload.uploads[0].name | fileName"></span></div>
        <div class="notification-attachment-extension truncate-text"><span
                tipsy="n.payload.uploads[0].file_name || n.payload.uploads[0].name | fileExtension"
                ng-bind="n.payload.uploads[0].file_name || n.payload.uploads[0].name | fileExtension"></span></div>
    </div>
    <span class="notification-attachment-count" ng-if="n.payload.activity_type != 'online_video'">[['共{0}份附件' | format: [n.payload.uploads.length] ]]</span>
</a><a class="notification-attachment notification-attachment-uploads" ng-click="linkToActivity(n.payload)"
   ng-if="['web_link', 'slide', 'lesson', 'online_video'].indexOf(n.payload.activity_type) != -1">
    <i class="icon font font-[[getActivityIcon(n.payload.activity_type)]]"></i>

    <div class="notification-attachment-name truncate-text">
        <span ng-bind="n.payload.activity_title" tipsy="n.payload.activity_title"></span>
    </div>
</a></div>
<span ng-switch-when="homework_ended" class="notification-item">
    课程 <a ng-click="linkToTeachingUnit(n.payload)" ng-bind='n.payload.course_name'></a>
    的作业 <a ng-bind='n.payload.homework_title' ng-click="linkToHomeworkActivity(n.payload)"></a>
    提交已于<span ng-bind='n.payload.end_time|datetime'></span>截止
</span>
<span ng-switch-when="homework_expiring" class="notification-item">
    课程 <a ng-click="linkToTeachingUnit(n.payload)" ng-bind='n.payload.course_name'></a>
    的作业 <a ng-bind='n.payload.homework_title' ng-click="linkToHomeworkActivity(n.payload)"></a>
    提交即将于<span ng-bind='n.payload.end_time|datetime'></span>截止
</span>
<span ng-switch-when="homework_expiring_today" class="notification-item">
    课程 <a ng-click="linkToTeachingUnit(n.payload)" ng-bind='n.payload.course_name'></a>
    的作业 <a ng-bind='n.payload.homework_title' ng-click="linkToHomeworkActivity(n.payload)"></a>
    提交即将于[[ n.payload.end_time|datetime ]]截止
</span>
<span ng-switch-when="homework_expiring_week" class="notification-item">
    课程 <a ng-click="linkToTeachingUnit(n.payload)" ng-bind='n.payload.course_name'></a>
    的作业 <a ng-bind='n.payload.homework_title' ng-click="linkToHomeworkActivity(n.payload)"></a>
    提交即将于<span ng-bind='n.payload.end_time|datetime'></span>截止
</span>
<div ng-switch-when="homework_opened_for_submission" class="estimate-item">
    <div class="notification-estimate-main-content">
        <span ng-bind="teachingUnitName(n.payload)"></span>
        <a ng-click="linkToTeachingUnit(n.payload)" ng-bind='n.payload.course_name'></a>
        的作业 <a ng-bind='n.payload.homework_title' ng-click="linkToHomeworkActivity(n.payload)"></a>
        已<span ng-if='n.payload.start_time'>于 [[ n.payload.start_time|datetime ]] </span>开始
    </div>
</div>
<span ng-switch-when="homework_opening_for_submission" class="notification-item">
    课程 <a ng-click="linkToTeachingUnit(n.payload)" ng-bind='n.payload.course_name'></a>
    的作业 <a ng-bind='n.payload.homework_title' ng-click="linkToHomeworkActivity(n.payload)"></a>
    即将于<span ng-bind='n.payload.start_time|datetime'></span>开放交付
</span>
<span ng-switch-when="score_published" class="notification-item">
    课程 <a ng-click="linkToTeachingUnit(n.payload)" ng-bind='n.payload.course_name'></a>
    的成绩已公布
</span>
<div ng-switch-when="bulletin_created" class="notification-item">
    <div class="notification-topic-info-region">
        <div class="reply" ng-if="n.payload.type == 'org'">
            您所在的平台发布了新公告
        </div>
        <div class="reply" ng-if="n.payload.type != 'org'">
            课程 <a ng-click="linkToTeachingUnit(n.payload)" ng-bind='n.payload.course_name'></a>发布了新公告
        </div>
        <div class="topic">
            <a class="topic-title" ng-click="linkToBulletin(n.payload)" ng-bind='n.payload.bulletin_title'></a>
            <div class="topic-content" ng-bind="n.payload.bulletin_content | truncateText:140:true"></div>
        </div>
    </div>
</div>
<div ng-switch-when="bulletin_updated" class="notification-item">
    <div class="notification-topic-info-region">
        <div class="reply">
            <span ng-if="!n.payload.deleted">
                <span ng-if="n.payload.type == 'org'">
                    您所在的平台更新了公告
                </span>
                <span ng-if="n.payload.type != 'org'">
                    课程 <a ng-click="linkToTeachingUnit(n.payload)" ng-bind='n.payload.course_name'></a>更新了公告
                </span>
            </span>
            <span ng-if="n.payload.deleted">
                <span ng-bind="n.payload.create_by_name" ng-if="!n.payload.update_by_name"></span>
                <span ng-bind="n.payload.update_by_name" ng-if="n.payload.update_by_name"></span>删除了课程
                <a ng-click="linkToTeachingUnit(n.payload)" ng-bind='n.payload.course_name'></a>的公告
            </span>
        </div>
        <div class="topic">
            <span ng-if="n.payload.deleted" class="topic-title" ng-bind='n.payload.bulletin_title'></span>
            <a ng-if="!n.payload.deleted" class="topic-title" ng-click="linkToBulletin(n.payload)"
                ng-bind='n.payload.bulletin_title'></a>
            <div class="topic-content" ng-bind="n.payload.bulletin_content | truncateText:140:true"></div>
        </div>
    </div>
</div>
<span ng-switch-when="reply_created" class="notification-item">
    <span ng-bind='n.payload.created_by'></span>
    <span ng-if='!n.payload.is_second_level'>
        回复了你发表的文章 <a ng-click="linkToTopic(n.payload)" ng-bind='n.payload.topic_title'></a>
    </span>
    <span ng-if='n.payload.is_second_level'>
        回复了你在文章 <a ng-click="linkToTopic(n.payload)" ng-bind='n.payload.topic_title'></a> 的发言
    </span>
</span>
<span ng-switch-when="user_join_course" class="notification-item">
    新的班级成员 <span ng-bind="n.payload.user_name"></span> 加入课程
    <a ng-click="linkToTeachingUnit(n.payload)" ng-bind='n.payload.course_name'></a>
</span>
<span ng-switch-when="user_exit_course" class="notification-item">
    班级成员 <span ng-bind="n.payload.user_name"></span> 退出了课程
    <span ng-bind='n.payload.course_name'></span>
</span>
<span ng-switch-when="homework_is_recommended">
    在 <a ng-href="/course/[[n.payload.course_id]]/content" ng-bind="n.payload.course_name"></a> 课程中，你的作业 <a
        ng-click="linkToHomeworkActivity(n.payload)" ng-bind="n.payload.homework_title"></a> 被老师推荐给了大家
</span>
<span ng-switch-when="homework_is_recommended_group">
    在 <a ng-href="/course/[[n.payload.course_id]]/content" ng-bind="n.payload.course_name"></a> 课程中，你所在小组的作业 <a
        ng-click="linkToHomeworkActivity(n.payload)" ng-bind="n.payload.homework_title"></a> 被老师推荐给了大家
</span>
<span ng-switch-when="has_recommend_homework">
    在 <a ng-href="/course/[[n.payload.course_id]]/content" ng-bind="n.payload.course_name"></a>
    <span ng-if="n.payload.created_by_name"> 课程中，老师推荐了 <span ng-bind="n.payload.created_by_name"></span> 的作业</span>
    <span ng-if="!n.payload.created_by_name">课程中，老师推荐了作业</span>
    <a ng-click="linkToHomeworkActivity(n.payload)" ng-bind="n.payload.homework_title"></a>
</span>
<span ng-switch-when="has_recommend_homework_group">
    在 <a ng-href="/course/[[n.payload.course_id]]/content" ng-bind="n.payload.course_name"></a>
    <span ng-if="n.payload.created_by_name">
        课程中， 老师推荐了小组<span ng-bind="n.payload.created_by_name"></span>的作业
    </span>
    <span ng-if="!n.payload.created_by_name">
        课程中， 老师推荐了小组作业
    </span>
    <a ng-click="linkToHomeworkActivity(n.payload)" ng-bind="n.payload.homework_title"></a>
</span>
<span ng-switch-when="recommend_homework_removed">
学生<span ng-bind="n.payload.created_by_name"></span>再次提交了作业 <a ng-click="linkToHomeworkActivity(n.payload)"
        ng-bind="n.payload.homework_title"></a>，原始作业已从推荐列表删除
</span>
<span ng-switch-when="group_recommend_homework_removed">
    分组<span ng-bind="n.payload.created_by_name"></span>再次提交了作业 <a ng-click="linkToHomeworkActivity(n.payload)"
        ng-bind="n.payload.homework_title"></a>，原始作业已从推荐列表删除
</span>
<span ng-switch-when="inter_score_homework_submission" class="notification-item">
    有学生提交了<span ng-if="n.payload.course_name">课程 <a ng-click="linkToTeachingUnit(n.payload)"
            ng-bind="n.payload.course_name"></a> 的</span>互评作业
    <a ng-bind='n.payload.homework_title' ng-click="linkToHomeworkActivity(n.payload)"></a>，请尽快批改
</span>
<span ng-switch-when="inter_score_ended" class="notification-item">
    课程 <a ng-click="linkToTeachingUnit(n.payload)" ng-bind='n.payload.course_name'></a>
    的作业 <a ng-bind='n.payload.homework_title' ng-click="linkToHomeworkActivity(n.payload)"></a>
    已于<span ng-bind='n.payload.inter_score_end_time|datetime'></span>截止互评，去查看互评结果并批改作业吧
</span>
<span ng-switch-when="inter_score_expiring" class="notification-item">
    课程 <a ng-click="linkToTeachingUnit(n.payload)" ng-bind='n.payload.course_name'></a>
    的作业 <a ng-bind='n.payload.homework_title' ng-click="linkToHomeworkActivity(n.payload)"></a>
    即将于<span ng-bind='n.payload.inter_score_end_time|datetime'></span>截止互评，快去给大家的作业进行评价吧
</span>
<span ng-switch-when="intra_score_ended" class="notification-item">
    课程 <a ng-click="linkToTeachingUnit(n.payload)" ng-bind='n.payload.course_name'></a>
    的作业 <a ng-bind='n.payload.homework_title' ng-click="linkToHomeworkActivity(n.payload)"></a>
    已于<span ng-bind='n.payload.inter_score_end_time|datetime'></span>截止互评，快去查看互评结果吧
</span>
<span ng-switch-when="intra_score_expiring" class="notification-item">
    课程 <a ng-click="linkToTeachingUnit(n.payload)" ng-bind='n.payload.course_name'></a>
    的作业 <a ng-bind='n.payload.homework_title' ng-click="linkToHomeworkActivity(n.payload)"></a>
    即将于<span ng-bind='n.payload.inter_score_end_time|datetime'></span>截止互评，快去参与互评吧
</span>
<span ng-switch-when="score_publish_closing" class="notification-item">
    课程 <a ng-click="linkToTeachingUnit(n.payload)" ng-bind="n.payload.course_name"></a> 的 <a
        ng-href='/course/[[n.payload.course_id]]/score'>总成绩</a> 将于
    <span ng-bind="n.payload.score_publish_deadline|datetime"></span> 截止送交
    <span ng-if="n.payload.auto_publish">，逾期将自动送交</span>
    ，请尽快送交总成绩
</span>
<span ng-switch-when="score_setting_changed" class="notification-item">
    课程 <a ng-href='/course/[[n.payload.course_id]]/content' ng-bind="n.payload.course_name"></a> 的总成绩需要
    <a ng-href='/course/[[n.payload.course_id]]/score'>送交</a>，
    送交时间由 <span ng-bind="n.payload.score_publish_start|datetime"></span> 开始
    <span ng-if="n.payload.score_publish_deadline">，截止至 <span
            ng-bind="n.payload.score_publish_deadline|datetime"></span></span>
    <span ng-if="n.payload.auto_publish">，逾期将自动送交</span>
</span>
<span ng-switch-when="score_publish_reject" class="notification-item">
    课程 <a ng-href='/course/[[n.payload.course_id]]/content' ng-bind="n.payload.course_name"></a>
    的成绩已被教务退回，请确认后重新送交</span>
<span ng-switch-when="warning_opened" class="notification-item">
    学习预警项目 <a ng-click="view(n.payload)"><span ng-bind="n.payload.warning_name"></span></a> 需要于 <span
        ng-bind="n.payload.start_date"></span> 至
    <span ng-bind="n.payload.end_date"></span> 期间提交预警名单
</span>
<span ng-switch-when="recent_plan_expire" class="notification-item">
    贵平台所使用套餐 有效期:([[n.payload.start_date | date]]-[[n.payload.end_date | date]]) 即将到期，为不影响正常使用，建议您及时<a
        ng-href="/management/plan">续费购买套餐</a>
</span>
<span ng-switch-when="plan_expired" class="notification-item">
    贵平台所使用套餐 有效期:([[n.payload.start_date | date]]-[[n.payload.end_date | date]]) 已过期，为不影响正常使用，建议您及时<a
        ng-href="/management/plan">续费购买套餐</a>
</span>
<span ng-switch-when="recent_storage_run_out" class="notification-item">
    贵平台套餐内的容量<span class='highlight'>已不足</span>，为不影响正常使用，建议您及时<a ng-href="/management/plan">加购容量或升级套餐</a>
</span>
<span ng-switch-when="storage_run_out" class="notification-item">
    贵平台套餐内的容量<span class='highlight'>已用完</span>，为不影响正常使用，建议您及时<a ng-href="/management/plan">加购容量或升级套餐</a>
</span>
<span ng-switch-when="recent_transfer_run_out" class="notification-item">
    贵平台当月的流量<span class='highlight'>已不足</span>，为不影响正常使用，建议您及时加<a ng-href="/management/plan">购流量或升级套餐</a>
</span>
<span ng-switch-when="transfer_run_out" class="notification-item">
    贵平台当月的流量<span class='highlight'>用完</span>，为不影响正常使用，建议您及时加<a ng-href="/management/plan">购流量或升级套餐</a>
</span>
<span ng-switch-when="instructor_submit_course_public_audit" class="notification-item">
教师公开了课程 <span class='highlight'>[[n.payload.course_name]]</span>，需要进行<a ng-href="/management/course/audit">审核</a>
</span>
<div ng-switch-when="course_public_audit_response" class="notification-item">
    您的公开课 <a ng-click="linkToTeachingUnit(n.payload)">[[n.payload.course_name]]</a>
    <span ng-if="n.payload.response == 'agree'">
        已通过审核，已经展现在平台的课程列表
    </span>
    <span ng-if="n.payload.response == 'reject'">
        <span>没有通过审核，拒绝原因：</span>
        <span ng-bind="n.payload.remark"></span>
    </span>
</div>
<span ng-switch-when="teaching_unit_invite" class="notification-item">
    <span ng-bind="teachingUnitName(n.payload)"></span> <span ng-bind="n.payload.teaching_unit_name"
        class="highlight"></span>
    的教师邀请您加入该<span ng-bind="teachingUnitName(n.payload)"></span>成为
    <span ng-bind="teachingUnitRoleName(n.payload)"></span>，请 <a ng-click="confirmInvite(n.payload)"
        class="highlight">进行确认操作</a>
</span>
<span ng-switch-when="org_plan_request" class="notification-item" ng-switch="n.payload.type">
    <span ng-switch-when="storage_plus">
        平台 <span class="highlight" ng-bind="n.payload.org_name"></span> 提交了 <span class="highlight">[加购容量]</span>
        的付费申请，<a href="/wg-admin/request">请与客户联系并进行审核</a>
    </span>
    <span ng-switch-when="transfer_plus">
        平台 <span class="highlight" ng-bind="n.payload.org_name"></span> 提交了 <span class="highlight">[加购流量]</span>
        的付费申请，<a href="/wg-admin/request">请与客户联系并进行审核</a>
    </span>
    <span ng-switch-when="change_plan">
        平台 <span class="highlight" ng-bind="n.payload.org_name"></span> 提交了 <span class="highlight">[升级套餐]</span>
        的付费申请，<a href="/wg-admin/request">请与客户联系并进行审核</a>
    </span>
</span>
<span ng-switch-when="org_plan_response" class="notification-item">
    您的付费申请<span class="highlight" ng-switch="n.payload.type">
        <span ng-switch-when="storage_plus">[加购容量]</span>
        <span ng-switch-when="transfer_plus">[加购流量]</span>
        <span ng-switch-when="change_plan">[升级套餐]</span>
    </span><!--
    --><span class='highlight' ng-if="n.payload.response == 'passed'"> <a href="/management/plan">已处理通过</a></span><!--
    --><span class='highlight' ng-if="n.payload.response == 'rejected'"> <a href="/management/plan">已被拒绝</a></span>
</span>
<div ng-switch-when="welcome" class="notification-item">
    <div class="notification-welcome-wrapper" ng-if="ui.defaultWelcomeNotification">
        <div class="notification-welcome-title">欢迎来到<span ng-bind="orgName || 'TronClass'"></span>！</div>
        <div class="notification-welcome-content">
            <div>在这里，教师可以进行线上授课，发布教材和作业测试，提升教学效率；</div>
            <div>学生可以随时获取课程动态，学习课程内容并完成各种学习活动；</div>
            <div class="notification-welcome-middle-line">还有更多丰富的功能，期待你的发现和体验。</div>
            <div>我们诚挚的期望这个平台带给您更加优秀的教学互动体验，让教与学更简单！</div>
            <div class="notification-welcome-org-name"><span ng-bind="orgName || 'TronClass'"></span></div>
        </div>
    </div>
    <div class="notification-welcome-wrapper" ng-if="!ui.defaultWelcomeNotification">

<div class="notification-welcome-content">
    <div class="notification-welcome-header" ng-bind="welcomeNotification.header" ng-if="welcomeNotification.header"></div>
    <div class="notification-welcome-content-line" ng-repeat="line in welcomeNotification.content track by $index">
        <div ng-bind="line"></div>
    </div>
    <div class="notification-welcome-footer" ng-bind="welcomeNotification.footer" ng-if="welcomeNotification.footer"></div>
    <div class="notification-welcome-org-name"><span ng-bind="orgName || 'TronClass'"></span></div>
</div>    </div>
</div>
<div ng-switch-when="course_estimate" class="notification-item estimate-item">
    <div class="notification-estimate-main-content">课程 <a ng-bind="n.payload.course_name"
            ng-href="[[ '/course/' + n.payload.course_id ]]"></a> 收到了 <a ng-bind="n.payload.estimate_count"
            ng-href="[[ '/course/' + n.payload.course_id ]]"></a> 条评论，去看看吧
    </div>
    <div class="notification-estimate-comment">
        <div class="notification-estimate-comment-content" ng-repeat="estimate in n.payload.latest_estimates">
            <div class="notification-estimate-student-name-wrapper"><span ng-bind="estimate.student_name"
                    class="notification-estimate-student-name"></span><span>:</span>
            </div>
            <div ng-bind-html="estimate.comment|clearText" class="notification-estimate-comment"></div>
        </div>
    </div>
</div>
<div ng-switch-when="course_estimate_reply" class="notification-item estimate-item">
    <div>
        <div class="notification-estimate-main-content">你在课程
            <a ng-bind="n.payload.course_name" ng-href="[['/course/' + n.payload.course_id]]"></a> 的评论收到了
            <a ng-bind="n.payload.replies_num" ng-href="[['/course/' + n.payload.course_id]]"></a>
            <span>条回复，去看看吧</span>
        </div>
    </div>
    <div class="notification-estimate-comment">
        <div class="notification-estimate-comment-content" ng-repeat="reply in n.payload.course_estimate_reply_data">
            <div class="notification-estimate-student-name-wrapper"><span ng-bind="reply.estimate_reply_user_name"
                    class="notification-estimate-student-name"> </span>
                <span>: </span>
            </div>
            <div class="notification-estimate-comment" ng-bind-html="reply.reply|clearText"></div>
        </div>
    </div>
</div>
<div ng-switch-when="homework_submitted" class="notification-item estimate-item">
    <div class="submit-rate" ng-if="n.payload.submission_count > 1">
        <div class="submit-rate-number">[[n.payload.submit_rate]]%</div>
        <div class="submit-rate-label">提交率</div>
    </div>
    <div class="single-submit" ng-if="n.payload.submission_count == 1">
        <div class="homework-submitted-content">
            <span ng-if="!n.payload.submit_by_group">
                <span ng-bind="n.payload.student_name"></span>
                <span>提交了</span>
                <span ng-bind="teachingUnitName(n.payload)"></span>
                <a ng-click="linkToTeachingUnit(n.payload)" ng-bind="n.payload.course_name"></a>
                <span>的作业</span>
                <a ng-click="linkToHomeworkActivity(n.payload)" ng-bind="n.payload.homework_title"></a>
            </span>
            <span ng-if="n.payload.submit_by_group">
                <span>小组</span>
                <span ng-bind="n.payload.group_name"></span>
                <span>提交了课程</span>
                <a ng-click="linkToTeachingUnit(n.payload)" ng-bind="n.payload.course_name"></a>
                <span>的分组作业</span>
                <a ng-click="linkToHomeworkActivity(n.payload)" ng-bind="n.payload.homework_title"></a>
            </span>
        </div>
<a class="notification-attachment notification-attachment-uploads"
   ng-if="['web_link', 'slide', 'lesson', 'online_video'].indexOf(n.payload.activity_type) == -1 && n.payload.uploads.length != 0"
   ng-click="link(n)">
    <i class="icon font font-file-[[fileTypeByExtension(n.payload.uploads[0])]]"></i>

    <div class="notification-attachment-name-wrapper">
        <div class="notification-attachment-name truncate-text"><span
                tipsy="n.payload.uploads[0].file_name || n.payload.uploads[0].name | fileName"
                ng-bind="n.payload.uploads[0].file_name || n.payload.uploads[0].name | fileName"></span></div>
        <div class="notification-attachment-extension truncate-text"><span
                tipsy="n.payload.uploads[0].file_name || n.payload.uploads[0].name | fileExtension"
                ng-bind="n.payload.uploads[0].file_name || n.payload.uploads[0].name | fileExtension"></span></div>
    </div>
    <span class="notification-attachment-count" ng-if="n.payload.activity_type != 'online_video'">[['共{0}份附件' | format: [n.payload.uploads.length] ]]</span>
</a>    </div>
    <div class="multi-submit" ng-if="n.payload.submission_count > 1">
        <span ng-if="!n.payload.submit_by_group">
            <span ng-bind="teachingUnitName(n.payload)"></span>
            <a ng-bind="n.payload.course_name" ng-click="linkToTeachingUnit(n.payload)"></a>
            <span>的作业</span>
            <a ng-bind="n.payload.homework_title" ng-click="linkToHomeworkActivity(n.payload)"></a>
            <span>已有</span>
            <span ng-bind="n.payload.submission_count"></span>
            <span>名学生提交</span>
        </span>
        <span ng-if="n.payload.submit_by_group">
            <span ng-bind="teachingUnitName(n.payload)"></span>
            <a ng-bind="n.payload.course_name" ng-click="linkToTeachingUnit(n.payload)"></a>
            <span>的分组作业</span>
            <a ng-bind="n.payload.homework_title" ng-click="linkToHomeworkActivity(n.payload)"></a>
            <span>已有</span>
            <span ng-bind="n.payload.submission_count"></span>
            <span>个分组提交</span>
        </span>
    </div>
    <div class="homework-submitted-foot-bar" ng-if="n.payload.correct_count < n.payload.submission_count">
        <a ng-click="linkToHomeworkActivity(n.payload, '?&view=scores')"><span>去批改</span> <span
                ng-if="n.payload.submission_count > 1">([[n.payload.submission_count -
                n.payload.correct_count]]份待批改)</span></a>
    </div>
</div>
<div ng-switch-when="exam_submission_info" class="notification-item estimate-item">
    <div class="submit-rate" ng-if="n.payload.exam_submission_total_count > 1">
        <div class="submit-rate-number">[[n.payload.exam_submission_rate]]%</div>
        <div class="submit-rate-label">提交率</div>
    </div>
    <div class="notification-estimate-main-content" ng-if="1 == n.payload.exam_submission_total_count">
        <span ng-bind='n.payload.student_name' ng-if="n.payload.student_name"></span>
        <span ng-bind='n.payload.group_name' ng-if="n.payload.group_name"></span>
        <span>提交了课程</span>
        <a ng-bind='n.payload.course_name' ng-click="linkToTeachingUnit(n.payload)"
            ng-if="n.payload.course_name"></a>
        <span>的在线测试</span>
        <span ng-bind="n.payload.exam_title" ng-if="n.payload.exam_title"></span>
        <a ng-bind='n.payload.activity_title' ng-click="linkToExamSubmissionInfo(n.payload)"
            ng-if="n.payload.activity_title"></a>
    </div>
    <div class="notification-estimate-main-content" ng-if="n.payload.exam_submission_total_count > 1">
        <span>课程</span>
        <a ng-bind='n.payload.course_name' ng-click="linkToTeachingUnit(n.payload)"></a>
        <span>的测试</span>
        <a ng-bind='n.payload.activity_title' ng-click="linkToExamSubmissionInfo(n.payload)"></a>
        <span>已有</span>
        <span ng-bind="n.payload.exam_submission_total_count"></span>
        <span ng-if="n.payload.is_group">组学生提交</span>
        <span ng-if="!n.payload.is_group">名学生提交</span>
    </div>
    <div ng-if="n.payload.exam_need_check_count">
        <div class="homework-submitted-foot-bar">
            <a ng-click="linkToExamSubmissionInfo(n.payload)">去批改(<span
                    ng-bind="n.payload.exam_need_check_count"></span>份待批改)</a>
        </div>
    </div>
</div>
<div ng-switch-when="exam_opened" class="notification-item">
    <span ng-bind="teachingUnitName(n.payload)"></span>
    <a ng-bind='n.payload.course_name' ng-click="linkToTeachingUnit(n.payload)"></a>
    <span>的测试</span>
    <a ng-bind='n.payload.exam_title' ng-click='linkToExam(n.payload)'></a>
    <span>
         已<span ng-if='n.payload.start_time'> 于[[ n.payload.start_time|datetime ]] </span>发布
    </span>
</div>
<div ng-switch-when="exam_expiring" class="notification-item">
    <span ng-bind="teachingUnitName(n.payload)"></span>
    <a ng-bind='n.payload.course_name' ng-click="linkToTeachingUnit(n.payload)"></a>
    <span>的测试</span>
    <a ng-bind='n.payload.exam_title' ng-click='linkToExam(n.payload)'></a>
    <span>
        即将于<span ng-bind='n.payload.end_time|datetime'></span>截止
    </span>
</div>
<div ng-switch-when="exam_expiring_today" class="notification-item">
    <span ng-bind="teachingUnitName(n.payload)"></span>
    <a ng-bind='n.payload.course_name' ng-click="linkToTeachingUnit(n.payload)"></a>
    <span>的测试</span>
    <a ng-bind='n.payload.exam_title' ng-click='linkToExam(n.payload)'></a>
    <span>
        即将于今天截止
    </span>
</div>
<div ng-switch-when="exam_expiring_week" class="notification-item">
    <span ng-bind="teachingUnitName(n.payload)"></span>
    <a ng-bind='n.payload.course_name' ng-click="linkToTeachingUnit(n.payload)"></a>
    <span>的测试</span>
    <a ng-bind='n.payload.exam_title' ng-click='linkToExam(n.payload)'></a>
    <span>
        即将于<span ng-bind='n.payload.end_time|datetime'></span>截止
    </span>
</div>
<div ng-switch-when="exam_ended" class="notification-item">
    <span ng-bind="teachingUnitName(n.payload)"></span>
    <a ng-bind='n.payload.course_name' ng-click="linkToTeachingUnit(n.payload)"></a>
    <span>的测试</span>
    <a ng-bind='n.payload.exam_title' ng-click='linkToExam(n.payload)'></a>
    <span>
        已于<span ng-bind='n.payload.end_time|datetime'></span>截止
    </span>
</div>
<div ng-switch-when="exam_submit_started" class="notification-item">
    <span ng-bind="teachingUnitName(n.payload)"></span>
    <a ng-bind='n.payload.course_name' ng-click="linkToTeachingUnit(n.payload)"></a>
    <span>的测试</span>
    <a ng-bind='n.payload.exam_title' ng-click='linkToExam(n.payload)'></a>
    <span ng-cloak>
       已<span ng-if='n.payload.start_time'> 于[[ n.payload.start_time|datetime ]] </span>开始
    </span>
</div>
<div ng-switch-when="exam_will_start" class="notification-item">
    <span ng-bind="teachingUnitName(n.payload)"></span>
    <a ng-bind='n.payload.course_name' ng-click="linkToTeachingUnit(n.payload)"></a>
    <span>的测试</span>
    <a ng-bind='n.payload.exam_title' ng-click='linkToExam(n.payload)'></a>
    <span ng-cloak>
        将于 [[ n.payload.start_time|datetime ]] 开放答题
    </span>
</div>
<div ng-switch-when="topic_replies" class="notification-item">
    <div class="notification-topic-info-region" ng-if="1 == n.payload.replies_num">
        <div class="reply" ng-bind="n.payload.replies_data[0].content | truncateText:150:true"></div>
        <div class="topic">
            <a class="topic-title" ng-click="linkToTopic(n.payload)" ng-bind='n.payload.topic_title'></a>
            <div class="topic-content" ng-bind="n.payload.topic_content | truncateText:140:true"></div>
        </div>
    </div>
    <div class="notification-topic-multi-replies" ng-if="n.payload.replies_num > 1">
        <div class="reply-info">你的帖子
            <a ng-click="linkToTopic(n.payload)" ng-bind='n.payload.topic_title'></a>
            已收到
            <a ng-click="linkToTopic(n.payload)" ng-bind='n.payload.replies_num'></a>
            条回复
        </div>
        <div class="reply-region">
            <div class="one_reply truncate-text" ng-repeat="reply in n.payload.replies_data">
                <span ng-bind="reply.reply_user_name"></span>:
                <span ng-bind="reply.content | truncateText:150:true"></span>
            </div>
        </div>
    </div>
</div>
<div ng-switch-when="topic_secondary_replies" class="notification-item">
    <div class="notification-topic-info-region" ng-if="1 == n.payload.replies_num">
        <div class="reply" ng-bind="n.payload.replies_data[0].content | truncateText:150:true"></div>
        <div class="topic">
            <a class="topic-title" ng-click="linkToTopic(n.payload)" ng-bind='n.payload.topic_title'></a>的回复
            <div class="topic-content" ng-bind="n.payload.reply_content | truncateText:140:true"></div>
        </div>
    </div>
    <div class="notification-secondary-topic-multi-replies" ng-if="n.payload.replies_num > 1">
        <div class="reply-info">你在帖子
            <a ng-click="linkToTopic(n.payload)" ng-bind='n.payload.topic_title'></a>
            的回复已收到
            <a ng-click="linkToTopic(n.payload)" ng-bind='n.payload.replies_num'></a>
            条评论
        </div>
        <div class="reply-region">
            <div class="one_reply truncate-text" ng-repeat="reply in n.payload.replies_data">
                <span ng-bind="reply.reply_user_name"></span>:
                <span ng-bind="reply.content | truncateText:150:true"></span>
            </div>
        </div>
    </div>
</div>
<div ng-switch-when="topic_like" class="notification-item">
    <div class="notification-topic-info-region" ng-if="1 == n.payload.like_count">
        <div class="topic">
            <a class="topic-title" ng-click="linkToTopic(n.payload)" ng-bind='n.payload.topic_title'></a>
            <div class="topic-content" ng-bind="n.payload.topic_content | truncateText:140:true"></div>
        </div>
    </div>
    <div class="notification-topic-like-multi-replies" ng-if="n.payload.like_count > 1">
        <div class="reply-info">你发布的帖子
            <a ng-click="linkToTopic(n.payload)" ng-bind='n.payload.topic_title'></a>
            收到
            <a ng-click="linkToTopic(n.payload)" ng-bind='n.payload.like_count'></a>
            个赞，去看看吧
        </div>
    </div>
</div>
<div ng-switch-when="topic_create" class="notification-item">
    <div class="notification-topic-info-region">
        <div class="reply">
            <span ng-bind="n.payload.user_name"></span>
            <span>在课程</span>
            <a ng-bind='n.payload.course_name' ng-href="[['/course/' + n.payload.course_id + '/content']]"></a>
            <span ng-if="n.payload.activity_id != null">
                <span>的讨论区</span>
                <a ng-bind='n.payload.activity_title' ng-click="linkToForumActivity(n.payload)"></a>
            </span>
            <span ng-if="n.payload.group_id != null">
                <span>的</span>
                <span ng-bind='n.payload.group_name'></span>
                <span>组内讨论</span>
            </span>
            <span>中发布了新帖子</span>
        </div>
        <div class="topic">
            <a class="topic-title" ng-click="linkToTopic(n.payload)" ng-bind='n.payload.topic_title'></a>
            <div class="topic-content" ng-bind="n.payload.topic_content | truncateText:140:true"></div>
        </div>
    </div>
</div>
<div ng-switch-when="discussion_create" class="notification-item">
    <span>课程</span>
    <a ng-bind='n.payload.course_name' ng-href="[['/course/' + n.payload.course_id + '/content']]"></a>
    <span>的讨论</span>
    <a ng-bind='n.payload.activity_title' ng-click="linkToForumActivity(n.payload)"></a>
    已<span ng-if='n.payload.start_time|datetime'>于[[ n.payload.start_time|datetime ]]</span>开始
</div>
<div ng-switch-when="homework_score_updated" class="notification-item">
    <span>你在</span>
    <span ng-bind="teachingUnitName(n.payload)"></span>
    <a ng-bind='n.payload.course_name' ng-click="linkToTeachingUnit(n.payload)"></a>
    <span>的作业</span>
    <a ng-bind='n.payload.activity_title' ng-click="linkToHomeworkActivity(n.payload)"></a>
    获得了<a ng-click="linkToHomeworkActivity(n.payload)" ng-bind="n.payload.score"></a>分的成绩
    <span ng-if="n.payload.instructor_comment">
        。评语：<span ng-bind="n.payload.instructor_comment"></span>
    </span>
</div>
<div ng-switch-when="exam_score_updated" class="notification-item">
    <span>你在</span>
    <span ng-bind="teachingUnitName(n.payload)"></span>
    <a ng-bind='n.payload.course_name' ng-click="linkToTeachingUnit(n.payload)"></a>
    <span>的测试</span>
    <a ng-bind='n.payload.exam_title' ng-click='linkToExam(n.payload)'></a>
    获得了<a ng-bind="n.payload.score" ng-click='linkToExam(n.payload)'></a>分的成绩
</div>
<div ng-switch-when="discussion_score_updated" class="notification-item">
    <span>你在课程</span>
    <a ng-bind='n.payload.course_name' ng-href="[['/course/' + n.payload.course_id + '/content']]"></a>
    <span>的讨论区</span>
    <a ng-bind='n.payload.activity_title' ng-click="linkToForumActivity(n.payload)"></a>
    获得了<a ng-bind="n.payload.score" ng-click="linkToForumActivity(n.payload)"></a>分的成绩
</div>
<div ng-switch-when="shared_resource_audit_agree" class="notification-item">
    你分享到资源平台的资源 <span class="shared-resource-name" ng-bind="n.payload.resource_name"></span> 已通过审核
    <span ng-if="n.payload.is_department_updated">，院系调整为 <span ng-bind="n.payload.department_name"></span></span>
    <span ng-if="n.payload.is_classification_updated">，并展示在 <span ng-bind="n.payload.classification_name"></span>
        分类下</span>
</div>
<div ng-switch-when="shared_resource_audit_reject" class="notification-item">
    你分享到资源平台的资源 <span class="shared-resource-name" ng-bind="n.payload.resource_name"></span> 审核未通过, 原因为 <span
        ng-bind="n.payload.remark"></span>
</div>
<div ng-switch-when="shared_resource_reported" class="notification-item">
    你分享到资源平台的资源 <span class="shared-resource-name" ng-bind="n.payload.resource_name"></span>
    <span ng-if="n.payload.report_count == 1">被举报</span>
    <span ng-if="n.payload.report_count > 1">被举报<span ng-bind="n.payload.report_count"></span>次</span>
</div>
<div ng-switch-when="shared_resource_off_the_shelf" class="notification-item">
    你分享到资源平台的资源 <span class="shared-resource-name" ng-bind="n.payload.resource_name"></span> 被下架，原因为 <span
        ng-bind="n.payload.remark"></span>
</div>
<div ng-switch-when="shared_resource_to_other_orgs_audit_agree" class="notification-item">
    你分享到 <span class="shared-other-orgs-name" ng-bind="n.payload.other_orgs_name"></span> 的资源 <span
        class="shared-resource-name" ng-bind="n.payload.resource_name"></span>
    <span ng-if="n.payload.updated_other_orgs_name">，由管理员调整分享范围为 <span
            ng-bind="n.payload.updated_other_orgs_name"></span></span> 已通过审核
</div>
<div ng-switch-when="shared_resource_to_other_orgs_audit_reject" class="notification-item">
    你分享到 <span class="shared-other-orgs-name" ng-bind="n.payload.other_orgs_name"></span> 的资源 <span
        class="shared-resource-name" ng-bind="n.payload.resource_name"></span> 审核未通过, 原因为 <span
        ng-bind="n.payload.remark"></span>
</div>
<div ng-switch-when="shared_resource_to_other_orgs_reported" class="notification-item">
    你分享到 <span class="shared-other-orgs-name" ng-bind="n.payload.other_orgs_name"></span> 的资源 <span
        class="shared-resource-name" ng-bind="n.payload.resource_name"></span> 被举报，原因为
    <span ng-bind="reportRemarks[n.payload.remark]"></span>
</div>
<div ng-switch-when="shared_resource_to_other_orgs_off_the_shelf" class="notification-item">
    你分享到 <span class="shared-other-orgs-name" ng-bind="n.payload.other_orgs_name"></span> 的资源 <span
        class="shared-resource-name" ng-bind="n.payload.resource_name"></span> 被下架，原因为 <span
        ng-bind="n.payload.remark"></span>
</div>
<div ng-switch-when="campus_subject_lib_audit_agree" class="notification-item">
    你发布的试题 <span class="subject-description" ng-bind-html="n.payload.description"></span> 已通过审核
</div>
<div ng-switch-when="campus_subject_lib_audit_reject" class="notification-item">
    你发布的试题 <span class="subject-description" ng-bind-html="n.payload.description"></span> 审核未通过，原因为 <span
        ng-bind="n.payload.remark"></span>
</div>
<div ng-switch-when="campus_subject_lib_off_the_shelf" class="notification-item">
    你发布的试题 <span class="subject-description" ng-bind-html="n.payload.description"></span> 被下架，原因为 <span
        ng-bind="n.payload.remark"></span>
</div>
<div ng-switch-when="calendar_event_publish" class="notification-item">
    <span>您收到了新的事件通知</span>
    <span ng-bind="n.payload.title"></span>
</div>
<div ng-switch-when="calendar_event_alert" class="notification-item">
    <span>事件</span>
    <span ng-bind="n.payload.title"></span>
    <span ng-if="n.payload.time_before == 0">现在开始</span>
    <span ng-if="n.payload.time_before > 0">将于<span ng-bind="n.payload.time_before">
        </span>[[ n.payload.time_unit == "minute" ? "分钟" : n.payload.time_unit == "hour" ? "小时" : "天" ]]后开始</span>
</div>
<div ng-switch-when="calendar_timetable_update" class="notification-item">
    <span ng-bind="n.payload.ntf_content"></span>
</div>
<div ng-switch-when="calendar_timetable_delete" class="notification-item">
    课程 <span ng-bind="n.payload.course_title"></span>
    <span ng-if="n.payload.update_scope == 'current'">已取消<span ng-bind="n.payload.target_month"></span>月<span
            ng-bind="n.payload.target_day"></span>日上课安排。</span>
    <span ng-if="n.payload.update_scope == 'current_and_after'">自<span ng-bind="n.payload.target_month"></span>月<span
            ng-bind="n.payload.target_day"></span>日起取消所有上课安排。</span>
    <span ng-if="n.payload.update_scope == 'all'">已取消所有上课安排。</span>
</div>
<div ng-switch-when="learning_progress_alert" class="notification-item">
    <span>课程</span>
    <a ng-bind="n.payload.course_name" ng-click="linkToTeachingUnit(n.payload)"></a>
    <span>已发送预警通知</span>
    <a ng-click="linkToLearningProgressAlert(n.payload)">请点此查看</a>
</div>
<div ng-switch-when="learning_warning" class="estimate-item">
    <div class="notification-estimate-main-content ">
        <span>你的课程</span>
        <a ng-bind="n.payload.course_name" ng-click="linkToTeachingUnit(n.payload)"></a>
        <span>在</span>
        <span ng-bind="n.payload.academic_year_name"></span>
        <span>学年</span>
        <span ng-bind="n.payload.semester_name"></span>
        <span>学期中因</span>
        <span ng-bind="n.payload.warning_status"></span>
        <span>被预警，现向你发出告诫。</span>
    </div>
    <div ng-if="n.payload.course_id">
        <div class="homework-submitted-foot-bar">
            <a ng-click="linkToLearningWarning(n.payload)"><span>点击查看预警详情</span></a>
        </div>
    </div>
</div>
<div ng-switch-when="homework_review_started" class="notification-item">
    <span ng-bind="teachingUnitName(n.payload)"></span>
    <a ng-click="linkToTeachingUnit(n.payload)" ng-bind='n.payload.course_name'></a>
    的作业 <a ng-bind='n.payload.homework_title' ng-click="linkToHomeworkActivity(n.payload)"></a>
    已于<span ng-bind='n.payload.review_start_time|datetime'></span>开放互评
</div>
<div ng-switch-when="share_resource_to_user" class="notification-item">
    <span ng-bind="n.payload.user_name"></span>（<span ng-bind="n.payload.creator_org_name"></span>） 将
    <span class="resources" ng-bind="n.payload.resource_names.join(',')"></span>
    分享给你啦!
    <div class="actions notification-action">
        <a href="#" ng-click="saveResource(n.payload)">保存到“我的资源”</a>
    </div>
</div>
<div ng-switch-when="resource_comment_at" class="notification-item">
    有人在资源 <a ng-href="[[n.payload.url]]" ng-bind="n.payload.resource_name" target="_blank"></a> 下提到你，快去看看吧
</div>
<div ng-switch-when="new_resource_share_to_follower" class="notification-item">
    <a ng-click="linkToTrackedUserResource(n.payload)" ng-bind="n.payload.tracked_user_name"></a> 分享了新的资源，快去瞧瞧
</div>
<div ng-switch-when="tracked_user_is_tracked" class="notification-item">
    你被 <a ng-click="linkToFollowerInfo(n.payload)" ng-bind='n.payload.follower'></a> 关注了，快去看看
</div>
<div ng-switch-when="shared_course_to_other_orgs_audit_agree" class="notification-item">
    你分享到 <span class="shared-other-orgs-name" ng-bind="n.payload.other_orgs_name"></span> 的公开课程
    <span class="shared-course-name" ng-bind="n.payload.course_name"></span>，由管理员调整为
    <span ng-bind="n.payload.updated_other_orgs_name"></span> 审核通过
</div>
<div ng-switch-when="shared_course_audit_agree" class="notification-item">
    你分享到 <span class="shared-other-orgs-name" ng-bind="n.payload.other_orgs_name"></span> 的公开课程
    <span class="shared-course-name" ng-bind="n.payload.course_name"></span>，审核通过
</div>
<div ng-switch-when="shared_course_audit_reject" class="notification-item">
    你分享到 <span class="shared-other-orgs-name" ng-bind="n.payload.other_orgs_name"></span> 的公开课程
    <span class="shared-course-name" ng-bind="n.payload.course_name"></span>，审核未通过, 原因为
    <span ng-bind="n.payload.remark"></span>
</div>
<div ng-switch-when="user_join_resource_group" class="notification-item">
    你已加入 <a ng-click="linkToResourceGroup(n.payload)" ng-bind="n.payload.group_name"></a> 可以开始小组活动啰！
</div>
<div ng-switch-when="user_leave_resource_group" class="notification-item">
    你已离开小组 [[n.payload.group_name]]
</div>
<div ng-switch-when="resource_group_deleted" class="notification-item">
    你参与的小组 [[n.payload.group_name]] 已解散
</div>
<div ng-switch-when="rollcall_alert" class="notification-item">
    <span ng-if="['absent', 'on_leave'].indexOf(n.payload.rollcall_status) !== -1">
        你在
        <span ng-bind="n.payload.rollcall_title"></span>
        <a ng-click="linkToTeachingUnit(n.payload)" ng-bind="n.payload.course_name"></a><!--
--><span ng-if="n.payload.rollcall_status === 'absent'">缺勤</span><!--
--><span ng-if="n.payload.rollcall_status === 'on_leave'">请假</span><!--
-->，该课程累计<!--
--><span ng-if="n.payload.rollcall_status === 'absent'">缺勤</span><!--
--><span ng-if="n.payload.rollcall_status === 'on_leave'">请假</span><!--
--><span ng-bind="n.payload.number"></span><!--
-->次。
    </span>
    <span ng-if="['attendance_rate', 'banned_attendance_rate'].indexOf(n.payload.rollcall_status) !== -1">
        你的课程
        <a ng-click="linkToTeachingUnit(n.payload)" ng-bind="n.payload.course_name"></a>
        因为到课率低于<span ng-bind="n.payload.threshold"></span>%，收到预警通知
        <span ng-if="n.payload.rollcall_status === 'banned_attendance_rate'">，将无法参加期末考</span>
    </span>
</div>
<div ng-switch-when="learning_activity_alert" class="notification-item">
    你的课程
    <a ng-click="linkToTeachingUnit(n.payload)" ng-bind="n.payload.course_name"></a>
    <span ng-if="n.payload.activity_type === 'homework'">作业</span><!--
 --><span ng-if="n.payload.activity_type === 'exam'">测试</span><!--
 --><span ng-if="n.payload.activity_type === 'forum'">讨论</span><!--
 --><span ng-if="n.payload.activity_type === 'classroom'">随堂测试</span>：<!--
 --><a ng-click="linkToActivity(n.payload)" ng-bind="n.payload.activity_title"></a>
    <span ng-if="['homework', 'exam'].indexOf(n.payload.activity_type) !== -1">未提交</span><!--
 --><span ng-if="['forum', 'classroom'].indexOf(n.payload.activity_type) !== -1">未参与</span><!--
 -->，该课程的<!--
 --><span ng-if="n.payload.activity_type === 'homework'">作业</span><!--
 --><span ng-if="n.payload.activity_type === 'exam'">测试</span><!--
 --><span ng-if="n.payload.activity_type === 'forum'">讨论</span><!--
 --><span ng-if="n.payload.activity_type === 'classroom'">随堂测试</span><!--
 -->累计<!--
 --><span ng-if="['homework', 'exam'].indexOf(n.payload.activity_type) !== -1">未提交</span><!--
 --><span ng-if="['forum', 'classroom'].indexOf(n.payload.activity_type) !== -1">未参与</span><!--
 --><span ng-bind="n.payload.number"></span>次。
</div>
<div ng-switch-when="course_completeness_alert" class="notification-item">
    截止到<span ng-bind="n.payload.semester"></span>的<span ng-bind="n.payload.created_at | datetime"></span>，您的
    <a ng-click="link(n)" ng-bind="n.payload.course_name"></a>
    课程信息完整度为<span ng-if="n.payload.status === 'partial'">
        部分填写</span><span ng-if="n.payload.status === 'none'">
        未填写</span>。请您尽快完善课程信息。
</div>
<div ng-switch-when="course_obe_unassociated_alert" class="notification-item">
    课程 <a ng-click="link(n)" ng-bind="n.payload.course_name"></a> 中存在未关联到任何学习活动的OBE指标，请尽快进行关联。
</div>
<div ng-switch-when="course_score_alert" class="notification-item">
    您的课程
    <a ng-click="linkToTeachingUnit(n.payload)" ng-bind='n.payload.course_name'></a>
    <span ng-bind="n.payload.credit"></span>
    学分 成绩为
    <span ng-bind="n.payload.score"></span>
    ,低于
    <span ng-bind="n.payload.threshold"></span>
    分，请您及时完成相应课程的重修，以免影响学业.
</div>
<div ng-switch-when="compulsory_not_taken_alert" class="notification-item">
    依据培养方案要求,您
    <span ng-bind="n.payload.year_semester_name"></span>
    还有
    <span ng-bind="n.payload.course_count"></span>
    门必修课(
    <span ng-bind="n.payload.course_names"></span>
    )仍未修习，请及时关注。
</div>
<div ng-switch-when="video_clipped" class="notification-item">
    视频
    <a ng-if="n.payload.status === 'success'" previewer from-page='resource' reveal-modal="file-previewer"
        ng-init="upload = {id: n.payload.resource_id, type: n.payload.referrer === 'file-resource' ? 'video': 'lesson-resource', name: n.payload.name}">
        <span ng-bind="n.payload.name"></span>
    </a>
    <span ng-if="n.payload.status === 'success'">剪辑成功，</span>
    <span ng-if="n.payload.status === 'fail'" ng-bind="n.payload.name"></span>
    <span ng-if="n.payload.status === 'fail'">剪辑失败，</span>
    可前往
    <a ng-if="n.payload.referrer === 'file-resource'" href="/user/resources/files">
        <span>我的资源-文件</span>
    </a>
    <a ng-if="n.payload.referrer === 'lesson-resource'" href="/user/resources/lesson-resource">
        <span>我的资源-录播教材</span>
    </a>
    查看
</div>
<div ng-switch-when="video_generated" class="notification-item">
    视频
    <a ng-if="n.payload.status === 'success'" previewer from-page='resource' reveal-modal="file-previewer"
        ng-init="upload = {id: n.payload.resource_id, type: 'lesson-resource', name: n.payload.name}">
        <span ng-bind="n.payload.name"></span>
    </a>
    <span ng-if="n.payload.status === 'success'">合成成功，</span>
    <span ng-if="n.payload.status === 'failed'" ng-bind="n.payload.name"></span>
    <span ng-if="n.payload.status === 'failed'">合成失败，</span>
    可前往
    <a ng-if="n.payload.referrer === 'file-resource'" href="/user/resources/files">
        <span>我的资源-文件</span>
    </a>
    <a ng-if="n.payload.referrer === 'lesson-resource'" href="/user/resources/lesson-resource">
        <span>我的资源-录播教材</span>
    </a>
    查看
</div>
<div ng-switch-when="create_research_meeting" class="notification-item">
    [[n.payload.created_by_name]]
    创建了
    <a ng-click="linkToResearchMeeting(n.payload)" ng-bind='n.payload.meeting_title'></a>
    教学研讨(会议)，开始时间为
    <span ng-bind='n.payload.start_time|datetime'></span>
</div>
<div ng-switch-when="research_meeting_will_begin" class="notification-item">
    <a ng-click="linkToResearchMeeting(n.payload)" ng-bind='n.payload.meeting_title'></a>
    教学研讨(会议)，将于五分钟后开始，请按时
    <a ng-href='[[n.payload.join_url]]' target="_Blank">入会</a>
</div>
<div ng-switch-when="research_discussion_created" class="notification-item">
    [[n.payload.created_by_name]]
    创建了
    <a ng-click="linkToResearchForum(n.payload)" target="_blank" ng-bind='n.payload.discussion_title'></a>
    教学研讨(讨论)
</div>
<div ng-switch-when="moodle_course_imported" class="notification-item">
    课程
    <a ng-click="linkToTeachingUnit(n.payload)" ng-bind='n.payload.course_name'></a>
    <span ng-if="n.payload.status === 'success'">的内容导入成功</span>
    <span ng-if="n.payload.status === 'failed'">的内容导入失败</span>
</div>
<div ng-switch-when="resource_audit_rejected" class="notification-item">
    您在课程
    <a ng-click="linkToTeachingUnit(n.payload)" ng-bind="n.payload.course_name"></a>
    的
    <a ng-click="linkToAuditActivity(n.payload)" ng-bind="n.payload.activity_name"></a>
    <span ng-if="n.payload.activity_type !== 'web_link'">中上传的 [[n.payload.upload_name]] 资源审核拒绝， 原因：</span>
    <span ng-if="n.payload.activity_type === 'web_link'">中上传的链接审核拒绝， 原因：</span>
    [[n.payload.audit_remark]]
</div>
<div ng-switch-when="questionnaire_submitted" class="notification-item">
    [[n.payload.user_name]]
老师您好，
    <span ng-if="n.payload.type === 'submit'">您的[[n.payload.course_name]]课程刚刚被评价了一次，</span>
    <span ng-if="n.payload.type === 'copy'">刚刚有一门被评价的课程请您查看，</span>
    请进入
    <a ng-href="[[n.payload.url]]" target="_blank">教学质量管理平台</a>
    进行查看
</div>
<div ng-switch-when="book_live_will_begin" class="notification-item">
    <span ng-if="n.payload.course_id">课程
        <a ng-click="isFromRMS(n.payload) ? n.payload.course_url : linkToTeachingUnit(n.payload)" ng-bind="n.payload.course_name" ng-attr-target="[[isFromRMS(n.payload) ? '_blank' : '_self']]"></a>
        的
    </span>
    <a ng-click="linkToBookLive(n.payload)" ng-bind="n.payload.live_title"
        ng-attr-target="[[isFromRMS(n.payload) ? '_blank' : '_self']]"></a>
    将要开始，请按时参加
</div>
<div ng-switch-when="continuous_absence_alert" class="notification-item">
    你已连续缺勤
    <span>[[ n.payload.number ]]</span>
    天，请按时上课。
</div>
<div ng-switch-when="continuous_absence_teacher_alert" class="notification-item">
    [[ n.payload.user_name ]]（[[ n.payload.user_no ]]）已连续缺勤
    <span>[[ n.payload.number ]]</span>
    天，请提醒学生按时上课。
</div>
<div ng-switch-when="course_outline_updated" class="notification-item">
    课程
    <span ng-if="n.payload.course_name">
        <a ng-bind="n.payload.course_name" ng-href="[['/course/' + n.payload.course_id + '/content']]"></a>
    </span>
    于<span ng-bind="n.payload.created_at | datetime"></span>更新了
    <a ng-href='/course/[[n.payload.course_id]]/outline'>
        课程信息
    </a>
</div>
<div ng-switch-when="course_attendance_rate_alert" class="notification-item">
    <span ng-if="n.payload.course_time">
        <span ng-bind="n.payload.course_time"></span>
    </span>
    课程
    <a ng-click="linkToTeachingUnit(n.payload)" ng-bind="n.payload.course_name"></a>
    的学生到课率为
    <span ng-bind="n.payload.attendance_rate"></span>
    %，请及时关注课程情况。
</div>
<div ng-switch-when="homework_redo" class="notification-item">
    <span ng-if="!n.payload.submit_by_group">你在课程</span>
    <span ng-if="n.payload.submit_by_group">你所在小组在课程</span>
    <a ng-click="linkToTeachingUnit(n.payload)" ng-bind="n.payload.course_name"></a>
作业
    <a ng-bind='n.payload.homework_title' ng-click="linkToHomeworkActivity(n.payload)"></a>
    提交的作业被老师打回，请重新提交
</div>
<div ng-switch-when="vtrs_member_deleted" class="notification-item">
    <span ng-bind="n.payload.owner_name"></span>
    已将你从
    <span ng-bind="n.payload.vtrs_name"></span>
    教研室中移除
</div>
<div ng-switch-when="vtrs_owner_transferred" class="notification-item">
    <span ng-bind="n.payload.last_owner_name"></span>
    已将
    <a ng-click="linkToVtrs(n.payload)" ng-bind="n.payload.vtrs_name"></a>
    教研室的组长权限转移给您
</div>
<span ng-switch-when="notify_evaluation_ended" class="notification-item">
    课程 <a ng-click="linkToTeachingUnit(n.payload)" ng-bind='n.payload.course_name'></a>
    的考核评价 <a ng-bind='n.payload.evaluation_title' ng-click="linkToEvaluationActivity(n.payload)"></a>
    已于<span ng-bind='n.payload.end_time|datetime'></span>截止
</span>
<span ng-switch-when="notify_evaluation_started" class="notification-item">
    课程 <a ng-click="linkToTeachingUnit(n.payload)" ng-bind='n.payload.course_name'></a>
    的考核评价 <a ng-bind='n.payload.evaluation_title' ng-click="linkToEvaluationActivity(n.payload)"></a>
    已于<span ng-bind='n.payload.start_time|datetime'></span>开启
</span>
<span ng-switch-when="project_apply_approved" class="notification-item">
    你申请的项目 <a ng-click="linkToProject(n.payload)" ng-bind="n.payload.project_name"></a>
    已通过审核
</span>
<span ng-switch-when="project_apply_rejected" class="notification-item">
    你申请的项目 <span ng-bind="n.payload.project_name"></span>
    已被拒绝，请联系相关项目导师
</span>
<span ng-switch-when="schedule_audit_agree" class="notification-item">
    你申请的活动<a ng-href="[[n.payload.link]]" ng-bind="n.payload.schedule_audit_name"></a>
    已通过，将在指定时间下发起直播或录制
</span>
<span ng-switch-when="schedule_audit_rejected" class="notification-item">
    你申请的活动<span ng-bind="n.payload.schedule_audit_name"></span>
    已被拒绝，请联系管理员后重新发起申请
</span>
<span ng-switch-when="schedule_audit_expired" class="notification-item">
    你申请的活动<span ng-bind="n.payload.schedule_audit_name"></span>
    已失效，请重新发起申请
</span>
<span ng-switch-when="low_user_air_credit" class="notification-item">
    您的 AIR 点数仅剩余
    <span ng-bind="n.payload.credits"></span>
    点，请您尽快
    <apply-air-credit-modal-link
        id="apply-air-credit-modal"
        ng-prop-target_id="n.payload.user_id"
        ng-prop-target_type="'user'">
    </apply-air-credit-modal-link>
    ，以继续使用。
</span>
<span ng-switch-when="low_course_air_credit" class="notification-item">
    您的《<span ng-bind="n.payload.course_name"></span>》AIR 点数仅剩余
    <span ng-bind="n.payload.credits"></span>
    点，请您尽快
    <apply-air-credit-modal-link
        id="apply-air-credit-modal"
        ng-prop-target_id="n.payload.course_id"
        ng-prop-target_type="'course'">
    </apply-air-credit-modal-link>
    ，以确保学生能继续使用。
</span>
<span ng-switch-when="air_user_credit_audit_approved" class="notification-item">
    您申请的个人点数
    <span ng-bind="n.payload.applied_credits"></span>
    点，已审核通过
    <span ng-bind="n.payload.approved_credits"></span>
    点，请继续使用。
</span>
<span ng-switch-when="air_course_credit_audit_approved" class="notification-item">
    您申请的《<span ng-bind="n.payload.course_name"></span>》课程点数
    <span ng-bind="n.payload.applied_credits"></span>
    点，已审核通过
    <span ng-bind="n.payload.approved_credits"></span>
    点，课程内的学生可继续使用。
</span>
<span ng-switch-when="air_user_credit_audit_rejected" class="notification-item">
    您的个人点数申请已被拒绝，原因是：
    <span ng-bind="n.payload.remark"></span>
</span>
<span ng-switch-when="air_course_credit_audit_rejected" class="notification-item">
    您申请的《<span ng-bind="n.payload.course_name"></span>》课程点数已被拒绝，原因是：
    <span ng-bind="n.payload.remark"></span>
</span><div id="instrucor-warning-info-popup" class="instrucor-warning-info-popup reveal-modal popup-area" resetable data-reveal>
    <div class="popup-content" ng-if="popupState.popupOpened">
        <div class="popup-header">
            <span>预警事项</span>
            <a class="right" close-popup="instrucor-warning-info-popup">
                <i class="font font-close"></i>
            </a>
        </div>
        <div class="warning-info columns large-32">
            <div class="name column large-8"><span>预警名称</span></div>
            <div class="value column large-24"><span ng-bind="warningInfo.warning_name"></span></div>
        </div>
        <div class="warning-info columns large-32">
            <div class="name column large-8"><span>学年</span></div>
            <div class="value column large-24"><span ng-bind="warningInfo.academic_year"></span></div>
        </div>
        <div class="warning-info columns large-32">
            <div class="name column large-8"><span>学期</span></div>
            <div class="value column large-24"><span ng-bind="warningInfo.semester"></span></div>
        </div>
        <div class="warning-info columns large-32">
            <div class="name column large-8"><span>预警时间范围</span></div>
            <div class="value column large-24">
                <span ng-bind="warningInfo.stat_start_date | date"></span> - <span ng-bind="warningInfo.stat_end_date | date"></span>
            </div>
        </div>
        <div class="warning-info columns large-32">
            <div class="name column large-8"><span>名单送交时间</span></div>
            <div class="value column large-24">
                <span ng-bind="warningInfo.start_date | date"></span> ~ <span ng-bind="warningInfo.end_date | date"></span>
            </div>
        </div>
    </div>
</div>        </div>
        <div ng-if="result.pages > 1">
<div class="list-pager">
    <ul>
        <li ng-show="pageIndex > 1" class="previous-page-button">
            <a class="small pager-button button-white" ng-click="changePage(pageIndex-1)">
                <span>< 上一页</span>
            </a>
        </li>
        <li class="first-page" ng-hide="pageIndex<=1">
            <a class="small pager-button button-white" ng-bind="1" ng-click="changePage(1)"></a>
        </li>
        <li class="ellipsis-pages" ng-hide="pageIndex<=1+2">
            <span>...</span>
        </li>
        <li class="preview-page" ng-hide="pageIndex<=1+1">
            <a class="small pager-button button-white" ng-bind="pageIndex-1" ng-click="changePage(pageIndex-1)"></a>
        </li>
        <li class="current-page">
            <a class="small pager-button button-white active" ng-bind="pageIndex"></a>
        </li>
        <li class="next-page" ng-hide="pageIndex>=result.pages-1">
            <a class="small pager-button button-white" ng-bind="pageIndex+1" ng-click="changePage(pageIndex+1)"></a>
        </li>
        <li class="ellipsis-pages" ng-hide="pageIndex>=result.pages-2">
            <span>...</span>
        </li>
        <li class="last-page" ng-hide="pageIndex>=result.pages">
            <a class="small pager-button button-white" ng-bind="result.pages" ng-click="changePage(result.pages)"></a>
        </li>
        <li ng-show="pageIndex != result.pages" class="next-page-button">
            <a class="small pager-button button-white" ng-click="changePage(pageIndex+1)">
                <span>下一页 ></span>
            </a>
        </li>
        <li class="hidden-in-mobile">
            <div class="select2-container page-selector">
                <select ui-select2="{dropdownCssClass: 'select2-drop-without-search'}"
                    ng-change="updatePageSize(pageSize)" ng-model="pageSize" parse-integer>
                    <option value="[[ number ]]" ng-repeat="number in pageSizeOptions" ng-bind="number"></option>
                </select>
            </div>
        </li>
        <li class="hidden-in-mobile">项/页</li>
    </ul>
</div>        </div>
    </div>
<div id="upload-save" class="folder-select reveal-modal popup-area popup-900" data-reveal resetable
     data-options="multiple_opened:true">
    <div class="popup-content" before-controller="allI18n='文件'" ng-controller="UploadSaveCtrl" ng-if="popupState.popupOpened">
        <div class="popup-header">
            <span ng-bind="folderSelectTitle"></span>
            <a class="right" close-popup="upload-save">
                <i class="font font-close"></i>
            </a>
        </div>
        <div class="main-area">
            <div class="folder-tree" ng-include="'folder-tree-nodes'">
            </div>
        </div>
        <div class="popup-footer">
            <div class="form-buttons">
<div class="loading-spinner" ng-show="loading">
    <div class="spinner">
        <div class="mask">
            <div class="maskedCircle"></div>
        </div>
    </div>
</div>                <button class="button button-green medium" ng-click="saveConfirm()"
                        type="button" ng-hide="loading">确认</button>
                <button class="button button-grey medium" close-popup="upload-save"
                        type="button" ng-hide="loading">取消</button>
            </div>
        </div>
    </div>
</div><script type="text/ng-template" id="folder-tree-nodes">
    <div class="folder" ng-repeat="folder in folders">
        <div class="folder-attribute folder-level-[[folder.level]]"
             ng-class="{'active': folder.selected}"
             ng-style="{'padding-left': folder.level * 50 + 20 + 'px'}"
             ng-click="selectParent(folder)">
            <i class="font font-tree-expanded"
               ng-click="expandFolder(folder)"
               ng-if="!folder.expanded"
               stop-propagation
               ng-style="{'visibility': folder.has_sub_folder?'visible':'hidden'}"></i>
            <i class="font font-tree-collapsed"
               ng-click="folder.expanded = false"
               ng-if="folder.expanded"
               stop-propagation
               ng-style="{'visibility': folder.has_sub_folder?'visible':'hidden'}"></i>
            <i class="font font-file-folder"></i>
            <div class="folder-name truncate-text">
                <span tipsy="upload.name" ng-bind="folder.name"></span>
            </div>
        </div>
        <div class="children" before-controller="" ng-if="(folders=folder.children) && folder.expanded" ng-include="'folder-tree-nodes'">
        </div>
    </div>
</script>
<div id="subject_library-save" class="folder-select reveal-modal popup-area popup-900" data-reveal resetable>
    <div class="popup-content" before-controller="allI18n='个人题库'" ng-controller="LibSaveCtrl" ng-if="popupState.popupOpened">
        <div class="popup-header">
            <span ng-bind="folderSelectTitle"></span>
            <a class="right" close-popup="subject_library-save">
                <i class="font font-close"></i>
            </a>
        </div>
        <div class="main-area">
            <div class="folder-tree" ng-include="'folder-tree-nodes'">
            </div>
        </div>
        <div class="popup-footer">
            <div class="form-buttons">
<div class="loading-spinner" ng-show="loading">
    <div class="spinner">
        <div class="mask">
            <div class="maskedCircle"></div>
        </div>
    </div>
</div>                <button class="button button-green medium" ng-click="saveConfirm()"
                        type="button" ng-hide="loading">确认</button>
                <button class="button button-grey medium" close-popup="subject_library-save"
                        type="button" ng-hide="loading">取消</button>
            </div>
        </div>
    </div>
</div><script type="text/ng-template" id="folder-tree-nodes">
    <div class="folder" ng-repeat="folder in folders">
        <div class="folder-attribute folder-level-[[folder.level]]"
             ng-class="{'active': folder.selected}"
             ng-style="{'padding-left': folder.level * 50 + 20 + 'px'}"
             ng-click="selectParent(folder)">
            <i class="font font-tree-expanded"
               ng-click="expandFolder(folder)"
               ng-if="!folder.expanded"
               stop-propagation
               ng-style="{'visibility': folder.has_sub_folder?'visible':'hidden'}"></i>
            <i class="font font-tree-collapsed"
               ng-click="folder.expanded = false"
               ng-if="folder.expanded"
               stop-propagation
               ng-style="{'visibility': folder.has_sub_folder?'visible':'hidden'}"></i>
            <i class="font font-file-folder"></i>
            <div class="folder-name truncate-text">
                <span tipsy="upload.name" ng-bind="folder.name"></span>
            </div>
        </div>
    </div>
</script>
<div id="slide-save" class="folder-select reveal-modal popup-area popup-900" data-reveal resetable>
    <div class="popup-content" before-controller="allI18n='微课'" ng-controller="SlideSaveCtrl" ng-if="popupState.popupOpened">
        <div class="popup-header">
            <span ng-bind="folderSelectTitle"></span>
            <a class="right" close-popup="slide-save">
                <i class="font font-close"></i>
            </a>
        </div>
        <div class="main-area">
            <div class="folder-tree" ng-include="'folder-tree-nodes'">
            </div>
        </div>
        <div class="popup-footer">
            <div class="form-buttons">
<div class="loading-spinner" ng-show="loading">
    <div class="spinner">
        <div class="mask">
            <div class="maskedCircle"></div>
        </div>
    </div>
</div>                <button class="button button-green medium" ng-click="saveConfirm()"
                        type="button" ng-hide="loading">确认</button>
                <button class="button button-grey medium" close-popup="slide-save"
                        type="button" ng-hide="loading">取消</button>
            </div>
        </div>
    </div>
</div>

<script type="text/ng-template" id="folder-tree-nodes">
    <div class="folder" ng-repeat="folder in folders">
        <div class="folder-attribute folder-level-[[folder.level]]"
             ng-class="{'active': folder.selected}"
             ng-style="{'padding-left': folder.level * 50 + 20 + 'px'}"
             ng-click="selectParent(folder)">
            <i class="font font-tree-expanded"
               ng-click="expandFolder(folder)"
               ng-if="!folder.expanded"
               stop-propagation
               ng-style="{'visibility': folder.has_sub_folder?'visible':'hidden'}"></i>
            <i class="font font-tree-collapsed"
               ng-click="folder.expanded = false"
               ng-if="folder.expanded"
               stop-propagation
               ng-style="{'visibility': folder.has_sub_folder?'visible':'hidden'}"></i>
            <i class="font font-file-folder"></i>
            <div class="folder-name truncate-text">
                <span tipsy="upload.name" ng-bind="folder.name"></span>
            </div>
        </div>
        <div class="children" before-controller="" ng-if="(folders=folder.children) && folder.expanded" ng-include="'folder-tree-nodes'">

        </div>
    </div>
</script><div id="prerequisites-confirmation-popup" data-reveal
     class="reveal-modal prerequisites-confirmation-popup popup-area popup-480">
    <div class="popup-content">
        <div class="popup-header">
            <span>开启条件</span>
            <a class="right" close-popup="prerequisites-confirmation-popup">
                <i class="font font-close"></i>
            </a>
        </div>
        <div class="main-area">
            <div ng-repeat="prerequisite in lockedActivity.prerequisites" class="prerequisite"
                 ng-class="{'finished': prerequisite.completion_criterion.has_completed && prerequisite.completion_criterion.is_in_progress,
                            'invalid': !prerequisite.completion_criterion.published || !prerequisite.completion_criterion.is_in_progress}">
                <span class="activity-type" ng-switch="prerequisite.activity_type">
                    <span ng-switch-when="homework">作业</span>
                    <span ng-switch-when="material">参考资料</span>
                    <span ng-switch-when="web_link">线上链接</span>
                    <span ng-switch-when="online_video">音视频教材</span>
                    <span ng-switch-when="interaction">互动教材</span>
                    <span ng-switch-when="lesson">录播教材</span>
                    <span ng-switch-when="slide">微课</span>
                    <span ng-switch-when="forum">讨论</span>
                    <span ng-switch-when="exam">测试</span>
                    <span ng-switch-when="chatroom">iSlide 直播</span>
                    <span ng-switch-when="virtual_classroom">Connect 直播</span>
                    <span ng-switch-when="questionnaire">调查问卷</span>
                    <span ng-switch-when="page">页面</span>
                    <span ng-switch-when="scorm">第三方教材</span>
                </span>
                <div class="truncate-text activity-title">
                    <span ng-bind="prerequisite.title" tipsy="prerequisite.title"></span>
                </div>
                <span class="activity-read-info">
                    (<span ng-bind="prerequisite.completion_criterion.completion_info"></span>)
                </span>
                <div ng-bind="prerequisite.completion_criterion.criterion_text"
                     class="activity-completion-criterion">
                </div>
            </div>
        </div>
        <div class="popup-footer">
            <div class="form-buttons">
                <button class="button button-green medium"
                        close-popup="prerequisites-confirmation-popup">确定</button>
            </div>
        </div>
    </div>
</div></div>            </div>
            <div class="latest-content gtm-label" ng-show="notificationTab == 'latestContent'" data-label="最新内容">
<div class="loading-in-element" ng-show="contentLoaded">
    <div class="spinner"></div>
</div>                <div ng-if="latestContentLoadingStatus == 'loaded'">
<div class="active-homework card">
    <div class="title">
        <i class="font font-course-homework"></i><span>进行中的作业</span>
    </div>
    <div class="homework-list" ng-class="{'more-item': coursesWithInProgressHomework.length > 3}">
        <div class="course homework"
         ng-repeat="course in coursesWithInProgressHomework" expandable-content="homework"
         ng-if="ui.shownAllInProgressHomeworkCourses || $index < 3">
        <div class="homework-summary summary">
            <div class="left-info">
                <div class="course-cover">
                    <img ng-src="[[course.cover ? course.cover : '/static/assets/images/large/course-cover-default70x39-94b50490.png']]">
                </div>
                <div class="summary-text truncate-text">
                    <span tipsy="course.name" class="course-name" ng-bind="course.name"></span>
                    <span class="course-department" ng-bind="getCourseInfo(course)" ng-if="getCourseInfo(course)" ng-cloak></span>
                </div>
            </div>
            <div class="right-info">
                <div>
                    <i class="icon icon-toggle-expanded-lighter" ng-class="{'icon-toggle-collapsed-lighter': !isExpanded, 'icon-toggle-expanded-lighter': isExpanded}"></i>
                </div>
                <div>
                    <span ng-bind="course.inProgressHomeworkNumber"></span><span>个</span>
                </div>
            </div>
        </div>
        <div class="homework-content content">
            <div class="item" ng-repeat="activity in course.inProgressHomeworkList">
                <div class="item-title truncate-text">
                    <i class="font font-homework"></i>
                    <a tipsy="activity.title" href="/course/[[course.id]]/learning-activity#/[[activity.id]]"
                       ng-bind="activity.title"></a>
                </div>
                <div class="item-detail last" ng-if="activity.end_time">
                    交付截止时间
                    <span ng-bind="activity.end_time|datetime"></span>
                    <div class="finish status" ng-if="activityFinish(activity)">
                        <i class="icon icon-submitted"></i>
                        已交
                        <span ng-show="activity.score != '-'">|<span ng-bind="activity.score"></span><span>分</span></span>
                    </div>
                </div>
        <div class="activity-prerequisites" ng-if="activity && activityHasNotFinishedPrerequisite(activity)"
             ng-mouseenter="resetPrerequisitesTipsPosition($event)">
<div id="prerequisites-confirmation-popup-[[activity.type]]-[[activity.id]]" data-reveal
     class="reveal-modal prerequisites-confirmation-popup popup-area popup-480">
    <div class="popup-content">
        <div class="popup-header">
            <span>开启条件</span>
            <a class="right" close-popup="prerequisites-confirmation-popup-[[activity.type]]-[[activity.id]]">
                <i class="font font-close"></i>
            </a>
        </div>
        <div class="main-area">
            <div ng-repeat="prerequisite in activity.prerequisites" class="prerequisite"
                 ng-class="{'finished': prerequisite.completion_criterion.has_completed && prerequisite.completion_criterion.is_in_progress,
                            'invalid': !prerequisite.completion_criterion.published || !prerequisite.completion_criterion.is_in_progress}">
<span class="activity-type" ng-switch="prerequisite.activity_type">
<span ng-switch-when="homework">作业</span>
<span ng-switch-when="material">参考资料</span>
<span ng-switch-when="web_link">线上链接</span>
<span ng-switch-when="online_video">音视频教材</span>
<span ng-switch-when="interaction">互动教材</span>
<span ng-switch-when="lesson">录播教材</span>
<span ng-switch-when="slide">微课</span>
<span ng-switch-when="forum">讨论</span>
<span ng-switch-when="exam">测试</span>
<span ng-switch-when="chatroom">iSlide 直播</span>
<span ng-switch-when="virtual_classroom">Connect 直播</span>
<span ng-switch-when="questionnaire">调查问卷</span>
<span ng-switch-when="page">页面</span>
<span ng-switch-when="scorm">第三方教材</span></span>
<div class="truncate-text activity-title">
    <span ng-bind="prerequisite.title" tipsy="prerequisite.title"></span>
</div>
<span class="activity-read-info">
    (<span ng-bind="prerequisite.completion_criterion.completion_info"></span>)
</span>
<div ng-bind="prerequisite.completion_criterion.criterion_text"
     class="activity-completion-criterion">
</div>            </div>
        </div>
        <div class="popup-footer">
            <div class="form-buttons">
                <button class="button button-green medium"
                        close-popup="prerequisites-confirmation-popup-[[activity.type]]-[[activity.id]]">确定</button>
            </div>
        </div>
    </div>
</div>            <activity-checkpoint-lock class="is-locked"></activity-checkpoint-lock>
            <div class="prerequisites-tips">
                <div class="title">开启条件</div>
                <div ng-repeat="prerequisite in activity.prerequisites" class="prerequisite"
                     ng-class="{'finished': prerequisite.completion_criterion.has_completed && prerequisite.completion_criterion.is_in_progress,
                                'invalid': !prerequisite.completion_criterion.published || !prerequisite.completion_criterion.is_in_progress}">
<span class="activity-type" ng-switch="prerequisite.activity_type">
<span ng-switch-when="homework">作业</span>
<span ng-switch-when="material">参考资料</span>
<span ng-switch-when="web_link">线上链接</span>
<span ng-switch-when="online_video">音视频教材</span>
<span ng-switch-when="interaction">互动教材</span>
<span ng-switch-when="lesson">录播教材</span>
<span ng-switch-when="slide">微课</span>
<span ng-switch-when="forum">讨论</span>
<span ng-switch-when="exam">测试</span>
<span ng-switch-when="chatroom">iSlide 直播</span>
<span ng-switch-when="virtual_classroom">Connect 直播</span>
<span ng-switch-when="questionnaire">调查问卷</span>
<span ng-switch-when="page">页面</span>
<span ng-switch-when="scorm">第三方教材</span></span>
<div class="truncate-text activity-title">
    <span ng-bind="prerequisite.title" tipsy="prerequisite.title"></span>
</div>
<span class="activity-read-info">
    (<span ng-bind="prerequisite.completion_criterion.completion_info"></span>)
</span>
<div ng-bind="prerequisite.completion_criterion.criterion_text"
     class="activity-completion-criterion">
</div>                </div>
            </div>
        </div>
            </div>
        </div>
    </div>
    </div>
    <div class="show-all-wrapper ng-cloak" ng-show="coursesWithInProgressHomework.length > 3">
        <a class="show-all text-center" ng-if="!ui.shownAllInProgressHomeworkCourses" ng-click="ui.shownAllInProgressHomeworkCourses=true">
            <span>展开更多</span>
            <i class="icon icon-arrow-down"></i>
        </a>
        <a class="show-all text-center" ng-if="ui.shownAllInProgressHomeworkCourses" ng-click="ui.shownAllInProgressHomeworkCourses=false">
            <span>收起内容</span>
            <i class="icon icon-arrow-down flip"></i>
        </a>
    </div>
    <div class="no-content" ng-if="!inProgressHomeworkNumber">
        <div class="text-center">暂没有进行中的作业</div>
        <i class="dashboard-blank-icon font font-course-homework"></i>
    </div>
</div><div class="latest-materials card">
    <div class="title">
        <i class="font font-course-material"></i><span>最新教材</span>
    </div>

    <div class="material-list" ng-class="{'more-item': coursesWithLatestMaterial.length > 3}">
        <div class="course material" ng-repeat="course in coursesWithLatestMaterial" expandable-content="material"
         ng-if="ui.shownAllLatestMaterialCourses || $index < 3">
            <div class="material-summary summary">
                <div class="left-info">
                    <div class="course-cover">
                        <img ng-src="[[course.cover ? course.cover : '/static/assets/images/large/course-cover-default70x39-94b50490.png']]">
                    </div>
                    <div class="summary-text truncate-text">
                        <span tipsy="course.name" class="course-name" ng-bind="course.name"></span>
                        <span class="course-department" ng-bind="getCourseInfo(course)" ng-if="getCourseInfo(course)" ng-cloak></span>
                    </div>
                </div>
                <div class="right-info">
                    <div>
                        <i class="icon icon-toggle-expanded-lighter" ng-class="{'icon-toggle-collapsed-lighter': !isExpanded, 'icon-toggle-expanded-lighter': isExpanded}"></i>
                    </div>
                    <div>
                        <span ng-bind="course.latestMaterialNumber"></span><span>个</span>
                    </div>
                </div>
            </div>
            <div class="material-content content">
                <div class="item" ng-repeat="activity in course.latestMaterialList" ng-switch="activity.type">
                    <div ng-switch-when="material">
                        <div class="item-title truncate-text">
                            <i class="font font-material"></i>
                            <a tipsy="activity.title" ng-href="/course/[[course.id]]/learning-activity#/[[activity.id]]?from=dashboard"
                               ng-bind="activity.title"></a>
                        </div>
        <div class="activity-prerequisites" ng-if="activity && activityHasNotFinishedPrerequisite(activity)"
             ng-mouseenter="resetPrerequisitesTipsPosition($event)">
<div id="prerequisites-confirmation-popup-[[activity.type]]-[[activity.id]]" data-reveal
     class="reveal-modal prerequisites-confirmation-popup popup-area popup-480">
    <div class="popup-content">
        <div class="popup-header">
            <span>开启条件</span>
            <a class="right" close-popup="prerequisites-confirmation-popup-[[activity.type]]-[[activity.id]]">
                <i class="font font-close"></i>
            </a>
        </div>
        <div class="main-area">
            <div ng-repeat="prerequisite in activity.prerequisites" class="prerequisite"
                 ng-class="{'finished': prerequisite.completion_criterion.has_completed && prerequisite.completion_criterion.is_in_progress,
                            'invalid': !prerequisite.completion_criterion.published || !prerequisite.completion_criterion.is_in_progress}">
<span class="activity-type" ng-switch="prerequisite.activity_type">
<span ng-switch-when="homework">作业</span>
<span ng-switch-when="material">参考资料</span>
<span ng-switch-when="web_link">线上链接</span>
<span ng-switch-when="online_video">音视频教材</span>
<span ng-switch-when="interaction">互动教材</span>
<span ng-switch-when="lesson">录播教材</span>
<span ng-switch-when="slide">微课</span>
<span ng-switch-when="forum">讨论</span>
<span ng-switch-when="exam">测试</span>
<span ng-switch-when="chatroom">iSlide 直播</span>
<span ng-switch-when="virtual_classroom">Connect 直播</span>
<span ng-switch-when="questionnaire">调查问卷</span>
<span ng-switch-when="page">页面</span>
<span ng-switch-when="scorm">第三方教材</span></span>
<div class="truncate-text activity-title">
    <span ng-bind="prerequisite.title" tipsy="prerequisite.title"></span>
</div>
<span class="activity-read-info">
    (<span ng-bind="prerequisite.completion_criterion.completion_info"></span>)
</span>
<div ng-bind="prerequisite.completion_criterion.criterion_text"
     class="activity-completion-criterion">
</div>            </div>
        </div>
        <div class="popup-footer">
            <div class="form-buttons">
                <button class="button button-green medium"
                        close-popup="prerequisites-confirmation-popup-[[activity.type]]-[[activity.id]]">确定</button>
            </div>
        </div>
    </div>
</div>            <activity-checkpoint-lock class="is-locked"></activity-checkpoint-lock>
            <div class="prerequisites-tips">
                <div class="title">开启条件</div>
                <div ng-repeat="prerequisite in activity.prerequisites" class="prerequisite"
                     ng-class="{'finished': prerequisite.completion_criterion.has_completed && prerequisite.completion_criterion.is_in_progress,
                                'invalid': !prerequisite.completion_criterion.published || !prerequisite.completion_criterion.is_in_progress}">
<span class="activity-type" ng-switch="prerequisite.activity_type">
<span ng-switch-when="homework">作业</span>
<span ng-switch-when="material">参考资料</span>
<span ng-switch-when="web_link">线上链接</span>
<span ng-switch-when="online_video">音视频教材</span>
<span ng-switch-when="interaction">互动教材</span>
<span ng-switch-when="lesson">录播教材</span>
<span ng-switch-when="slide">微课</span>
<span ng-switch-when="forum">讨论</span>
<span ng-switch-when="exam">测试</span>
<span ng-switch-when="chatroom">iSlide 直播</span>
<span ng-switch-when="virtual_classroom">Connect 直播</span>
<span ng-switch-when="questionnaire">调查问卷</span>
<span ng-switch-when="page">页面</span>
<span ng-switch-when="scorm">第三方教材</span></span>
<div class="truncate-text activity-title">
    <span ng-bind="prerequisite.title" tipsy="prerequisite.title"></span>
</div>
<span class="activity-read-info">
    (<span ng-bind="prerequisite.completion_criterion.completion_info"></span>)
</span>
<div ng-bind="prerequisite.completion_criterion.criterion_text"
     class="activity-completion-criterion">
</div>                </div>
            </div>
        </div>
                        <span class="right" ng-if="activity.end_time" ng-bind="activity.end_time | datetime"></span>
                        <br class="clear-both" />
                            <div ng-init="uploads = activity.uploads">
<div class="attachments-wrapper" ng-if="uploads.length" stop-propagation check-upload-status>

<div class="attachment-header clearfix">
    <div class="attachment-column column" ng-class="{'large-11': true, 'large-15': !true}">
        附件名
    </div>
    <div class="attachment-column column" ng-if="ui.videoType !=='sobey'"
        ng-class="{'large-7': true, 'large-10': !true}">
        大小
    </div>
        <div ng-if="airHelper.canShowAttachmentQuestion(activity) === true" class="attachment-column column large-2">题目</div>
    <div class="attachment-column column large-3">&nbsp;</div>
</div>    <div class="attachment-body">
        <div ng-repeat="upload in uploads">
        <div class="attachment-row preview-able clearfix" ng-if="canPreview(upload) && !upload.deleted && canShowResource(upload, isInstructorView)"
             previewer="{uploads: uploads, currentFile: upload, activity: activity, canAddNote: true}" reveal-modal="file-previewer-with-note" ng-click="downloadBlob(activity, upload, 'view')">



    <div class="attachment-column column large-10" ng-if="upload.type != 'slide'" ng-class="{'large-20':upload.source === 'sobey'}">
        <div ng-if="upload.source == 'auto-generated-pdf'">
            <svg class="file-text-content left">
                <use xlink:href="#file-text-content"></use>
            </svg>
            <span class="file-name-wrapper truncate-text left">
                <span class="file-name" tipsy-literal="[[ upload.name.split('.')[0] ]]">[[ upload.name.split('.')[0] ]]</span>
            </span>
        </div>
        <div ng-if="upload.source !== 'auto-generated-pdf'" class="w-full flex">
            <i class="font font-file-[[fileTypeByExtension(upload)]] left"></i>
            <span class="file-name-wrapper truncate-text left">
                <span class="file-name" tipsy-literal="[[ upload.name ]]" ng-bind="upload.name|fileName"></span>
            </span>
            <span class="file-extension left" ng-bind="upload.name|fileExtension"></span>
        </div>
    </div>
    <div class="attachment-column column large-10" ng-if="upload.type == 'slide'">
        <i class="font font-slide left"></i>
        <span class="file-name-wrapper truncate-text left">
            <span class="file-name" tipsy-literal="[[ upload.title ]]" ng-bind="upload.title|fileName"></span>
        </span>
    </div>
        <div class="attachment-column column attachment-state" ng-if="!upload.deleted && upload.source !== 'sobey'"
            ng-class="{'large-1': true, 'large-5': !true}">
        <span ng-if="!upload.status || upload.status === 'ready' || (upload.status === 'processing' && (upload.type === 'video' || upload.videos)) || upload.status === 'none' || upload.deleted || wpsPreview(upload)">&nbsp;</span>
        <span ng-if="(upload.status === 'failed' || uploadsStatus[upload.id] === 'failed') && !upload.deleted">&nbsp;</span>
        <span ng-if="(upload.status === 'processing' || uploadsStatus[upload.id] === 'processing') && (upload.type != 'video' || !upload.videos) && !upload.deleted && !wpsPreview(upload)">&nbsp;</span>
    </div>
    <div class="attachment-column column attachment-deleted large-5" ng-if="upload.deleted">
        <span>文件已删除</span>
    </div>
    <div class="attachment-column column attachment-size attachment-marked"
         ng-class="{'large-7': true, 'large-10': !true}"
         ng-init="isUploadFailed = (upload.status || uploadsStatus[upload.id]) == 'failed';
                  isUploadProcessing = (upload.status || uploadsStatus[upload.id]) == 'processing';
                  isNotVideo = upload.type != 'video' || !upload.videos;
                  showFileSize = !isUploadFailed && !isUploadProcessing && upload.size >= 0">
        <span ng-if="upload.source == 'LARK'" style="height: 1px;">——</span>
        <span ng-if="upload.source != 'LARK' && showFileSize" ng-bind="upload.size|humanizeBytes"></span>
        <span ng-if="upload.source != 'LARK' && !showFileSize && !upload.deleted">
            <span ng-if="isUploadFailed" class="attachment-state-failed">
                    转码失败
            </span>
            <span ng-if="isUploadProcessing && isNotVideo && !wpsPreview(upload)" class="attachment-state-processing">
                    正在转码中
            </span>
        </span>
        <div ng-if="upload.type=='scorm' && upload.scorm">
            教材大小:<span ng-bind="upload.scorm.files_size|humanizeBytes"></span>
        </div>
        <div ng-if="upload.type=='slide' && upload.duration">
            时长:<span ng-bind="upload.duration | formatTime"></span>
        </div>
    </div>



        <div ng-if="airHelper.canShowAttachmentQuestion(activity) === true" class="attachment-column column large-2">
            <span class="aiQuiz-content">
                [[upload.aiQuiz.subjectsCount || "--"]]
            </span>
        </div>

    <div class="attachment-column column"
         ng-class="{'large-7': true, 'large-5': !true}">
<span class="attachment-operations">
        <div class="horizon">



            <a target="_blank" ng-if="upload.source == 'LARK'" ng-href="[[upload.url]]" tipsy-literal="预览">
                <i class="font font-table-edit-view-2"></i>
            </a>
            <a stop-propagation previewer="{uploads: uploads, currentFile: upload, activity: activity, canAddNote: true}" reveal-modal="file-previewer-with-note"
                tipsy-literal="预览" ng-click="downloadBlob(activity, upload, 'view')"
                ng-if="upload.source != 'LARK' && canPreview(upload) && !upload.deleted && canShowResource(upload, isInstructorView)">
                <i class="font font-table-edit-view-2"></i>
            </a>
        <a ng-click="openSobeyVideo()" ng-if="upload.source==='sobey'">
            <i class="font font-table-edit-view-2"></i>
        </a>
                <a stop-propagation ng-href="/api/uploads/reference/[[upload.reference_id]]/blob" target="_blank"
                    tipsy-literal="下载" ng-click="downloadBlob(activity, upload)"
                    ng-if="upload.reference_id && !upload.deleted && upload.allow_download && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
                <a stop-propagation ng-href="/api/uploads/[[upload.id]]/blob?preview=true&activity_type=[[activity.type]]" target="_blank"
                    tipsy-literal="下载" ng-click="downloadBlob(activity, upload)"
                    ng-if="!upload.reference_id && !upload.deleted && upload.allow_download && !upload.source && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
                <a stop-propagation ng-href="[[upload.url]]/download" target="_blank"
                    tipsy-literal="下载" ng-click="downloadBlob(activity, upload)"
                    ng-if="upload.source && !['LARK', 'auto-generated-pdf', 'WEDRIVE'].includes(upload.source) && !upload.reference_id && !upload.deleted && upload.allow_download && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
                <!-- 针对特殊source类型 -->
                <a stop-propagation ng-href="/api/uploads/[[upload.id]]/blob"
                    tipsy-literal="下载" ng-click="downloadBlob(activity, upload)"
                    ng-if="!upload.reference_id && !upload.deleted && upload.allow_download && ['auto-generated-pdf'].includes(upload.source) && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
                <a stop-propagation ng-href="/api/wedrive/file/[[upload.fileid]]"
                    tipsy-literal="下载"
                    ng-if="!upload.deleted && upload.allow_download && upload.source == 'WEDRIVE' && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
        </div>
</span>    </div>

</div>

<div class="attachment-row clearfix" ng-if="!canPreview(upload) || upload.deleted || !canShowResource(upload, isInstructorView)" ng-click="downloadWeDrive(upload)">


    <div class="attachment-column column large-10" ng-if="upload.type != 'slide'" ng-class="{'large-20':upload.source === 'sobey'}">
        <div ng-if="upload.source == 'auto-generated-pdf'">
            <svg class="file-text-content left">
                <use xlink:href="#file-text-content"></use>
            </svg>
            <span class="file-name-wrapper truncate-text left">
                <span class="file-name" tipsy-literal="[[ upload.name.split('.')[0] ]]">[[ upload.name.split('.')[0] ]]</span>
            </span>
        </div>
        <div ng-if="upload.source !== 'auto-generated-pdf'" class="w-full flex">
            <i class="font font-file-[[fileTypeByExtension(upload)]] left"></i>
            <span class="file-name-wrapper truncate-text left">
                <span class="file-name" tipsy-literal="[[ upload.name ]]" ng-bind="upload.name|fileName"></span>
            </span>
            <span class="file-extension left" ng-bind="upload.name|fileExtension"></span>
        </div>
    </div>
    <div class="attachment-column column large-10" ng-if="upload.type == 'slide'">
        <i class="font font-slide left"></i>
        <span class="file-name-wrapper truncate-text left">
            <span class="file-name" tipsy-literal="[[ upload.title ]]" ng-bind="upload.title|fileName"></span>
        </span>
    </div>
        <div class="attachment-column column attachment-state" ng-if="!upload.deleted && upload.source !== 'sobey'"
            ng-class="{'large-1': true, 'large-5': !true}">
        <span ng-if="!upload.status || upload.status === 'ready' || (upload.status === 'processing' && (upload.type === 'video' || upload.videos)) || upload.status === 'none' || upload.deleted || wpsPreview(upload)">&nbsp;</span>
        <span ng-if="(upload.status === 'failed' || uploadsStatus[upload.id] === 'failed') && !upload.deleted">&nbsp;</span>
        <span ng-if="(upload.status === 'processing' || uploadsStatus[upload.id] === 'processing') && (upload.type != 'video' || !upload.videos) && !upload.deleted && !wpsPreview(upload)">&nbsp;</span>
    </div>
    <div class="attachment-column column attachment-deleted large-5" ng-if="upload.deleted">
        <span>文件已删除</span>
    </div>
    <div class="attachment-column column attachment-size attachment-marked"
         ng-class="{'large-7': true, 'large-10': !true}"
         ng-init="isUploadFailed = (upload.status || uploadsStatus[upload.id]) == 'failed';
                  isUploadProcessing = (upload.status || uploadsStatus[upload.id]) == 'processing';
                  isNotVideo = upload.type != 'video' || !upload.videos;
                  showFileSize = !isUploadFailed && !isUploadProcessing && upload.size >= 0">
        <span ng-if="upload.source == 'LARK'" style="height: 1px;">——</span>
        <span ng-if="upload.source != 'LARK' && showFileSize" ng-bind="upload.size|humanizeBytes"></span>
        <span ng-if="upload.source != 'LARK' && !showFileSize && !upload.deleted">
            <span ng-if="isUploadFailed" class="attachment-state-failed">
                    转码失败
            </span>
            <span ng-if="isUploadProcessing && isNotVideo && !wpsPreview(upload)" class="attachment-state-processing">
                    正在转码中
            </span>
        </span>
        <div ng-if="upload.type=='scorm' && upload.scorm">
            教材大小:<span ng-bind="upload.scorm.files_size|humanizeBytes"></span>
        </div>
        <div ng-if="upload.type=='slide' && upload.duration">
            时长:<span ng-bind="upload.duration | formatTime"></span>
        </div>
    </div>



        <div ng-if="airHelper.canShowAttachmentQuestion(activity) === true" class="attachment-column column large-2">
            <span class="aiQuiz-content">
                [[upload.aiQuiz.subjectsCount || "--"]]
            </span>
        </div>

    <div class="attachment-column column"
         ng-class="{'large-7': true, 'large-5': !true}">
<span class="attachment-operations">
        <div class="horizon">



            <a target="_blank" ng-if="upload.source == 'LARK'" ng-href="[[upload.url]]" tipsy-literal="预览">
                <i class="font font-table-edit-view-2"></i>
            </a>
            <a stop-propagation previewer="{uploads: uploads, currentFile: upload, activity: activity, canAddNote: true}" reveal-modal="file-previewer-with-note"
                tipsy-literal="预览" ng-click="downloadBlob(activity, upload, 'view')"
                ng-if="upload.source != 'LARK' && canPreview(upload) && !upload.deleted && canShowResource(upload, isInstructorView)">
                <i class="font font-table-edit-view-2"></i>
            </a>
        <a ng-click="openSobeyVideo()" ng-if="upload.source==='sobey'">
            <i class="font font-table-edit-view-2"></i>
        </a>
                <a stop-propagation ng-href="/api/uploads/reference/[[upload.reference_id]]/blob" target="_blank"
                    tipsy-literal="下载" ng-click="downloadBlob(activity, upload)"
                    ng-if="upload.reference_id && !upload.deleted && upload.allow_download && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
                <a stop-propagation ng-href="/api/uploads/[[upload.id]]/blob?preview=true&activity_type=[[activity.type]]" target="_blank"
                    tipsy-literal="下载" ng-click="downloadBlob(activity, upload)"
                    ng-if="!upload.reference_id && !upload.deleted && upload.allow_download && !upload.source && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
                <a stop-propagation ng-href="[[upload.url]]/download" target="_blank"
                    tipsy-literal="下载" ng-click="downloadBlob(activity, upload)"
                    ng-if="upload.source && !['LARK', 'auto-generated-pdf', 'WEDRIVE'].includes(upload.source) && !upload.reference_id && !upload.deleted && upload.allow_download && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
                <!-- 针对特殊source类型 -->
                <a stop-propagation ng-href="/api/uploads/[[upload.id]]/blob"
                    tipsy-literal="下载" ng-click="downloadBlob(activity, upload)"
                    ng-if="!upload.reference_id && !upload.deleted && upload.allow_download && ['auto-generated-pdf'].includes(upload.source) && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
                <a stop-propagation ng-href="/api/wedrive/file/[[upload.fileid]]"
                    tipsy-literal="下载"
                    ng-if="!upload.deleted && upload.allow_download && upload.source == 'WEDRIVE' && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
        </div>
</span>    </div>

</div>        </div>
    </div>
</div>                            </div>
                    </div>
                    <div ng-switch-when="web_link">
                        <div class="item-title truncate-text">
                            <i class="font font-web-link"></i>
                            <a tipsy="activity.title" ng-href="/course/[[course.id]]/learning-activity#/[[activity.id]]?from=dashboard"
                               ng-bind="activity.title"></a>
                        </div>
        <div class="activity-prerequisites" ng-if="activity && activityHasNotFinishedPrerequisite(activity)"
             ng-mouseenter="resetPrerequisitesTipsPosition($event)">
<div id="prerequisites-confirmation-popup-[[activity.type]]-[[activity.id]]" data-reveal
     class="reveal-modal prerequisites-confirmation-popup popup-area popup-480">
    <div class="popup-content">
        <div class="popup-header">
            <span>开启条件</span>
            <a class="right" close-popup="prerequisites-confirmation-popup-[[activity.type]]-[[activity.id]]">
                <i class="font font-close"></i>
            </a>
        </div>
        <div class="main-area">
            <div ng-repeat="prerequisite in activity.prerequisites" class="prerequisite"
                 ng-class="{'finished': prerequisite.completion_criterion.has_completed && prerequisite.completion_criterion.is_in_progress,
                            'invalid': !prerequisite.completion_criterion.published || !prerequisite.completion_criterion.is_in_progress}">
<span class="activity-type" ng-switch="prerequisite.activity_type">
<span ng-switch-when="homework">作业</span>
<span ng-switch-when="material">参考资料</span>
<span ng-switch-when="web_link">线上链接</span>
<span ng-switch-when="online_video">音视频教材</span>
<span ng-switch-when="interaction">互动教材</span>
<span ng-switch-when="lesson">录播教材</span>
<span ng-switch-when="slide">微课</span>
<span ng-switch-when="forum">讨论</span>
<span ng-switch-when="exam">测试</span>
<span ng-switch-when="chatroom">iSlide 直播</span>
<span ng-switch-when="virtual_classroom">Connect 直播</span>
<span ng-switch-when="questionnaire">调查问卷</span>
<span ng-switch-when="page">页面</span>
<span ng-switch-when="scorm">第三方教材</span></span>
<div class="truncate-text activity-title">
    <span ng-bind="prerequisite.title" tipsy="prerequisite.title"></span>
</div>
<span class="activity-read-info">
    (<span ng-bind="prerequisite.completion_criterion.completion_info"></span>)
</span>
<div ng-bind="prerequisite.completion_criterion.criterion_text"
     class="activity-completion-criterion">
</div>            </div>
        </div>
        <div class="popup-footer">
            <div class="form-buttons">
                <button class="button button-green medium"
                        close-popup="prerequisites-confirmation-popup-[[activity.type]]-[[activity.id]]">确定</button>
            </div>
        </div>
    </div>
</div>            <activity-checkpoint-lock class="is-locked"></activity-checkpoint-lock>
            <div class="prerequisites-tips">
                <div class="title">开启条件</div>
                <div ng-repeat="prerequisite in activity.prerequisites" class="prerequisite"
                     ng-class="{'finished': prerequisite.completion_criterion.has_completed && prerequisite.completion_criterion.is_in_progress,
                                'invalid': !prerequisite.completion_criterion.published || !prerequisite.completion_criterion.is_in_progress}">
<span class="activity-type" ng-switch="prerequisite.activity_type">
<span ng-switch-when="homework">作业</span>
<span ng-switch-when="material">参考资料</span>
<span ng-switch-when="web_link">线上链接</span>
<span ng-switch-when="online_video">音视频教材</span>
<span ng-switch-when="interaction">互动教材</span>
<span ng-switch-when="lesson">录播教材</span>
<span ng-switch-when="slide">微课</span>
<span ng-switch-when="forum">讨论</span>
<span ng-switch-when="exam">测试</span>
<span ng-switch-when="chatroom">iSlide 直播</span>
<span ng-switch-when="virtual_classroom">Connect 直播</span>
<span ng-switch-when="questionnaire">调查问卷</span>
<span ng-switch-when="page">页面</span>
<span ng-switch-when="scorm">第三方教材</span></span>
<div class="truncate-text activity-title">
    <span ng-bind="prerequisite.title" tipsy="prerequisite.title"></span>
</div>
<span class="activity-read-info">
    (<span ng-bind="prerequisite.completion_criterion.completion_info"></span>)
</span>
<div ng-bind="prerequisite.completion_criterion.criterion_text"
     class="activity-completion-criterion">
</div>                </div>
            </div>
        </div>
                        <span class="right" ng-if="activity.end_time" ng-bind="activity.end_time | datetime"></span>
                    </div>
                    <div ng-switch-when="online_video">
                        <div class="item-title truncate-text">
                            <i class="font font-online-video"></i>
                            <a tipsy="activity.title" ng-href="/course/[[course.id]]/learning-activity#/[[activity.id]]?from=dashboard"
                               ng-bind="activity.title"></a>
                        </div>
        <div class="activity-prerequisites" ng-if="activity && activityHasNotFinishedPrerequisite(activity)"
             ng-mouseenter="resetPrerequisitesTipsPosition($event)">
<div id="prerequisites-confirmation-popup-[[activity.type]]-[[activity.id]]" data-reveal
     class="reveal-modal prerequisites-confirmation-popup popup-area popup-480">
    <div class="popup-content">
        <div class="popup-header">
            <span>开启条件</span>
            <a class="right" close-popup="prerequisites-confirmation-popup-[[activity.type]]-[[activity.id]]">
                <i class="font font-close"></i>
            </a>
        </div>
        <div class="main-area">
            <div ng-repeat="prerequisite in activity.prerequisites" class="prerequisite"
                 ng-class="{'finished': prerequisite.completion_criterion.has_completed && prerequisite.completion_criterion.is_in_progress,
                            'invalid': !prerequisite.completion_criterion.published || !prerequisite.completion_criterion.is_in_progress}">
<span class="activity-type" ng-switch="prerequisite.activity_type">
<span ng-switch-when="homework">作业</span>
<span ng-switch-when="material">参考资料</span>
<span ng-switch-when="web_link">线上链接</span>
<span ng-switch-when="online_video">音视频教材</span>
<span ng-switch-when="interaction">互动教材</span>
<span ng-switch-when="lesson">录播教材</span>
<span ng-switch-when="slide">微课</span>
<span ng-switch-when="forum">讨论</span>
<span ng-switch-when="exam">测试</span>
<span ng-switch-when="chatroom">iSlide 直播</span>
<span ng-switch-when="virtual_classroom">Connect 直播</span>
<span ng-switch-when="questionnaire">调查问卷</span>
<span ng-switch-when="page">页面</span>
<span ng-switch-when="scorm">第三方教材</span></span>
<div class="truncate-text activity-title">
    <span ng-bind="prerequisite.title" tipsy="prerequisite.title"></span>
</div>
<span class="activity-read-info">
    (<span ng-bind="prerequisite.completion_criterion.completion_info"></span>)
</span>
<div ng-bind="prerequisite.completion_criterion.criterion_text"
     class="activity-completion-criterion">
</div>            </div>
        </div>
        <div class="popup-footer">
            <div class="form-buttons">
                <button class="button button-green medium"
                        close-popup="prerequisites-confirmation-popup-[[activity.type]]-[[activity.id]]">确定</button>
            </div>
        </div>
    </div>
</div>            <activity-checkpoint-lock class="is-locked"></activity-checkpoint-lock>
            <div class="prerequisites-tips">
                <div class="title">开启条件</div>
                <div ng-repeat="prerequisite in activity.prerequisites" class="prerequisite"
                     ng-class="{'finished': prerequisite.completion_criterion.has_completed && prerequisite.completion_criterion.is_in_progress,
                                'invalid': !prerequisite.completion_criterion.published || !prerequisite.completion_criterion.is_in_progress}">
<span class="activity-type" ng-switch="prerequisite.activity_type">
<span ng-switch-when="homework">作业</span>
<span ng-switch-when="material">参考资料</span>
<span ng-switch-when="web_link">线上链接</span>
<span ng-switch-when="online_video">音视频教材</span>
<span ng-switch-when="interaction">互动教材</span>
<span ng-switch-when="lesson">录播教材</span>
<span ng-switch-when="slide">微课</span>
<span ng-switch-when="forum">讨论</span>
<span ng-switch-when="exam">测试</span>
<span ng-switch-when="chatroom">iSlide 直播</span>
<span ng-switch-when="virtual_classroom">Connect 直播</span>
<span ng-switch-when="questionnaire">调查问卷</span>
<span ng-switch-when="page">页面</span>
<span ng-switch-when="scorm">第三方教材</span></span>
<div class="truncate-text activity-title">
    <span ng-bind="prerequisite.title" tipsy="prerequisite.title"></span>
</div>
<span class="activity-read-info">
    (<span ng-bind="prerequisite.completion_criterion.completion_info"></span>)
</span>
<div ng-bind="prerequisite.completion_criterion.criterion_text"
     class="activity-completion-criterion">
</div>                </div>
            </div>
        </div>
                        <span class="right" ng-if="activity.end_time" ng-bind="activity.end_time | datetime"></span>
                    </div>
                    <div ng-switch-when="slide">
                        <div class="item-title truncate-text">
                            <i class="font font-slide"></i>
                            <a tipsy="activity.title" ng-href="/course/[[course.id]]/learning-activity#/[[activity.id]]?from=dashboard"
                               ng-bind="activity.title"></a>
                        </div>
        <div class="activity-prerequisites" ng-if="activity && activityHasNotFinishedPrerequisite(activity)"
             ng-mouseenter="resetPrerequisitesTipsPosition($event)">
<div id="prerequisites-confirmation-popup-[[activity.type]]-[[activity.id]]" data-reveal
     class="reveal-modal prerequisites-confirmation-popup popup-area popup-480">
    <div class="popup-content">
        <div class="popup-header">
            <span>开启条件</span>
            <a class="right" close-popup="prerequisites-confirmation-popup-[[activity.type]]-[[activity.id]]">
                <i class="font font-close"></i>
            </a>
        </div>
        <div class="main-area">
            <div ng-repeat="prerequisite in activity.prerequisites" class="prerequisite"
                 ng-class="{'finished': prerequisite.completion_criterion.has_completed && prerequisite.completion_criterion.is_in_progress,
                            'invalid': !prerequisite.completion_criterion.published || !prerequisite.completion_criterion.is_in_progress}">
<span class="activity-type" ng-switch="prerequisite.activity_type">
<span ng-switch-when="homework">作业</span>
<span ng-switch-when="material">参考资料</span>
<span ng-switch-when="web_link">线上链接</span>
<span ng-switch-when="online_video">音视频教材</span>
<span ng-switch-when="interaction">互动教材</span>
<span ng-switch-when="lesson">录播教材</span>
<span ng-switch-when="slide">微课</span>
<span ng-switch-when="forum">讨论</span>
<span ng-switch-when="exam">测试</span>
<span ng-switch-when="chatroom">iSlide 直播</span>
<span ng-switch-when="virtual_classroom">Connect 直播</span>
<span ng-switch-when="questionnaire">调查问卷</span>
<span ng-switch-when="page">页面</span>
<span ng-switch-when="scorm">第三方教材</span></span>
<div class="truncate-text activity-title">
    <span ng-bind="prerequisite.title" tipsy="prerequisite.title"></span>
</div>
<span class="activity-read-info">
    (<span ng-bind="prerequisite.completion_criterion.completion_info"></span>)
</span>
<div ng-bind="prerequisite.completion_criterion.criterion_text"
     class="activity-completion-criterion">
</div>            </div>
        </div>
        <div class="popup-footer">
            <div class="form-buttons">
                <button class="button button-green medium"
                        close-popup="prerequisites-confirmation-popup-[[activity.type]]-[[activity.id]]">确定</button>
            </div>
        </div>
    </div>
</div>            <activity-checkpoint-lock class="is-locked"></activity-checkpoint-lock>
            <div class="prerequisites-tips">
                <div class="title">开启条件</div>
                <div ng-repeat="prerequisite in activity.prerequisites" class="prerequisite"
                     ng-class="{'finished': prerequisite.completion_criterion.has_completed && prerequisite.completion_criterion.is_in_progress,
                                'invalid': !prerequisite.completion_criterion.published || !prerequisite.completion_criterion.is_in_progress}">
<span class="activity-type" ng-switch="prerequisite.activity_type">
<span ng-switch-when="homework">作业</span>
<span ng-switch-when="material">参考资料</span>
<span ng-switch-when="web_link">线上链接</span>
<span ng-switch-when="online_video">音视频教材</span>
<span ng-switch-when="interaction">互动教材</span>
<span ng-switch-when="lesson">录播教材</span>
<span ng-switch-when="slide">微课</span>
<span ng-switch-when="forum">讨论</span>
<span ng-switch-when="exam">测试</span>
<span ng-switch-when="chatroom">iSlide 直播</span>
<span ng-switch-when="virtual_classroom">Connect 直播</span>
<span ng-switch-when="questionnaire">调查问卷</span>
<span ng-switch-when="page">页面</span>
<span ng-switch-when="scorm">第三方教材</span></span>
<div class="truncate-text activity-title">
    <span ng-bind="prerequisite.title" tipsy="prerequisite.title"></span>
</div>
<span class="activity-read-info">
    (<span ng-bind="prerequisite.completion_criterion.completion_info"></span>)
</span>
<div ng-bind="prerequisite.completion_criterion.criterion_text"
     class="activity-completion-criterion">
</div>                </div>
            </div>
        </div>
                        <span class="right" ng-if="activity.end_time" ng-bind="activity.end_time | datetime"></span>
                    </div>
                    <div ng-switch-when="page">
                        <div class="item-title truncate-text">
                            <i class="font font-page"></i>
                            <a tipsy="activity.title" ng-href="/course/[[course.id]]/learning-activity#/[[activity.id]]?from=dashboard"
                               ng-bind="activity.title"></a>
                        </div>
        <div class="activity-prerequisites" ng-if="activity && activityHasNotFinishedPrerequisite(activity)"
             ng-mouseenter="resetPrerequisitesTipsPosition($event)">
<div id="prerequisites-confirmation-popup-[[activity.type]]-[[activity.id]]" data-reveal
     class="reveal-modal prerequisites-confirmation-popup popup-area popup-480">
    <div class="popup-content">
        <div class="popup-header">
            <span>开启条件</span>
            <a class="right" close-popup="prerequisites-confirmation-popup-[[activity.type]]-[[activity.id]]">
                <i class="font font-close"></i>
            </a>
        </div>
        <div class="main-area">
            <div ng-repeat="prerequisite in activity.prerequisites" class="prerequisite"
                 ng-class="{'finished': prerequisite.completion_criterion.has_completed && prerequisite.completion_criterion.is_in_progress,
                            'invalid': !prerequisite.completion_criterion.published || !prerequisite.completion_criterion.is_in_progress}">
<span class="activity-type" ng-switch="prerequisite.activity_type">
<span ng-switch-when="homework">作业</span>
<span ng-switch-when="material">参考资料</span>
<span ng-switch-when="web_link">线上链接</span>
<span ng-switch-when="online_video">音视频教材</span>
<span ng-switch-when="interaction">互动教材</span>
<span ng-switch-when="lesson">录播教材</span>
<span ng-switch-when="slide">微课</span>
<span ng-switch-when="forum">讨论</span>
<span ng-switch-when="exam">测试</span>
<span ng-switch-when="chatroom">iSlide 直播</span>
<span ng-switch-when="virtual_classroom">Connect 直播</span>
<span ng-switch-when="questionnaire">调查问卷</span>
<span ng-switch-when="page">页面</span>
<span ng-switch-when="scorm">第三方教材</span></span>
<div class="truncate-text activity-title">
    <span ng-bind="prerequisite.title" tipsy="prerequisite.title"></span>
</div>
<span class="activity-read-info">
    (<span ng-bind="prerequisite.completion_criterion.completion_info"></span>)
</span>
<div ng-bind="prerequisite.completion_criterion.criterion_text"
     class="activity-completion-criterion">
</div>            </div>
        </div>
        <div class="popup-footer">
            <div class="form-buttons">
                <button class="button button-green medium"
                        close-popup="prerequisites-confirmation-popup-[[activity.type]]-[[activity.id]]">确定</button>
            </div>
        </div>
    </div>
</div>            <activity-checkpoint-lock class="is-locked"></activity-checkpoint-lock>
            <div class="prerequisites-tips">
                <div class="title">开启条件</div>
                <div ng-repeat="prerequisite in activity.prerequisites" class="prerequisite"
                     ng-class="{'finished': prerequisite.completion_criterion.has_completed && prerequisite.completion_criterion.is_in_progress,
                                'invalid': !prerequisite.completion_criterion.published || !prerequisite.completion_criterion.is_in_progress}">
<span class="activity-type" ng-switch="prerequisite.activity_type">
<span ng-switch-when="homework">作业</span>
<span ng-switch-when="material">参考资料</span>
<span ng-switch-when="web_link">线上链接</span>
<span ng-switch-when="online_video">音视频教材</span>
<span ng-switch-when="interaction">互动教材</span>
<span ng-switch-when="lesson">录播教材</span>
<span ng-switch-when="slide">微课</span>
<span ng-switch-when="forum">讨论</span>
<span ng-switch-when="exam">测试</span>
<span ng-switch-when="chatroom">iSlide 直播</span>
<span ng-switch-when="virtual_classroom">Connect 直播</span>
<span ng-switch-when="questionnaire">调查问卷</span>
<span ng-switch-when="page">页面</span>
<span ng-switch-when="scorm">第三方教材</span></span>
<div class="truncate-text activity-title">
    <span ng-bind="prerequisite.title" tipsy="prerequisite.title"></span>
</div>
<span class="activity-read-info">
    (<span ng-bind="prerequisite.completion_criterion.completion_info"></span>)
</span>
<div ng-bind="prerequisite.completion_criterion.criterion_text"
     class="activity-completion-criterion">
</div>                </div>
            </div>
        </div>
                        <span class="right" ng-if="activity.end_time" ng-bind="activity.end_time | datetime"></span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="show-all-wrapper ng-cloak" ng-show="coursesWithLatestMaterial.length > 3">
        <a class="show-all text-center" ng-if="!ui.shownAllLatestMaterialCourses" ng-click="ui.shownAllLatestMaterialCourses=true">
            <span>展开更多</span>
            <i class="icon icon-arrow-down"></i>
        </a>
        <a class="show-all text-center" ng-if="ui.shownAllLatestMaterialCourses" ng-click="ui.shownAllLatestMaterialCourses=false">
            <span>收起内容</span>
            <i class="icon icon-arrow-down flip"></i>
        </a>
    </div>
    <div class="no-content" ng-if="!latestMaterialNumber">
        <div class="text-center">最近没有新教材发布</div>
        <i class="dashboard-blank-icon font font-course-material"></i>
    </div>
<div id="file-previewer-with-note" ng-controller="FilePreviewerController"
     class="pdf-reader-wrapper reveal-modal popup-area"
     resetable data-reveal data-options="multiple_opened:true" ng-init="fileAddNote=true">
    <div class="popup-content">
        <div class="pdf-reader-detail">
            <div class="header clearfix">
                <span class="title truncate-text left">
                    <span ng-bind="upload.name|fileName" tipsy="upload.name"></span>
                </span>
                <span class="file-extension left" ng-bind="upload.name|fileExtension"></span>
                <span>
                    <span class="cc-license"
                    ng-class="{'cc-license-default': upload.cc_license_code == 'private'}"
                    ng-if="upload.cc_license_code && upload.cc_license_code == 'private'"
                    tipsy="upload.cc_license_description" tipsy-ellipsis="no">
                        <svg-icon name="license-[[upload.cc_license_code]]"></svg-icon>
                    </span>
                    <a class="cc-license"
                        ng-href="[[upload.cc_license_link]]" target="_blank"
                        ng-class="{'cc-license-default': upload.cc_license_code == 'public_domain'}"
                        ng-if="upload.cc_license_code && upload.cc_license_code != 'private'"
                        tipsy="upload.cc_license_description" tipsy-ellipsis="no">
                        <svg-icon name="license-[[upload.cc_license_code]]"></svg-icon>
                    </a>
                </span>
                <div class="file-preview-actions right">
                    <div class="file-preview-view-mode" ng-if="viewMode.enablePreviewMode(upload)">
                        <input type="radio" name="view-mode" value='preview' id="view-mode" checked="checked" ng-model='viewMode.mode'>
                        <label for='view-mode'> 预览模式 </label>
                        <input type="radio" name="view-mode" value='normal' id='note-mode' ng-model='viewMode.mode'>
                        <label for='note-mode'> 笔记模式 </label>
                    </div>
                    <span class="ai-quiz-panel" ng-class="{'prompt-btn': ui.showAnswerPrompt === true}" ng-if="ui.showAiQuizPanelBtn && upload.aiQuiz.id" ng-click="showAiQuizPanel(false)">
                        <svg-icon name="information-title" class="panel-icon"></svg-icon>
                        <span>[[$t("air.answer")]]
                            <!-- <span ng-if="upload.aiQuiz.subjectsCount">([[upload.aiQuiz.subjectsCount]])</span> -->
                        </span>
                        <div class="prompt-content" ng-if="ui.showAnswerPrompt">
                            <svg-icon name="solid-triangle" class="icon-triangle"></svg-icon>
                            <div class="document-answer">
                                <div class="flex">
                                    <svg-icon name="air-answer" class="air-answer"></svg-icon>
                                    <span>自测答题</span>
                                </div>
                            </div>
                            <div class="prompt-title">自测答题</div>
                            <div class="prompt-desc">该文件添加了题目，可以进行答题自测哦~</div>
                        </div>
                    </span>

                    <prompt-modal content-desc="看完课件，可以进行答题自测哦~" confirm-text="去答题"></prompt-modal>
                    <span class="question-panel" ng-if="ui.showQuestionPanelBtn" ng-click="showQuestionPanel()">
                        <svg-icon name="question" class="panel-icon"></svg-icon>
                        <span>疑问&nbsp;([[ui.commentsCount]])</span>
                    </span>
                </div>
                <a class="right close"  ng-click="manualClosePreviewer()"><i class="font font-close"></i></a>
            </div>
            <div ng-if="upload.type != 'video-quiz'" class="content"
                 ng-controller="FilePreviewNoteController" ng-class="{'zooming-content': ui.showQuestionPanel === true || ui.showAiQuizPanel === true}">
<div class="file-previewer zooming" ng-if="upload" ng-cloak>
    <div class="bd clearfix">
        <div class="org-transfer-arrears" ng-if="isOrgArrears && ui.urlLoaded">
            <span>平台套餐已过期或流量不足，暂无法查看该平台资源</span>
        </div>
        <div ng-if="viewMode.mode==='normal'" class="reader-wrapper">
            <div ng-if="!isOrgArrears && ui.urlLoaded" class="reader-wrapper" ng-class="{'full-screen': ui.fullScreen}">
                <div class="toolbar" ng-if="(isIE9 || !(upload.type == 'document' && upload.status == 'ready')) && !wpsPreview(upload)">
<div class="toolbar-buttons"
     ng-class="{'pdf-view': upload.type == 'document', 'none-border-toolbar':upload.status != 'ready' || isIE9 || upload.isTextFile }">
    <a title="缩小" ng-click="zoomOut()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-zoom-out"></i>
    </a>
    <span class="separator" ng-if="upload.type == 'image'"></span>
    <a title="放大" ng-click="zoomIn()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-zoom-in"></i>
    </a>
    <a title="逆时针旋转" ng-click="rotateImg()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-rotate"></i>
    </a>
    <a title="复原" ng-click="restoreImg()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-restore"></i>
    </a>
    <a ng-if="forceShowDownloadButton && upload.id && upload.type != 'link' && !upload.isFromKnowledgeGraph"
       ng-href="[['/api/uploads/'+upload.id+'/blob']]" title="下载" target="_blank">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="upload.from_project && upload.allow_download"
       ng-href="[[ '/api/project/'+upload.project_id+'/share-resource/blob?upload_id='+upload.id+'&node_ids='+upload.node_ids+'&reference_id='+upload.ref_id ]]" title="下载"  target="_blank">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="!resource && !manualUrl && !canGuestPreview && upload.id && upload.type != 'link' && upload.status != 'cliping' && upload.status != 'clip_failed' && upload.status != 'uploading' && upload.status !='failed' && (upload.allow_download || (isInMyFileListPage && upload.owner_id == currentUserId)) && !upload.isFromKnowledgeGraph && !upload.from_project"
       ng-href="[[ '/api/uploads/'+upload.id+'/blob' ]]" title="下载" ng-click="downloadBlob(activity, upload)" target="_blank">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.open_scope != 'group' && !resource.share_to_id && resource.allow_download && resource.upload.status != 'uploading'" ng-click="download(resource)" title="下载">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.open_scope == 'group' && resource.allow_download && resource.upload.status != 'uploading'" ng-href="/api/shared-resources/[[resource.id]]/blob" target="_self" title="下载">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.share_to_id && resource.allow_download && resource.upload.status != 'uploading'" ng-href="/api/shared-resources-to/[[resource.id]]/blob" target="_self" title="下载">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a id="downloadManual" ng-if="!resource && manualUrl " ng-href="[[manualUrl]]"
       target="_blank" title="下载" download="manual.pdf">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="(upload.type == 'image' || upload.type == 'document' || upload.type == 'scorm') && upload.status != 'uploading' && upload.status !='failed'" ng-hide="ui.fullScreen" ng-click="enterFullScreen('.file-previewer .reader-wrapper')"
       title="进入全屏">
        <i class="icon icon-file-preview-enter-full-screen"></i>
    </a>
    <a ng-if="(upload.type == 'image' || upload.type == 'document' || upload.type == 'scorm') && upload.status != 'uploading'" ng-show="ui.fullScreen" ng-click="exitFullScreen()"
       title="退出全屏">
        <i class="icon icon-file-preview-exit-full-screen"></i>
    </a>
        <a ng-if="uploadCanAddNote(upload)" class="add-note"
           ng-disabled="!canAddNote()"
           ng-hide="ui.fullScreen" ng-click="showNoteBox()">
            <i class="font font-add-note"></i>
            笔记
        </a>
     <a class="open-in-browser" ng-if="upload.type == 'link'" ng-href="[[ upload.link.url ]]" target="_blank" title="在浏览器中打开">
        <i class="font font-open-in-browser-min"></i>
    </a>
</div>                </div>

                <div class="unsupported" ng-if="(isIE9 && upload.type == 'document') || upload.type == 'file' || upload.type == 'wmpkg'">
                    <div class="icon-resource-type">
                        <i class="font font-file-document big-file-font"></i>
                        <div class="file-info" ng-if="upload.status=='uploading'">正在传输中</div>
                        <div class="file-info">[[ upload.name ]]</div>
                        <div class="file-info"> 暂不支持该文件的预览</div>
                        <div class="file-info" ng-if="upload.type == 'wmpkg'"> 旭联智慧大师文件</div>
                        <div class="file-download-button" ng-if="forceShowDownloadButton || resource.allow_download || (upload.allow_download || upload.allowDownload || (isInMyFileListPage && upload.owner_id == currentUserId)) || (!resource && manualUrl)">
                            <a ng-if="forceShowDownloadButton && upload.id && upload.type != 'link'"
                            ng-href="[['/api/uploads/' + upload.id + '/blob?refer_type=' + upload.referType + '&refer_id=' + upload.referId]]" title="下载文件" target="_blank" class="file-download-content">
                                <i class="font font-download"></i><span>下载文件</span><span class="file-size" ng-bind="upload.size|humanizeBytes"></span>
                            </a>
                            <a ng-if="upload.from_project && (upload.allow_download || upload.allowDownload)"
                                ng-href="[[ '/api/project/'+upload.project_id+'/share-resource/blob?upload_id='+upload.id+'&node_ids='+upload.node_ids+'&reference_id='+upload.ref_id ]]" title="下载文件"  target="_blank" class="file-download-content">
                                <i class="font font-download"></i><span>下载文件</span><span class="file-size" ng-bind="upload.size|humanizeBytes"></span>
                            </a>
                            <a ng-if="!upload.from_project && !resource && !manualUrl && !canGuestPreview && upload.id && upload.type != 'link' && upload.status != 'cliping' && upload.status != 'clip_failed' && upload.status != 'uploading' && upload.status !='failed' && (upload.allow_download || upload.allowDownload || (isInMyFileListPage && upload.owner_id == currentUserId))"
                            ng-href="[[ upload.source === 'RMS'? '/api/uploads/' + upload.id + '/rms-preview' : '/api/uploads/' + upload.id + '/blob?refer_type=' + upload.referType + '&refer_id=' + upload.referId ]]" title="下载文件" ng-click="downloadBlob(activity, upload)" target="_blank" class="file-download-content">
                                <i class="font font-download"></i><span>下载文件</span><span class="file-size" ng-bind="upload.size|humanizeBytes"></span>
                            </a>
                            <a ng-if="resource && resource.open_scope != 'group' && !resource.share_to_id && resource.allow_download && resource.upload.status != 'uploading'" ng-click="download(resource)" title="下载文件" class="file-download-content">
                                <i class="font font-download"></i><span>下载文件</span><span class="file-size" ng-bind="upload.size|humanizeBytes"></span>
                            </a>
                            <a ng-if="resource && resource.open_scope == 'group' && resource.allow_download && resource.upload.status != 'uploading'" ng-href="/api/shared-resources/[[resource.id]]/blob" target="_self" title="下载文件" class="file-download-content">
                                <i class="font font-download"></i><span>下载文件</span><span class="file-size" ng-bind="upload.size|humanizeBytes"></span>
                            </a>
                            <a ng-if="resource && resource.share_to_id && resource.allow_download && resource.upload.status != 'uploading'" ng-href="/api/shared-resources-to/[[resource.id]]/blob" target="_self" title="下载文件" class="file-download-content">
                                <i class="font font-download"></i><span>下载文件</span><span class="file-size" ng-bind="upload.size|humanizeBytes"></span>
                            </a>
                            <a id="downloadManual" ng-if="!resource && manualUrl " ng-href="[[manualUrl]]"
                            target="_blank" title="下载文件" download="manual.pdf" class="file-download-content">
                                <i class="font font-download"></i><span>下载文件</span><span class="file-size" ng-bind="upload.size|humanizeBytes"></span>
                            </a>
                            <a ng-if="upload.source == 'WEDRIVE' && (upload.allow_download || upload.allowDownload)" ng-href="/api/wedrive/file/[[upload.fileid]]" target="_self" title="下载文件" class="file-download-content">
                                <i class="font font-download"></i><span>下载文件</span><span class="file-size" ng-bind="upload.size|humanizeBytes"></span>
                            </a>
                        </div>
                    </div>
                </div>

                <div class="transcode-unready" ng-if="showTranscodeUnreadyTips(upload)">
                    <div class="icon-resource-type">
                        <div ng-if="upload.status == 'file_locked'">
                            <img ng-src="/static/assets/images/large/file_locked-cf8c5024.png" class="icon-file-locked">
                            <div class="file-info"> 抱歉，该文件已进行加密故无法预览，请您下载后查看</div>
                        </div>

                        <i ng-if="upload.status != 'file_locked'" class="font font-file-[[fileTypeByExtension(upload)]] big-file-font"></i>

                        <div class="file-info" ng-if="upload.status=='uploading'">正在传输中</div>
                        <div class="file-info" ng-if="upload.status === 'processing' && uploadStatus[upload.id] === 'processing'"> 正在转码中</div>
                        <div class="file-info" ng-if="upload.status === 'failed' || uploadStatus[upload.id] === 'failed'"> 转码失败</div>
                        <div class="file-info" ng-if="upload.status == 'cliping'"> 剪辑中</div>
                        <div class="file-info" ng-if="upload.status == 'clip_failed'"> 剪輯失敗</div>
                        <div ng-if="upload.type == 'scorm' && upload.status == 'failed'">
                            <div ng-switch="error.status_code">
                                <span ng-switch-when="SCORM101">imsmanifest.xml 文件不存在 (请上传符合 SCORM 1.2 格式的 ZIP 文件)</span>
                                <span ng-switch-when="SCORM102">不支持的 SCORM 格式或版本 (请上传符合 SCORM 1.2 格式的 ZIP 文件)</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="pdf-container"
                     ng-if="!isIE9 && (upload.type == 'document' && upload.status == 'ready' && !upload.isTextFile && !wpsPreview(upload) && fileTypeByExtension(upload) !== 'ofd')">

                    <iframe id='pdf-viewer' width="100%" height='100%' frameborder="0" ng-if="upload.documentUrl"
                        ng-src="[[trustAsResourceUrl(upload.documentUrl)]]" allowfullscreen="true">
                    </iframe>
                    <div ng-if="!aliyunOfficePreview(upload)">
<div class="toolbar-buttons"
     ng-class="{'pdf-view': upload.type == 'document', 'none-border-toolbar':upload.status != 'ready' || isIE9 || upload.isTextFile }">
    <a title="缩小" ng-click="zoomOut()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-zoom-out"></i>
    </a>
    <span class="separator" ng-if="upload.type == 'image'"></span>
    <a title="放大" ng-click="zoomIn()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-zoom-in"></i>
    </a>
    <a title="逆时针旋转" ng-click="rotateImg()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-rotate"></i>
    </a>
    <a title="复原" ng-click="restoreImg()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-restore"></i>
    </a>
    <a ng-if="forceShowDownloadButton && upload.id && upload.type != 'link' && !upload.isFromKnowledgeGraph"
       ng-href="[['/api/uploads/'+upload.id+'/blob']]" title="下载" target="_blank">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="upload.from_project && upload.allow_download"
       ng-href="[[ '/api/project/'+upload.project_id+'/share-resource/blob?upload_id='+upload.id+'&node_ids='+upload.node_ids+'&reference_id='+upload.ref_id ]]" title="下载"  target="_blank">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="!resource && !manualUrl && !canGuestPreview && upload.id && upload.type != 'link' && upload.status != 'cliping' && upload.status != 'clip_failed' && upload.status != 'uploading' && upload.status !='failed' && (upload.allow_download || (isInMyFileListPage && upload.owner_id == currentUserId)) && !upload.isFromKnowledgeGraph && !upload.from_project"
       ng-href="[[ '/api/uploads/'+upload.id+'/blob' ]]" title="下载" ng-click="downloadBlob(activity, upload)" target="_blank">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.open_scope != 'group' && !resource.share_to_id && resource.allow_download && resource.upload.status != 'uploading'" ng-click="download(resource)" title="下载">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.open_scope == 'group' && resource.allow_download && resource.upload.status != 'uploading'" ng-href="/api/shared-resources/[[resource.id]]/blob" target="_self" title="下载">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.share_to_id && resource.allow_download && resource.upload.status != 'uploading'" ng-href="/api/shared-resources-to/[[resource.id]]/blob" target="_self" title="下载">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a id="downloadManual" ng-if="!resource && manualUrl " ng-href="[[manualUrl]]"
       target="_blank" title="下载" download="manual.pdf">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="(upload.type == 'image' || upload.type == 'document' || upload.type == 'scorm') && upload.status != 'uploading' && upload.status !='failed'" ng-hide="ui.fullScreen" ng-click="enterFullScreen('.file-previewer .reader-wrapper')"
       title="进入全屏">
        <i class="icon icon-file-preview-enter-full-screen"></i>
    </a>
    <a ng-if="(upload.type == 'image' || upload.type == 'document' || upload.type == 'scorm') && upload.status != 'uploading'" ng-show="ui.fullScreen" ng-click="exitFullScreen()"
       title="退出全屏">
        <i class="icon icon-file-preview-exit-full-screen"></i>
    </a>
        <a ng-if="uploadCanAddNote(upload)" class="add-note"
           ng-disabled="!canAddNote()"
           ng-hide="ui.fullScreen" ng-click="showNoteBox()">
            <i class="font font-add-note"></i>
            笔记
        </a>
     <a class="open-in-browser" ng-if="upload.type == 'link'" ng-href="[[ upload.link.url ]]" target="_blank" title="在浏览器中打开">
        <i class="font font-open-in-browser-min"></i>
    </a>
</div>                    </div>
                </div>

                <div class="odf-container" style="height: 100%;" ng-if="upload.type == 'document' && upload.status == 'ready' && fileTypeByExtension(upload) === 'ofd'">
                    <iframe id='ofd-viewer' width="100%" height='100%' frameborder="0" ng-if="upload.documentUrl"
                        ng-src="[[trustAsResourceUrl(upload.documentUrl)]]" allowfullscreen="true">
                    </iframe>
                </div>

                <div class="ppt-container"
                     ng-if="wpsPreview(upload)" ng-controller="PreviewModeController">
                    <div id="ppt-viewer" class="ppt-viewer"></div>

<div class="toolbar-buttons"
     ng-class="{'pdf-view': upload.type == 'document', 'none-border-toolbar':upload.status != 'ready' || isIE9 || upload.isTextFile }">
    <a title="缩小" ng-click="zoomOut()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-zoom-out"></i>
    </a>
    <span class="separator" ng-if="upload.type == 'image'"></span>
    <a title="放大" ng-click="zoomIn()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-zoom-in"></i>
    </a>
    <a title="逆时针旋转" ng-click="rotateImg()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-rotate"></i>
    </a>
    <a title="复原" ng-click="restoreImg()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-restore"></i>
    </a>
    <a ng-if="forceShowDownloadButton && upload.id && upload.type != 'link' && !upload.isFromKnowledgeGraph"
       ng-href="[['/api/uploads/'+upload.id+'/blob']]" title="下载" target="_blank">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="upload.from_project && upload.allow_download"
       ng-href="[[ '/api/project/'+upload.project_id+'/share-resource/blob?upload_id='+upload.id+'&node_ids='+upload.node_ids+'&reference_id='+upload.ref_id ]]" title="下载"  target="_blank">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="!resource && !manualUrl && !canGuestPreview && upload.id && upload.type != 'link' && upload.status != 'cliping' && upload.status != 'clip_failed' && upload.status != 'uploading' && upload.status !='failed' && (upload.allow_download || (isInMyFileListPage && upload.owner_id == currentUserId)) && !upload.isFromKnowledgeGraph && !upload.from_project"
       ng-href="[[ '/api/uploads/'+upload.id+'/blob' ]]" title="下载" ng-click="downloadBlob(activity, upload)" target="_blank">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.open_scope != 'group' && !resource.share_to_id && resource.allow_download && resource.upload.status != 'uploading'" ng-click="download(resource)" title="下载">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.open_scope == 'group' && resource.allow_download && resource.upload.status != 'uploading'" ng-href="/api/shared-resources/[[resource.id]]/blob" target="_self" title="下载">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.share_to_id && resource.allow_download && resource.upload.status != 'uploading'" ng-href="/api/shared-resources-to/[[resource.id]]/blob" target="_self" title="下载">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a id="downloadManual" ng-if="!resource && manualUrl " ng-href="[[manualUrl]]"
       target="_blank" title="下载" download="manual.pdf">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="(upload.type == 'image' || upload.type == 'document' || upload.type == 'scorm') && upload.status != 'uploading' && upload.status !='failed'" ng-hide="ui.fullScreen" ng-click="enterFullScreen('.file-previewer .reader-wrapper')"
       title="进入全屏">
        <i class="icon icon-file-preview-enter-full-screen"></i>
    </a>
    <a ng-if="(upload.type == 'image' || upload.type == 'document' || upload.type == 'scorm') && upload.status != 'uploading'" ng-show="ui.fullScreen" ng-click="exitFullScreen()"
       title="退出全屏">
        <i class="icon icon-file-preview-exit-full-screen"></i>
    </a>
        <a ng-if="uploadCanAddNote(upload)" class="add-note"
           ng-disabled="!canAddNote()"
           ng-hide="ui.fullScreen" ng-click="showNoteBox()">
            <i class="font font-add-note"></i>
            笔记
        </a>
     <a class="open-in-browser" ng-if="upload.type == 'link'" ng-href="[[ upload.link.url ]]" target="_blank" title="在浏览器中打开">
        <i class="font font-open-in-browser-min"></i>
    </a>
</div>                </div>

                <div class="txt-file-container" ng-if="upload.type == 'document' && upload.status == 'ready' && upload.isTextFile">
                    <div class="toolbar">
<div class="toolbar-buttons"
     ng-class="{'pdf-view': upload.type == 'document', 'none-border-toolbar':upload.status != 'ready' || isIE9 || upload.isTextFile }">
    <a title="缩小" ng-click="zoomOut()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-zoom-out"></i>
    </a>
    <span class="separator" ng-if="upload.type == 'image'"></span>
    <a title="放大" ng-click="zoomIn()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-zoom-in"></i>
    </a>
    <a title="逆时针旋转" ng-click="rotateImg()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-rotate"></i>
    </a>
    <a title="复原" ng-click="restoreImg()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-restore"></i>
    </a>
    <a ng-if="forceShowDownloadButton && upload.id && upload.type != 'link' && !upload.isFromKnowledgeGraph"
       ng-href="[['/api/uploads/'+upload.id+'/blob']]" title="下载" target="_blank">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="upload.from_project && upload.allow_download"
       ng-href="[[ '/api/project/'+upload.project_id+'/share-resource/blob?upload_id='+upload.id+'&node_ids='+upload.node_ids+'&reference_id='+upload.ref_id ]]" title="下载"  target="_blank">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="!resource && !manualUrl && !canGuestPreview && upload.id && upload.type != 'link' && upload.status != 'cliping' && upload.status != 'clip_failed' && upload.status != 'uploading' && upload.status !='failed' && (upload.allow_download || (isInMyFileListPage && upload.owner_id == currentUserId)) && !upload.isFromKnowledgeGraph && !upload.from_project"
       ng-href="[[ '/api/uploads/'+upload.id+'/blob' ]]" title="下载" ng-click="downloadBlob(activity, upload)" target="_blank">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.open_scope != 'group' && !resource.share_to_id && resource.allow_download && resource.upload.status != 'uploading'" ng-click="download(resource)" title="下载">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.open_scope == 'group' && resource.allow_download && resource.upload.status != 'uploading'" ng-href="/api/shared-resources/[[resource.id]]/blob" target="_self" title="下载">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.share_to_id && resource.allow_download && resource.upload.status != 'uploading'" ng-href="/api/shared-resources-to/[[resource.id]]/blob" target="_self" title="下载">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a id="downloadManual" ng-if="!resource && manualUrl " ng-href="[[manualUrl]]"
       target="_blank" title="下载" download="manual.pdf">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="(upload.type == 'image' || upload.type == 'document' || upload.type == 'scorm') && upload.status != 'uploading' && upload.status !='failed'" ng-hide="ui.fullScreen" ng-click="enterFullScreen('.file-previewer .reader-wrapper')"
       title="进入全屏">
        <i class="icon icon-file-preview-enter-full-screen"></i>
    </a>
    <a ng-if="(upload.type == 'image' || upload.type == 'document' || upload.type == 'scorm') && upload.status != 'uploading'" ng-show="ui.fullScreen" ng-click="exitFullScreen()"
       title="退出全屏">
        <i class="icon icon-file-preview-exit-full-screen"></i>
    </a>
        <a ng-if="uploadCanAddNote(upload)" class="add-note"
           ng-disabled="!canAddNote()"
           ng-hide="ui.fullScreen" ng-click="showNoteBox()">
            <i class="font font-add-note"></i>
            笔记
        </a>
     <a class="open-in-browser" ng-if="upload.type == 'link'" ng-href="[[ upload.link.url ]]" target="_blank" title="在浏览器中打开">
        <i class="font font-open-in-browser-min"></i>
    </a>
</div>                    </div>
                    <div class='txt-file-content pre-wrap' ng-bind="upload.textContent" ng-if='upload.textContent'>
                    </div>
                </div>

                <div class="img-container" ng-if="upload.type == 'image' && upload.source !== 'RMS' && (!upload.status || upload.status == 'ready' || upload.status != 3)">
                    <img ng-cloak ng-if="!isVisitor && !resourceId" ng-src="[[upload.url || '/api/uploads/' + upload.id + '/blob?preview=true&refer_type=' + upload.referType + '&refer_id=' + upload.referId]]">
                    <img ng-cloak ng-if="isVisitor && activity && !upload.source" ng-src="[[upload.url || '/anonymous-api/' + activity.id + '/uploads/' + upload.id + '/blob?preview=true']]">
                    <img ng-cloak ng-if="isVisitor && activity && upload.source" ng-src="[[upload.imageUrl]]">
                    <img ng-cloak ng-if="!activity && resourceId" ng-src="[['/' + apiPrefix + '/shared-resources/' + resourceId + '/preview?preview=true']]">
                </div>
                <div class="img-container" ng-if="upload.type == 'image' && upload.source === 'RMS' && (!upload.status || upload.status == 'ready' || upload.status != 3)">
                    <img ng-cloak ng-if="upload.source === 'RMS'" ng-src="[[upload.imageUrl]]">
                </div>
                <div class="video-container" ng-if="(upload.type == 'video' && upload.video_urls) || (upload.type == 'other' && upload.video_url && upload.status == 'ready')">
                        <div id="video" class="video-player">
                            <div id="wg-video-player"
                                wg-video-player
                                style="height:calc(100% - 16px);overflow: unset;"
                                resolutions="{'ORIGINAL': '原画', 'HD': '1080p', 'VGA': '720p', 'QVGA': '480p'}"
                                default-resolution="'HD'"
                                upload="upload"
                                resource="resource"
                                video-src-type="upload.video_src_type"
                                video-urls="upload.video_urls"
                                download="false"
                                disable-track="true"
                                customize-height="true"
                                org-code="'1'"
                                enable-chapter="false"
                                enable-aisk="false"
                                chapter-permission="upload.chapter_permission"
                                enable-caption="false"
                                caption-permission="upload.caption_permission"
                                enable-topic="false"
                                topic-permission="upload.topic_permission"
                                video-editor-server='https://courses.zju.edu.cn/video-editor'
                                enable-play-rate=True
                                caption-paragraph-split-interval=5000
                                caption-translate-permission="upload.caption_translate_permission"
                                    player-initiated="playerInitiated(player)"
                            ></div>
                        </div>

                    <div id="cc_video" class="video-player" ng-if="upload.is_cc_video && upload.status == 'ready'"
                         ng-bind-html="upload.play_code | trustAsHtml">
                    </div>
                </div>

                <div class="video-container" ng-if="upload.type == 'other' && upload.page_url && upload.status == 'ready'">
                    <div class="lesson-resource-preview">
                        <iframe id="lessonResourceIframe" frameborder="0"
                                ng-src="[[ trustAsResourceUrl(upload.page_url) ]]"
                                ng-style="iframeStyle"
                                allowfullscreen width="100%" height="100%">
                        </iframe>
                    </div>
                </div>

                <div class="audio-container" ng-if="upload.type == 'audio' && upload.status == 'ready' && audioUrl">
<div class="audio-wrapper" ng-controller="AudioPlayCtrl"
     ng-init="forwardSeekingWarning='教师已设置观看该视频不能快进';init()"
     before-controller="pauseWhenLeavingWindow = false;">
    <div class="music-note" ng-click="togglePlay($event)">
        <i class="font font-music"></i>
    </div>
    <div class="audio-player-wrapper">
        <div class="play">
            <a ng-click="togglePlay($event)">
                <i class="font" ng-class="ui.isPlaying ? 'font-audio-pause' : 'font-audio-play'"></i>
            </a>
        </div>
        <div class="current-time">
            <span class="current">[[ ui.currentTimeStr ]]</span>
        </div>
        <div class="slider-bar"
             ng-mousemove="refreshPos($event)"
             ng-mouseleave="deleteClass()">
            <div class="audio-slider"></div>
            <div class="audio-slider-mask"
                 ng-style="{width: ui.maskWidth + 'px'}"></div>
            <div class="slider-tip" ng-bind="sliderTip ? sliderTip : forwardSeekingWarning"></div>
            <div class="slider-tip-arrow"></div>
            <div class="slider-tip-line"></div>
        </div>
        <div class="time-divider">
            <span>/</span>
        </div>
        <div class="duration">
            <span>[[ ui.durationStr ]]</span>
        </div>
        <div class="download" ng-if="allow_download && !activity.uploads[0].deleted && !upload.source">
            <a ng-href="/api/uploads/[[activity.uploads[0].id]]/blob">
                <i class="font font-audio-download"></i>
            </a>
        </div>
        <div class="download" ng-if="allow_download && !activity.uploads[0].deleted && upload.source">
            <a ng-href="[[upload.url]]/download">
                <i class="font font-audio-download"></i>
            </a>
        </div>
        <div class="description" ng-if="activity.data['description']">
            <i class="font font-audio-desc"></i>
            <div class="desc-content-wrapper">
                <div class="content-detail simditor-viewer" ng-bind-html="activity.data['description']|sanitizeHtml" mathjax></div>
                <div class="content-arrow"></div>
            </div>
        </div>
        <div class="volume">
            <a ng-click="toggleVolume($event)">
                <i ng-class="ui.isMuting ? 'font-audio-volume-off' : 'font-audio-volume'" class="font"></i>
            </a>
            <div class="volume-slider-wrapper">
                <div class="volume-slider-arrow"></div>
                <div class="volume-slider"></div>
            </div>
        </div>
    </div>
    <audio preload="auto" class="audio">
        <source ng-src="[[audioUrl | trustSrc]]">
    </audio>
</div>                </div>

                <div class="swf-container" ng-if="upload.type == 'swf' && (!upload.status || upload.status != 'uploading')">
                    <div class="swf-player">
                        <div class="loading" ng-hide="!ui.swfLoading"></div>
                        <div ng-if="!isVisitor" swf-object id="preview-flash" swf-url="/api/uploads/[[upload.id]]/swf" swf-width="100%"
                             swf-height="525" swf-load="swfLoaded()">
                        </div>
                        <div ng-if="isVisitor && activity" swf-object id="preview-flash" swf-url="/anonymous-api/[[activity.id]]/uploads/[[upload.id]]/swf?preview=true" swf-width="100%"
                             swf-height="525" swf-load="swfLoaded()">
                        </div>
                        <div ng-if="isVisitor && !activity && resourceId" swf-object id="preview-flash" swf-url="/anonymous-api/shared-resources/[[resourceId]]/preview?preview=true" swf-width="100%"
                             swf-height="525" swf-load="swfLoaded()">
                        </div>
                        <div ng-if="!hasFlashPlayer" class="no-flash-player">
                            您还没有安装Flash播放器，请点击
                            <a ng-href="https://get.adobe.com/flashplayer/">这里</a>
                            安装
                        </div>
                    </div>
                </div>

                <div class="scorm-container" ng-if="upload.type == 'scorm' && upload.status == 'ready'">
                    <div class="sco-menu">
                        <span ng-bind="scormManifest.organizations.organization.title"></span>
                        <div ng-show="scormManifest.organizations.organization.item.length > 0"
                             ng-repeat="i1 in scormManifest.organizations.organization.item" class="menu-level1">
<span ng-bind="i1.title" ng-hide="i1.scormUrl"></span>
<a ng-click="viewScorm(i1)" ng-bind="i1.title" class="sco-link" ng-show="i1.scormUrl"></a>

<div ng-show="i1.item" class="menu-level2">
    <span ng-bind="i1.item.title" ng-hide="i1.item.scormUrl"></span>
    <a ng-click="viewScorm(i1.item)" ng-bind="i1.item.title" class="sco-link" ng-show="i1.item.scormUrl"></a>
</div>

<div ng-repeat="i2 in i1.item" class="menu-level2" ng-show="i1.item.length > 0">
    <span ng-bind="i2.title" ng-hide="i2.scormUrl"></span>
    <a ng-click="viewScorm(i2)" ng-bind="i2.title" class="sco-link" ng-show="i2.scormUrl"></a>
    <div ng-repeat="i3 in i2.item" class="menu-level2">
        <span ng-bind="i3.title" ng-hide="i3.scormUrl"></span>
        <a ng-click="viewScorm(i3)" ng-bind="i3.title" class="sco-link" ng-show="i3.scormUrl"></a>
        <div ng-repeat="i4 in i3.item" class="menu-level2">
            <span ng-bind="i4.title" ng-hide="i4.scormUrl"></span>
            <a ng-click="viewScorm(i4)" ng-bind="i4.title" class="sco-link" ng-show="i4.scormUrl"></a>
        </div>
    </div>
</div>                        </div>
                        <div ng-show="scormManifest.organizations.organization.item" class="menu-level1">
                            <span ng-bind="scormManifest.organizations.organization.item.title"
                                  ng-hide="scormManifest.organizations.organization.item.scormUrl"></span>
                            <a ng-click="viewScorm(scormManifest.organizations.organization.item)"
                               ng-bind="scormManifest.organizations.organization.item.title"
                               ng-show="scormManifest.organizations.organization.item.scormUrl"
                               class="sco-link"></a>
                            <div ng-show="scormManifest.organizations.organization.item.item.length > 0"
                                 ng-repeat="i1 in scormManifest.organizations.organization.item.item" class="menu-level1">
<span ng-bind="i1.title" ng-hide="i1.scormUrl"></span>
<a ng-click="viewScorm(i1)" ng-bind="i1.title" class="sco-link" ng-show="i1.scormUrl"></a>

<div ng-show="i1.item" class="menu-level2">
    <span ng-bind="i1.item.title" ng-hide="i1.item.scormUrl"></span>
    <a ng-click="viewScorm(i1.item)" ng-bind="i1.item.title" class="sco-link" ng-show="i1.item.scormUrl"></a>
</div>

<div ng-repeat="i2 in i1.item" class="menu-level2" ng-show="i1.item.length > 0">
    <span ng-bind="i2.title" ng-hide="i2.scormUrl"></span>
    <a ng-click="viewScorm(i2)" ng-bind="i2.title" class="sco-link" ng-show="i2.scormUrl"></a>
    <div ng-repeat="i3 in i2.item" class="menu-level2">
        <span ng-bind="i3.title" ng-hide="i3.scormUrl"></span>
        <a ng-click="viewScorm(i3)" ng-bind="i3.title" class="sco-link" ng-show="i3.scormUrl"></a>
        <div ng-repeat="i4 in i3.item" class="menu-level2">
            <span ng-bind="i4.title" ng-hide="i4.scormUrl"></span>
            <a ng-click="viewScorm(i4)" ng-bind="i4.title" class="sco-link" ng-show="i4.scormUrl"></a>
        </div>
    </div>
</div>                            </div>
                        </div>
                    </div>
                    <div class="sco-viewer">
                        <iframe id='scorm-viewer' frameborder="0" class="scorm-iframe">
                        </iframe>
                    </div>
                </div>
                <div class="evercam-container" ng-if="upload.type == 'evercam' && upload.status == 'ready'">
                    <div class="evercam-viewer">
                        <iframe id='evercam-viewer' frameborder="0" class="evercam-iframe">
                        </iframe>
                    </div>
                </div>
                <div class="link-container" ng-if="upload.type == 'link'">
                    <div class="video-link-previewer" ng-if="upload.link.embedded_url">
                        <iframe id="iframeplayer"
                                ng-src="[[ trustAsResourceUrl(upload.link.embedded_url) ]]"
                                ng-style="iframeStyle"
                                height="100%" width="100%"
                                marginwidth="0" marginheight="0"
                                scrolling="No" frameborder="0"
                                allowfullscreen>
                        </iframe>
                    </div>
                    <div class="link-previewer" ng-if="!upload.link.embedded_url">
                        <div class="icon-resource-type">
                            <i class="font font-open-in-browser big-file-font"></i>
                            <div>
                                <a class="button button-green small" ng-href="[[upload.link.url]]" target="_blank">在浏览器中打开</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class='preview-mode reader-wrapper' ng-if="viewMode.mode==='preview'" ng-controller="PreviewModeController">
            <iframe id='preview-viewer' width="100%" height='100%' frameborder="0"
                ng-src="[[trustAsResourceUrl(previewDataMap[upload.id])]]">
            </iframe>
        </div>
    </div>
</div>                <div class="file-preview-note-box" ng-show="uploadCanAddNote(upload) && isShowingNoteBox">
<div id="note-box" class="note-container" ng-show="isShowingNoteBox" ng-controller="NoteController">
    <div class="note-card">
        <div class="card-header">
            <a class="right" ng-click="hideNoteBox()">
                <i class="font font-close"></i>
            </a>
        </div>
        <div class="note-list">
            <div class="note-blank" ng-if="notes.length == 0">
                <i class="font font-note-blank"></i>
                <div class="blank-message">还没有任何笔记</div>
            </div>

            <div class="note-item" ng-repeat="n in notes | orderBy:'order'">
                <div class="title" ng-if="note.target_type == 'video' || note.target_type == 'document'">
                    <a class="anchor" ng-click="seekToAnchor(n)" ng-if="note.target_type == 'video'">
                        <i class="font font-note-video" ng-show="n.anchor >= 0"></i>
                        <span ng-bind="formatAnchor(n)"></span>
                    </a>
                    <a class="anchor" ng-click="seekToAnchor(n)" ng-if="note.target_type == 'document'">
                        <i class="font font-note-document" ng-show="n.anchor >= 1"></i>
                        <span ng-bind="formatAnchor(n)"></span>
                    </a>
                </div>
                <div class="note-content"><span ng-bind="n.content"></span></div>
                <div class="info">
                    <span class="created-at" ng-bind="n.updated_at || n.created_at | datetime"></span>
                    <div class="right operations">
                        <a class="edit-note" ng-click="editNote(n)">
                            <i class="font font-edit" tipsy-literal="编辑" original-title="编辑"></i>
                        </a>
                        <a class="delete-note" confirm-dialog="是否确认删除该笔记？" ng-click="deleteNote(n.id)">
                            <i class="font font-delete" tipsy-literal="删除" original-title="删除"></i>
                        </a>
                    </div>
                </div>

            </div>
        </div>
        <div class="note-edit-area">
            <div class="add-note" ng-show="!ui.showForm" ng-click="showAddNoteForm()">
                <span>添加一条笔记...</span>
            </div>
            <div class="note-form" ng-show="ui.showForm">
                <form name="note_form" server-validated>
                    <textarea name="content" class="note-content" rows="4"
                              server-validated ng-model="note.content"
                              placeholder="500字以内"></textarea>
                    <div class="field-error">
                        <span error-for="content"></span>
                    </div>
                    <div class="action">
                        <a class="anchor" ng-if="note.target_type == 'video'">
                            <i class="font font-note-video" ng-show="note.anchor >=0"></i>
                            <span ng-bind="formatAnchor(note)"></span>
                        </a>
                        <a class="anchor" ng-if="note.target_type == 'document'">
                            <i class="font font-note-document" ng-show="note.anchor >=1"></i>
                            <span ng-bind="formatAnchor(note)"></span>
                        </a>
                        <button class="button button-grey small" type="button" ng-click="hideAddNoteForm()" ng-hide="loading" >取消</button>
                        <button class="button button-green small" type="button" ng-click="save()" ng-hide="loading" ng-disabled="isSimulatingStudent">保存</button>
<div class="loading-spinner" ng-show="loading">
    <div class="spinner">
        <div class="mask">
            <div class="maskedCircle"></div>
        </div>
    </div>
</div>                    </div>
                </form>
            </div>
        </div>
    </div>
</div>                </div>
                <div class="question-panel" ng-if="ui.showQuestionPanel === true">
                    <question-submit-panel
                    ng-prop-course_id="courseId"
                    ng-prop-activity="activity"
                    ng-prop-is_simulating_instructor="isSimulatingInstructor"
                    ng-prop-material="upload"></question-submit-panel>
                </div>

                <div class="ai-quiz-panel"  ng-if="ui.showAiQuizPanel === true && upload">
                    <ai-quiz-subjects-view ng-prop-activity="activity" ng-prop-upload="upload" ng-prop-is_instructor="false"></ai-quiz-subjects-view>
                </div>
            </div>
            <div ng-if="upload.type == 'video-quiz'" class="content">
<div ng-controller="VideoQuizPreviewController"
     ng-init="subjectTypeMap={
        'single_selection': '单选题',
        'multiple_selection': '多选题',
        'true_or_false': '判断题'};
        useNewPlayer=false;
        usePlayer2=true;"
     class="video-quiz-preview-container" ng-cloak>
    <div class="video-player-section section" ng-if="upload.video_urls">
        <div class='interaction-container' ng-if="!upload.deleted && !ui.isOrgTransferArrears">
            <div class="video-player">
    <div id='video-quiz-player' class="video-player">
        <div ng-if="upload.video_urls"
            id="wg-video-player-quiz-video"
            wg-video-player
            style="height:100%;"
            resolutions="{'ORIGINAL':'原画', 'HD': '1080p', 'VGA': '720p', 'QVGA': '480p'}"
            default-resolution="'HD'"
            upload="upload"
            video-src-type="upload.video_src_type"
            video-urls="upload.video_urls"
            seekable="allow_forward_seeking"
            activity="activity"
            player-initiated="playerInitiated(player)"
            download="false"
            disableTrack="true"
            enable-play-rate=True
            org-code="'1'"
            enable-caption="false"
            enable-topic="false"
            video-editor-server='https://courses.zju.edu.cn/video-editor'
        ></div>
    </div>
            </div>
            <div class="interaction-subjects subjects-preview" ng-if="ui.isVideoPaused && subjectsForCurrentTime.length > 0">
<div class="exam-paper with-submit" ng-if="!ui.shouldShowAnswerAtTheCurrentTime">
    <div class="subjects-jit-display">
        <div class="subjects" ng-if="isInstructorView">
            <li class="subject" ng-repeat="subject in subjectsForCurrentTime">
<div ng-if="subject.isObjective()">
<div class="subject-head" ng-attr-id="[[subject.id]]">
    <div class="summary-title" ng-class="{'required': subject.settings.required}">
<div class="subject-resort-index" ng-hide="ui.editSubjectPage">
    <span ng-if="!subject.parent_id || subject.data.is_random_subject">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>
    <span ng-if="subject.parent_id  && !subject.data.is_random_subject">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>


<div class="subject-resort-index" ng-if="ui.editSubjectPage">
    <span ng-if="!subject.parent_id">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type == 'random'">
        <span ng-bind="getSubjectIndex(parentSubject, $index)"></span>-<span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type != 'random'">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>        <span ng-compile-html="subject.displayedDescription || subject.description | sanitizeHtml"
              class="pre-wrap subject-description simditor-viewer" mathjax></span>
        <span class="require-info" ng-if="subject.settings.required">（必填）</span>
            <span class="random-info" ng-if="subject.data.is_random_subject">随机</span>
        <span class="prompt-message alert" ng-if="subject.updated">题目内容已更新,请重新作答</span>
        <span class="prompt-message alert-required" ng-if="subject.settings.required && subject.not_answered">
            &nbsp;&nbsp;未填写&nbsp;&nbsp;
        </span>
        <span ng-if="subject.unsaved" class="answer-unsaved-reminder">未保存</span>
    </div>
    <div class="summary-sub-title">
        <span ng-bind="subjectTypeMap[subject.type]"></span>
        <span ng-if="!questionnaire">
            (<span ng-bind="subject.getPoint()"></span>
            <span>分)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'fill_in_blank' && !subject.settings.unordered">(请按题目中的空缺顺序依次填写答案)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'matching'">
                (计分规则:
                <span ng-if="subject.score_rule == 'single'">按匹配正确项计分</span>
                <span ng-if="subject.score_rule == 'overall'">有匹配错误项则该题目不得分</span>)
            </span>
        </span>
    </div>
</div><ul class="media-uploads-paper" ng-init="noPopup = false">
    <li ng-repeat="upload in subject.settings.uploads | filter:uploadWithName">
        <div ng-if="upload.type == 'audio'" simditor-audio id="[[upload.id]]"
        src="[[trustSrc('/api/uploads/' + upload.id + '/in-rich-content?file_key=' + upload.key )]]" name="[[upload.name]]"></div>
        <div ng-if="upload.type === 'video'" exam-video-player upload="upload" no-popup="noPopup"  resolutions="{'ORIGINAL':'原画', 'HD': '1080p', 'VGA': '720p', 'QVGA': '480p'}"
        default-resolution="'HD'"  lang='zh-CN'
         settings="subject.settings"
        >
        </div>

        <div ng-if="upload.enable_origin_text && (canViewCorrectAnswer || canViewAnswerForClassroom || canViewAnswerExplanation)">
            <div class="show-text">
            原文/译文
            <label class="switch">
                <input type="checkbox" class="switch-input" ng-model="upload.show_text"/>
                <span class="switch-label" data-on="" data-off=""></span>
                <span class="switch-handle"></span>
            </label>
            </div>

            <span ng-show="upload.show_text" class="pre-wrap subject-description simditor-viewer origin-text mb-3"
            ng-compile-html="upload.text | sanitizeHtml" mathjax>
            </span>
        </div>
    </li>
</ul>
<div class="subject-body">
    <ol class="subject-options">
        <li class="option" ng-class="subject.settings.options_layout"
            ng-style="{width: ui.calcOptionWidth(subject.options, subject.settings.options_layout)}"
            ng-repeat="option in subject.options | orderBy: 'sort'">
            <label ng-class="{'answered-option': option.id == subject.answeredOption}">
                <span class="left">
                    <input ng-if="subject.type=='single_selection' || subject.type=='true_or_false'"
                           type="radio" ng-value="[[option.id]]"
                           ng-model="subject.answeredOption" ng-change="onChangeSubmission(subject)" />
                    <input ng-if="subject.type=='multiple_selection'"
                           type="checkbox"
                           ng-model="option.checked" ng-change="onChangeSubmission(subject)" />
                    <span class="option-index" ng-bind="ui.intToChar($index)"></span><span>.</span>
                </span>

                <div class="option-content">
                    <span ng-compile-html="option.content | sanitizeHtml" class="pre-wrap simditor-viewer" mathjax></span>
                </div>
            </label>
        </li>
    </ol>
</div></div>
<div ng-if="subject.type == 'fill_in_blank'">
<div class="subject-head" ng-attr-id="[[subject.id]]">
    <div class="summary-title" ng-class="{'required': subject.settings.required}">
<div class="subject-resort-index" ng-hide="ui.editSubjectPage">
    <span ng-if="!subject.parent_id || subject.data.is_random_subject">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>
    <span ng-if="subject.parent_id  && !subject.data.is_random_subject">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>


<div class="subject-resort-index" ng-if="ui.editSubjectPage">
    <span ng-if="!subject.parent_id">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type == 'random'">
        <span ng-bind="getSubjectIndex(parentSubject, $index)"></span>-<span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type != 'random'">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>        <span ng-compile-html="subject.displayedDescription || subject.description | sanitizeHtml"
              class="pre-wrap subject-description simditor-viewer" mathjax></span>
        <span class="require-info" ng-if="subject.settings.required">（必填）</span>
            <span class="random-info" ng-if="subject.data.is_random_subject">随机</span>
        <span class="prompt-message alert" ng-if="subject.updated">题目内容已更新,请重新作答</span>
        <span class="prompt-message alert-required" ng-if="subject.settings.required && subject.not_answered">
            &nbsp;&nbsp;未填写&nbsp;&nbsp;
        </span>
        <span ng-if="subject.unsaved" class="answer-unsaved-reminder">未保存</span>
    </div>
    <div class="summary-sub-title">
        <span ng-bind="subjectTypeMap[subject.type]"></span>
        <span ng-if="!questionnaire">
            (<span ng-bind="subject.getPoint()"></span>
            <span>分)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'fill_in_blank' && !subject.settings.unordered">(请按题目中的空缺顺序依次填写答案)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'matching'">
                (计分规则:
                <span ng-if="subject.score_rule == 'single'">按匹配正确项计分</span>
                <span ng-if="subject.score_rule == 'overall'">有匹配错误项则该题目不得分</span>)
            </span>
        </span>
    </div>
</div><ul class="media-uploads-paper" ng-init="noPopup = false">
    <li ng-repeat="upload in subject.settings.uploads | filter:uploadWithName">
        <div ng-if="upload.type == 'audio'" simditor-audio id="[[upload.id]]"
        src="[[trustSrc('/api/uploads/' + upload.id + '/in-rich-content?file_key=' + upload.key )]]" name="[[upload.name]]"></div>
        <div ng-if="upload.type === 'video'" exam-video-player upload="upload" no-popup="noPopup"  resolutions="{'ORIGINAL':'原画', 'HD': '1080p', 'VGA': '720p', 'QVGA': '480p'}"
        default-resolution="'HD'"  lang='zh-CN'
         settings="subject.settings"
        >
        </div>

        <div ng-if="upload.enable_origin_text && (canViewCorrectAnswer || canViewAnswerForClassroom || canViewAnswerExplanation)">
            <div class="show-text">
            原文/译文
            <label class="switch">
                <input type="checkbox" class="switch-input" ng-model="upload.show_text"/>
                <span class="switch-label" data-on="" data-off=""></span>
                <span class="switch-handle"></span>
            </label>
            </div>

            <span ng-show="upload.show_text" class="pre-wrap subject-description simditor-viewer origin-text mb-3"
            ng-compile-html="upload.text | sanitizeHtml" mathjax>
            </span>
        </div>
    </li>
</ul>
<div class="subject-body">
    <div class="subject-answers">
        <ol>
            <li ng-form="answers" class="answer" ng-repeat="answer in subject.answers">
                <span ng-if="subject.answers.length > 1">
                    <span class="sort circle-number" ng-bind-html="$index+1"></span>
                </span>
                <input class="content" type="text" ng-model="answer.content" ng-change="onChangeSubmission(subject)" format-validated />
            </li>
        </ol>
    </div>
</div></div>
<div ng-if="subject.type == 'text'">
    <div class="subject-head">
        <div class="summary-title">
            <span class="pre-wrap subject-description simditor-viewer"
                ng-compile-html="subject.description || '暂无题目描述' | sanitizeHtml" mathjax>
            </span>
        </div>
    </div>
</div>
<div ng-if="subject.type == 'short_answer'">
<div class="subject-head" ng-attr-id="[[subject.id]]">
    <div class="summary-title" ng-class="{'required': subject.settings.required}">
<div class="subject-resort-index" ng-hide="ui.editSubjectPage">
    <span ng-if="!subject.parent_id || subject.data.is_random_subject">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>
    <span ng-if="subject.parent_id  && !subject.data.is_random_subject">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>


<div class="subject-resort-index" ng-if="ui.editSubjectPage">
    <span ng-if="!subject.parent_id">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type == 'random'">
        <span ng-bind="getSubjectIndex(parentSubject, $index)"></span>-<span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type != 'random'">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>        <span ng-compile-html="subject.displayedDescription || subject.description | sanitizeHtml"
              class="pre-wrap subject-description simditor-viewer" mathjax></span>
        <span class="require-info" ng-if="subject.settings.required">（必填）</span>
            <span class="random-info" ng-if="subject.data.is_random_subject">随机</span>
        <span class="prompt-message alert" ng-if="subject.updated">题目内容已更新,请重新作答</span>
        <span class="prompt-message alert-required" ng-if="subject.settings.required && subject.not_answered">
            &nbsp;&nbsp;未填写&nbsp;&nbsp;
        </span>
        <span ng-if="subject.unsaved" class="answer-unsaved-reminder">未保存</span>
    </div>
    <div class="summary-sub-title">
        <span ng-bind="subjectTypeMap[subject.type]"></span>
        <span ng-if="!questionnaire">
            (<span ng-bind="subject.getPoint()"></span>
            <span>分)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'fill_in_blank' && !subject.settings.unordered">(请按题目中的空缺顺序依次填写答案)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'matching'">
                (计分规则:
                <span ng-if="subject.score_rule == 'single'">按匹配正确项计分</span>
                <span ng-if="subject.score_rule == 'overall'">有匹配错误项则该题目不得分</span>)
            </span>
        </span>
    </div>
</div>
<div class="subject-body short-answer">
    <div class="answer-content" ng-init="subject.isFocus = false;">
        <div class="answer-area-container" ng-class="{'is-focus': subject.isFocus}">
            <textarea ng-model="subject.answered_content" ng-change="onChangeSubmission(subject)" ng-trim="false"
                      class="short-answer-take"
                      bind-model="subject"
                      rows="5"
                      clean-font-size-paste
                      sim-editor sim-toolbar="code">
            </textarea>
        </div>
        <div class="left add-attachments" ng-if="!questionnaire && !classroom">
            <span>附件</span>
            <a class="button add-attachment-btn" ng-click="openFileSelectPopup(subject)"
               on-file-selected="addAttachments">
                <i class="font font-file-image"></i>
                <span>上传</span>
            </a>
        </div>
    </div>

    <div class="short-answer-upload-list" ng-init="uploads = (ui.get_subject_attachments && ui.get_subject_attachments(subject)) || subject.attachments" refresh-on="subject.attachments">
<div class="attachments-wrapper" ng-if="uploads.length" stop-propagation check-upload-status>

<div class="attachment-header clearfix">
    <div class="attachment-column column" ng-class="{'large-11': true, 'large-15': !true}">
        附件名
    </div>
    <div class="attachment-column column" ng-if="ui.videoType !=='sobey'"
        ng-class="{'large-7': true, 'large-10': !true}">
        大小
    </div>
        <div ng-if="airHelper.canShowAttachmentQuestion(activity) === true" class="attachment-column column large-2">题目</div>
    <div class="attachment-column column large-3">&nbsp;</div>
</div>    <div class="attachment-body">
        <div ng-repeat="upload in uploads">
    <div class="attachment-row preview-able clearfix" ng-if="canPreview(upload) && !upload.deleted && canShowResource(upload, isInstructorView)"
             previewer="{uploads: uploads, currentFile: upload, activity: exam, isAttachment: isAttachment}" reveal-modal="file-previewer" ng-click="downloadBlob(exam, upload, 'view')">



    <div class="attachment-column column large-10" ng-if="upload.type != 'slide'" ng-class="{'large-20':upload.source === 'sobey'}">
        <div ng-if="upload.source == 'auto-generated-pdf'">
            <svg class="file-text-content left">
                <use xlink:href="#file-text-content"></use>
            </svg>
            <span class="file-name-wrapper truncate-text left">
                <span class="file-name" tipsy-literal="[[ upload.name.split('.')[0] ]]">[[ upload.name.split('.')[0] ]]</span>
            </span>
        </div>
        <div ng-if="upload.source !== 'auto-generated-pdf'" class="w-full flex">
            <i class="font font-file-[[fileTypeByExtension(upload)]] left"></i>
            <span class="file-name-wrapper truncate-text left">
                <span class="file-name" tipsy-literal="[[ upload.name ]]" ng-bind="upload.name|fileName"></span>
            </span>
            <span class="file-extension left" ng-bind="upload.name|fileExtension"></span>
        </div>
    </div>
    <div class="attachment-column column large-10" ng-if="upload.type == 'slide'">
        <i class="font font-slide left"></i>
        <span class="file-name-wrapper truncate-text left">
            <span class="file-name" tipsy-literal="[[ upload.title ]]" ng-bind="upload.title|fileName"></span>
        </span>
    </div>
        <div class="attachment-column column attachment-state" ng-if="!upload.deleted && upload.source !== 'sobey'"
            ng-class="{'large-1': true, 'large-5': !true}">
        <span ng-if="!upload.status || upload.status === 'ready' || (upload.status === 'processing' && (upload.type === 'video' || upload.videos)) || upload.status === 'none' || upload.deleted || wpsPreview(upload)">&nbsp;</span>
        <span ng-if="(upload.status === 'failed' || uploadsStatus[upload.id] === 'failed') && !upload.deleted">&nbsp;</span>
        <span ng-if="(upload.status === 'processing' || uploadsStatus[upload.id] === 'processing') && (upload.type != 'video' || !upload.videos) && !upload.deleted && !wpsPreview(upload)">&nbsp;</span>
    </div>
    <div class="attachment-column column attachment-deleted large-5" ng-if="upload.deleted">
        <span>文件已删除</span>
    </div>
    <div class="attachment-column column attachment-size attachment-marked"
         ng-class="{'large-7': true, 'large-10': !true}"
         ng-init="isUploadFailed = (upload.status || uploadsStatus[upload.id]) == 'failed';
                  isUploadProcessing = (upload.status || uploadsStatus[upload.id]) == 'processing';
                  isNotVideo = upload.type != 'video' || !upload.videos;
                  showFileSize = !isUploadFailed && !isUploadProcessing && upload.size >= 0">
        <span ng-if="upload.source == 'LARK'" style="height: 1px;">——</span>
        <span ng-if="upload.source != 'LARK' && showFileSize" ng-bind="upload.size|humanizeBytes"></span>
        <span ng-if="upload.source != 'LARK' && !showFileSize && !upload.deleted">
            <span ng-if="isUploadFailed" class="attachment-state-failed">
                    转码失败
            </span>
            <span ng-if="isUploadProcessing && isNotVideo && !wpsPreview(upload)" class="attachment-state-processing">
                    正在转码中
            </span>
        </span>
        <div ng-if="upload.type=='scorm' && upload.scorm">
            教材大小:<span ng-bind="upload.scorm.files_size|humanizeBytes"></span>
        </div>
        <div ng-if="upload.type=='slide' && upload.duration">
            时长:<span ng-bind="upload.duration | formatTime"></span>
        </div>
    </div>



        <div ng-if="airHelper.canShowAttachmentQuestion(activity) === true" class="attachment-column column large-2">
            <span class="aiQuiz-content">
                [[upload.aiQuiz.subjectsCount || "--"]]
            </span>
        </div>

    <div class="attachment-column column"
         ng-class="{'large-7': true, 'large-5': !true}">
<span class="attachment-operations">
        <div class="horizon">



            <a stop-propagation previewer="{uploads: uploads, currentFile: upload, activity: exam, isAttachment: isAttachment}" reveal-modal="file-previewer"
                tipsy-literal="预览" ng-click="downloadBlob(exam, upload, 'view')"
                ng-if="canPreview(upload) && !upload.deleted && canShowResource(upload, isInstructorView)">
                <i class="font font-table-edit-view-2"></i>
            </a>
        <a ng-click="openSobeyVideo()" ng-if="upload.source==='sobey'">
            <i class="font font-table-edit-view-2"></i>
        </a>
        <a stop-propagation ng-click="deleteFile(upload, subject)" tipsy-literal="删除" ng-hide="['auditing', 'agree'].includes(upload.audit_status)" ng-class="{'delete-btn-disabled': upload.viewCount > 0}">
            <i class="font font-delete"></i>
            <span class="dropdown-item dropdown-item-hide">删除</span>
        </a>
        </div>
</span>    </div>

</div>

<div class="attachment-row clearfix" ng-if="!canPreview(upload) || upload.deleted || !canShowResource(upload, isInstructorView)" ng-click="downloadWeDrive(upload)">


    <div class="attachment-column column large-10" ng-if="upload.type != 'slide'" ng-class="{'large-20':upload.source === 'sobey'}">
        <div ng-if="upload.source == 'auto-generated-pdf'">
            <svg class="file-text-content left">
                <use xlink:href="#file-text-content"></use>
            </svg>
            <span class="file-name-wrapper truncate-text left">
                <span class="file-name" tipsy-literal="[[ upload.name.split('.')[0] ]]">[[ upload.name.split('.')[0] ]]</span>
            </span>
        </div>
        <div ng-if="upload.source !== 'auto-generated-pdf'" class="w-full flex">
            <i class="font font-file-[[fileTypeByExtension(upload)]] left"></i>
            <span class="file-name-wrapper truncate-text left">
                <span class="file-name" tipsy-literal="[[ upload.name ]]" ng-bind="upload.name|fileName"></span>
            </span>
            <span class="file-extension left" ng-bind="upload.name|fileExtension"></span>
        </div>
    </div>
    <div class="attachment-column column large-10" ng-if="upload.type == 'slide'">
        <i class="font font-slide left"></i>
        <span class="file-name-wrapper truncate-text left">
            <span class="file-name" tipsy-literal="[[ upload.title ]]" ng-bind="upload.title|fileName"></span>
        </span>
    </div>
        <div class="attachment-column column attachment-state" ng-if="!upload.deleted && upload.source !== 'sobey'"
            ng-class="{'large-1': true, 'large-5': !true}">
        <span ng-if="!upload.status || upload.status === 'ready' || (upload.status === 'processing' && (upload.type === 'video' || upload.videos)) || upload.status === 'none' || upload.deleted || wpsPreview(upload)">&nbsp;</span>
        <span ng-if="(upload.status === 'failed' || uploadsStatus[upload.id] === 'failed') && !upload.deleted">&nbsp;</span>
        <span ng-if="(upload.status === 'processing' || uploadsStatus[upload.id] === 'processing') && (upload.type != 'video' || !upload.videos) && !upload.deleted && !wpsPreview(upload)">&nbsp;</span>
    </div>
    <div class="attachment-column column attachment-deleted large-5" ng-if="upload.deleted">
        <span>文件已删除</span>
    </div>
    <div class="attachment-column column attachment-size attachment-marked"
         ng-class="{'large-7': true, 'large-10': !true}"
         ng-init="isUploadFailed = (upload.status || uploadsStatus[upload.id]) == 'failed';
                  isUploadProcessing = (upload.status || uploadsStatus[upload.id]) == 'processing';
                  isNotVideo = upload.type != 'video' || !upload.videos;
                  showFileSize = !isUploadFailed && !isUploadProcessing && upload.size >= 0">
        <span ng-if="upload.source == 'LARK'" style="height: 1px;">——</span>
        <span ng-if="upload.source != 'LARK' && showFileSize" ng-bind="upload.size|humanizeBytes"></span>
        <span ng-if="upload.source != 'LARK' && !showFileSize && !upload.deleted">
            <span ng-if="isUploadFailed" class="attachment-state-failed">
                    转码失败
            </span>
            <span ng-if="isUploadProcessing && isNotVideo && !wpsPreview(upload)" class="attachment-state-processing">
                    正在转码中
            </span>
        </span>
        <div ng-if="upload.type=='scorm' && upload.scorm">
            教材大小:<span ng-bind="upload.scorm.files_size|humanizeBytes"></span>
        </div>
        <div ng-if="upload.type=='slide' && upload.duration">
            时长:<span ng-bind="upload.duration | formatTime"></span>
        </div>
    </div>



        <div ng-if="airHelper.canShowAttachmentQuestion(activity) === true" class="attachment-column column large-2">
            <span class="aiQuiz-content">
                [[upload.aiQuiz.subjectsCount || "--"]]
            </span>
        </div>

    <div class="attachment-column column"
         ng-class="{'large-7': true, 'large-5': !true}">
<span class="attachment-operations">
        <div class="horizon">



            <a stop-propagation previewer="{uploads: uploads, currentFile: upload, activity: exam, isAttachment: isAttachment}" reveal-modal="file-previewer"
                tipsy-literal="预览" ng-click="downloadBlob(exam, upload, 'view')"
                ng-if="canPreview(upload) && !upload.deleted && canShowResource(upload, isInstructorView)">
                <i class="font font-table-edit-view-2"></i>
            </a>
        <a ng-click="openSobeyVideo()" ng-if="upload.source==='sobey'">
            <i class="font font-table-edit-view-2"></i>
        </a>
        <a stop-propagation ng-click="deleteFile(upload, subject)" tipsy-literal="删除" ng-hide="['auditing', 'agree'].includes(upload.audit_status)" ng-class="{'delete-btn-disabled': upload.viewCount > 0}">
            <i class="font font-delete"></i>
            <span class="dropdown-item dropdown-item-hide">删除</span>
        </a>
        </div>
</span>    </div>

</div>        </div>
    </div>
</div>    </div>

</div></div>
<div ng-if="subject.type == 'cloze'">
<div class="subject-head" ng-attr-id="[[subject.id]]">
    <div class="summary-title" ng-class="{'required': subject.settings.required}">
<div class="subject-resort-index" ng-hide="ui.editSubjectPage">
    <span ng-if="!subject.parent_id || subject.data.is_random_subject">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>
    <span ng-if="subject.parent_id  && !subject.data.is_random_subject">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>


<div class="subject-resort-index" ng-if="ui.editSubjectPage">
    <span ng-if="!subject.parent_id">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type == 'random'">
        <span ng-bind="getSubjectIndex(parentSubject, $index)"></span>-<span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type != 'random'">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>        <span ng-compile-html="subject.displayedDescription || subject.description | sanitizeHtml"
              class="pre-wrap subject-description simditor-viewer" mathjax></span>
        <span class="require-info" ng-if="subject.settings.required">（必填）</span>
            <span class="random-info" ng-if="subject.data.is_random_subject">随机</span>
        <span class="prompt-message alert" ng-if="subject.updated">题目内容已更新,请重新作答</span>
        <span class="prompt-message alert-required" ng-if="subject.settings.required && subject.not_answered">
            &nbsp;&nbsp;未填写&nbsp;&nbsp;
        </span>
        <span ng-if="subject.unsaved" class="answer-unsaved-reminder">未保存</span>
    </div>
    <div class="summary-sub-title">
        <span ng-bind="subjectTypeMap[subject.type]"></span>
        <span ng-if="!questionnaire">
            (<span ng-bind="subject.getPoint()"></span>
            <span>分)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'fill_in_blank' && !subject.settings.unordered">(请按题目中的空缺顺序依次填写答案)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'matching'">
                (计分规则:
                <span ng-if="subject.score_rule == 'single'">按匹配正确项计分</span>
                <span ng-if="subject.score_rule == 'overall'">有匹配错误项则该题目不得分</span>)
            </span>
        </span>
    </div>
</div></div>
<div ng-if="subject.type === 'matching'">
<div class="subject-head" ng-attr-id="[[subject.id]]">
    <div class="summary-title" ng-class="{'required': subject.settings.required}">
<div class="subject-resort-index" ng-hide="ui.editSubjectPage">
    <span ng-if="!subject.parent_id || subject.data.is_random_subject">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>
    <span ng-if="subject.parent_id  && !subject.data.is_random_subject">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>


<div class="subject-resort-index" ng-if="ui.editSubjectPage">
    <span ng-if="!subject.parent_id">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type == 'random'">
        <span ng-bind="getSubjectIndex(parentSubject, $index)"></span>-<span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type != 'random'">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>        <span ng-compile-html="subject.displayedDescription || subject.description | sanitizeHtml"
              class="pre-wrap subject-description simditor-viewer" mathjax></span>
        <span class="require-info" ng-if="subject.settings.required">（必填）</span>
            <span class="random-info" ng-if="subject.data.is_random_subject">随机</span>
        <span class="prompt-message alert" ng-if="subject.updated">题目内容已更新,请重新作答</span>
        <span class="prompt-message alert-required" ng-if="subject.settings.required && subject.not_answered">
            &nbsp;&nbsp;未填写&nbsp;&nbsp;
        </span>
        <span ng-if="subject.unsaved" class="answer-unsaved-reminder">未保存</span>
    </div>
    <div class="summary-sub-title">
        <span ng-bind="subjectTypeMap[subject.type]"></span>
        <span ng-if="!questionnaire">
            (<span ng-bind="subject.getPoint()"></span>
            <span>分)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'fill_in_blank' && !subject.settings.unordered">(请按题目中的空缺顺序依次填写答案)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'matching'">
                (计分规则:
                <span ng-if="subject.score_rule == 'single'">按匹配正确项计分</span>
                <span ng-if="subject.score_rule == 'overall'">有匹配错误项则该题目不得分</span>)
            </span>
        </span>
    </div>
</div>
<div class="subject-body">
    <div class="subject-answers">
        <div class="matching-answer-box">
            <ul>
                <li>
                    <div class="list-panel panel-desc">提示</div>
                    <div class="line"></div>
                    <div class="list-panel panel-desc">请从右侧拖入合适的答案</div>
                </li>
                <li ng-repeat="subSubject in subject.sub_subjects">
                    <div class="list-panel" ng-init="vueParam={subjectDescription: subSubject.description}">
                        <div vue-wrapper>
                            <match-subject-info :content="subjectDescription" class="desc"></match-subject-info>
                        </div>
                    </div>
                    <div class="line"><span></span></div>
                    <div class="list-panel option"
                        ng-class="{'option-fill' : subSubject.answer_number > 0}"
                        drag-cloneable="matching-dragable" drag-type="to"
                        drag-options="subject" drag-callback="dragAddCallback(subject)" ng-style="{height: subSubject.defaultStyle}">
                        <div class="clone-area drag-area" data-drag-node-id="[[subSubject.answer_number]]" ng-if="subSubject.note">
                            <div class="content-wrapper" ng-init="vueParam={subjectNote: subSubject.note.content}">
                                <div class="icon icon-drag"><i class="font font-activity-drag"></i></div>
                                <div vue-wrapper>
                                    <match-subject-info :content="subjectNote"></match-subject-info>
                                </div>
                            </div>
                        </div>
                    </div>
                </li>
            </ul>
            <div class="answer-pool">
                <div class="head panel-desc">答案池</div>
                <div id="cloneable-source" class="pool" drag-cloneable="matching-dragable" drag-type="from"
                    drag-options="subject" drag-callback="dragAddCallback(subject)">
                    <div class="clone-area drag-area" data-drag-node-id="[[answer.id]]" ng-repeat="answer in subject.options">
                        <div class="content-wrapper" ng-init="vueParam={subjectAnswer: answer.content}">
                            <div class="icon icon-drag"><i class="font font-activity-drag"></i></div>
                            <div vue-wrapper>
                                <match-subject-info :content="subjectAnswer"></match-subject-info>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="drag-trash-[[subject.id]]" class="cloneable-trash">
                    <div class="trash-area" drag-cloneable="matching-dragable" drag-type="trash"
                    drag-options="subject" drag-callback="dragAddCallback(subject)"></div>
                    <i class="font font-move-trash"></i>
                </div>
            </div>
        </div>
    </div>
</div></div>
<div class="paragraph-desc" ng-if="subject.type === 'paragraph_desc'">
    <div class="summary-title mb-4">
        <span class="pre-wrap subject-description simditor-viewer"
            ng-compile-html="subject.description || '暂无题目描述' | sanitizeHtml" mathjax>
        </span>
    </div>
<ul class="media-uploads-paper" ng-init="noPopup = false">
    <li ng-repeat="upload in subject.settings.uploads | filter:uploadWithName">
        <div ng-if="upload.type == 'audio'" simditor-audio id="[[upload.id]]"
        src="[[trustSrc('/api/uploads/' + upload.id + '/in-rich-content?file_key=' + upload.key )]]" name="[[upload.name]]"></div>
        <div ng-if="upload.type === 'video'" exam-video-player upload="upload" no-popup="noPopup"  resolutions="{'ORIGINAL':'原画', 'HD': '1080p', 'VGA': '720p', 'QVGA': '480p'}"
        default-resolution="'HD'"  lang='zh-CN'
         settings="subject.settings"
        >
        </div>

        <div ng-if="upload.enable_origin_text && (canViewCorrectAnswer || canViewAnswerForClassroom || canViewAnswerExplanation)">
            <div class="show-text">
            原文/译文
            <label class="switch">
                <input type="checkbox" class="switch-input" ng-model="upload.show_text"/>
                <span class="switch-label" data-on="" data-off=""></span>
                <span class="switch-handle"></span>
            </label>
            </div>

            <span ng-show="upload.show_text" class="pre-wrap subject-description simditor-viewer origin-text mb-3"
            ng-compile-html="upload.text | sanitizeHtml" mathjax>
            </span>
        </div>
    </li>
</ul></div>            </li>
        </div>
        <div class="subjects" ng-if="!isInstructorView">
            <li class="subject" ng-repeat="subject in subjectsForCurrentTime" ng-if="((!subject.hasValidAnswer && !activity.interaction_activity_attributes.repeat_answer) || activity.interaction_activity_attributes.repeat_answer) && !activity.is_closed">
<div ng-if="subject.isObjective()">
<div class="subject-head" ng-attr-id="[[subject.id]]">
    <div class="summary-title" ng-class="{'required': subject.settings.required}">
<div class="subject-resort-index" ng-hide="ui.editSubjectPage">
    <span ng-if="!subject.parent_id || subject.data.is_random_subject">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>
    <span ng-if="subject.parent_id  && !subject.data.is_random_subject">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>


<div class="subject-resort-index" ng-if="ui.editSubjectPage">
    <span ng-if="!subject.parent_id">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type == 'random'">
        <span ng-bind="getSubjectIndex(parentSubject, $index)"></span>-<span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type != 'random'">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>        <span ng-compile-html="subject.displayedDescription || subject.description | sanitizeHtml"
              class="pre-wrap subject-description simditor-viewer" mathjax></span>
        <span class="require-info" ng-if="subject.settings.required">（必填）</span>
            <span class="random-info" ng-if="subject.data.is_random_subject">随机</span>
        <span class="prompt-message alert" ng-if="subject.updated">题目内容已更新,请重新作答</span>
        <span class="prompt-message alert-required" ng-if="subject.settings.required && subject.not_answered">
            &nbsp;&nbsp;未填写&nbsp;&nbsp;
        </span>
        <span ng-if="subject.unsaved" class="answer-unsaved-reminder">未保存</span>
    </div>
    <div class="summary-sub-title">
        <span ng-bind="subjectTypeMap[subject.type]"></span>
        <span ng-if="!questionnaire">
            (<span ng-bind="subject.getPoint()"></span>
            <span>分)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'fill_in_blank' && !subject.settings.unordered">(请按题目中的空缺顺序依次填写答案)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'matching'">
                (计分规则:
                <span ng-if="subject.score_rule == 'single'">按匹配正确项计分</span>
                <span ng-if="subject.score_rule == 'overall'">有匹配错误项则该题目不得分</span>)
            </span>
        </span>
    </div>
</div><ul class="media-uploads-paper" ng-init="noPopup = false">
    <li ng-repeat="upload in subject.settings.uploads | filter:uploadWithName">
        <div ng-if="upload.type == 'audio'" simditor-audio id="[[upload.id]]"
        src="[[trustSrc('/api/uploads/' + upload.id + '/in-rich-content?file_key=' + upload.key )]]" name="[[upload.name]]"></div>
        <div ng-if="upload.type === 'video'" exam-video-player upload="upload" no-popup="noPopup"  resolutions="{'ORIGINAL':'原画', 'HD': '1080p', 'VGA': '720p', 'QVGA': '480p'}"
        default-resolution="'HD'"  lang='zh-CN'
         settings="subject.settings"
        >
        </div>

        <div ng-if="upload.enable_origin_text && (canViewCorrectAnswer || canViewAnswerForClassroom || canViewAnswerExplanation)">
            <div class="show-text">
            原文/译文
            <label class="switch">
                <input type="checkbox" class="switch-input" ng-model="upload.show_text"/>
                <span class="switch-label" data-on="" data-off=""></span>
                <span class="switch-handle"></span>
            </label>
            </div>

            <span ng-show="upload.show_text" class="pre-wrap subject-description simditor-viewer origin-text mb-3"
            ng-compile-html="upload.text | sanitizeHtml" mathjax>
            </span>
        </div>
    </li>
</ul>
<div class="subject-body">
    <ol class="subject-options">
        <li class="option" ng-class="subject.settings.options_layout"
            ng-style="{width: ui.calcOptionWidth(subject.options, subject.settings.options_layout)}"
            ng-repeat="option in subject.options | orderBy: 'sort'">
            <label ng-class="{'answered-option': option.id == subject.answeredOption}">
                <span class="left">
                    <input ng-if="subject.type=='single_selection' || subject.type=='true_or_false'"
                           type="radio" ng-value="[[option.id]]"
                           ng-model="subject.answeredOption" ng-change="onChangeSubmission(subject)" />
                    <input ng-if="subject.type=='multiple_selection'"
                           type="checkbox"
                           ng-model="option.checked" ng-change="onChangeSubmission(subject)" />
                    <span class="option-index" ng-bind="ui.intToChar($index)"></span><span>.</span>
                </span>

                <div class="option-content">
                    <span ng-compile-html="option.content | sanitizeHtml" class="pre-wrap simditor-viewer" mathjax></span>
                </div>
            </label>
        </li>
    </ol>
</div></div>
<div ng-if="subject.type == 'fill_in_blank'">
<div class="subject-head" ng-attr-id="[[subject.id]]">
    <div class="summary-title" ng-class="{'required': subject.settings.required}">
<div class="subject-resort-index" ng-hide="ui.editSubjectPage">
    <span ng-if="!subject.parent_id || subject.data.is_random_subject">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>
    <span ng-if="subject.parent_id  && !subject.data.is_random_subject">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>


<div class="subject-resort-index" ng-if="ui.editSubjectPage">
    <span ng-if="!subject.parent_id">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type == 'random'">
        <span ng-bind="getSubjectIndex(parentSubject, $index)"></span>-<span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type != 'random'">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>        <span ng-compile-html="subject.displayedDescription || subject.description | sanitizeHtml"
              class="pre-wrap subject-description simditor-viewer" mathjax></span>
        <span class="require-info" ng-if="subject.settings.required">（必填）</span>
            <span class="random-info" ng-if="subject.data.is_random_subject">随机</span>
        <span class="prompt-message alert" ng-if="subject.updated">题目内容已更新,请重新作答</span>
        <span class="prompt-message alert-required" ng-if="subject.settings.required && subject.not_answered">
            &nbsp;&nbsp;未填写&nbsp;&nbsp;
        </span>
        <span ng-if="subject.unsaved" class="answer-unsaved-reminder">未保存</span>
    </div>
    <div class="summary-sub-title">
        <span ng-bind="subjectTypeMap[subject.type]"></span>
        <span ng-if="!questionnaire">
            (<span ng-bind="subject.getPoint()"></span>
            <span>分)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'fill_in_blank' && !subject.settings.unordered">(请按题目中的空缺顺序依次填写答案)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'matching'">
                (计分规则:
                <span ng-if="subject.score_rule == 'single'">按匹配正确项计分</span>
                <span ng-if="subject.score_rule == 'overall'">有匹配错误项则该题目不得分</span>)
            </span>
        </span>
    </div>
</div><ul class="media-uploads-paper" ng-init="noPopup = false">
    <li ng-repeat="upload in subject.settings.uploads | filter:uploadWithName">
        <div ng-if="upload.type == 'audio'" simditor-audio id="[[upload.id]]"
        src="[[trustSrc('/api/uploads/' + upload.id + '/in-rich-content?file_key=' + upload.key )]]" name="[[upload.name]]"></div>
        <div ng-if="upload.type === 'video'" exam-video-player upload="upload" no-popup="noPopup"  resolutions="{'ORIGINAL':'原画', 'HD': '1080p', 'VGA': '720p', 'QVGA': '480p'}"
        default-resolution="'HD'"  lang='zh-CN'
         settings="subject.settings"
        >
        </div>

        <div ng-if="upload.enable_origin_text && (canViewCorrectAnswer || canViewAnswerForClassroom || canViewAnswerExplanation)">
            <div class="show-text">
            原文/译文
            <label class="switch">
                <input type="checkbox" class="switch-input" ng-model="upload.show_text"/>
                <span class="switch-label" data-on="" data-off=""></span>
                <span class="switch-handle"></span>
            </label>
            </div>

            <span ng-show="upload.show_text" class="pre-wrap subject-description simditor-viewer origin-text mb-3"
            ng-compile-html="upload.text | sanitizeHtml" mathjax>
            </span>
        </div>
    </li>
</ul>
<div class="subject-body">
    <div class="subject-answers">
        <ol>
            <li ng-form="answers" class="answer" ng-repeat="answer in subject.answers">
                <span ng-if="subject.answers.length > 1">
                    <span class="sort circle-number" ng-bind-html="$index+1"></span>
                </span>
                <input class="content" type="text" ng-model="answer.content" ng-change="onChangeSubmission(subject)" format-validated />
            </li>
        </ol>
    </div>
</div></div>
<div ng-if="subject.type == 'text'">
    <div class="subject-head">
        <div class="summary-title">
            <span class="pre-wrap subject-description simditor-viewer"
                ng-compile-html="subject.description || '暂无题目描述' | sanitizeHtml" mathjax>
            </span>
        </div>
    </div>
</div>
<div ng-if="subject.type == 'short_answer'">
<div class="subject-head" ng-attr-id="[[subject.id]]">
    <div class="summary-title" ng-class="{'required': subject.settings.required}">
<div class="subject-resort-index" ng-hide="ui.editSubjectPage">
    <span ng-if="!subject.parent_id || subject.data.is_random_subject">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>
    <span ng-if="subject.parent_id  && !subject.data.is_random_subject">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>


<div class="subject-resort-index" ng-if="ui.editSubjectPage">
    <span ng-if="!subject.parent_id">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type == 'random'">
        <span ng-bind="getSubjectIndex(parentSubject, $index)"></span>-<span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type != 'random'">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>        <span ng-compile-html="subject.displayedDescription || subject.description | sanitizeHtml"
              class="pre-wrap subject-description simditor-viewer" mathjax></span>
        <span class="require-info" ng-if="subject.settings.required">（必填）</span>
            <span class="random-info" ng-if="subject.data.is_random_subject">随机</span>
        <span class="prompt-message alert" ng-if="subject.updated">题目内容已更新,请重新作答</span>
        <span class="prompt-message alert-required" ng-if="subject.settings.required && subject.not_answered">
            &nbsp;&nbsp;未填写&nbsp;&nbsp;
        </span>
        <span ng-if="subject.unsaved" class="answer-unsaved-reminder">未保存</span>
    </div>
    <div class="summary-sub-title">
        <span ng-bind="subjectTypeMap[subject.type]"></span>
        <span ng-if="!questionnaire">
            (<span ng-bind="subject.getPoint()"></span>
            <span>分)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'fill_in_blank' && !subject.settings.unordered">(请按题目中的空缺顺序依次填写答案)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'matching'">
                (计分规则:
                <span ng-if="subject.score_rule == 'single'">按匹配正确项计分</span>
                <span ng-if="subject.score_rule == 'overall'">有匹配错误项则该题目不得分</span>)
            </span>
        </span>
    </div>
</div>
<div class="subject-body short-answer">
    <div class="answer-content" ng-init="subject.isFocus = false;">
        <div class="answer-area-container" ng-class="{'is-focus': subject.isFocus}">
            <textarea ng-model="subject.answered_content" ng-change="onChangeSubmission(subject)" ng-trim="false"
                      class="short-answer-take"
                      bind-model="subject"
                      rows="5"
                      clean-font-size-paste
                      sim-editor sim-toolbar="code">
            </textarea>
        </div>
        <div class="left add-attachments" ng-if="!questionnaire && !classroom">
            <span>附件</span>
            <a class="button add-attachment-btn" ng-click="openFileSelectPopup(subject)"
               on-file-selected="addAttachments">
                <i class="font font-file-image"></i>
                <span>上传</span>
            </a>
        </div>
    </div>

    <div class="short-answer-upload-list" ng-init="uploads = (ui.get_subject_attachments && ui.get_subject_attachments(subject)) || subject.attachments" refresh-on="subject.attachments">
<div class="attachments-wrapper" ng-if="uploads.length" stop-propagation check-upload-status>

<div class="attachment-header clearfix">
    <div class="attachment-column column" ng-class="{'large-11': true, 'large-15': !true}">
        附件名
    </div>
    <div class="attachment-column column" ng-if="ui.videoType !=='sobey'"
        ng-class="{'large-7': true, 'large-10': !true}">
        大小
    </div>
        <div ng-if="airHelper.canShowAttachmentQuestion(activity) === true" class="attachment-column column large-2">题目</div>
    <div class="attachment-column column large-3">&nbsp;</div>
</div>    <div class="attachment-body">
        <div ng-repeat="upload in uploads">
    <div class="attachment-row preview-able clearfix" ng-if="canPreview(upload) && !upload.deleted && canShowResource(upload, isInstructorView)"
             previewer="{uploads: uploads, currentFile: upload, activity: exam, isAttachment: isAttachment}" reveal-modal="file-previewer" ng-click="downloadBlob(exam, upload, 'view')">



    <div class="attachment-column column large-10" ng-if="upload.type != 'slide'" ng-class="{'large-20':upload.source === 'sobey'}">
        <div ng-if="upload.source == 'auto-generated-pdf'">
            <svg class="file-text-content left">
                <use xlink:href="#file-text-content"></use>
            </svg>
            <span class="file-name-wrapper truncate-text left">
                <span class="file-name" tipsy-literal="[[ upload.name.split('.')[0] ]]">[[ upload.name.split('.')[0] ]]</span>
            </span>
        </div>
        <div ng-if="upload.source !== 'auto-generated-pdf'" class="w-full flex">
            <i class="font font-file-[[fileTypeByExtension(upload)]] left"></i>
            <span class="file-name-wrapper truncate-text left">
                <span class="file-name" tipsy-literal="[[ upload.name ]]" ng-bind="upload.name|fileName"></span>
            </span>
            <span class="file-extension left" ng-bind="upload.name|fileExtension"></span>
        </div>
    </div>
    <div class="attachment-column column large-10" ng-if="upload.type == 'slide'">
        <i class="font font-slide left"></i>
        <span class="file-name-wrapper truncate-text left">
            <span class="file-name" tipsy-literal="[[ upload.title ]]" ng-bind="upload.title|fileName"></span>
        </span>
    </div>
        <div class="attachment-column column attachment-state" ng-if="!upload.deleted && upload.source !== 'sobey'"
            ng-class="{'large-1': true, 'large-5': !true}">
        <span ng-if="!upload.status || upload.status === 'ready' || (upload.status === 'processing' && (upload.type === 'video' || upload.videos)) || upload.status === 'none' || upload.deleted || wpsPreview(upload)">&nbsp;</span>
        <span ng-if="(upload.status === 'failed' || uploadsStatus[upload.id] === 'failed') && !upload.deleted">&nbsp;</span>
        <span ng-if="(upload.status === 'processing' || uploadsStatus[upload.id] === 'processing') && (upload.type != 'video' || !upload.videos) && !upload.deleted && !wpsPreview(upload)">&nbsp;</span>
    </div>
    <div class="attachment-column column attachment-deleted large-5" ng-if="upload.deleted">
        <span>文件已删除</span>
    </div>
    <div class="attachment-column column attachment-size attachment-marked"
         ng-class="{'large-7': true, 'large-10': !true}"
         ng-init="isUploadFailed = (upload.status || uploadsStatus[upload.id]) == 'failed';
                  isUploadProcessing = (upload.status || uploadsStatus[upload.id]) == 'processing';
                  isNotVideo = upload.type != 'video' || !upload.videos;
                  showFileSize = !isUploadFailed && !isUploadProcessing && upload.size >= 0">
        <span ng-if="upload.source == 'LARK'" style="height: 1px;">——</span>
        <span ng-if="upload.source != 'LARK' && showFileSize" ng-bind="upload.size|humanizeBytes"></span>
        <span ng-if="upload.source != 'LARK' && !showFileSize && !upload.deleted">
            <span ng-if="isUploadFailed" class="attachment-state-failed">
                    转码失败
            </span>
            <span ng-if="isUploadProcessing && isNotVideo && !wpsPreview(upload)" class="attachment-state-processing">
                    正在转码中
            </span>
        </span>
        <div ng-if="upload.type=='scorm' && upload.scorm">
            教材大小:<span ng-bind="upload.scorm.files_size|humanizeBytes"></span>
        </div>
        <div ng-if="upload.type=='slide' && upload.duration">
            时长:<span ng-bind="upload.duration | formatTime"></span>
        </div>
    </div>



        <div ng-if="airHelper.canShowAttachmentQuestion(activity) === true" class="attachment-column column large-2">
            <span class="aiQuiz-content">
                [[upload.aiQuiz.subjectsCount || "--"]]
            </span>
        </div>

    <div class="attachment-column column"
         ng-class="{'large-7': true, 'large-5': !true}">
<span class="attachment-operations">
        <div class="horizon">



            <a stop-propagation previewer="{uploads: uploads, currentFile: upload, activity: exam, isAttachment: isAttachment}" reveal-modal="file-previewer"
                tipsy-literal="预览" ng-click="downloadBlob(exam, upload, 'view')"
                ng-if="canPreview(upload) && !upload.deleted && canShowResource(upload, isInstructorView)">
                <i class="font font-table-edit-view-2"></i>
            </a>
        <a ng-click="openSobeyVideo()" ng-if="upload.source==='sobey'">
            <i class="font font-table-edit-view-2"></i>
        </a>
        <a stop-propagation ng-click="deleteFile(upload, subject)" tipsy-literal="删除" ng-hide="['auditing', 'agree'].includes(upload.audit_status)" ng-class="{'delete-btn-disabled': upload.viewCount > 0}">
            <i class="font font-delete"></i>
            <span class="dropdown-item dropdown-item-hide">删除</span>
        </a>
        </div>
</span>    </div>

</div>

<div class="attachment-row clearfix" ng-if="!canPreview(upload) || upload.deleted || !canShowResource(upload, isInstructorView)" ng-click="downloadWeDrive(upload)">


    <div class="attachment-column column large-10" ng-if="upload.type != 'slide'" ng-class="{'large-20':upload.source === 'sobey'}">
        <div ng-if="upload.source == 'auto-generated-pdf'">
            <svg class="file-text-content left">
                <use xlink:href="#file-text-content"></use>
            </svg>
            <span class="file-name-wrapper truncate-text left">
                <span class="file-name" tipsy-literal="[[ upload.name.split('.')[0] ]]">[[ upload.name.split('.')[0] ]]</span>
            </span>
        </div>
        <div ng-if="upload.source !== 'auto-generated-pdf'" class="w-full flex">
            <i class="font font-file-[[fileTypeByExtension(upload)]] left"></i>
            <span class="file-name-wrapper truncate-text left">
                <span class="file-name" tipsy-literal="[[ upload.name ]]" ng-bind="upload.name|fileName"></span>
            </span>
            <span class="file-extension left" ng-bind="upload.name|fileExtension"></span>
        </div>
    </div>
    <div class="attachment-column column large-10" ng-if="upload.type == 'slide'">
        <i class="font font-slide left"></i>
        <span class="file-name-wrapper truncate-text left">
            <span class="file-name" tipsy-literal="[[ upload.title ]]" ng-bind="upload.title|fileName"></span>
        </span>
    </div>
        <div class="attachment-column column attachment-state" ng-if="!upload.deleted && upload.source !== 'sobey'"
            ng-class="{'large-1': true, 'large-5': !true}">
        <span ng-if="!upload.status || upload.status === 'ready' || (upload.status === 'processing' && (upload.type === 'video' || upload.videos)) || upload.status === 'none' || upload.deleted || wpsPreview(upload)">&nbsp;</span>
        <span ng-if="(upload.status === 'failed' || uploadsStatus[upload.id] === 'failed') && !upload.deleted">&nbsp;</span>
        <span ng-if="(upload.status === 'processing' || uploadsStatus[upload.id] === 'processing') && (upload.type != 'video' || !upload.videos) && !upload.deleted && !wpsPreview(upload)">&nbsp;</span>
    </div>
    <div class="attachment-column column attachment-deleted large-5" ng-if="upload.deleted">
        <span>文件已删除</span>
    </div>
    <div class="attachment-column column attachment-size attachment-marked"
         ng-class="{'large-7': true, 'large-10': !true}"
         ng-init="isUploadFailed = (upload.status || uploadsStatus[upload.id]) == 'failed';
                  isUploadProcessing = (upload.status || uploadsStatus[upload.id]) == 'processing';
                  isNotVideo = upload.type != 'video' || !upload.videos;
                  showFileSize = !isUploadFailed && !isUploadProcessing && upload.size >= 0">
        <span ng-if="upload.source == 'LARK'" style="height: 1px;">——</span>
        <span ng-if="upload.source != 'LARK' && showFileSize" ng-bind="upload.size|humanizeBytes"></span>
        <span ng-if="upload.source != 'LARK' && !showFileSize && !upload.deleted">
            <span ng-if="isUploadFailed" class="attachment-state-failed">
                    转码失败
            </span>
            <span ng-if="isUploadProcessing && isNotVideo && !wpsPreview(upload)" class="attachment-state-processing">
                    正在转码中
            </span>
        </span>
        <div ng-if="upload.type=='scorm' && upload.scorm">
            教材大小:<span ng-bind="upload.scorm.files_size|humanizeBytes"></span>
        </div>
        <div ng-if="upload.type=='slide' && upload.duration">
            时长:<span ng-bind="upload.duration | formatTime"></span>
        </div>
    </div>



        <div ng-if="airHelper.canShowAttachmentQuestion(activity) === true" class="attachment-column column large-2">
            <span class="aiQuiz-content">
                [[upload.aiQuiz.subjectsCount || "--"]]
            </span>
        </div>

    <div class="attachment-column column"
         ng-class="{'large-7': true, 'large-5': !true}">
<span class="attachment-operations">
        <div class="horizon">



            <a stop-propagation previewer="{uploads: uploads, currentFile: upload, activity: exam, isAttachment: isAttachment}" reveal-modal="file-previewer"
                tipsy-literal="预览" ng-click="downloadBlob(exam, upload, 'view')"
                ng-if="canPreview(upload) && !upload.deleted && canShowResource(upload, isInstructorView)">
                <i class="font font-table-edit-view-2"></i>
            </a>
        <a ng-click="openSobeyVideo()" ng-if="upload.source==='sobey'">
            <i class="font font-table-edit-view-2"></i>
        </a>
        <a stop-propagation ng-click="deleteFile(upload, subject)" tipsy-literal="删除" ng-hide="['auditing', 'agree'].includes(upload.audit_status)" ng-class="{'delete-btn-disabled': upload.viewCount > 0}">
            <i class="font font-delete"></i>
            <span class="dropdown-item dropdown-item-hide">删除</span>
        </a>
        </div>
</span>    </div>

</div>        </div>
    </div>
</div>    </div>

</div></div>
<div ng-if="subject.type == 'cloze'">
<div class="subject-head" ng-attr-id="[[subject.id]]">
    <div class="summary-title" ng-class="{'required': subject.settings.required}">
<div class="subject-resort-index" ng-hide="ui.editSubjectPage">
    <span ng-if="!subject.parent_id || subject.data.is_random_subject">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>
    <span ng-if="subject.parent_id  && !subject.data.is_random_subject">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>


<div class="subject-resort-index" ng-if="ui.editSubjectPage">
    <span ng-if="!subject.parent_id">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type == 'random'">
        <span ng-bind="getSubjectIndex(parentSubject, $index)"></span>-<span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type != 'random'">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>        <span ng-compile-html="subject.displayedDescription || subject.description | sanitizeHtml"
              class="pre-wrap subject-description simditor-viewer" mathjax></span>
        <span class="require-info" ng-if="subject.settings.required">（必填）</span>
            <span class="random-info" ng-if="subject.data.is_random_subject">随机</span>
        <span class="prompt-message alert" ng-if="subject.updated">题目内容已更新,请重新作答</span>
        <span class="prompt-message alert-required" ng-if="subject.settings.required && subject.not_answered">
            &nbsp;&nbsp;未填写&nbsp;&nbsp;
        </span>
        <span ng-if="subject.unsaved" class="answer-unsaved-reminder">未保存</span>
    </div>
    <div class="summary-sub-title">
        <span ng-bind="subjectTypeMap[subject.type]"></span>
        <span ng-if="!questionnaire">
            (<span ng-bind="subject.getPoint()"></span>
            <span>分)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'fill_in_blank' && !subject.settings.unordered">(请按题目中的空缺顺序依次填写答案)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'matching'">
                (计分规则:
                <span ng-if="subject.score_rule == 'single'">按匹配正确项计分</span>
                <span ng-if="subject.score_rule == 'overall'">有匹配错误项则该题目不得分</span>)
            </span>
        </span>
    </div>
</div></div>
<div ng-if="subject.type === 'matching'">
<div class="subject-head" ng-attr-id="[[subject.id]]">
    <div class="summary-title" ng-class="{'required': subject.settings.required}">
<div class="subject-resort-index" ng-hide="ui.editSubjectPage">
    <span ng-if="!subject.parent_id || subject.data.is_random_subject">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>
    <span ng-if="subject.parent_id  && !subject.data.is_random_subject">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>


<div class="subject-resort-index" ng-if="ui.editSubjectPage">
    <span ng-if="!subject.parent_id">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type == 'random'">
        <span ng-bind="getSubjectIndex(parentSubject, $index)"></span>-<span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type != 'random'">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>        <span ng-compile-html="subject.displayedDescription || subject.description | sanitizeHtml"
              class="pre-wrap subject-description simditor-viewer" mathjax></span>
        <span class="require-info" ng-if="subject.settings.required">（必填）</span>
            <span class="random-info" ng-if="subject.data.is_random_subject">随机</span>
        <span class="prompt-message alert" ng-if="subject.updated">题目内容已更新,请重新作答</span>
        <span class="prompt-message alert-required" ng-if="subject.settings.required && subject.not_answered">
            &nbsp;&nbsp;未填写&nbsp;&nbsp;
        </span>
        <span ng-if="subject.unsaved" class="answer-unsaved-reminder">未保存</span>
    </div>
    <div class="summary-sub-title">
        <span ng-bind="subjectTypeMap[subject.type]"></span>
        <span ng-if="!questionnaire">
            (<span ng-bind="subject.getPoint()"></span>
            <span>分)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'fill_in_blank' && !subject.settings.unordered">(请按题目中的空缺顺序依次填写答案)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'matching'">
                (计分规则:
                <span ng-if="subject.score_rule == 'single'">按匹配正确项计分</span>
                <span ng-if="subject.score_rule == 'overall'">有匹配错误项则该题目不得分</span>)
            </span>
        </span>
    </div>
</div>
<div class="subject-body">
    <div class="subject-answers">
        <div class="matching-answer-box">
            <ul>
                <li>
                    <div class="list-panel panel-desc">提示</div>
                    <div class="line"></div>
                    <div class="list-panel panel-desc">请从右侧拖入合适的答案</div>
                </li>
                <li ng-repeat="subSubject in subject.sub_subjects">
                    <div class="list-panel" ng-init="vueParam={subjectDescription: subSubject.description}">
                        <div vue-wrapper>
                            <match-subject-info :content="subjectDescription" class="desc"></match-subject-info>
                        </div>
                    </div>
                    <div class="line"><span></span></div>
                    <div class="list-panel option"
                        ng-class="{'option-fill' : subSubject.answer_number > 0}"
                        drag-cloneable="matching-dragable" drag-type="to"
                        drag-options="subject" drag-callback="dragAddCallback(subject)" ng-style="{height: subSubject.defaultStyle}">
                        <div class="clone-area drag-area" data-drag-node-id="[[subSubject.answer_number]]" ng-if="subSubject.note">
                            <div class="content-wrapper" ng-init="vueParam={subjectNote: subSubject.note.content}">
                                <div class="icon icon-drag"><i class="font font-activity-drag"></i></div>
                                <div vue-wrapper>
                                    <match-subject-info :content="subjectNote"></match-subject-info>
                                </div>
                            </div>
                        </div>
                    </div>
                </li>
            </ul>
            <div class="answer-pool">
                <div class="head panel-desc">答案池</div>
                <div id="cloneable-source" class="pool" drag-cloneable="matching-dragable" drag-type="from"
                    drag-options="subject" drag-callback="dragAddCallback(subject)">
                    <div class="clone-area drag-area" data-drag-node-id="[[answer.id]]" ng-repeat="answer in subject.options">
                        <div class="content-wrapper" ng-init="vueParam={subjectAnswer: answer.content}">
                            <div class="icon icon-drag"><i class="font font-activity-drag"></i></div>
                            <div vue-wrapper>
                                <match-subject-info :content="subjectAnswer"></match-subject-info>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="drag-trash-[[subject.id]]" class="cloneable-trash">
                    <div class="trash-area" drag-cloneable="matching-dragable" drag-type="trash"
                    drag-options="subject" drag-callback="dragAddCallback(subject)"></div>
                    <i class="font font-move-trash"></i>
                </div>
            </div>
        </div>
    </div>
</div></div>
<div class="paragraph-desc" ng-if="subject.type === 'paragraph_desc'">
    <div class="summary-title mb-4">
        <span class="pre-wrap subject-description simditor-viewer"
            ng-compile-html="subject.description || '暂无题目描述' | sanitizeHtml" mathjax>
        </span>
    </div>
<ul class="media-uploads-paper" ng-init="noPopup = false">
    <li ng-repeat="upload in subject.settings.uploads | filter:uploadWithName">
        <div ng-if="upload.type == 'audio'" simditor-audio id="[[upload.id]]"
        src="[[trustSrc('/api/uploads/' + upload.id + '/in-rich-content?file_key=' + upload.key )]]" name="[[upload.name]]"></div>
        <div ng-if="upload.type === 'video'" exam-video-player upload="upload" no-popup="noPopup"  resolutions="{'ORIGINAL':'原画', 'HD': '1080p', 'VGA': '720p', 'QVGA': '480p'}"
        default-resolution="'HD'"  lang='zh-CN'
         settings="subject.settings"
        >
        </div>

        <div ng-if="upload.enable_origin_text && (canViewCorrectAnswer || canViewAnswerForClassroom || canViewAnswerExplanation)">
            <div class="show-text">
            原文/译文
            <label class="switch">
                <input type="checkbox" class="switch-input" ng-model="upload.show_text"/>
                <span class="switch-label" data-on="" data-off=""></span>
                <span class="switch-handle"></span>
            </label>
            </div>

            <span ng-show="upload.show_text" class="pre-wrap subject-description simditor-viewer origin-text mb-3"
            ng-compile-html="upload.text | sanitizeHtml" mathjax>
            </span>
        </div>
    </li>
</ul></div>            </li>
        </div>
        <i class="font font-close" ng-click="closeForReplay()"></i>
        <div class="operations interaction-operations">
            <a class="button button-green medium" ng-click="submit()">提交</a>
        </div>
    </div>
</div><div class="subjects-jit-display" ng-if="ui.shouldShowAnswerAtTheCurrentTime">
<div class="exam-paper exam-result"
     ng-init="subjectTypeMap={'single_selection': '单选题', 'multiple_selection': '多选题', 'true_or_false': '判断题'}; isInteraction=true">
    <div class="paper-content">
        <div class="exam-subjects">
            <ol class="subjects-jit-display">
                <li class="subject" ng-repeat="subject in subjectsForCurrentTime" ng-class="subject.type">
                    <div style="display:none;">[[
                        isCorrect = subject.answerState == 1;
                    ]]</div>
<div style="display:none;">[[
    isInstructorViewAndNotSimulatedSubmission = isInstructorView && !submissionData.isSimulated;
    canViewAnswerState = isInstructorViewAndNotSimulatedSubmission || exam.is_announce_answer_time_passed || isInteraction;
    canViewAnswerForInteraction = isInteraction && (isCorrect || activity && !activity.interaction_activity_attributes.repeat_answer);
    canViewAnswerExplanation = ((isInstructorViewAndNotSimulatedSubmission || exam.is_announce_answer_time_passed) && !isInteraction ) || isInteraction;
    canViewCorrectAnswer = ((isInstructorViewAndNotSimulatedSubmission || !!(exam.is_announce_answer_time_passed && exam.announce_answer_type == 'answer_and_explanation')) && !isInteraction) || canViewAnswerForInteraction;
    canViewAnswerForClassroom = classroom && classroom.is_answer_announced;
    canGiveScore = allowExamScoreMark && !submissionData.isSimulated;
]]</div>
<div ng-if="subject.isObjective()">
<div class="subject-head" ng-init="answerState = getSubjectAnswerState(subject, submissionScoreData)" ng-attr-id="[[subject.id]]">
    <div class="summary-title" ng-class="{'required': subject.settings.required}">
<div class="subject-resort-index" ng-hide="ui.editSubjectPage">
    <span ng-if="!subject.parent_id || subject.data.is_random_subject">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>
    <span ng-if="subject.parent_id  && !subject.data.is_random_subject">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>


<div class="subject-resort-index" ng-if="ui.editSubjectPage">
    <span ng-if="!subject.parent_id">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type == 'random'">
        <span ng-bind="getSubjectIndex(parentSubject, $index)"></span>-<span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type != 'random'">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>        <span ng-compile-html="subject.displayedDescription || subject.description || '暂无题目描述' | sanitizeHtml"
            class="pre-wrap subject-description simditor-viewer" mathjax></span>
        <span class="answer-error"
              ng-if="!questionnaire && (canViewAnswerState || canViewAnswerForClassroom)">
            <span ng-if="answerState == -1" class="answer-message tc-tag error">此题未答</span>
            <span ng-if="answerState == 0" class="answer-message tc-tag error">回答错误</span>
            <span ng-if="answerState == 2" class="tc-tag info">部分答对</span>
        </span>
    </div>
    <div class="summary-sub-title">
        <span class="subject-point">
            <span ng-bind="subjectTypeMap[subject.type]"></span>
            <span ng-if="subject.score >= 0 && subject.score !== null && !questionnaire">
                (<span ng-bind="subject.getPoint()"></span>
                <span>分</span>)

                <span class="actual-score" ng-if="(isInstructorView || exam.is_announce_score_time_passed)"
                    ng-init="subject.score_copy = subject.score">
                    <span ng-if="subject.type == 'fill_in_blank' && exam">
                        <span ng-if="canGiveScore"  ng-show="subject.showEdit">
                            <input ng-attr-id="[['input-' + subject.id]]" class="auto-width" name="score"
                                ng-disabled="course.score_published || !canShowOperations(exam)" ng-change="removeError(subject)"
                                esc-press="subject.score_copy" ng-on-change="editScore(subject)"
                                ng-blur="resetSubject(subject)" ng-model="subject.score" maxlength="4" server-validated
                                float-precision="1">
                            </input>
                        </span>
                        <span ng-show="!subject.showEdit">
                            <span ng-bind="subject.score"></span>
                            <span>分</span>
                            <a ng-if="canGiveScore" ng-click="edit(subject)"><i class="font font-edit"></i></a>
                        </span>
                    </span>
                    <span ng-if="subject.type != 'fill_in_blank' || !exam">[[subject.getScore()]]分</span>
                </span>
            </span>
            <span ng-if="!subject.score && subject.score != 0 && !questionnaire">
                (<span ng-bind="subject.getPoint()"></span>
                <span>分</span>)
            </span>
            <span class="sub-title-hint" ng-if="subject.type == 'matching'">
                <span ng-if="subject.score_rule == 'single'">(计分规则:按匹配正确项计分)</span>
                <span ng-if="subject.score_rule == 'overall'">(计分规则:有匹配错误项则该题目不得分)</span>
            </span>
            <span ng-if="isInstructorView && !questionnaire">
<span ng-if="!isQuestionnaire">（难易度:
    <span ng-if="subject.difficulty_level=='none'">中）</span>
    <span ng-if="subject.difficulty_level=='hard'">难）</span>
    <span ng-if="subject.difficulty_level=='medium'">中）</span>
    <span ng-if="subject.difficulty_level=='easy'">易）</span>
</span>            </span>
            <span class="sub-title-hint"
                ng-if="subject.type == 'fill_in_blank' && !allowExamEdit">(请按题目中的空缺顺序依次填写答案)</span>
            <span ng-if="subject.type == 'fill_in_blank' && allowExamEdit" class="error score-error ng-binding"
                ng-style="{'display': 'inline-block'}" ng-bind="subject.error || ''"></span>
        </span>
    </div>
</div><ul class="media-uploads-paper" ng-init="noPopup = false">
    <li ng-repeat="upload in subject.settings.uploads | filter:uploadWithName">
        <div ng-if="upload.type == 'audio'" simditor-audio id="[[upload.id]]"
        src="[[trustSrc('/api/uploads/' + upload.id + '/in-rich-content?file_key=' + upload.key )]]" name="[[upload.name]]"></div>
        <div ng-if="upload.type === 'video'" exam-video-player upload="upload" no-popup="noPopup"  resolutions="{'ORIGINAL':'原画', 'HD': '1080p', 'VGA': '720p', 'QVGA': '480p'}"
        default-resolution="'HD'"  lang='zh-CN'
         settings="subject.settings"
        >
        </div>

        <div ng-if="upload.enable_origin_text && (canViewCorrectAnswer || canViewAnswerForClassroom || canViewAnswerExplanation)">
            <div class="show-text">
            原文/译文
            <label class="switch">
                <input type="checkbox" class="switch-input" ng-model="upload.show_text"/>
                <span class="switch-label" data-on="" data-off=""></span>
                <span class="switch-handle"></span>
            </label>
            </div>

            <span ng-show="upload.show_text" class="pre-wrap subject-description simditor-viewer origin-text mb-3"
            ng-compile-html="upload.text | sanitizeHtml" mathjax>
            </span>
        </div>
    </li>
</ul>
<div class="subject-body">
    <ol class="subject-options">
        <li class="option"
            ng-class="subject.settings.options_layout"
            ng-style="{width: ui.calcOptionWidth(subject.options, subject.settings.options_layout)}"
            ng-repeat="option in subject.options | orderBy: 'sort'">
            <label>
                <span class="left">
                    <input ng-if="subject.type=='single_selection' || subject.type=='true_or_false'"
                           type="radio" ng-checked="option.isChosen"
                           ng-disabled="true"/>
                    <input ng-if="subject.type=='multiple_selection'"
                           type="checkbox" ng-checked="option.isChosen"
                           ng-disabled="true"/>
                    <span class="option-index" ng-bind="ui.intToChar($index)"></span><span>.</span>
                </span>
                <div class="option-content">
                    <span ng-compile-html="option.content | sanitizeHtml"
                          class="pre-wrap simditor-viewer" mathjax></span>
                </div>
            </label>
        </li>
    </ol>
    <div class="subject-message"
        ng-if="!questionnaire && (canViewCorrectAnswer || canViewAnswerForClassroom || canViewAnswerExplanation && (subject.answer_explanation || subject.wrong_explanation))">
        <div class="note" ng-if="isInstructorViewAndNotSimulatedSubmission && subject.settings.show_note">
            <span>备注:&nbsp</span>
            <span ng-bind="subject.note"></span>
        </div>
        <div class="answer-options" ng-class="{'answer-only':isAnswerOnly(subject)}"
             ng-if="canViewCorrectAnswer || canViewAnswerForClassroom">
            <span>正确答案:</span>
            <span ng-bind="ui.getCorrectOptions(subject)"></span>
        </div>
        <div class="explanation" ng-if="canViewAnswerExplanation && subject.answer_explanation && answerState != 0">
            <div class="explanation-label">答案解释:</div>
            <span class="simditor-viewer" ng-compile-html="subject.answer_explanation | sanitizeHtml" mathjax></span>
        </div>
        <div class="explanation" ng-if="canViewAnswerExplanation && subject.wrong_explanation && answerState == 0">
            <div class="explanation-label">答案解释:</div>
            <span class="simditor-viewer" ng-compile-html="subject.wrong_explanation | sanitizeHtml" mathjax></span>
        </div>
    <div class="knowledge-node" ng-if="subject.knowledgeNodes">
        <div class="knowledge-node-label">知识点:</div>
        <div class="node-list">
            <div ng-repeat="node_reference in subject.knowledgeNodes">
                <knowledge-node-tag
                    ng-prop-course_id="node_reference.course_id"
                    ng-prop-node_id="node_reference.knowledge_node.id"
                    ng-prop-content="node_reference.knowledge_node.name"
                    ng-prop-go_to_graph="true"
                    size="medium"
                >
                </knowledge-node-tag>
            </div>
        </div>
    </div>
    </div>
</div></div>
<div ng-if="subject.type == 'fill_in_blank'">
<div class="subject-head" ng-init="answerState = getSubjectAnswerState(subject, submissionScoreData)" ng-attr-id="[[subject.id]]">
    <div class="summary-title" ng-class="{'required': subject.settings.required}">
<div class="subject-resort-index" ng-hide="ui.editSubjectPage">
    <span ng-if="!subject.parent_id || subject.data.is_random_subject">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>
    <span ng-if="subject.parent_id  && !subject.data.is_random_subject">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>


<div class="subject-resort-index" ng-if="ui.editSubjectPage">
    <span ng-if="!subject.parent_id">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type == 'random'">
        <span ng-bind="getSubjectIndex(parentSubject, $index)"></span>-<span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type != 'random'">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>        <span ng-compile-html="subject.displayedDescription || subject.description || '暂无题目描述' | sanitizeHtml"
            class="pre-wrap subject-description simditor-viewer" mathjax></span>
        <span class="answer-error"
              ng-if="!questionnaire && (canViewAnswerState || canViewAnswerForClassroom)">
            <span ng-if="answerState == -1" class="answer-message tc-tag error">此题未答</span>
            <span ng-if="answerState == 0" class="answer-message tc-tag error">回答错误</span>
            <span ng-if="answerState == 2" class="tc-tag info">部分答对</span>
        </span>
    </div>
    <div class="summary-sub-title">
        <span class="subject-point">
            <span ng-bind="subjectTypeMap[subject.type]"></span>
            <span ng-if="subject.score >= 0 && subject.score !== null && !questionnaire">
                (<span ng-bind="subject.getPoint()"></span>
                <span>分</span>)

                <span class="actual-score" ng-if="(isInstructorView || exam.is_announce_score_time_passed)"
                    ng-init="subject.score_copy = subject.score">
                    <span ng-if="subject.type == 'fill_in_blank' && exam">
                        <span ng-if="canGiveScore"  ng-show="subject.showEdit">
                            <input ng-attr-id="[['input-' + subject.id]]" class="auto-width" name="score"
                                ng-disabled="course.score_published || !canShowOperations(exam)" ng-change="removeError(subject)"
                                esc-press="subject.score_copy" ng-on-change="editScore(subject)"
                                ng-blur="resetSubject(subject)" ng-model="subject.score" maxlength="4" server-validated
                                float-precision="1">
                            </input>
                        </span>
                        <span ng-show="!subject.showEdit">
                            <span ng-bind="subject.score"></span>
                            <span>分</span>
                            <a ng-if="canGiveScore" ng-click="edit(subject)"><i class="font font-edit"></i></a>
                        </span>
                    </span>
                    <span ng-if="subject.type != 'fill_in_blank' || !exam">[[subject.getScore()]]分</span>
                </span>
            </span>
            <span ng-if="!subject.score && subject.score != 0 && !questionnaire">
                (<span ng-bind="subject.getPoint()"></span>
                <span>分</span>)
            </span>
            <span class="sub-title-hint" ng-if="subject.type == 'matching'">
                <span ng-if="subject.score_rule == 'single'">(计分规则:按匹配正确项计分)</span>
                <span ng-if="subject.score_rule == 'overall'">(计分规则:有匹配错误项则该题目不得分)</span>
            </span>
            <span ng-if="isInstructorView && !questionnaire">
<span ng-if="!isQuestionnaire">（难易度:
    <span ng-if="subject.difficulty_level=='none'">中）</span>
    <span ng-if="subject.difficulty_level=='hard'">难）</span>
    <span ng-if="subject.difficulty_level=='medium'">中）</span>
    <span ng-if="subject.difficulty_level=='easy'">易）</span>
</span>            </span>
            <span class="sub-title-hint"
                ng-if="subject.type == 'fill_in_blank' && !allowExamEdit">(请按题目中的空缺顺序依次填写答案)</span>
            <span ng-if="subject.type == 'fill_in_blank' && allowExamEdit" class="error score-error ng-binding"
                ng-style="{'display': 'inline-block'}" ng-bind="subject.error || ''"></span>
        </span>
    </div>
</div><ul class="media-uploads-paper" ng-init="noPopup = false">
    <li ng-repeat="upload in subject.settings.uploads | filter:uploadWithName">
        <div ng-if="upload.type == 'audio'" simditor-audio id="[[upload.id]]"
        src="[[trustSrc('/api/uploads/' + upload.id + '/in-rich-content?file_key=' + upload.key )]]" name="[[upload.name]]"></div>
        <div ng-if="upload.type === 'video'" exam-video-player upload="upload" no-popup="noPopup"  resolutions="{'ORIGINAL':'原画', 'HD': '1080p', 'VGA': '720p', 'QVGA': '480p'}"
        default-resolution="'HD'"  lang='zh-CN'
         settings="subject.settings"
        >
        </div>

        <div ng-if="upload.enable_origin_text && (canViewCorrectAnswer || canViewAnswerForClassroom || canViewAnswerExplanation)">
            <div class="show-text">
            原文/译文
            <label class="switch">
                <input type="checkbox" class="switch-input" ng-model="upload.show_text"/>
                <span class="switch-label" data-on="" data-off=""></span>
                <span class="switch-handle"></span>
            </label>
            </div>

            <span ng-show="upload.show_text" class="pre-wrap subject-description simditor-viewer origin-text mb-3"
            ng-compile-html="upload.text | sanitizeHtml" mathjax>
            </span>
        </div>
    </li>
</ul>
<div class="subject-body">
  <div class="answer-content" ng-init="getSubjectAnswerState(subject, submissionScoreData)">
    <ol class="subject-answers">
      <li class="answer" ng-repeat="answer in subject.answers | orderBy: 'sort' track by $index">
        <span ng-if="subject.answers.length > 1">
          <span class="sort circle-number" ng-bind-html="$index+1"></span>
        </span>
        <textarea
          class="content"
          type="text"
          ng-model="answer.content"
          disabled="disabled"
          auto-height-textarea
          format-validated
        ></textarea>
        <div class="answer-error" ng-if="canViewAnswerState">
          <span ng-if="!answer.content" class="answer-message tc-tag error">此题未答</span>
          <span ng-if="answer.content && answer.status == -1 " class="answer-message tc-tag error">
            回答错误
          </span>
        </div>
      </li>
    </ol>
  </div>
  <div
    class="subject-message"
    ng-if="canViewCorrectAnswer || canViewAnswerForClassroom || (canViewAnswerExplanation && subject.answer_explanation)"
  >
    <div class="note" ng-if="isInstructorViewAndNotSimulatedSubmission && subject.settings.show_note">
      <span>备注:&nbsp</span>
      <span ng-bind="subject.note"></span>
    </div>
    <div
      class="answer-options"
      ng-if="canViewCorrectAnswer || canViewAnswerForClassroom"
      ng-class="{'answer-only':isAnswerOnly(subject)}"
    >
      <span>正确答案:</span>
      <div class="row collapse correct_answer" ng-repeat="correctAnswer in subject.correct_answers">
        <span class="sort circle-number" ng-bind-html="$index+1"></span>
        <ul style="display: inline-grid">
          <li><span ng-bind="correctAnswer.content | unescapeHtmlChar"></span></li>
          <li ng-repeat="alternate in correctAnswer.alternates">
            <span ng-bind="alternate.content | unescapeHtmlChar"></span>
          </li>
        </ul>
      </div>
    </div>
    <div class="explanation" ng-if="canViewAnswerExplanation && subject.answer_explanation">
      <div class="explanation-label">答案解释:</div>
      <span class="simditor-viewer" ng-compile-html="subject.answer_explanation | sanitizeHtml" mathjax></span>
    </div>
    <div class="knowledge-node" ng-if="subject.knowledgeNodes">
        <div class="knowledge-node-label">知识点:</div>
        <div class="node-list">
            <div ng-repeat="node_reference in subject.knowledgeNodes">
                <knowledge-node-tag
                    ng-prop-course_id="node_reference.course_id"
                    ng-prop-node_id="node_reference.knowledge_node.id"
                    ng-prop-content="node_reference.knowledge_node.name"
                    ng-prop-go_to_graph="true"
                    size="medium"
                >
                </knowledge-node-tag>
            </div>
        </div>
    </div>
  </div>
</div></div>
<div ng-if="subject.type == 'short_answer'">
<div class="subject-head" ng-init="answerState = getSubjectAnswerState(subject, submissionScoreData)" ng-attr-id="[[subject.id]]">
    <div class="summary-title" ng-class="{'required': subject.settings.required}">
<div class="subject-resort-index" ng-hide="ui.editSubjectPage">
    <span ng-if="!subject.parent_id || subject.data.is_random_subject">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>
    <span ng-if="subject.parent_id  && !subject.data.is_random_subject">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>


<div class="subject-resort-index" ng-if="ui.editSubjectPage">
    <span ng-if="!subject.parent_id">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type == 'random'">
        <span ng-bind="getSubjectIndex(parentSubject, $index)"></span>-<span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type != 'random'">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>        <span ng-compile-html="subject.displayedDescription || subject.description || '暂无题目描述' | sanitizeHtml"
            class="pre-wrap subject-description simditor-viewer" mathjax></span>
        <span class="answer-error"
              ng-if="!questionnaire && (canViewAnswerState || canViewAnswerForClassroom)">
            <span ng-if="answerState == -1" class="answer-message tc-tag error">此题未答</span>
            <span ng-if="answerState == 0" class="answer-message tc-tag error">回答错误</span>
            <span ng-if="answerState == 2" class="tc-tag info">部分答对</span>
        </span>
    </div>
    <div class="summary-sub-title">
        <span class="subject-point">
            <span ng-bind="subjectTypeMap[subject.type]"></span>
            <span ng-if="subject.score >= 0 && subject.score !== null && !questionnaire">
                (<span ng-bind="subject.getPoint()"></span>
                <span>分</span>)

                <span class="actual-score" ng-if="(isInstructorView || exam.is_announce_score_time_passed)"
                    ng-init="subject.score_copy = subject.score">
                    <span ng-if="subject.type == 'fill_in_blank' && exam">
                        <span ng-if="canGiveScore"  ng-show="subject.showEdit">
                            <input ng-attr-id="[['input-' + subject.id]]" class="auto-width" name="score"
                                ng-disabled="course.score_published || !canShowOperations(exam)" ng-change="removeError(subject)"
                                esc-press="subject.score_copy" ng-on-change="editScore(subject)"
                                ng-blur="resetSubject(subject)" ng-model="subject.score" maxlength="4" server-validated
                                float-precision="1">
                            </input>
                        </span>
                        <span ng-show="!subject.showEdit">
                            <span ng-bind="subject.score"></span>
                            <span>分</span>
                            <a ng-if="canGiveScore" ng-click="edit(subject)"><i class="font font-edit"></i></a>
                        </span>
                    </span>
                    <span ng-if="subject.type != 'fill_in_blank' || !exam">[[subject.getScore()]]分</span>
                </span>
            </span>
            <span ng-if="!subject.score && subject.score != 0 && !questionnaire">
                (<span ng-bind="subject.getPoint()"></span>
                <span>分</span>)
            </span>
            <span class="sub-title-hint" ng-if="subject.type == 'matching'">
                <span ng-if="subject.score_rule == 'single'">(计分规则:按匹配正确项计分)</span>
                <span ng-if="subject.score_rule == 'overall'">(计分规则:有匹配错误项则该题目不得分)</span>
            </span>
            <span ng-if="isInstructorView && !questionnaire">
<span ng-if="!isQuestionnaire">（难易度:
    <span ng-if="subject.difficulty_level=='none'">中）</span>
    <span ng-if="subject.difficulty_level=='hard'">难）</span>
    <span ng-if="subject.difficulty_level=='medium'">中）</span>
    <span ng-if="subject.difficulty_level=='easy'">易）</span>
</span>            </span>
            <span class="sub-title-hint"
                ng-if="subject.type == 'fill_in_blank' && !allowExamEdit">(请按题目中的空缺顺序依次填写答案)</span>
            <span ng-if="subject.type == 'fill_in_blank' && allowExamEdit" class="error score-error ng-binding"
                ng-style="{'display': 'inline-block'}" ng-bind="subject.error || ''"></span>
        </span>
    </div>
</div>
<div class="subject-body" ng-init="instructorCommentMaxLen=5000;">
    <div class="answer-content flex">
        <div ng-compile-html="subject.answer | sanitizeHtml"
              class="pre-wrap subject-description simditor-viewer short-answer-view" mathjax>
        </div>
        <div class="operation-bar" ng-if="subject.textPdfUpload">
            <a stop-propagation previewer="{uploads: subject.attachments, currentFile: subject.textPdfUpload, activity: activity, isAttachment: isAttachment}" reveal-modal="file-previewer" class="opt-icon"
               tipsy-literal="预览" ng-click="downloadBlob(activity, subject.textPdfUpload, 'view')"
               ng-if="subject.textPdfUpload.source != 'LARK' &&
                      canPreview(subject.textPdfUpload) &&
                      !subject.textPdfUpload.deleted &&
                      !isInstructorView">
                <i class="font font-table-edit-view"></i>
            </a>
            <!-- 针对特殊source类型 -->
            <a stop-propagation ng-href="/api/uploads/[[subject.textPdfUpload.id]]/blob" class="opt-icon"
               tipsy-literal="下载" ng-click="downloadBlob(activity, subject.textPdfUpload)"
               ng-if="subject.textPdfUpload &&
                      !subject.textPdfUpload.reference_id &&
                      !subject.textPdfUpload.deleted &&
                      subject.textPdfUpload.allow_download &&
                      ['auto-generated-pdf'].includes(subject.textPdfUpload.source) &&
                      canShowResource(subject.textPdfUpload, isInstructorView)">
                <i class="font font-table-edit-download"></i>
            </a>
        </div>
    </div>
    <div ng-init="isViewSubmission = true">
            <div class="short-answer-upload-list"
                 ng-init="uploads = subject.displayAttachments" refresh-on="subject.displayAttachments">
<div class="attachments-wrapper" ng-if="uploads.length" stop-propagation check-upload-status>

<div class="attachment-header clearfix">
    <div class="attachment-column column" ng-class="{'large-11': true, 'large-15': !true}">
        附件名
    </div>
    <div class="attachment-column column" ng-if="ui.videoType !=='sobey'"
        ng-class="{'large-7': true, 'large-10': !true}">
        大小
    </div>
        <div ng-if="airHelper.canShowAttachmentQuestion(activity) === true" class="attachment-column column large-2">题目</div>
    <div class="attachment-column column large-3">&nbsp;</div>
</div>    <div class="attachment-body">
        <div ng-repeat="upload in uploads">
        <div class="attachment-row preview-able clearfix" ng-if="canPreview(upload) && !upload.deleted && canShowResource(upload, isInstructorView)"
             previewer="{uploads: uploads, currentFile: upload, activity: activity, isAttachment: isAttachment}" reveal-modal="file-previewer" ng-click="downloadBlob(activity, upload, 'view')">



    <div class="attachment-column column large-10" ng-if="upload.type != 'slide'" ng-class="{'large-20':upload.source === 'sobey'}">
        <div ng-if="upload.source == 'auto-generated-pdf'">
            <svg class="file-text-content left">
                <use xlink:href="#file-text-content"></use>
            </svg>
            <span class="file-name-wrapper truncate-text left">
                <span class="file-name" tipsy-literal="[[ upload.name.split('.')[0] ]]">[[ upload.name.split('.')[0] ]]</span>
            </span>
        </div>
        <div ng-if="upload.source !== 'auto-generated-pdf'" class="w-full flex">
            <i class="font font-file-[[fileTypeByExtension(upload)]] left"></i>
            <span class="file-name-wrapper truncate-text left">
                <span class="file-name" tipsy-literal="[[ upload.name ]]" ng-bind="upload.name|fileName"></span>
            </span>
            <span class="file-extension left" ng-bind="upload.name|fileExtension"></span>
        </div>
    </div>
    <div class="attachment-column column large-10" ng-if="upload.type == 'slide'">
        <i class="font font-slide left"></i>
        <span class="file-name-wrapper truncate-text left">
            <span class="file-name" tipsy-literal="[[ upload.title ]]" ng-bind="upload.title|fileName"></span>
        </span>
    </div>
        <div class="attachment-column column attachment-state" ng-if="!upload.deleted && upload.source !== 'sobey'"
            ng-class="{'large-1': true, 'large-5': !true}">
        <span ng-if="!upload.status || upload.status === 'ready' || (upload.status === 'processing' && (upload.type === 'video' || upload.videos)) || upload.status === 'none' || upload.deleted || wpsPreview(upload)">&nbsp;</span>
        <span ng-if="(upload.status === 'failed' || uploadsStatus[upload.id] === 'failed') && !upload.deleted">&nbsp;</span>
        <span ng-if="(upload.status === 'processing' || uploadsStatus[upload.id] === 'processing') && (upload.type != 'video' || !upload.videos) && !upload.deleted && !wpsPreview(upload)">&nbsp;</span>
    </div>
    <div class="attachment-column column attachment-deleted large-5" ng-if="upload.deleted">
        <span>文件已删除</span>
    </div>
    <div class="attachment-column column attachment-size attachment-marked"
         ng-class="{'large-7': true, 'large-10': !true}"
         ng-init="isUploadFailed = (upload.status || uploadsStatus[upload.id]) == 'failed';
                  isUploadProcessing = (upload.status || uploadsStatus[upload.id]) == 'processing';
                  isNotVideo = upload.type != 'video' || !upload.videos;
                  showFileSize = !isUploadFailed && !isUploadProcessing && upload.size >= 0">
        <span ng-if="upload.source == 'LARK'" style="height: 1px;">——</span>
        <span ng-if="upload.source != 'LARK' && showFileSize" ng-bind="upload.size|humanizeBytes"></span>
        <span ng-if="upload.source != 'LARK' && !showFileSize && !upload.deleted">
            <span ng-if="isUploadFailed" class="attachment-state-failed">
                    转码失败
            </span>
            <span ng-if="isUploadProcessing && isNotVideo && !wpsPreview(upload)" class="attachment-state-processing">
                    正在转码中
            </span>
        </span>
        <div ng-if="upload.type=='scorm' && upload.scorm">
            教材大小:<span ng-bind="upload.scorm.files_size|humanizeBytes"></span>
        </div>
        <div ng-if="upload.type=='slide' && upload.duration">
            时长:<span ng-bind="upload.duration | formatTime"></span>
        </div>
    </div>



        <div ng-if="airHelper.canShowAttachmentQuestion(activity) === true" class="attachment-column column large-2">
            <span class="aiQuiz-content">
                [[upload.aiQuiz.subjectsCount || "--"]]
            </span>
        </div>

    <div class="attachment-column column"
         ng-class="{'large-7': true, 'large-5': !true}">
<span class="attachment-operations">
        <div class="horizon">



            <a ng-if="canCheckMarked(upload.id)" class="marked-details" ng-click="openMarkedDetail(upload)" stop-propagation>
                查看批注
            </a>
            <a target="_blank" ng-if="upload.source == 'LARK'" ng-href="[[upload.url]]" tipsy-literal="预览">
                <i class="font font-table-edit-view-2"></i>
            </a>
            <a stop-propagation previewer="{uploads: uploads, currentFile: upload, activity: activity, isAttachment: isAttachment}" reveal-modal="file-previewer"
                tipsy-literal="预览" ng-click="downloadBlob(activity, upload, 'view')"
                ng-if="upload.source != 'LARK' && canPreview(upload) && !upload.deleted && canShowResource(upload, isInstructorView) && upload.id > 0">
                <i class="font font-table-edit-view-2"></i>
            </a>
        <a ng-click="openSobeyVideo()" ng-if="upload.source==='sobey'">
            <i class="font font-table-edit-view-2"></i>
        </a>
            <a stop-propagation tipsy-literal="批改"
                ng-click="openEditor(upload.id, subject)"
                ng-if="canEditByPdfEditor(upload) && subject && isInstructorView && !progressUi.inPreview">
                <i class="font font-edit"></i>
                <span class="dropdown-item">批改</span>
            </a>
                <a stop-propagation ng-href="/api/uploads/reference/[[upload.reference_id]]/blob" target="_blank"
                    tipsy-literal="下载" ng-click="downloadBlob(activity, upload)"
                    ng-if="upload.reference_id && !upload.deleted && upload.allow_download && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
                <a stop-propagation ng-href="/api/uploads/[[upload.id]]/blob?preview=true&activity_type=[[activity.type]]" target="_blank"
                    tipsy-literal="下载" ng-click="downloadBlob(activity, upload)"
                    ng-if="!upload.reference_id && !upload.deleted && upload.allow_download && !upload.source && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
                <a stop-propagation ng-href="[[upload.url]]/download" target="_blank"
                    tipsy-literal="下载" ng-click="downloadBlob(activity, upload)"
                    ng-if="upload.source && !['LARK', 'auto-generated-pdf', 'WEDRIVE'].includes(upload.source) && !upload.reference_id && !upload.deleted && upload.allow_download && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
                <!-- 针对特殊source类型 -->
                <a stop-propagation ng-href="/api/uploads/[[upload.id]]/blob"
                    tipsy-literal="下载" ng-click="downloadBlob(activity, upload)"
                    ng-if="!upload.reference_id && !upload.deleted && upload.allow_download && ['auto-generated-pdf'].includes(upload.source) && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
                <a stop-propagation ng-href="/api/wedrive/file/[[upload.fileid]]"
                    tipsy-literal="下载"
                    ng-if="!upload.deleted && upload.allow_download && upload.source == 'WEDRIVE' && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
        </div>
</span>    </div>

</div>

<div class="attachment-row clearfix" ng-if="!canPreview(upload) || upload.deleted || !canShowResource(upload, isInstructorView)" ng-click="downloadWeDrive(upload)">


    <div class="attachment-column column large-10" ng-if="upload.type != 'slide'" ng-class="{'large-20':upload.source === 'sobey'}">
        <div ng-if="upload.source == 'auto-generated-pdf'">
            <svg class="file-text-content left">
                <use xlink:href="#file-text-content"></use>
            </svg>
            <span class="file-name-wrapper truncate-text left">
                <span class="file-name" tipsy-literal="[[ upload.name.split('.')[0] ]]">[[ upload.name.split('.')[0] ]]</span>
            </span>
        </div>
        <div ng-if="upload.source !== 'auto-generated-pdf'" class="w-full flex">
            <i class="font font-file-[[fileTypeByExtension(upload)]] left"></i>
            <span class="file-name-wrapper truncate-text left">
                <span class="file-name" tipsy-literal="[[ upload.name ]]" ng-bind="upload.name|fileName"></span>
            </span>
            <span class="file-extension left" ng-bind="upload.name|fileExtension"></span>
        </div>
    </div>
    <div class="attachment-column column large-10" ng-if="upload.type == 'slide'">
        <i class="font font-slide left"></i>
        <span class="file-name-wrapper truncate-text left">
            <span class="file-name" tipsy-literal="[[ upload.title ]]" ng-bind="upload.title|fileName"></span>
        </span>
    </div>
        <div class="attachment-column column attachment-state" ng-if="!upload.deleted && upload.source !== 'sobey'"
            ng-class="{'large-1': true, 'large-5': !true}">
        <span ng-if="!upload.status || upload.status === 'ready' || (upload.status === 'processing' && (upload.type === 'video' || upload.videos)) || upload.status === 'none' || upload.deleted || wpsPreview(upload)">&nbsp;</span>
        <span ng-if="(upload.status === 'failed' || uploadsStatus[upload.id] === 'failed') && !upload.deleted">&nbsp;</span>
        <span ng-if="(upload.status === 'processing' || uploadsStatus[upload.id] === 'processing') && (upload.type != 'video' || !upload.videos) && !upload.deleted && !wpsPreview(upload)">&nbsp;</span>
    </div>
    <div class="attachment-column column attachment-deleted large-5" ng-if="upload.deleted">
        <span>文件已删除</span>
    </div>
    <div class="attachment-column column attachment-size attachment-marked"
         ng-class="{'large-7': true, 'large-10': !true}"
         ng-init="isUploadFailed = (upload.status || uploadsStatus[upload.id]) == 'failed';
                  isUploadProcessing = (upload.status || uploadsStatus[upload.id]) == 'processing';
                  isNotVideo = upload.type != 'video' || !upload.videos;
                  showFileSize = !isUploadFailed && !isUploadProcessing && upload.size >= 0">
        <span ng-if="upload.source == 'LARK'" style="height: 1px;">——</span>
        <span ng-if="upload.source != 'LARK' && showFileSize" ng-bind="upload.size|humanizeBytes"></span>
        <span ng-if="upload.source != 'LARK' && !showFileSize && !upload.deleted">
            <span ng-if="isUploadFailed" class="attachment-state-failed">
                    转码失败
            </span>
            <span ng-if="isUploadProcessing && isNotVideo && !wpsPreview(upload)" class="attachment-state-processing">
                    正在转码中
            </span>
        </span>
        <div ng-if="upload.type=='scorm' && upload.scorm">
            教材大小:<span ng-bind="upload.scorm.files_size|humanizeBytes"></span>
        </div>
        <div ng-if="upload.type=='slide' && upload.duration">
            时长:<span ng-bind="upload.duration | formatTime"></span>
        </div>
    </div>



        <div ng-if="airHelper.canShowAttachmentQuestion(activity) === true" class="attachment-column column large-2">
            <span class="aiQuiz-content">
                [[upload.aiQuiz.subjectsCount || "--"]]
            </span>
        </div>

    <div class="attachment-column column"
         ng-class="{'large-7': true, 'large-5': !true}">
<span class="attachment-operations">
        <div class="horizon">



            <a ng-if="canCheckMarked(upload.id)" class="marked-details" ng-click="openMarkedDetail(upload)" stop-propagation>
                查看批注
            </a>
            <a target="_blank" ng-if="upload.source == 'LARK'" ng-href="[[upload.url]]" tipsy-literal="预览">
                <i class="font font-table-edit-view-2"></i>
            </a>
            <a stop-propagation previewer="{uploads: uploads, currentFile: upload, activity: activity, isAttachment: isAttachment}" reveal-modal="file-previewer"
                tipsy-literal="预览" ng-click="downloadBlob(activity, upload, 'view')"
                ng-if="upload.source != 'LARK' && canPreview(upload) && !upload.deleted && canShowResource(upload, isInstructorView) && upload.id > 0">
                <i class="font font-table-edit-view-2"></i>
            </a>
        <a ng-click="openSobeyVideo()" ng-if="upload.source==='sobey'">
            <i class="font font-table-edit-view-2"></i>
        </a>
            <a stop-propagation tipsy-literal="批改"
                ng-click="openEditor(upload.id, subject)"
                ng-if="canEditByPdfEditor(upload) && subject && isInstructorView && !progressUi.inPreview">
                <i class="font font-edit"></i>
                <span class="dropdown-item">批改</span>
            </a>
                <a stop-propagation ng-href="/api/uploads/reference/[[upload.reference_id]]/blob" target="_blank"
                    tipsy-literal="下载" ng-click="downloadBlob(activity, upload)"
                    ng-if="upload.reference_id && !upload.deleted && upload.allow_download && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
                <a stop-propagation ng-href="/api/uploads/[[upload.id]]/blob?preview=true&activity_type=[[activity.type]]" target="_blank"
                    tipsy-literal="下载" ng-click="downloadBlob(activity, upload)"
                    ng-if="!upload.reference_id && !upload.deleted && upload.allow_download && !upload.source && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
                <a stop-propagation ng-href="[[upload.url]]/download" target="_blank"
                    tipsy-literal="下载" ng-click="downloadBlob(activity, upload)"
                    ng-if="upload.source && !['LARK', 'auto-generated-pdf', 'WEDRIVE'].includes(upload.source) && !upload.reference_id && !upload.deleted && upload.allow_download && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
                <!-- 针对特殊source类型 -->
                <a stop-propagation ng-href="/api/uploads/[[upload.id]]/blob"
                    tipsy-literal="下载" ng-click="downloadBlob(activity, upload)"
                    ng-if="!upload.reference_id && !upload.deleted && upload.allow_download && ['auto-generated-pdf'].includes(upload.source) && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
                <a stop-propagation ng-href="/api/wedrive/file/[[upload.fileid]]"
                    tipsy-literal="下载"
                    ng-if="!upload.deleted && upload.allow_download && upload.source == 'WEDRIVE' && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
        </div>
</span>    </div>

</div>        </div>
    </div>
</div>            </div>
    </div>

    <div class="subject-message" ng-if="!questionnaire && canViewAnswerExplanation">
        <div class="note" ng-if="isInstructorViewAndNotSimulatedSubmission && subject.settings.show_note">
            <span>备注:&nbsp</span>
            <span ng-bind="subject.note"></span>
        </div>
        <div class="explanation" ng-show="subject.answer_explanation">
            <div class="explanation-label">答案解释:</div>
            <span class="simditor-viewer" ng-compile-html="subject.answer_explanation | sanitizeHtml" mathjax></span>
        </div>
    <div class="knowledge-node" ng-if="subject.knowledgeNodes">
        <div class="knowledge-node-label">知识点:</div>
        <div class="node-list">
            <div ng-repeat="node_reference in subject.knowledgeNodes">
                <knowledge-node-tag
                    ng-prop-course_id="node_reference.course_id"
                    ng-prop-node_id="node_reference.knowledge_node.id"
                    ng-prop-content="node_reference.knowledge_node.name"
                    ng-prop-go_to_graph="true"
                    size="medium"
                >
                </knowledge-node-tag>
            </div>
        </div>
    </div>
    </div>
    <div class="subject-score" ng-if="canGiveScore" ng-init="subject.score_copy = subject.score">
        <span class="field-title">分值:</span>
        <input type="text" name="score" ng-model="subject.score"
               ng-disabled="course.score_published || !canShowOperations(exam)"
               ng-class="{'ng-invalid': subject.error}"
               ng-change="removeError(subject)"
               esc-press="subject.score_copy"
               model-patron="{required: false}"
               submit-callback="autoSaveScore(subject)"
               maxlength="4" float-precision="1" />
        <span class="error score-error" ng-bind="subject.error || ''"></span>
    </div>
    <div class="submission-comment student-view" ng-if="examId && subject.comment && !allowExamEdit">
        <div class="teacher-comment">
            <div class="comment-label">教师评语:</div>
            <span class="comment-content" ng-bind="subject.comment"></span>
        </div>
    </div>
    <div class="submission-comment" ng-if="canGiveScore && examId"
         ng-init="bindLeftCommentLength(subject, instructorCommentMaxLen)">
        <span class="field-title">教师评语:</span>
        <div class="comment-area-container" ng-class="{'is-focus': subject.isFocus}" ng-init="subject.isFocus = false;">
            <textarea class="comment-content" rows="6" name="comment"
                      ng-focus="subject.isFocus=true"
                      ng-blur="subject.isFocus=false"
                      ng-model="subject.comment"
                      ng-disabled="!canShowOperations(exam)"
                      placeholder="您可以在此输入评语"
                      content-length-limit="commentContentExceeded(subject, $exceeded, instructorCommentMaxLen)"
                      content-length-max="[[instructorCommentMaxLen]]"
                      model-patron="{required: false, enterToSubmit: false, bindConvertValue: false}"
                      submit-callback="autoSaveSubmissionComment(subject)">
            </textarea>
            <div class="left-count">
                 <span>[[subject.leftCommentLength]]</span>
            </div>
        </div>
    </div>
    <div ng-if="true">
        <div ng-init="isViewSubmission = true">
            <div class="short-answer-marked-upload-list"
                 ng-init="uploads = subject.marked_attachments; isAttachment = true" refresh-on="subject.marked_attachments">
<div class="attachments-wrapper" ng-if="uploads.length" stop-propagation check-upload-status>
    <span class="field-title">批改附件</span>

<div class="attachment-header clearfix">
    <div class="attachment-column column" ng-class="{'large-11': true, 'large-15': !true}">
        附件名
    </div>
    <div class="attachment-column column" ng-if="ui.videoType !=='sobey'"
        ng-class="{'large-7': true, 'large-10': !true}">
        大小
    </div>
        <div ng-if="airHelper.canShowAttachmentQuestion(activity) === true" class="attachment-column column large-2">题目</div>
    <div class="attachment-column column large-3">&nbsp;</div>
</div>    <div ng-repeat="upload in uploads">
        <div class="attachment-row preview-able clearfix" ng-if="canPreview(upload) && !upload.deleted && canShowResource(upload, isInstructorView)"
             previewer="{uploads: uploads, currentFile: upload, activity: activity, isAttachment: isAttachment}" reveal-modal="file-previewer" ng-click="downloadBlob(activity, upload, 'view')">



    <div class="attachment-column column large-10" ng-if="upload.type != 'slide'" ng-class="{'large-20':upload.source === 'sobey'}">
        <div ng-if="upload.source == 'auto-generated-pdf'">
            <svg class="file-text-content left">
                <use xlink:href="#file-text-content"></use>
            </svg>
            <span class="file-name-wrapper truncate-text left">
                <span class="file-name" tipsy-literal="[[ upload.name.split('.')[0] ]]">[[ upload.name.split('.')[0] ]]</span>
            </span>
        </div>
        <div ng-if="upload.source !== 'auto-generated-pdf'" class="w-full flex">
            <i class="font font-file-[[fileTypeByExtension(upload)]] left"></i>
            <span class="file-name-wrapper truncate-text left">
                <span class="file-name" tipsy-literal="[[ upload.name ]]" ng-bind="upload.name|fileName"></span>
            </span>
            <span class="file-extension left" ng-bind="upload.name|fileExtension"></span>
        </div>
    </div>
    <div class="attachment-column column large-10" ng-if="upload.type == 'slide'">
        <i class="font font-slide left"></i>
        <span class="file-name-wrapper truncate-text left">
            <span class="file-name" tipsy-literal="[[ upload.title ]]" ng-bind="upload.title|fileName"></span>
        </span>
    </div>
        <div class="attachment-column column attachment-state" ng-if="!upload.deleted && upload.source !== 'sobey'"
            ng-class="{'large-1': true, 'large-5': !true}">
        <span ng-if="!upload.status || upload.status === 'ready' || (upload.status === 'processing' && (upload.type === 'video' || upload.videos)) || upload.status === 'none' || upload.deleted || wpsPreview(upload)">&nbsp;</span>
        <span ng-if="(upload.status === 'failed' || uploadsStatus[upload.id] === 'failed') && !upload.deleted">&nbsp;</span>
        <span ng-if="(upload.status === 'processing' || uploadsStatus[upload.id] === 'processing') && (upload.type != 'video' || !upload.videos) && !upload.deleted && !wpsPreview(upload)">&nbsp;</span>
    </div>
    <div class="attachment-column column attachment-deleted large-5" ng-if="upload.deleted">
        <span>文件已删除</span>
    </div>
    <div class="attachment-column column attachment-size attachment-marked"
         ng-class="{'large-7': true, 'large-10': !true}"
         ng-init="isUploadFailed = (upload.status || uploadsStatus[upload.id]) == 'failed';
                  isUploadProcessing = (upload.status || uploadsStatus[upload.id]) == 'processing';
                  isNotVideo = upload.type != 'video' || !upload.videos;
                  showFileSize = !isUploadFailed && !isUploadProcessing && upload.size >= 0">
        <span ng-if="upload.source == 'LARK'" style="height: 1px;">——</span>
        <span ng-if="upload.source != 'LARK' && showFileSize" ng-bind="upload.size|humanizeBytes"></span>
        <span ng-if="upload.source != 'LARK' && !showFileSize && !upload.deleted">
            <span ng-if="isUploadFailed" class="attachment-state-failed">
                    转码失败
            </span>
            <span ng-if="isUploadProcessing && isNotVideo && !wpsPreview(upload)" class="attachment-state-processing">
                    正在转码中
            </span>
        </span>
        <div ng-if="upload.type=='scorm' && upload.scorm">
            教材大小:<span ng-bind="upload.scorm.files_size|humanizeBytes"></span>
        </div>
        <div ng-if="upload.type=='slide' && upload.duration">
            时长:<span ng-bind="upload.duration | formatTime"></span>
        </div>
    </div>



        <div ng-if="airHelper.canShowAttachmentQuestion(activity) === true" class="attachment-column column large-2">
            <span class="aiQuiz-content">
                [[upload.aiQuiz.subjectsCount || "--"]]
            </span>
        </div>

    <div class="attachment-column column"
         ng-class="{'large-7': true, 'large-5': !true}">
<span class="attachment-operations">
        <div class="horizon">



            <a ng-if="canCheckMarked(upload.id)" class="marked-details" ng-click="openMarkedDetail(upload)" stop-propagation>
                查看批注
            </a>
            <a target="_blank" ng-if="upload.source == 'LARK'" ng-href="[[upload.url]]" tipsy-literal="预览">
                <i class="font font-table-edit-view-2"></i>
            </a>
            <a stop-propagation previewer="{uploads: uploads, currentFile: upload, activity: activity, isAttachment: isAttachment}" reveal-modal="file-previewer"
                tipsy-literal="预览" ng-click="downloadBlob(activity, upload, 'view')"
                ng-if="upload.source != 'LARK' && canPreview(upload) && !upload.deleted && canShowResource(upload, isInstructorView) && upload.id > 0">
                <i class="font font-table-edit-view-2"></i>
            </a>
        <a ng-click="openSobeyVideo()" ng-if="upload.source==='sobey'">
            <i class="font font-table-edit-view-2"></i>
        </a>
                <a stop-propagation ng-href="/api/uploads/reference/[[upload.reference_id]]/blob" target="_blank"
                    tipsy-literal="下载" ng-click="downloadBlob(activity, upload)"
                    ng-if="upload.reference_id && !upload.deleted && upload.allow_download && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
                <a stop-propagation ng-href="/api/uploads/[[upload.id]]/blob?preview=true&activity_type=[[activity.type]]" target="_blank"
                    tipsy-literal="下载" ng-click="downloadBlob(activity, upload)"
                    ng-if="!upload.reference_id && !upload.deleted && upload.allow_download && !upload.source && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
                <a stop-propagation ng-href="[[upload.url]]/download" target="_blank"
                    tipsy-literal="下载" ng-click="downloadBlob(activity, upload)"
                    ng-if="upload.source && !['LARK', 'auto-generated-pdf', 'WEDRIVE'].includes(upload.source) && !upload.reference_id && !upload.deleted && upload.allow_download && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
                <!-- 针对特殊source类型 -->
                <a stop-propagation ng-href="/api/uploads/[[upload.id]]/blob"
                    tipsy-literal="下载" ng-click="downloadBlob(activity, upload)"
                    ng-if="!upload.reference_id && !upload.deleted && upload.allow_download && ['auto-generated-pdf'].includes(upload.source) && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
                <a stop-propagation ng-href="/api/wedrive/file/[[upload.fileid]]"
                    tipsy-literal="下载"
                    ng-if="!upload.deleted && upload.allow_download && upload.source == 'WEDRIVE' && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
        </div>
</span>    </div>

</div>

<div class="attachment-row clearfix" ng-if="!canPreview(upload) || upload.deleted || !canShowResource(upload, isInstructorView)" ng-click="downloadWeDrive(upload)">


    <div class="attachment-column column large-10" ng-if="upload.type != 'slide'" ng-class="{'large-20':upload.source === 'sobey'}">
        <div ng-if="upload.source == 'auto-generated-pdf'">
            <svg class="file-text-content left">
                <use xlink:href="#file-text-content"></use>
            </svg>
            <span class="file-name-wrapper truncate-text left">
                <span class="file-name" tipsy-literal="[[ upload.name.split('.')[0] ]]">[[ upload.name.split('.')[0] ]]</span>
            </span>
        </div>
        <div ng-if="upload.source !== 'auto-generated-pdf'" class="w-full flex">
            <i class="font font-file-[[fileTypeByExtension(upload)]] left"></i>
            <span class="file-name-wrapper truncate-text left">
                <span class="file-name" tipsy-literal="[[ upload.name ]]" ng-bind="upload.name|fileName"></span>
            </span>
            <span class="file-extension left" ng-bind="upload.name|fileExtension"></span>
        </div>
    </div>
    <div class="attachment-column column large-10" ng-if="upload.type == 'slide'">
        <i class="font font-slide left"></i>
        <span class="file-name-wrapper truncate-text left">
            <span class="file-name" tipsy-literal="[[ upload.title ]]" ng-bind="upload.title|fileName"></span>
        </span>
    </div>
        <div class="attachment-column column attachment-state" ng-if="!upload.deleted && upload.source !== 'sobey'"
            ng-class="{'large-1': true, 'large-5': !true}">
        <span ng-if="!upload.status || upload.status === 'ready' || (upload.status === 'processing' && (upload.type === 'video' || upload.videos)) || upload.status === 'none' || upload.deleted || wpsPreview(upload)">&nbsp;</span>
        <span ng-if="(upload.status === 'failed' || uploadsStatus[upload.id] === 'failed') && !upload.deleted">&nbsp;</span>
        <span ng-if="(upload.status === 'processing' || uploadsStatus[upload.id] === 'processing') && (upload.type != 'video' || !upload.videos) && !upload.deleted && !wpsPreview(upload)">&nbsp;</span>
    </div>
    <div class="attachment-column column attachment-deleted large-5" ng-if="upload.deleted">
        <span>文件已删除</span>
    </div>
    <div class="attachment-column column attachment-size attachment-marked"
         ng-class="{'large-7': true, 'large-10': !true}"
         ng-init="isUploadFailed = (upload.status || uploadsStatus[upload.id]) == 'failed';
                  isUploadProcessing = (upload.status || uploadsStatus[upload.id]) == 'processing';
                  isNotVideo = upload.type != 'video' || !upload.videos;
                  showFileSize = !isUploadFailed && !isUploadProcessing && upload.size >= 0">
        <span ng-if="upload.source == 'LARK'" style="height: 1px;">——</span>
        <span ng-if="upload.source != 'LARK' && showFileSize" ng-bind="upload.size|humanizeBytes"></span>
        <span ng-if="upload.source != 'LARK' && !showFileSize && !upload.deleted">
            <span ng-if="isUploadFailed" class="attachment-state-failed">
                    转码失败
            </span>
            <span ng-if="isUploadProcessing && isNotVideo && !wpsPreview(upload)" class="attachment-state-processing">
                    正在转码中
            </span>
        </span>
        <div ng-if="upload.type=='scorm' && upload.scorm">
            教材大小:<span ng-bind="upload.scorm.files_size|humanizeBytes"></span>
        </div>
        <div ng-if="upload.type=='slide' && upload.duration">
            时长:<span ng-bind="upload.duration | formatTime"></span>
        </div>
    </div>



        <div ng-if="airHelper.canShowAttachmentQuestion(activity) === true" class="attachment-column column large-2">
            <span class="aiQuiz-content">
                [[upload.aiQuiz.subjectsCount || "--"]]
            </span>
        </div>

    <div class="attachment-column column"
         ng-class="{'large-7': true, 'large-5': !true}">
<span class="attachment-operations">
        <div class="horizon">



            <a ng-if="canCheckMarked(upload.id)" class="marked-details" ng-click="openMarkedDetail(upload)" stop-propagation>
                查看批注
            </a>
            <a target="_blank" ng-if="upload.source == 'LARK'" ng-href="[[upload.url]]" tipsy-literal="预览">
                <i class="font font-table-edit-view-2"></i>
            </a>
            <a stop-propagation previewer="{uploads: uploads, currentFile: upload, activity: activity, isAttachment: isAttachment}" reveal-modal="file-previewer"
                tipsy-literal="预览" ng-click="downloadBlob(activity, upload, 'view')"
                ng-if="upload.source != 'LARK' && canPreview(upload) && !upload.deleted && canShowResource(upload, isInstructorView) && upload.id > 0">
                <i class="font font-table-edit-view-2"></i>
            </a>
        <a ng-click="openSobeyVideo()" ng-if="upload.source==='sobey'">
            <i class="font font-table-edit-view-2"></i>
        </a>
                <a stop-propagation ng-href="/api/uploads/reference/[[upload.reference_id]]/blob" target="_blank"
                    tipsy-literal="下载" ng-click="downloadBlob(activity, upload)"
                    ng-if="upload.reference_id && !upload.deleted && upload.allow_download && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
                <a stop-propagation ng-href="/api/uploads/[[upload.id]]/blob?preview=true&activity_type=[[activity.type]]" target="_blank"
                    tipsy-literal="下载" ng-click="downloadBlob(activity, upload)"
                    ng-if="!upload.reference_id && !upload.deleted && upload.allow_download && !upload.source && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
                <a stop-propagation ng-href="[[upload.url]]/download" target="_blank"
                    tipsy-literal="下载" ng-click="downloadBlob(activity, upload)"
                    ng-if="upload.source && !['LARK', 'auto-generated-pdf', 'WEDRIVE'].includes(upload.source) && !upload.reference_id && !upload.deleted && upload.allow_download && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
                <!-- 针对特殊source类型 -->
                <a stop-propagation ng-href="/api/uploads/[[upload.id]]/blob"
                    tipsy-literal="下载" ng-click="downloadBlob(activity, upload)"
                    ng-if="!upload.reference_id && !upload.deleted && upload.allow_download && ['auto-generated-pdf'].includes(upload.source) && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
                <a stop-propagation ng-href="/api/wedrive/file/[[upload.fileid]]"
                    tipsy-literal="下载"
                    ng-if="!upload.deleted && upload.allow_download && upload.source == 'WEDRIVE' && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
        </div>
</span>    </div>

</div>    </div>
</div>            </div>
        </div>
    </div>
</div></div>
<div ng-if="subject.type == 'matching'">
<div class="subject-head" ng-init="answerState = getSubjectAnswerState(subject, submissionScoreData)" ng-attr-id="[[subject.id]]">
    <div class="summary-title" ng-class="{'required': subject.settings.required}">
<div class="subject-resort-index" ng-hide="ui.editSubjectPage">
    <span ng-if="!subject.parent_id || subject.data.is_random_subject">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>
    <span ng-if="subject.parent_id  && !subject.data.is_random_subject">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>


<div class="subject-resort-index" ng-if="ui.editSubjectPage">
    <span ng-if="!subject.parent_id">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type == 'random'">
        <span ng-bind="getSubjectIndex(parentSubject, $index)"></span>-<span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type != 'random'">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>        <span ng-compile-html="subject.displayedDescription || subject.description || '暂无题目描述' | sanitizeHtml"
            class="pre-wrap subject-description simditor-viewer" mathjax></span>
        <span class="answer-error"
              ng-if="!questionnaire && (canViewAnswerState || canViewAnswerForClassroom)">
            <span ng-if="answerState == -1" class="answer-message tc-tag error">此题未答</span>
            <span ng-if="answerState == 0" class="answer-message tc-tag error">回答错误</span>
            <span ng-if="answerState == 2" class="tc-tag info">部分答对</span>
        </span>
    </div>
    <div class="summary-sub-title">
        <span class="subject-point">
            <span ng-bind="subjectTypeMap[subject.type]"></span>
            <span ng-if="subject.score >= 0 && subject.score !== null && !questionnaire">
                (<span ng-bind="subject.getPoint()"></span>
                <span>分</span>)

                <span class="actual-score" ng-if="(isInstructorView || exam.is_announce_score_time_passed)"
                    ng-init="subject.score_copy = subject.score">
                    <span ng-if="subject.type == 'fill_in_blank' && exam">
                        <span ng-if="canGiveScore"  ng-show="subject.showEdit">
                            <input ng-attr-id="[['input-' + subject.id]]" class="auto-width" name="score"
                                ng-disabled="course.score_published || !canShowOperations(exam)" ng-change="removeError(subject)"
                                esc-press="subject.score_copy" ng-on-change="editScore(subject)"
                                ng-blur="resetSubject(subject)" ng-model="subject.score" maxlength="4" server-validated
                                float-precision="1">
                            </input>
                        </span>
                        <span ng-show="!subject.showEdit">
                            <span ng-bind="subject.score"></span>
                            <span>分</span>
                            <a ng-if="canGiveScore" ng-click="edit(subject)"><i class="font font-edit"></i></a>
                        </span>
                    </span>
                    <span ng-if="subject.type != 'fill_in_blank' || !exam">[[subject.getScore()]]分</span>
                </span>
            </span>
            <span ng-if="!subject.score && subject.score != 0 && !questionnaire">
                (<span ng-bind="subject.getPoint()"></span>
                <span>分</span>)
            </span>
            <span class="sub-title-hint" ng-if="subject.type == 'matching'">
                <span ng-if="subject.score_rule == 'single'">(计分规则:按匹配正确项计分)</span>
                <span ng-if="subject.score_rule == 'overall'">(计分规则:有匹配错误项则该题目不得分)</span>
            </span>
            <span ng-if="isInstructorView && !questionnaire">
<span ng-if="!isQuestionnaire">（难易度:
    <span ng-if="subject.difficulty_level=='none'">中）</span>
    <span ng-if="subject.difficulty_level=='hard'">难）</span>
    <span ng-if="subject.difficulty_level=='medium'">中）</span>
    <span ng-if="subject.difficulty_level=='easy'">易）</span>
</span>            </span>
            <span class="sub-title-hint"
                ng-if="subject.type == 'fill_in_blank' && !allowExamEdit">(请按题目中的空缺顺序依次填写答案)</span>
            <span ng-if="subject.type == 'fill_in_blank' && allowExamEdit" class="error score-error ng-binding"
                ng-style="{'display': 'inline-block'}" ng-bind="subject.error || ''"></span>
        </span>
    </div>
</div>
<div class="subject-body">
    <div class="matching-subject">
        <ul class="matching-list"
            ng-class="subject.settings.options_layout"
            ng-style="{width: ui.calcOptionWidth(subject.options, subject.settings.options_layout)}"
            ng-repeat="sub_subject in subject.sub_subjects | orderBy: 'sort' track by $index">
            <li ng-if="sub_subject.sort == 0">
                <div class="tip-answer">
                    <div>提示</div>
                    <div class="line"></div>
                    <div>答案</div>
                </div>
            </li>
            <li ng-repeat="option in sub_subject.options | orderBy: 'sort'">
                <div ng-if="sub_subject.submittedOptionIds[0] == option.id" ng-init="vueParam={subjectDescription: sub_subject.description, subjectAnswer: option.content}">
                    <div vue-wrapper>
                        <match-subject-info class="tips" :content="subjectDescription"></match-subject-info>
                    </div>
                    <div class="line"><hr/></div>
                    <div vue-wrapper>
                        <match-subject-info class="answer" :content="subjectAnswer"></match-subject-info>
                    </div>
                    <div class="answer-error" ng-if="canViewAnswerState">
                        <span ng-if="sub_subject.correctOptions[0].id != option.id"
                              class="answer-message tc-tag error">回答错误</span>
                    </div>
                </div>
            </li>
            <li ng-if="sub_subject.submittedOptionIds.length == 0">
                <div ng-init="vueParam={subjectDescription: sub_subject.description}">
                    <div vue-wrapper>
                        <match-subject-info class="tips" :content="subjectDescription"></match-subject-info>
                    </div>
                    <div class="line"><hr/></div>
                    <div class="answer" style="height: 48px;"></div>
                    <div class="answer-error" ng-if="canViewAnswerState">
                        <span class="answer-message tc-tag error">此题未答</span>
                    </div>
                </div>
            </li>
        </ul>
    </div>
    <div class="matching-subject" ng-init="getSubjectAnswerState(subject)">
        <div class="correct-answer"
            ng-if="!questionnaire && (canViewCorrectAnswer || canViewAnswerForClassroom || canViewAnswerExplanation && (subject.answer_explanation || subject.wrong_explanation))">
            <div class="note" ng-if="isInstructorViewAndNotSimulatedSubmission && subject.settings.show_note">
                <span>备注:&nbsp</span>
                <span ng-bind="subject.note"></span>
            </div>
            <div class="answer-options" ng-class="{'answer-only':isAnswerOnly(subject)}"
                 ng-if="canViewCorrectAnswer || canViewAnswerForClassroom">
                <span>正确答案:</span>
                 <ul class="matching-list"
                ng-class="subject.settings.options_layout"
                ng-style="{width: ui.calcOptionWidth(subject.options, subject.settings.options_layout)}"
                ng-repeat="sub_subject in subject.sub_subjects | orderBy: 'sort'">

                <li ng-repeat="option in sub_subject.options | orderBy: 'sort'">
                    <div ng-if="sub_subject.correctOptions[0].id == option.id" ng-init="vueParam={subjectDescription: sub_subject.description, subjectAnswer: option.content}">
                        <div vue-wrapper>
                            <match-subject-info class="tips" :content="subjectDescription"></match-subject-info>
                        </div>
                        <div class="line"><hr/></div>
                        <div vue-wrapper>
                            <match-subject-info class="answer answer-bg" :content="subjectAnswer"></match-subject-info>
                        </div>
                        <div></div>
                    </div>
                </li>
            </ul>
            </div>
            <div class="explanation" ng-if="canViewAnswerExplanation && subject.answer_explanation && answerState != 0">
                <div class="explanation-label">答案解释:</div>
                <span class="simditor-viewer" ng-compile-html="subject.answer_explanation | sanitizeHtml" mathjax></span>
            </div>
            <div class="explanation" ng-if="canViewAnswerExplanation && subject.wrong_explanation && answerState == 0">
                <div class="explanation-label">答案解释:</div>
                <span class="simditor-viewer" ng-compile-html="subject.wrong_explanation | sanitizeHtml" mathjax></span>
            </div>
    <div class="knowledge-node" ng-if="subject.knowledgeNodes">
        <div class="knowledge-node-label">知识点:</div>
        <div class="node-list">
            <div ng-repeat="node_reference in subject.knowledgeNodes">
                <knowledge-node-tag
                    ng-prop-course_id="node_reference.course_id"
                    ng-prop-node_id="node_reference.knowledge_node.id"
                    ng-prop-content="node_reference.knowledge_node.name"
                    ng-prop-go_to_graph="true"
                    size="medium"
                >
                </knowledge-node-tag>
            </div>
        </div>
    </div>
        </div>
    </div>
</div></div>
<div ng-if="subject.type == 'cloze'">
<div class="subject-head" ng-attr-id="[[subject.id]]">
    <div class="summary-title">
<div class="subject-resort-index" ng-hide="ui.editSubjectPage">
    <span ng-if="!subject.parent_id || subject.data.is_random_subject">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>
    <span ng-if="subject.parent_id  && !subject.data.is_random_subject">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>


<div class="subject-resort-index" ng-if="ui.editSubjectPage">
    <span ng-if="!subject.parent_id">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type == 'random'">
        <span ng-bind="getSubjectIndex(parentSubject, $index)"></span>-<span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type != 'random'">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>        <span ng-compile-html="subject.description || '暂无题目描述' | sanitizeHtml" class="pre-wrap exam-subject simditor-viewer" mathjax></span>
    </div>
    <div class="summary-sub-title">
        <span class="subject-point">
            <span ng-bind="subjectTypeMap[subject.type]"></span>
            <span ng-if="subject.score >= 0 && !questionnaire">
                (<span ng-bind="subject.getPoint()"></span>
                <span>分</span>)

                <span class="actual-score" ng-if="subject.score !== ''">
                    <span ng-bind="subject.score"></span>
                    <span>分</span>
                </span>
            </span>
            <span ng-if="!subject.score && subject.score != 0 && !questionnaire">
                (<span ng-bind="subject.getPoint()"></span>
                <span>分</span>)
            </span>
        </span>
          <span ng-if="isInstructorView && !questionnaire">
<span ng-if="!isQuestionnaire">（难易度:
    <span ng-if="subject.difficulty_level=='none'">中）</span>
    <span ng-if="subject.difficulty_level=='hard'">难）</span>
    <span ng-if="subject.difficulty_level=='medium'">中）</span>
    <span ng-if="subject.difficulty_level=='easy'">易）</span>
</span>          </span>
    </div>
</div>

<div class="subject-body">
    <ol ng-if="subject.sub_subjects.length > 0" class="cloze-sub-subjects"
        sortable="sub-subject" ng-init="parentSubject = subject">
        <li ng-repeat="subSubject in parentSubject.sub_subjects" class="sub-subject-content">
            <div class="sub-subject" style="display: flex;" ng-init="subject = subSubject">
<div class="subject-resort-index" ng-hide="ui.editSubjectPage">
    <span ng-if="!subject.parent_id || subject.data.is_random_subject">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>
    <span ng-if="subject.parent_id  && !subject.data.is_random_subject">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>


<div class="subject-resort-index" ng-if="ui.editSubjectPage">
    <span ng-if="!subject.parent_id">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type == 'random'">
        <span ng-bind="getSubjectIndex(parentSubject, $index)"></span>-<span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type != 'random'">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>                <div class="subject-body">
                    <ol class="subject-options">
                        <li class="option" ng-class="subject.settings.options_layout"
                            ng-style="{width: ui.calcOptionWidth(subject.options, subject.settings.options_layout)}"
                            ng-repeat="option in subject.options | orderBy: 'sort'">
                            <label ng-class="{'answered-option': option.id == subject.answeredOption}">
                                <span class="left">
                                  <input type="radio" ng-checked="option.isChosen" ng-disabled="true"/>
                                  <span class="option-index" ng-bind="ui.intToChar($index)"></span><span>.</span>
                                </span>

                                <div class="option-content">
                                    <span ng-compile-html="option.content | sanitizeHtml" class="pre-wrap simditor-viewer" mathjax></span>
                                </div>
                            </label>
                        </li>
                    </ol>
                </div>
                 <div class="answer-error" ng-if="canViewAnswerState" ng-init="answerState = getSubjectAnswerState(subject)">
                    <span ng-if="answerState == -1" class="answer-message tc-tag error">此题未答</span>
                    <span ng-if="answerState == 0" class="answer-message tc-tag error">回答错误</span>
                </div>
            </div>
        </li>
    </ol>

  <div class="subject-message"
    ng-if="!questionnaire && (canViewCorrectAnswer || canViewAnswerForClassroom || canViewAnswerExplanation && (subject.answer_explanation || subject.wrong_explanation))">
    <div class="note" ng-if="isInstructorViewAndNotSimulatedSubmission && subject.settings.show_note">
        <span>备注:&nbsp</span>
        <span ng-bind="subject.note"></span>
    </div>
    <div class="answer-options"
        ng-if="canViewCorrectAnswer || canViewAnswerForClassroom">
        <span>正确答案:</span>
        <span class="answer-option" ng-repeat="option in subject.correctOptions">
          ([[option.parent.sort + 1]]) [[ui.intToChar(option.sort)]]&nbsp&nbsp&nbsp
        </span>
    </div>
    <div class="explanation" ng-if="canViewAnswerExplanation && subject.answer_explanation && answerState != 0">
       <div class="explanation-label">答案解释:</div>
      <div   class="mathjax-process"ng-compile-html="subject.answer_explanation | sanitizeHtml" mathjax></div>
    </div>
    <div class="knowledge-node" ng-if="subject.knowledgeNodes">
        <div class="knowledge-node-label">知识点:</div>
        <div class="node-list">
            <div ng-repeat="node_reference in subject.knowledgeNodes">
                <knowledge-node-tag
                    ng-prop-course_id="node_reference.course_id"
                    ng-prop-node_id="node_reference.knowledge_node.id"
                    ng-prop-content="node_reference.knowledge_node.name"
                    ng-prop-go_to_graph="true"
                    size="medium"
                >
                </knowledge-node-tag>
            </div>
        </div>
    </div>
  </div>
</div>

</div>
<div ng-if="subject.type === 'paragraph_desc'">
    <div class="summary-title subject-head mb-4">
        <span class="pre-wrap subject-description simditor-viewer"
            ng-compile-html="subject.description || '暂无题目描述' | sanitizeHtml" mathjax>
        </span>
    </div>
<ul class="media-uploads-paper" ng-init="noPopup = false">
    <li ng-repeat="upload in subject.settings.uploads | filter:uploadWithName">
        <div ng-if="upload.type == 'audio'" simditor-audio id="[[upload.id]]"
        src="[[trustSrc('/api/uploads/' + upload.id + '/in-rich-content?file_key=' + upload.key )]]" name="[[upload.name]]"></div>
        <div ng-if="upload.type === 'video'" exam-video-player upload="upload" no-popup="noPopup"  resolutions="{'ORIGINAL':'原画', 'HD': '1080p', 'VGA': '720p', 'QVGA': '480p'}"
        default-resolution="'HD'"  lang='zh-CN'
         settings="subject.settings"
        >
        </div>

        <div ng-if="upload.enable_origin_text && (canViewCorrectAnswer || canViewAnswerForClassroom || canViewAnswerExplanation)">
            <div class="show-text">
            原文/译文
            <label class="switch">
                <input type="checkbox" class="switch-input" ng-model="upload.show_text"/>
                <span class="switch-label" data-on="" data-off=""></span>
                <span class="switch-handle"></span>
            </label>
            </div>

            <span ng-show="upload.show_text" class="pre-wrap subject-description simditor-viewer origin-text mb-3"
            ng-compile-html="upload.text | sanitizeHtml" mathjax>
            </span>
        </div>
    </li>
</ul></div>
<div ng-if="subject.type == 'text'">
    <div class="subject-head">
        <div class="summary-title">
            <span class="pre-wrap subject-description simditor-viewer"
                  ng-compile-html="subject.description || '暂无题目描述' | sanitizeHtml" mathjax>
            </span>
        </div>
    </div>
</div>                </li>
            </ol>
        </div>
    </div>
</div>    <div class="operations interaction-operations">
        <a class="button button-green medium" ng-show="canContinue()"
           ng-click="continue()">继续播放</a>
    </div>
</div>
            </div>
        </div>
    </div>
<div ng-if="upload">
    <div class="interaction-message" ng-if="upload.status == 'ready' && !upload.deleted && ui.isOrgTransferArrears">
        <span class="attachment-delete-info">平台套餐已过期或流量不足，暂无法查看该平台资源</span>
    </div>
    <div class="interaction-message" ng-if="upload.status == 'ready' && upload.deleted">
        <span class="attachment-delete-info">文件已删除</span>
    </div>
    <div class="interaction-message" ng-if="(upload.status != 'ready' && !upload.video_urls) && !upload.deleted">
        <div class="video-in-transcoding-msg" ng-if="upload.status == 'processing'">正在转码中，请稍候</div>
        <div class="video-in-transcoding-msg" ng-if="upload.status == 'failed'">转码失败</div>
    </div>
</div></div>            </div>
        </div>
    </div>
    <div class="file-previewer-nav" ng-if="uploads.length > 1">
        <span class="arrow-wrapper" ng-click="changeFile(currentFileIndex - 1)"><i class="icon font font-arrow-left-middle"></i></span>
    </div>
    <div class="file-previewer-nav right" ng-class="{'side-part': ui.showQuestionPanel || ui.showAiQuizPanel}" ng-if="uploads.length > 1">
        <span class="arrow-wrapper" ng-click="changeFile(currentFileIndex + 1)"><i class="icon font font-arrow-right-middle"></i></span>
    </div>
</div></div><div class="latest-topics card">
    <div class="title">
        <i class="font font-course-topic"></i><span>最新讨论</span>
    </div>

    <div class="topic" ng-init="topic=topics[0]" ng-if="topics.length > 0">
        <a class="course-name-area" ng-href="/course/[[topic.course_id]]/content">
            <div class="course-cover">
                <img ng-src="[[topic.course_cover ? topic.course_cover : '/static/assets/images/large/course-cover-default70x39-94b50490.png']]">
            </div>
            <div class="course-name truncate-text">
                <span tipsy="topic.course_name" ng-bind="topic.course_name"></span>
            </div>
            <i class="icon icon-arrow-right-link right"></i>
        </a>

        <a class="topic-link" ng-href="[[topic.url]]">
            <div class="author-info">
                <div class="avatar32">
                    <avatar src='topic.created_by.avatar_small_url'></avatar>
                </div>
                <div class="user-info">
                    <div class="name" ng-bind="topic.created_by.name"></div>
                    <div class="role">
                        <span ng-if="topic.course_role == 'student'">学生</span>
                        <span ng-if="topic.course_role == 'instructor'">教师</span>
                        <span ng-if="topic.course_role == 'instructor_assistant'">助教</span>
                        <span ng-if="topic.course_role.indexOf('student_assistant') != -1">学生助教</span>
                    </div>
                </div>
                <div class="created-at">
                    <span ng-bind="topic.created_at | datetime"></span>
                    <span>发表</span>
                </div>
            </div>
            <div class="item">
                <div class="item-title truncate-text">
                    <span tipsy="topic.title" ng-bind="topic.title"></span>
                </div>
                <span class="item-detail" ng-bind="topic.content | truncateText:100:true"></span>
            </div>
        </a>
    </div>
    <div class="no-content" ng-if="topics.length == 0">
        <div class="text-center">最近没有新讨论产生</div>
        <i class="dashboard-blank-icon font font-course-topic"></i>
    </div>
</div>                </div>
            </div>
        </div>
        <div class="right-frame">
<div class="latest-visit-course card gtm-label" data-label="最近访问">
    <div class="title">
        <i class="font font-clock"></i><span>最近访问</span>
    </div>
    <div class="visited-course-list">
        <div class="visited-course bulletin" ng-repeat="course in visitedCourses" ng-if="visitedCourses.length">
            <a ng-href="[[course.visitUrl]]">
                <div class="course-cover">
                    <img ng-src="[[course.cover ? course.cover : '/static/assets/images/large/course-cover-default140x76-d5045d1f.png']]">
                    <i class="icon icon-invalid-course-mark type-marker" ng-if="course.course_type == 4"></i>
                    <div ng-if="course.course_type == 4" class="course-type zh-CN">无效课程</div>
                </div>
                <div class="course-info">
                    <div class="truncate-text">
                        <span class="course-name" ng-bind="course.name" tipsy="course.name"></span>
                    </div>
                    <div class="course-department truncate-text">
                        <span tipsy="course.department.name" ng-bind="course.department.name"></span>
                    </div>
                    <div class="course-department truncate-text">
                        <span tipsy="getGradeClassName(course)" ng-bind="getGradeClassName(course)"></span>
                    </div>
                    <div class="course-department truncate-text">
                        <span tipsy="course.course_attributes.teaching_class_name"
                              ng-bind="course.course_attributes.teaching_class_name">
                        </span>
                    </div>
                </div>
            </a>
        </div>
    </div>
    <div class="no-content" ng-if="!visitedCourses.length">
        <div class="text-center">最近没有访问任何课程</div>
        <i class="dashboard-blank-icon font font-clock"></i>
    </div>
</div><div class="latest-todo-list card gtm-label" data-label="代办事项">
    <div class="title">
        <i class="font font-course-calendar"></i><span>待办事项</span>
    </div>

    <div class="todo-list-list">
        <div class="todo-list" ng-repeat="todoData in todoList" ng-show="ui.shownAllLatestTodoList || $index < 4"
    ng-class="{'first': $first, 'last': $last}">
        <i class="font font-bracket-left"></i>
        <a ng-click="openActivity(todoData)">
            <div class="todo-title">
                <div class="title-text truncate-text">
                    <span tipsy="todoData.title" ng-bind="todoData.title"></span>
                </div>
                <span class="activity-type" ng-if="todoData.type == 'homework'">作业</span>
                <span class="activity-type" ng-if="todoData.type == 'exam'">测试</span>
                <span class="activity-type" ng-if="todoData.type == 'questionnaire'">调查问卷</span>
                <span class="activity-type" ng-if="todoData.type == 'evaluation'">考核评价</span>
            </div>
            <div class="truncate-text">
                <div ng-if="todoData.is_student">
                    <span ng-if="todoData.type == 'evaluation'">
                        <span ng-if="!todoData.not_scored_num">待评分</span>
                    </span>
                    <span ng-if="todoData.type != 'evaluation'">
                        <span ng-if="!todoData.not_scored_num">待提交</span>
                    </span>
                    <span ng-if="todoData.not_scored_num">[[todoData.not_scored_num]]个 待批改</span>
                    <span ng-if="todoData.end_time">截止日期:[[todoData.end_time | datetime]]</span>
                </div>
                <div ng-if="!todoData.is_student">
                    <span ng-if="todoData.type !== 'evaluation'">[[todoData.not_scored_num]]个 待批改</span>
                    <span ng-if="todoData.type === 'evaluation'">[[todoData.not_scored_num]]个 待评分</span>
                </div>

            </div>
        </a>
    </div>
    </div>
    <div class="show-all-wrapper ng-cloak" ng-show="todoList.length > 4">
        <a class="show-all text-center" ng-if="!ui.shownAllLatestTodoList" ng-click="ui.shownAllLatestTodoList=true">
            <span>展开更多</span>
            <i class="icon icon-arrow-down"></i>
        </a>
        <a class="show-all text-center" ng-if="ui.shownAllLatestTodoList" ng-click="ui.shownAllLatestTodoList=false">
            <span>收起内容</span>
            <i class="icon icon-arrow-down flip"></i>
        </a>
    </div>
    <div class="no-content" ng-if="!todoList.length">
        <div class="text-center">所在课程暂没有待办事项</div>
        <i class="dashboard-blank-icon font font-course-calendar"></i>
    </div>
</div><div class="latest-bulletins card gtm-label" data-label="最新公告">
    <div class="title">
        <i class="font font-course-bulletin"></i><span>最新公告</span>
    </div>
    <div class="bulletin-list" ng-class="{'more-item': bulletins.length > 6}">
        <div class="course bulletin" ng-repeat="bulletin in bulletins | orderBy: '-order'"
             ng-if="ui.shownAllBulletin || $index < 6">
            <div class="bulletin-summary summary">
                <a ng-href="/bulletin-list/?type=[[bulletin.type]]">
                    <div class="title truncate-text">
                        <span tipsy="bulletin.title" ng-bind="bulletin.title"></span>
                    </div>
                    <div class="course-info truncate-text" ng-if="bulletin.type == 'course'">
                        <span class="course-name" ng-bind="bulletin.course.name"></span>
                        <span ng-if="getCourseInfo(bulletin.course)"> - </span>
                        <span class="course-department" ng-bind="getCourseInfo(bulletin.course)"></span>
                    </div>
                    <div class="truncate-text" ng-if="bulletin.type == 'org'">
                        <span>平台公告</span>
                    </div>
                    <div class="bulltin-created-at">
                        <i class="font font-clock icon-font"></i>
                        <span ng-bind="bulletin.updated_at | datetime" ng-if="bulletin.updated_at"></span>
                        <span ng-bind="bulletin.created_at | datetime" ng-if="!bulletin.updated_at"></span>
                    </div>
                </a>
            </div>
        </div>
    </div>
    <div class="show-all-wrapper ng-cloak" ng-show="bulletins.length > 6">
        <a class="show-all text-center" ng-if="!ui.shownAllBulletin" ng-click="ui.shownAllBulletin=true">
            <span>展开更多</span>
            <i class="icon icon-arrow-down"></i>
        </a>
        <a class="show-all text-center" ng-if="ui.shownAllBulletin" ng-click="ui.shownAllBulletin=false">
            <span>收起内容</span>
            <i class="icon icon-arrow-down flip"></i>
        </a>
    </div>
    <div class="no-content" ng-if="!bulletins.length">
        <div class="text-center">最近没有新的课程公告推送</div>
        <i class="dashboard-blank-icon font font-course-bulletin"></i>
    </div>
</div>        </div>
    </div>
</div>        <input id="userRole" type="hidden" value="Student"/>
    </div>





            </div>
        </div>
    </div>
        </div>

<div class="footer gtm-category" data-category="tronclass-footer" ng-controller="FooterCtrl"
     ng-init="copyright='Copyright © 2025 TronClass. All Rights Reserved. 西安智园软件开发管理有限公司 版权所有'; filingNumber=''" ng-cloak>
    <div class="footer-bd">
        <div class="legality-text">
            2019-2025 浙江大学 浙ICP备05074421号 电话：0571-87951669 / E-mail：xwmaster@zju.edu.cn / 地址：中国 杭州 / 邮编：310027
        </div>
    </div>
</div>    </div>

<!--[if lte IE 8]>
    <script type="text/javascript">
        window.location.href='/browser-warning';
    </script>
<![endif]-->

<!--[if IE 9]>
    <script type="text/javascript">
        // window.FileAPI = {};
        window.onload = function()
        {
            document.title = "TronClass";
        }
        window.isIE9 = true;
    </script>
<![endif]-->

<script type="text/javascript">
    /*@cc_on
        if (/^10/.test(@_jscript_version)) {
            window.isIE10 = true;
        }
    @*/
</script>
    <script type="text/javascript">
        window.statisticsSettings = {
            userId: "281121",
            orgId: "1",
            departmentId: "0",
                server: "/statistics",
            idleThreshold: "5",
            gaTrackingId: "G-H5QC8W782Q",
            gaVersion: "GA4",
            enableMgsQueryCache: false,
            enableIdleWarning: false,
            showIdleWarning: false,
        };
    </script>

    <script src="/static/runtime~js/lms-main-d3856864.js" defer></script>
<script src="/static/30381-7dfb2df5.js" defer></script>
<script src="/static/70538-e0880ef2.js" defer></script>
<script src="/static/15544-e68a2711.js" defer></script>
<script src="/static/70012-9b89387b.js" defer></script>
<script src="/static/83849-a1d9dacd.js" defer></script>
<script src="/static/85565-156fdf64.js" defer></script>
<script src="/static/60111-449445db.js" defer></script>
<script src="/static/26033-6593f5e3.js" defer></script>
<script src="/static/4266-e2893ad4.js" defer></script>
<script src="/static/53925-64f81b33.js" defer></script>
<script src="/static/81194-ee82ba83.js" defer></script>
<script src="/static/35175-1d536c46.js" defer></script>
<script src="/static/98128-9052f725.js" defer></script>
<script src="/static/67344-af7cdc36.js" defer></script>
<script src="/static/83994-91108ee0.js" defer></script>
<script src="/static/83302-8ac0db48.js" defer></script>
<script src="/static/30587-0e6c98c7.js" defer></script>
<script src="/static/26778-492ed1ef.js" defer></script>
<script src="/static/67728-26551f95.js" defer></script>
<script src="/static/34922-e7f17d45.js" defer></script>
<script src="/static/702-fce1af02.js" defer></script>
<script src="/static/40678-0b872123.js" defer></script>
<script src="/static/98659-b9ef5380.js" defer></script>
<script src="/static/74932-eedbaa7b.js" defer></script>
<script src="/static/4849-dca64225.js" defer></script>
<script src="/static/50085-d76e07fd.js" defer></script>
<script src="/static/8398-26b2feff.js" defer></script>
<script src="/static/8901-ef8b30c8.js" defer></script>
<script src="/static/48850-57dba0a4.js" defer></script>
<script src="/static/60252-1d478553.js" defer></script>
<script src="/static/36435-d264f869.js" defer></script>
<script src="/static/32067-8d802843.js" defer></script>
<script src="/static/11293-9f6222a0.js" defer></script>
<script src="/static/77260-88fc0d90.js" defer></script>
<script src="/static/20837-8088d89e.js" defer></script>
<script src="/static/55032-073d03ef.js" defer></script>
<script src="/static/32156-2eb01b95.js" defer></script>
<script src="/static/32991-4e35991d.js" defer></script>
<script src="/static/31646-54cd9148.js" defer></script>
<script src="/static/58637-25214ece.js" defer></script>
<script src="/static/18792-d5618450.js" defer></script>
<script src="/static/30454-d05f042a.js" defer></script>
<script src="/static/40433-125568ff.js" defer></script>
<script src="/static/15974-6ba94525.js" defer></script>
<script src="/static/29433-884193d3.js" defer></script>
<script src="/static/81573-0057614b.js" defer></script>
<script src="/static/61139-b48f1a4c.js" defer></script>
<script src="/static/30138-5275ed5f.js" defer></script>
<script src="/static/65387-56b7f93f.js" defer></script>
<script src="/static/27317-2490e6d9.js" defer></script>
<script src="/static/98035-0c223b0b.js" defer></script>
<script src="/static/1302-68cfa447.js" defer></script>
<script src="/static/19279-cbf03227.js" defer></script>
<script src="/static/66309-e9846dc8.js" defer></script>
<script src="/static/42609-af95e8bb.js" defer></script>
<script src="/static/70743-979ca99e.js" defer></script>
<script src="/static/11646-fc4b9f60.js" defer></script>
<script src="/static/11610-6fb4ce93.js" defer></script>
<script src="/static/85787-3f9875a6.js" defer></script>
<script src="/static/51845-5145a65a.js" defer></script>
<script src="/static/99480-e1876422.js" defer></script>
<script src="/static/32910-a7129d0f.js" defer></script>
<script src="/static/17127-bc60ed91.js" defer></script>
<script src="/static/73085-8e684210.js" defer></script>
<script src="/static/72840-c117ab92.js" defer></script>
<script src="/static/7391-39c474c7.js" defer></script>
<script src="/static/80557-776dd324.js" defer></script>
<script src="/static/62061-6988c352.js" defer></script>
<script src="/static/83865-ce457400.js" defer></script>
<script src="/static/56230-ae1769e0.js" defer></script>
<script src="/static/38785-ddbc521a.js" defer></script>
<script src="/static/js/lms-main-a6ea8381.js" defer></script>

    <!-- 自定义主题色 -->

    <script type="text/javascript">
        window.onload = () => {
            $(document).foundation();
        };
    </script>

    <script type="text/javascript">
        window.analyticsData = {
            orgName: '学在浙大',
            userId: '281121',
            userName: '黄浩旸'
        }
    </script>

        <div class="invite-confirm-wrapper">
<div id="invite-confirm" class="reveal-modal popup-area" data-reveal>
    <div class="popup-content" ng-if="popupState.popupOpened" resetable ng-controller="InviteConfirmController">
        <div class="popup-header">
            <span>提示</span>
            <a class="right" close-popup="invite-confirm">
                <i class="font font-close"></i>
            </a>
        </div>
        <div class="main-area" ng-if="!error">
            <span ng-if="!joined && teachingUnitType == 'course'">确定接受邀请加入该课程？</span>
            <span ng-if="joined && teachingUnitType == 'course'">您已加入该课程</span>
            <span ng-if="!joined && teachingUnitType == 'teaching_class'">确定接受邀请加入该班级？</span>
            <span ng-if="joined && teachingUnitType == 'teaching_class'">您已加入该班级</span>
        </div>

        <div class="main-area" ng-if="error">
            <span ng-if="error.inviteCancelled">已取消邀请加入课程</span>
            <span ng-if="error.courseDeleted">该课程已被删除</span>
        </div>

        <div class="popup-footer">
            <div class="form-buttons">
<div class="loading-spinner" ng-show="loading">
    <div class="spinner">
        <div class="mask">
            <div class="maskedCircle"></div>
        </div>
    </div>
</div>                <button type="submit" id="confirmInvite" class="button button-green medium" ng-if="!error"
                        ng-click="confirm()" ng-hide="loading">确定</button>
                <button class="button button-green medium" ng-if="error" ng-click="toUserIndex()">确定</button>

                <button type="button" class="button button-grey medium" close-popup="invite-confirm">取消</button>
            </div>
        </div>
    </div>
</div>        </div>


        <div class="file-previewer-wrapper">

<div id="file-previewer" ng-init="hasAiAbility=false;" ng-controller="FilePreviewerController" class="pdf-reader-wrapper reveal-modal popup-area" resetable data-reveal data-options="multiple_opened:true">
    <div class="popup-content" ng-class="{'catalog': canGuestPreview == true, 'multiple-uploads': uploads.length > 1, 'scorm':upload.type == 'scorm', 'lesson-resource': upload.type == 'lesson-resource'}">
        <div ng-if="upload.name || upload.file_name" class="pdf-reader-detail">
            <div class="header clearfix">
                <span class="title truncate-text left" ng-if="resource  && resource.open_scope == 'group'">
                    <span ng-bind="resource.name|fileName" tipsy="resource.name"></span>
                </span>
                <span class="title truncate-text left" ng-if="!(resource && resource.open_scope == 'group')">
                    <span ng-bind="upload.name|fileName" tipsy="upload.name"></span>
                </span>
                <span class="file-extension left" ng-bind="upload.name|fileExtension" ng-if="!(resource && resource.open_scope == 'group')"></span>
                <span>
                    <span class="cc-license"
                    ng-class="{'cc-license-default': upload.cc_license_code == 'private'}"
                    ng-if="upload.cc_license_code && upload.cc_license_code == 'private'"
                    tipsy="upload.cc_license_description" tipsy-ellipsis="no">
                        <svg-icon name="license-[[upload.cc_license_code]]"></svg-icon>
                    </span>
                    <a class="cc-license"
                        ng-href="[[upload.cc_license_link]]" target="_blank"
                        ng-class="{'cc-license-default': upload.cc_license_code == 'public_domain'}"
                        ng-if="upload.cc_license_code && upload.cc_license_code != 'private'"
                        tipsy="upload.cc_license_description" tipsy-ellipsis="no">
                        <svg-icon name="license-[[upload.cc_license_code]]"></svg-icon>
                    </a>
                </span>
                <div class="file-preview-actions right">
                    <div class="file-preview-view-mode" ng-if="viewMode.enablePreviewMode(upload)">
                        <input type="radio" name="view-mode" value='preview' id="view-mode" checked="checked" ng-model='viewMode.mode'>
                        <label for='view-mode'> 预览模式 </label>
                        <input type="radio" name="view-mode" value='normal' id='note-mode' ng-model='viewMode.mode'>
                        <label for='note-mode'> 笔记模式 </label>
                    </div>
                    <span class="ai-quiz-panel" ng-if="ui.showAiQuizPanelBtn && upload.aiQuiz.id && (hasAiAbility || isSimulatingInstructor)" ng-click="showAiQuizPanel()">
                        <svg-icon name="information-title" class="panel-icon"></svg-icon>
                        <span>[[$t("air.question")]]
                            <span ng-if="upload.aiQuiz.subjectsCount">([[upload.aiQuiz.subjectsCount]])</span>
                        </span>
                    </span>
                    <span class="air-primary-generate-button ai-quiz-panel" ng-disabled="upload.originStatus !== 'ready' "  ng-if="ui.showAiQuizPanelBtn && !upload.aiQuiz.id && hasAiAbility && false" ng-click="showAiQuizModal(upload)">
                        <svg-icon name="ai-generate-icon" class="panel-icon"></svg-icon>
                        <span>[[$t("air.aiQuestion")]]</span>
                    </span>
                    <span class="question-panel" ng-if="ui.showQuestionPanelBtn" ng-click="showQuestionPanel()">
                        <svg-icon name="question" class="panel-icon"></svg-icon>
                        <span>疑问&nbsp;([[ui.commentsCount]])</span>
                    </span>
                </div>

                <a class="right close" close-popup="file-previewer"><i class="font font-close"></i></a>
            </div>
            <div ng-if="previewType(upload.type) == 'file'" class="content" ng-class="{'zooming-content': ui.showQuestionPanel === true || ui.showAiQuizPanel === true}">
<div class="file-previewer zooming" ng-if="upload" ng-cloak>
    <div class="bd clearfix">
        <div class="org-transfer-arrears" ng-if="isOrgArrears && ui.urlLoaded">
            <span>平台套餐已过期或流量不足，暂无法查看该平台资源</span>
        </div>
        <div ng-if="viewMode.mode==='normal'" class="reader-wrapper">
            <div ng-if="!isOrgArrears && ui.urlLoaded" class="reader-wrapper" ng-class="{'full-screen': ui.fullScreen}">
                <div class="toolbar" ng-if="(isIE9 || !(upload.type == 'document' && upload.status == 'ready')) && !wpsPreview(upload)">
<div class="toolbar-buttons"
     ng-class="{'pdf-view': upload.type == 'document', 'none-border-toolbar':upload.status != 'ready' || isIE9 || upload.isTextFile }">
    <a title="缩小" ng-click="zoomOut()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-zoom-out"></i>
    </a>
    <span class="separator" ng-if="upload.type == 'image'"></span>
    <a title="放大" ng-click="zoomIn()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-zoom-in"></i>
    </a>
    <a title="逆时针旋转" ng-click="rotateImg()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-rotate"></i>
    </a>
    <a title="复原" ng-click="restoreImg()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-restore"></i>
    </a>
    <a ng-if="forceShowDownloadButton && upload.id && upload.type != 'link' && !upload.isFromKnowledgeGraph"
       ng-href="[['/api/uploads/'+upload.id+'/blob']]" title="下载" target="_blank">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="upload.from_project && upload.allow_download"
       ng-href="[[ '/api/project/'+upload.project_id+'/share-resource/blob?upload_id='+upload.id+'&node_ids='+upload.node_ids+'&reference_id='+upload.ref_id ]]" title="下载"  target="_blank">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="!resource && !manualUrl && !canGuestPreview && upload.id && upload.type != 'link' && upload.status != 'cliping' && upload.status != 'clip_failed' && upload.status != 'uploading' && upload.status !='failed' && (upload.allow_download || (isInMyFileListPage && upload.owner_id == currentUserId)) && !upload.isFromKnowledgeGraph && !upload.from_project"
       ng-href="[[ '/api/uploads/'+upload.id+'/blob' ]]" title="下载" ng-click="downloadBlob(activity, upload)" target="_blank">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.open_scope != 'group' && !resource.share_to_id && resource.allow_download && resource.upload.status != 'uploading'" ng-click="download(resource)" title="下载">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.open_scope == 'group' && resource.allow_download && resource.upload.status != 'uploading'" ng-href="/api/shared-resources/[[resource.id]]/blob" target="_self" title="下载">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.share_to_id && resource.allow_download && resource.upload.status != 'uploading'" ng-href="/api/shared-resources-to/[[resource.id]]/blob" target="_self" title="下载">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a id="downloadManual" ng-if="!resource && manualUrl " ng-href="[[manualUrl]]"
       target="_blank" title="下载" download="manual.pdf">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="(upload.type == 'image' || upload.type == 'document' || upload.type == 'scorm') && upload.status != 'uploading' && upload.status !='failed'" ng-hide="ui.fullScreen" ng-click="enterFullScreen('.file-previewer .reader-wrapper')"
       title="进入全屏">
        <i class="icon icon-file-preview-enter-full-screen"></i>
    </a>
    <a ng-if="(upload.type == 'image' || upload.type == 'document' || upload.type == 'scorm') && upload.status != 'uploading'" ng-show="ui.fullScreen" ng-click="exitFullScreen()"
       title="退出全屏">
        <i class="icon icon-file-preview-exit-full-screen"></i>
    </a>
     <a class="open-in-browser" ng-if="upload.type == 'link'" ng-href="[[ upload.link.url ]]" target="_blank" title="在浏览器中打开">
        <i class="font font-open-in-browser-min"></i>
    </a>
</div>                </div>

                <div class="unsupported" ng-if="(isIE9 && upload.type == 'document') || upload.type == 'file' || upload.type == 'wmpkg'">
                    <div class="icon-resource-type">
                        <i class="font font-file-document big-file-font"></i>
                        <div class="file-info" ng-if="upload.status=='uploading'">正在传输中</div>
                        <div class="file-info">[[ upload.name ]]</div>
                        <div class="file-info"> 暂不支持该文件的预览</div>
                        <div class="file-info" ng-if="upload.type == 'wmpkg'"> 旭联智慧大师文件</div>
                        <div class="file-download-button" ng-if="forceShowDownloadButton || resource.allow_download || (upload.allow_download || upload.allowDownload || (isInMyFileListPage && upload.owner_id == currentUserId)) || (!resource && manualUrl)">
                            <a ng-if="forceShowDownloadButton && upload.id && upload.type != 'link'"
                            ng-href="[['/api/uploads/' + upload.id + '/blob?refer_type=' + upload.referType + '&refer_id=' + upload.referId]]" title="下载文件" target="_blank" class="file-download-content">
                                <i class="font font-download"></i><span>下载文件</span><span class="file-size" ng-bind="upload.size|humanizeBytes"></span>
                            </a>
                            <a ng-if="upload.from_project && (upload.allow_download || upload.allowDownload)"
                                ng-href="[[ '/api/project/'+upload.project_id+'/share-resource/blob?upload_id='+upload.id+'&node_ids='+upload.node_ids+'&reference_id='+upload.ref_id ]]" title="下载文件"  target="_blank" class="file-download-content">
                                <i class="font font-download"></i><span>下载文件</span><span class="file-size" ng-bind="upload.size|humanizeBytes"></span>
                            </a>
                            <a ng-if="!upload.from_project && !resource && !manualUrl && !canGuestPreview && upload.id && upload.type != 'link' && upload.status != 'cliping' && upload.status != 'clip_failed' && upload.status != 'uploading' && upload.status !='failed' && (upload.allow_download || upload.allowDownload || (isInMyFileListPage && upload.owner_id == currentUserId))"
                            ng-href="[[ upload.source === 'RMS'? '/api/uploads/' + upload.id + '/rms-preview' : '/api/uploads/' + upload.id + '/blob?refer_type=' + upload.referType + '&refer_id=' + upload.referId ]]" title="下载文件" ng-click="downloadBlob(activity, upload)" target="_blank" class="file-download-content">
                                <i class="font font-download"></i><span>下载文件</span><span class="file-size" ng-bind="upload.size|humanizeBytes"></span>
                            </a>
                            <a ng-if="resource && resource.open_scope != 'group' && !resource.share_to_id && resource.allow_download && resource.upload.status != 'uploading'" ng-click="download(resource)" title="下载文件" class="file-download-content">
                                <i class="font font-download"></i><span>下载文件</span><span class="file-size" ng-bind="upload.size|humanizeBytes"></span>
                            </a>
                            <a ng-if="resource && resource.open_scope == 'group' && resource.allow_download && resource.upload.status != 'uploading'" ng-href="/api/shared-resources/[[resource.id]]/blob" target="_self" title="下载文件" class="file-download-content">
                                <i class="font font-download"></i><span>下载文件</span><span class="file-size" ng-bind="upload.size|humanizeBytes"></span>
                            </a>
                            <a ng-if="resource && resource.share_to_id && resource.allow_download && resource.upload.status != 'uploading'" ng-href="/api/shared-resources-to/[[resource.id]]/blob" target="_self" title="下载文件" class="file-download-content">
                                <i class="font font-download"></i><span>下载文件</span><span class="file-size" ng-bind="upload.size|humanizeBytes"></span>
                            </a>
                            <a id="downloadManual" ng-if="!resource && manualUrl " ng-href="[[manualUrl]]"
                            target="_blank" title="下载文件" download="manual.pdf" class="file-download-content">
                                <i class="font font-download"></i><span>下载文件</span><span class="file-size" ng-bind="upload.size|humanizeBytes"></span>
                            </a>
                            <a ng-if="upload.source == 'WEDRIVE' && (upload.allow_download || upload.allowDownload)" ng-href="/api/wedrive/file/[[upload.fileid]]" target="_self" title="下载文件" class="file-download-content">
                                <i class="font font-download"></i><span>下载文件</span><span class="file-size" ng-bind="upload.size|humanizeBytes"></span>
                            </a>
                        </div>
                    </div>
                </div>

                <div class="transcode-unready" ng-if="showTranscodeUnreadyTips(upload)">
                    <div class="icon-resource-type">
                        <div ng-if="upload.status == 'file_locked'">
                            <img ng-src="/static/assets/images/large/file_locked-cf8c5024.png" class="icon-file-locked">
                            <div class="file-info"> 抱歉，该文件已进行加密故无法预览，请您下载后查看</div>
                        </div>

                        <i ng-if="upload.status != 'file_locked'" class="font font-file-[[fileTypeByExtension(upload)]] big-file-font"></i>

                        <div class="file-info" ng-if="upload.status=='uploading'">正在传输中</div>
                        <div class="file-info" ng-if="upload.status === 'processing' && uploadStatus[upload.id] === 'processing'"> 正在转码中</div>
                        <div class="file-info" ng-if="upload.status === 'failed' || uploadStatus[upload.id] === 'failed'"> 转码失败</div>
                        <div class="file-info" ng-if="upload.status == 'cliping'"> 剪辑中</div>
                        <div class="file-info" ng-if="upload.status == 'clip_failed'"> 剪輯失敗</div>
                        <div ng-if="upload.type == 'scorm' && upload.status == 'failed'">
                            <div ng-switch="error.status_code">
                                <span ng-switch-when="SCORM101">imsmanifest.xml 文件不存在 (请上传符合 SCORM 1.2 格式的 ZIP 文件)</span>
                                <span ng-switch-when="SCORM102">不支持的 SCORM 格式或版本 (请上传符合 SCORM 1.2 格式的 ZIP 文件)</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="pdf-container"
                     ng-if="!isIE9 && (upload.type == 'document' && upload.status == 'ready' && !upload.isTextFile && !wpsPreview(upload) && fileTypeByExtension(upload) !== 'ofd')">

                    <iframe id='pdf-viewer' width="100%" height='100%' frameborder="0" ng-if="upload.documentUrl"
                        ng-src="[[trustAsResourceUrl(upload.documentUrl)]]" allowfullscreen="true">
                    </iframe>
                    <div ng-if="!aliyunOfficePreview(upload)">
<div class="toolbar-buttons"
     ng-class="{'pdf-view': upload.type == 'document', 'none-border-toolbar':upload.status != 'ready' || isIE9 || upload.isTextFile }">
    <a title="缩小" ng-click="zoomOut()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-zoom-out"></i>
    </a>
    <span class="separator" ng-if="upload.type == 'image'"></span>
    <a title="放大" ng-click="zoomIn()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-zoom-in"></i>
    </a>
    <a title="逆时针旋转" ng-click="rotateImg()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-rotate"></i>
    </a>
    <a title="复原" ng-click="restoreImg()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-restore"></i>
    </a>
    <a ng-if="forceShowDownloadButton && upload.id && upload.type != 'link' && !upload.isFromKnowledgeGraph"
       ng-href="[['/api/uploads/'+upload.id+'/blob']]" title="下载" target="_blank">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="upload.from_project && upload.allow_download"
       ng-href="[[ '/api/project/'+upload.project_id+'/share-resource/blob?upload_id='+upload.id+'&node_ids='+upload.node_ids+'&reference_id='+upload.ref_id ]]" title="下载"  target="_blank">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="!resource && !manualUrl && !canGuestPreview && upload.id && upload.type != 'link' && upload.status != 'cliping' && upload.status != 'clip_failed' && upload.status != 'uploading' && upload.status !='failed' && (upload.allow_download || (isInMyFileListPage && upload.owner_id == currentUserId)) && !upload.isFromKnowledgeGraph && !upload.from_project"
       ng-href="[[ '/api/uploads/'+upload.id+'/blob' ]]" title="下载" ng-click="downloadBlob(activity, upload)" target="_blank">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.open_scope != 'group' && !resource.share_to_id && resource.allow_download && resource.upload.status != 'uploading'" ng-click="download(resource)" title="下载">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.open_scope == 'group' && resource.allow_download && resource.upload.status != 'uploading'" ng-href="/api/shared-resources/[[resource.id]]/blob" target="_self" title="下载">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.share_to_id && resource.allow_download && resource.upload.status != 'uploading'" ng-href="/api/shared-resources-to/[[resource.id]]/blob" target="_self" title="下载">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a id="downloadManual" ng-if="!resource && manualUrl " ng-href="[[manualUrl]]"
       target="_blank" title="下载" download="manual.pdf">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="(upload.type == 'image' || upload.type == 'document' || upload.type == 'scorm') && upload.status != 'uploading' && upload.status !='failed'" ng-hide="ui.fullScreen" ng-click="enterFullScreen('.file-previewer .reader-wrapper')"
       title="进入全屏">
        <i class="icon icon-file-preview-enter-full-screen"></i>
    </a>
    <a ng-if="(upload.type == 'image' || upload.type == 'document' || upload.type == 'scorm') && upload.status != 'uploading'" ng-show="ui.fullScreen" ng-click="exitFullScreen()"
       title="退出全屏">
        <i class="icon icon-file-preview-exit-full-screen"></i>
    </a>
     <a class="open-in-browser" ng-if="upload.type == 'link'" ng-href="[[ upload.link.url ]]" target="_blank" title="在浏览器中打开">
        <i class="font font-open-in-browser-min"></i>
    </a>
</div>                    </div>
                </div>

                <div class="odf-container" style="height: 100%;" ng-if="upload.type == 'document' && upload.status == 'ready' && fileTypeByExtension(upload) === 'ofd'">
                    <iframe id='ofd-viewer' width="100%" height='100%' frameborder="0" ng-if="upload.documentUrl"
                        ng-src="[[trustAsResourceUrl(upload.documentUrl)]]" allowfullscreen="true">
                    </iframe>
                </div>

                <div class="ppt-container"
                     ng-if="wpsPreview(upload)" ng-controller="PreviewModeController">
                    <div id="ppt-viewer" class="ppt-viewer"></div>

<div class="toolbar-buttons"
     ng-class="{'pdf-view': upload.type == 'document', 'none-border-toolbar':upload.status != 'ready' || isIE9 || upload.isTextFile }">
    <a title="缩小" ng-click="zoomOut()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-zoom-out"></i>
    </a>
    <span class="separator" ng-if="upload.type == 'image'"></span>
    <a title="放大" ng-click="zoomIn()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-zoom-in"></i>
    </a>
    <a title="逆时针旋转" ng-click="rotateImg()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-rotate"></i>
    </a>
    <a title="复原" ng-click="restoreImg()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-restore"></i>
    </a>
    <a ng-if="forceShowDownloadButton && upload.id && upload.type != 'link' && !upload.isFromKnowledgeGraph"
       ng-href="[['/api/uploads/'+upload.id+'/blob']]" title="下载" target="_blank">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="upload.from_project && upload.allow_download"
       ng-href="[[ '/api/project/'+upload.project_id+'/share-resource/blob?upload_id='+upload.id+'&node_ids='+upload.node_ids+'&reference_id='+upload.ref_id ]]" title="下载"  target="_blank">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="!resource && !manualUrl && !canGuestPreview && upload.id && upload.type != 'link' && upload.status != 'cliping' && upload.status != 'clip_failed' && upload.status != 'uploading' && upload.status !='failed' && (upload.allow_download || (isInMyFileListPage && upload.owner_id == currentUserId)) && !upload.isFromKnowledgeGraph && !upload.from_project"
       ng-href="[[ '/api/uploads/'+upload.id+'/blob' ]]" title="下载" ng-click="downloadBlob(activity, upload)" target="_blank">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.open_scope != 'group' && !resource.share_to_id && resource.allow_download && resource.upload.status != 'uploading'" ng-click="download(resource)" title="下载">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.open_scope == 'group' && resource.allow_download && resource.upload.status != 'uploading'" ng-href="/api/shared-resources/[[resource.id]]/blob" target="_self" title="下载">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.share_to_id && resource.allow_download && resource.upload.status != 'uploading'" ng-href="/api/shared-resources-to/[[resource.id]]/blob" target="_self" title="下载">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a id="downloadManual" ng-if="!resource && manualUrl " ng-href="[[manualUrl]]"
       target="_blank" title="下载" download="manual.pdf">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="(upload.type == 'image' || upload.type == 'document' || upload.type == 'scorm') && upload.status != 'uploading' && upload.status !='failed'" ng-hide="ui.fullScreen" ng-click="enterFullScreen('.file-previewer .reader-wrapper')"
       title="进入全屏">
        <i class="icon icon-file-preview-enter-full-screen"></i>
    </a>
    <a ng-if="(upload.type == 'image' || upload.type == 'document' || upload.type == 'scorm') && upload.status != 'uploading'" ng-show="ui.fullScreen" ng-click="exitFullScreen()"
       title="退出全屏">
        <i class="icon icon-file-preview-exit-full-screen"></i>
    </a>
     <a class="open-in-browser" ng-if="upload.type == 'link'" ng-href="[[ upload.link.url ]]" target="_blank" title="在浏览器中打开">
        <i class="font font-open-in-browser-min"></i>
    </a>
</div>                </div>

                <div class="txt-file-container" ng-if="upload.type == 'document' && upload.status == 'ready' && upload.isTextFile">
                    <div class="toolbar">
<div class="toolbar-buttons"
     ng-class="{'pdf-view': upload.type == 'document', 'none-border-toolbar':upload.status != 'ready' || isIE9 || upload.isTextFile }">
    <a title="缩小" ng-click="zoomOut()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-zoom-out"></i>
    </a>
    <span class="separator" ng-if="upload.type == 'image'"></span>
    <a title="放大" ng-click="zoomIn()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-zoom-in"></i>
    </a>
    <a title="逆时针旋转" ng-click="rotateImg()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-rotate"></i>
    </a>
    <a title="复原" ng-click="restoreImg()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-restore"></i>
    </a>
    <a ng-if="forceShowDownloadButton && upload.id && upload.type != 'link' && !upload.isFromKnowledgeGraph"
       ng-href="[['/api/uploads/'+upload.id+'/blob']]" title="下载" target="_blank">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="upload.from_project && upload.allow_download"
       ng-href="[[ '/api/project/'+upload.project_id+'/share-resource/blob?upload_id='+upload.id+'&node_ids='+upload.node_ids+'&reference_id='+upload.ref_id ]]" title="下载"  target="_blank">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="!resource && !manualUrl && !canGuestPreview && upload.id && upload.type != 'link' && upload.status != 'cliping' && upload.status != 'clip_failed' && upload.status != 'uploading' && upload.status !='failed' && (upload.allow_download || (isInMyFileListPage && upload.owner_id == currentUserId)) && !upload.isFromKnowledgeGraph && !upload.from_project"
       ng-href="[[ '/api/uploads/'+upload.id+'/blob' ]]" title="下载" ng-click="downloadBlob(activity, upload)" target="_blank">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.open_scope != 'group' && !resource.share_to_id && resource.allow_download && resource.upload.status != 'uploading'" ng-click="download(resource)" title="下载">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.open_scope == 'group' && resource.allow_download && resource.upload.status != 'uploading'" ng-href="/api/shared-resources/[[resource.id]]/blob" target="_self" title="下载">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.share_to_id && resource.allow_download && resource.upload.status != 'uploading'" ng-href="/api/shared-resources-to/[[resource.id]]/blob" target="_self" title="下载">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a id="downloadManual" ng-if="!resource && manualUrl " ng-href="[[manualUrl]]"
       target="_blank" title="下载" download="manual.pdf">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="(upload.type == 'image' || upload.type == 'document' || upload.type == 'scorm') && upload.status != 'uploading' && upload.status !='failed'" ng-hide="ui.fullScreen" ng-click="enterFullScreen('.file-previewer .reader-wrapper')"
       title="进入全屏">
        <i class="icon icon-file-preview-enter-full-screen"></i>
    </a>
    <a ng-if="(upload.type == 'image' || upload.type == 'document' || upload.type == 'scorm') && upload.status != 'uploading'" ng-show="ui.fullScreen" ng-click="exitFullScreen()"
       title="退出全屏">
        <i class="icon icon-file-preview-exit-full-screen"></i>
    </a>
     <a class="open-in-browser" ng-if="upload.type == 'link'" ng-href="[[ upload.link.url ]]" target="_blank" title="在浏览器中打开">
        <i class="font font-open-in-browser-min"></i>
    </a>
</div>                    </div>
                    <div class='txt-file-content pre-wrap' ng-bind="upload.textContent" ng-if='upload.textContent'>
                    </div>
                </div>

                <div class="img-container" ng-if="upload.type == 'image' && upload.source !== 'RMS' && (!upload.status || upload.status == 'ready' || upload.status != 3)">
                    <img ng-cloak ng-if="!isVisitor && !resourceId" ng-src="[[upload.url || '/api/uploads/' + upload.id + '/blob?preview=true&refer_type=' + upload.referType + '&refer_id=' + upload.referId]]">
                    <img ng-cloak ng-if="isVisitor && activity && !upload.source" ng-src="[[upload.url || '/anonymous-api/' + activity.id + '/uploads/' + upload.id + '/blob?preview=true']]">
                    <img ng-cloak ng-if="isVisitor && activity && upload.source" ng-src="[[upload.imageUrl]]">
                    <img ng-cloak ng-if="!activity && resourceId" ng-src="[['/' + apiPrefix + '/shared-resources/' + resourceId + '/preview?preview=true']]">
                </div>
                <div class="img-container" ng-if="upload.type == 'image' && upload.source === 'RMS' && (!upload.status || upload.status == 'ready' || upload.status != 3)">
                    <img ng-cloak ng-if="upload.source === 'RMS'" ng-src="[[upload.imageUrl]]">
                </div>
                <div class="video-container" ng-if="(upload.type == 'video' && upload.video_urls) || (upload.type == 'other' && upload.video_url && upload.status == 'ready')">
                        <div id="video" class="video-player">
                            <div id="wg-video-player"
                                wg-video-player
                                style="height:calc(100% - 16px);overflow: unset;"
                                resolutions="{'ORIGINAL': '原画', 'HD': '1080p', 'VGA': '720p', 'QVGA': '480p'}"
                                default-resolution="'HD'"
                                upload="upload"
                                resource="resource"
                                video-src-type="upload.video_src_type"
                                video-urls="upload.video_urls"
                                download="false"
                                disable-track="true"
                                customize-height="true"
                                org-code="'1'"
                                enable-chapter="false"
                                enable-aisk="false"
                                chapter-permission="upload.chapter_permission"
                                enable-caption="false"
                                caption-permission="upload.caption_permission"
                                enable-topic="false"
                                topic-permission="upload.topic_permission"
                                video-editor-server='https://courses.zju.edu.cn/video-editor'
                                enable-play-rate=True
                                caption-paragraph-split-interval=5000
                                caption-translate-permission="upload.caption_translate_permission"
                            ></div>
                        </div>

                    <div id="cc_video" class="video-player" ng-if="upload.is_cc_video && upload.status == 'ready'"
                         ng-bind-html="upload.play_code | trustAsHtml">
                    </div>
                </div>

                <div class="video-container" ng-if="upload.type == 'other' && upload.page_url && upload.status == 'ready'">
                    <div class="lesson-resource-preview">
                        <iframe id="lessonResourceIframe" frameborder="0"
                                ng-src="[[ trustAsResourceUrl(upload.page_url) ]]"
                                ng-style="iframeStyle"
                                allowfullscreen width="100%" height="100%">
                        </iframe>
                    </div>
                </div>

                <div class="audio-container" ng-if="upload.type == 'audio' && upload.status == 'ready' && audioUrl">
<div class="audio-wrapper" ng-controller="AudioPlayCtrl"
     ng-init="forwardSeekingWarning='教师已设置观看该视频不能快进';init()"
     before-controller="pauseWhenLeavingWindow = false;">
    <div class="music-note" ng-click="togglePlay($event)">
        <i class="font font-music"></i>
    </div>
    <div class="audio-player-wrapper">
        <div class="play">
            <a ng-click="togglePlay($event)">
                <i class="font" ng-class="ui.isPlaying ? 'font-audio-pause' : 'font-audio-play'"></i>
            </a>
        </div>
        <div class="current-time">
            <span class="current">[[ ui.currentTimeStr ]]</span>
        </div>
        <div class="slider-bar"
             ng-mousemove="refreshPos($event)"
             ng-mouseleave="deleteClass()">
            <div class="audio-slider"></div>
            <div class="audio-slider-mask"
                 ng-style="{width: ui.maskWidth + 'px'}"></div>
            <div class="slider-tip" ng-bind="sliderTip ? sliderTip : forwardSeekingWarning"></div>
            <div class="slider-tip-arrow"></div>
            <div class="slider-tip-line"></div>
        </div>
        <div class="time-divider">
            <span>/</span>
        </div>
        <div class="duration">
            <span>[[ ui.durationStr ]]</span>
        </div>
        <div class="download" ng-if="allow_download && !activity.uploads[0].deleted && !upload.source">
            <a ng-href="/api/uploads/[[activity.uploads[0].id]]/blob">
                <i class="font font-audio-download"></i>
            </a>
        </div>
        <div class="download" ng-if="allow_download && !activity.uploads[0].deleted && upload.source">
            <a ng-href="[[upload.url]]/download">
                <i class="font font-audio-download"></i>
            </a>
        </div>
        <div class="description" ng-if="activity.data['description']">
            <i class="font font-audio-desc"></i>
            <div class="desc-content-wrapper">
                <div class="content-detail simditor-viewer" ng-bind-html="activity.data['description']|sanitizeHtml" mathjax></div>
                <div class="content-arrow"></div>
            </div>
        </div>
        <div class="volume">
            <a ng-click="toggleVolume($event)">
                <i ng-class="ui.isMuting ? 'font-audio-volume-off' : 'font-audio-volume'" class="font"></i>
            </a>
            <div class="volume-slider-wrapper">
                <div class="volume-slider-arrow"></div>
                <div class="volume-slider"></div>
            </div>
        </div>
    </div>
    <audio preload="auto" class="audio">
        <source ng-src="[[audioUrl | trustSrc]]">
    </audio>
</div>                </div>

                <div class="swf-container" ng-if="upload.type == 'swf' && (!upload.status || upload.status != 'uploading')">
                    <div class="swf-player">
                        <div class="loading" ng-hide="!ui.swfLoading"></div>
                        <div ng-if="!isVisitor" swf-object id="preview-flash" swf-url="/api/uploads/[[upload.id]]/swf" swf-width="100%"
                             swf-height="525" swf-load="swfLoaded()">
                        </div>
                        <div ng-if="isVisitor && activity" swf-object id="preview-flash" swf-url="/anonymous-api/[[activity.id]]/uploads/[[upload.id]]/swf?preview=true" swf-width="100%"
                             swf-height="525" swf-load="swfLoaded()">
                        </div>
                        <div ng-if="isVisitor && !activity && resourceId" swf-object id="preview-flash" swf-url="/anonymous-api/shared-resources/[[resourceId]]/preview?preview=true" swf-width="100%"
                             swf-height="525" swf-load="swfLoaded()">
                        </div>
                        <div ng-if="!hasFlashPlayer" class="no-flash-player">
                            您还没有安装Flash播放器，请点击
                            <a ng-href="https://get.adobe.com/flashplayer/">这里</a>
                            安装
                        </div>
                    </div>
                </div>

                <div class="scorm-container" ng-if="upload.type == 'scorm' && upload.status == 'ready'">
                    <div class="sco-menu">
                        <span ng-bind="scormManifest.organizations.organization.title"></span>
                        <div ng-show="scormManifest.organizations.organization.item.length > 0"
                             ng-repeat="i1 in scormManifest.organizations.organization.item" class="menu-level1">
<span ng-bind="i1.title" ng-hide="i1.scormUrl"></span>
<a ng-click="viewScorm(i1)" ng-bind="i1.title" class="sco-link" ng-show="i1.scormUrl"></a>

<div ng-show="i1.item" class="menu-level2">
    <span ng-bind="i1.item.title" ng-hide="i1.item.scormUrl"></span>
    <a ng-click="viewScorm(i1.item)" ng-bind="i1.item.title" class="sco-link" ng-show="i1.item.scormUrl"></a>
</div>

<div ng-repeat="i2 in i1.item" class="menu-level2" ng-show="i1.item.length > 0">
    <span ng-bind="i2.title" ng-hide="i2.scormUrl"></span>
    <a ng-click="viewScorm(i2)" ng-bind="i2.title" class="sco-link" ng-show="i2.scormUrl"></a>
    <div ng-repeat="i3 in i2.item" class="menu-level2">
        <span ng-bind="i3.title" ng-hide="i3.scormUrl"></span>
        <a ng-click="viewScorm(i3)" ng-bind="i3.title" class="sco-link" ng-show="i3.scormUrl"></a>
        <div ng-repeat="i4 in i3.item" class="menu-level2">
            <span ng-bind="i4.title" ng-hide="i4.scormUrl"></span>
            <a ng-click="viewScorm(i4)" ng-bind="i4.title" class="sco-link" ng-show="i4.scormUrl"></a>
        </div>
    </div>
</div>                        </div>
                        <div ng-show="scormManifest.organizations.organization.item" class="menu-level1">
                            <span ng-bind="scormManifest.organizations.organization.item.title"
                                  ng-hide="scormManifest.organizations.organization.item.scormUrl"></span>
                            <a ng-click="viewScorm(scormManifest.organizations.organization.item)"
                               ng-bind="scormManifest.organizations.organization.item.title"
                               ng-show="scormManifest.organizations.organization.item.scormUrl"
                               class="sco-link"></a>
                            <div ng-show="scormManifest.organizations.organization.item.item.length > 0"
                                 ng-repeat="i1 in scormManifest.organizations.organization.item.item" class="menu-level1">
<span ng-bind="i1.title" ng-hide="i1.scormUrl"></span>
<a ng-click="viewScorm(i1)" ng-bind="i1.title" class="sco-link" ng-show="i1.scormUrl"></a>

<div ng-show="i1.item" class="menu-level2">
    <span ng-bind="i1.item.title" ng-hide="i1.item.scormUrl"></span>
    <a ng-click="viewScorm(i1.item)" ng-bind="i1.item.title" class="sco-link" ng-show="i1.item.scormUrl"></a>
</div>

<div ng-repeat="i2 in i1.item" class="menu-level2" ng-show="i1.item.length > 0">
    <span ng-bind="i2.title" ng-hide="i2.scormUrl"></span>
    <a ng-click="viewScorm(i2)" ng-bind="i2.title" class="sco-link" ng-show="i2.scormUrl"></a>
    <div ng-repeat="i3 in i2.item" class="menu-level2">
        <span ng-bind="i3.title" ng-hide="i3.scormUrl"></span>
        <a ng-click="viewScorm(i3)" ng-bind="i3.title" class="sco-link" ng-show="i3.scormUrl"></a>
        <div ng-repeat="i4 in i3.item" class="menu-level2">
            <span ng-bind="i4.title" ng-hide="i4.scormUrl"></span>
            <a ng-click="viewScorm(i4)" ng-bind="i4.title" class="sco-link" ng-show="i4.scormUrl"></a>
        </div>
    </div>
</div>                            </div>
                        </div>
                    </div>
                    <div class="sco-viewer">
                        <iframe id='scorm-viewer' frameborder="0" class="scorm-iframe">
                        </iframe>
                    </div>
                </div>
                <div class="evercam-container" ng-if="upload.type == 'evercam' && upload.status == 'ready'">
                    <div class="evercam-viewer">
                        <iframe id='evercam-viewer' frameborder="0" class="evercam-iframe">
                        </iframe>
                    </div>
                </div>
                <div class="link-container" ng-if="upload.type == 'link'">
                    <div class="video-link-previewer" ng-if="upload.link.embedded_url">
                        <iframe id="iframeplayer"
                                ng-src="[[ trustAsResourceUrl(upload.link.embedded_url) ]]"
                                ng-style="iframeStyle"
                                height="100%" width="100%"
                                marginwidth="0" marginheight="0"
                                scrolling="No" frameborder="0"
                                allowfullscreen>
                        </iframe>
                    </div>
                    <div class="link-previewer" ng-if="!upload.link.embedded_url">
                        <div class="icon-resource-type">
                            <i class="font font-open-in-browser big-file-font"></i>
                            <div>
                                <a class="button button-green small" ng-href="[[upload.link.url]]" target="_blank">在浏览器中打开</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class='preview-mode reader-wrapper' ng-if="viewMode.mode==='preview'" ng-controller="PreviewModeController">
            <iframe id='preview-viewer' width="100%" height='100%' frameborder="0"
                ng-src="[[trustAsResourceUrl(previewDataMap[upload.id])]]">
            </iframe>
        </div>
    </div>
</div>
                <div class="question-panel" ng-if="ui.showQuestionPanel === true">
                    <question-submit-panel
                    ng-prop-user_id="281121"
                    ng-prop-course_id="courseId"
                    ng-prop-activity="activity"
                    ng-prop-is_simulating_instructor="isSimulatingInstructor"
                    ng-prop-material="upload"></question-submit-panel>
                </div>

                <div class="ai-quiz-panel" ng-if="ui.showAiQuizPanel">
                    <ai-quiz-subjects-view ng-prop-activity="activity"
                        ng-prop-upload="upload"
                        ng-prop-is_instructor="isInstructorView"
                        ng-prop-allow_edit="false"
                                           ng-prop-has_ai_ability="hasAiAbility">
                    </ai-quiz-subjects-view>
                </div>
            </div>
            <div ng-if="previewType(upload.type) == 'video-quiz'" class="content" ng-class="{'has-footer': uploads.length > 1}">
<div ng-controller="VideoQuizPreviewController"
     ng-init="subjectTypeMap={
        'single_selection': '单选题',
        'multiple_selection': '多选题',
        'true_or_false': '判断题'};
        useNewPlayer=false;
        usePlayer2=true;"
     class="video-quiz-preview-container" ng-cloak>
    <div class="video-player-section section" ng-if="upload.video_urls">
        <div class='interaction-container' ng-if="!upload.deleted && !ui.isOrgTransferArrears">
            <div class="video-player">
    <div id='video-quiz-player' class="video-player">
        <div ng-if="upload.video_urls"
            id="wg-video-player-quiz-video"
            wg-video-player
            style="height:100%;"
            resolutions="{'ORIGINAL':'原画', 'HD': '1080p', 'VGA': '720p', 'QVGA': '480p'}"
            default-resolution="'HD'"
            upload="upload"
            video-src-type="upload.video_src_type"
            video-urls="upload.video_urls"
            seekable="allow_forward_seeking"
            activity="activity"
            player-initiated="playerInitiated(player)"
            download="false"
            disableTrack="true"
            enable-play-rate=True
            org-code="'1'"
            enable-caption="false"
            enable-topic="false"
            video-editor-server='https://courses.zju.edu.cn/video-editor'
        ></div>
    </div>
            </div>
            <div class="interaction-subjects subjects-preview" ng-if="ui.isVideoPaused && subjectsForCurrentTime.length > 0">
<div class="exam-paper with-submit" ng-if="!ui.shouldShowAnswerAtTheCurrentTime">
    <div class="subjects-jit-display">
        <div class="subjects" ng-if="isInstructorView">
            <li class="subject" ng-repeat="subject in subjectsForCurrentTime">
<div ng-if="subject.isObjective()">
<div class="subject-head" ng-attr-id="[[subject.id]]">
    <div class="summary-title" ng-class="{'required': subject.settings.required}">
<div class="subject-resort-index" ng-hide="ui.editSubjectPage">
    <span ng-if="!subject.parent_id || subject.data.is_random_subject">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>
    <span ng-if="subject.parent_id  && !subject.data.is_random_subject">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>


<div class="subject-resort-index" ng-if="ui.editSubjectPage">
    <span ng-if="!subject.parent_id">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type == 'random'">
        <span ng-bind="getSubjectIndex(parentSubject, $index)"></span>-<span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type != 'random'">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>        <span ng-compile-html="subject.displayedDescription || subject.description | sanitizeHtml"
              class="pre-wrap subject-description simditor-viewer" mathjax></span>
        <span class="require-info" ng-if="subject.settings.required">（必填）</span>
            <span class="random-info" ng-if="subject.data.is_random_subject">随机</span>
        <span class="prompt-message alert" ng-if="subject.updated">题目内容已更新,请重新作答</span>
        <span class="prompt-message alert-required" ng-if="subject.settings.required && subject.not_answered">
            &nbsp;&nbsp;未填写&nbsp;&nbsp;
        </span>
        <span ng-if="subject.unsaved" class="answer-unsaved-reminder">未保存</span>
    </div>
    <div class="summary-sub-title">
        <span ng-bind="subjectTypeMap[subject.type]"></span>
        <span ng-if="!questionnaire">
            (<span ng-bind="subject.getPoint()"></span>
            <span>分)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'fill_in_blank' && !subject.settings.unordered">(请按题目中的空缺顺序依次填写答案)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'matching'">
                (计分规则:
                <span ng-if="subject.score_rule == 'single'">按匹配正确项计分</span>
                <span ng-if="subject.score_rule == 'overall'">有匹配错误项则该题目不得分</span>)
            </span>
        </span>
    </div>
</div><ul class="media-uploads-paper" ng-init="noPopup = false">
    <li ng-repeat="upload in subject.settings.uploads | filter:uploadWithName">
        <div ng-if="upload.type == 'audio'" simditor-audio id="[[upload.id]]"
        src="[[trustSrc('/api/uploads/' + upload.id + '/in-rich-content?file_key=' + upload.key )]]" name="[[upload.name]]"></div>
        <div ng-if="upload.type === 'video'" exam-video-player upload="upload" no-popup="noPopup"  resolutions="{'ORIGINAL':'原画', 'HD': '1080p', 'VGA': '720p', 'QVGA': '480p'}"
        default-resolution="'HD'"  lang='zh-CN'
         settings="subject.settings"
        >
        </div>

        <div ng-if="upload.enable_origin_text && (canViewCorrectAnswer || canViewAnswerForClassroom || canViewAnswerExplanation)">
            <div class="show-text">
            原文/译文
            <label class="switch">
                <input type="checkbox" class="switch-input" ng-model="upload.show_text"/>
                <span class="switch-label" data-on="" data-off=""></span>
                <span class="switch-handle"></span>
            </label>
            </div>

            <span ng-show="upload.show_text" class="pre-wrap subject-description simditor-viewer origin-text mb-3"
            ng-compile-html="upload.text | sanitizeHtml" mathjax>
            </span>
        </div>
    </li>
</ul>
<div class="subject-body">
    <ol class="subject-options">
        <li class="option" ng-class="subject.settings.options_layout"
            ng-style="{width: ui.calcOptionWidth(subject.options, subject.settings.options_layout)}"
            ng-repeat="option in subject.options | orderBy: 'sort'">
            <label ng-class="{'answered-option': option.id == subject.answeredOption}">
                <span class="left">
                    <input ng-if="subject.type=='single_selection' || subject.type=='true_or_false'"
                           type="radio" ng-value="[[option.id]]"
                           ng-model="subject.answeredOption" ng-change="onChangeSubmission(subject)" />
                    <input ng-if="subject.type=='multiple_selection'"
                           type="checkbox"
                           ng-model="option.checked" ng-change="onChangeSubmission(subject)" />
                    <span class="option-index" ng-bind="ui.intToChar($index)"></span><span>.</span>
                </span>

                <div class="option-content">
                    <span ng-compile-html="option.content | sanitizeHtml" class="pre-wrap simditor-viewer" mathjax></span>
                </div>
            </label>
        </li>
    </ol>
</div></div>
<div ng-if="subject.type == 'fill_in_blank'">
<div class="subject-head" ng-attr-id="[[subject.id]]">
    <div class="summary-title" ng-class="{'required': subject.settings.required}">
<div class="subject-resort-index" ng-hide="ui.editSubjectPage">
    <span ng-if="!subject.parent_id || subject.data.is_random_subject">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>
    <span ng-if="subject.parent_id  && !subject.data.is_random_subject">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>


<div class="subject-resort-index" ng-if="ui.editSubjectPage">
    <span ng-if="!subject.parent_id">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type == 'random'">
        <span ng-bind="getSubjectIndex(parentSubject, $index)"></span>-<span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type != 'random'">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>        <span ng-compile-html="subject.displayedDescription || subject.description | sanitizeHtml"
              class="pre-wrap subject-description simditor-viewer" mathjax></span>
        <span class="require-info" ng-if="subject.settings.required">（必填）</span>
            <span class="random-info" ng-if="subject.data.is_random_subject">随机</span>
        <span class="prompt-message alert" ng-if="subject.updated">题目内容已更新,请重新作答</span>
        <span class="prompt-message alert-required" ng-if="subject.settings.required && subject.not_answered">
            &nbsp;&nbsp;未填写&nbsp;&nbsp;
        </span>
        <span ng-if="subject.unsaved" class="answer-unsaved-reminder">未保存</span>
    </div>
    <div class="summary-sub-title">
        <span ng-bind="subjectTypeMap[subject.type]"></span>
        <span ng-if="!questionnaire">
            (<span ng-bind="subject.getPoint()"></span>
            <span>分)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'fill_in_blank' && !subject.settings.unordered">(请按题目中的空缺顺序依次填写答案)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'matching'">
                (计分规则:
                <span ng-if="subject.score_rule == 'single'">按匹配正确项计分</span>
                <span ng-if="subject.score_rule == 'overall'">有匹配错误项则该题目不得分</span>)
            </span>
        </span>
    </div>
</div><ul class="media-uploads-paper" ng-init="noPopup = false">
    <li ng-repeat="upload in subject.settings.uploads | filter:uploadWithName">
        <div ng-if="upload.type == 'audio'" simditor-audio id="[[upload.id]]"
        src="[[trustSrc('/api/uploads/' + upload.id + '/in-rich-content?file_key=' + upload.key )]]" name="[[upload.name]]"></div>
        <div ng-if="upload.type === 'video'" exam-video-player upload="upload" no-popup="noPopup"  resolutions="{'ORIGINAL':'原画', 'HD': '1080p', 'VGA': '720p', 'QVGA': '480p'}"
        default-resolution="'HD'"  lang='zh-CN'
         settings="subject.settings"
        >
        </div>

        <div ng-if="upload.enable_origin_text && (canViewCorrectAnswer || canViewAnswerForClassroom || canViewAnswerExplanation)">
            <div class="show-text">
            原文/译文
            <label class="switch">
                <input type="checkbox" class="switch-input" ng-model="upload.show_text"/>
                <span class="switch-label" data-on="" data-off=""></span>
                <span class="switch-handle"></span>
            </label>
            </div>

            <span ng-show="upload.show_text" class="pre-wrap subject-description simditor-viewer origin-text mb-3"
            ng-compile-html="upload.text | sanitizeHtml" mathjax>
            </span>
        </div>
    </li>
</ul>
<div class="subject-body">
    <div class="subject-answers">
        <ol>
            <li ng-form="answers" class="answer" ng-repeat="answer in subject.answers">
                <span ng-if="subject.answers.length > 1">
                    <span class="sort circle-number" ng-bind-html="$index+1"></span>
                </span>
                <input class="content" type="text" ng-model="answer.content" ng-change="onChangeSubmission(subject)" format-validated />
            </li>
        </ol>
    </div>
</div></div>
<div ng-if="subject.type == 'text'">
    <div class="subject-head">
        <div class="summary-title">
            <span class="pre-wrap subject-description simditor-viewer"
                ng-compile-html="subject.description || '暂无题目描述' | sanitizeHtml" mathjax>
            </span>
        </div>
    </div>
</div>
<div ng-if="subject.type == 'short_answer'">
<div class="subject-head" ng-attr-id="[[subject.id]]">
    <div class="summary-title" ng-class="{'required': subject.settings.required}">
<div class="subject-resort-index" ng-hide="ui.editSubjectPage">
    <span ng-if="!subject.parent_id || subject.data.is_random_subject">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>
    <span ng-if="subject.parent_id  && !subject.data.is_random_subject">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>


<div class="subject-resort-index" ng-if="ui.editSubjectPage">
    <span ng-if="!subject.parent_id">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type == 'random'">
        <span ng-bind="getSubjectIndex(parentSubject, $index)"></span>-<span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type != 'random'">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>        <span ng-compile-html="subject.displayedDescription || subject.description | sanitizeHtml"
              class="pre-wrap subject-description simditor-viewer" mathjax></span>
        <span class="require-info" ng-if="subject.settings.required">（必填）</span>
            <span class="random-info" ng-if="subject.data.is_random_subject">随机</span>
        <span class="prompt-message alert" ng-if="subject.updated">题目内容已更新,请重新作答</span>
        <span class="prompt-message alert-required" ng-if="subject.settings.required && subject.not_answered">
            &nbsp;&nbsp;未填写&nbsp;&nbsp;
        </span>
        <span ng-if="subject.unsaved" class="answer-unsaved-reminder">未保存</span>
    </div>
    <div class="summary-sub-title">
        <span ng-bind="subjectTypeMap[subject.type]"></span>
        <span ng-if="!questionnaire">
            (<span ng-bind="subject.getPoint()"></span>
            <span>分)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'fill_in_blank' && !subject.settings.unordered">(请按题目中的空缺顺序依次填写答案)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'matching'">
                (计分规则:
                <span ng-if="subject.score_rule == 'single'">按匹配正确项计分</span>
                <span ng-if="subject.score_rule == 'overall'">有匹配错误项则该题目不得分</span>)
            </span>
        </span>
    </div>
</div>
<div class="subject-body short-answer">
    <div class="answer-content" ng-init="subject.isFocus = false;">
        <div class="answer-area-container" ng-class="{'is-focus': subject.isFocus}">
            <textarea ng-model="subject.answered_content" ng-change="onChangeSubmission(subject)" ng-trim="false"
                      class="short-answer-take"
                      bind-model="subject"
                      rows="5"
                      clean-font-size-paste
                      sim-editor sim-toolbar="code">
            </textarea>
        </div>
        <div class="left add-attachments" ng-if="!questionnaire && !classroom">
            <span>附件</span>
            <a class="button add-attachment-btn" ng-click="openFileSelectPopup(subject)"
               on-file-selected="addAttachments">
                <i class="font font-file-image"></i>
                <span>上传</span>
            </a>
        </div>
    </div>

    <div class="short-answer-upload-list" ng-init="uploads = (ui.get_subject_attachments && ui.get_subject_attachments(subject)) || subject.attachments" refresh-on="subject.attachments">
<div class="attachments-wrapper" ng-if="uploads.length" stop-propagation check-upload-status>

<div class="attachment-header clearfix">
    <div class="attachment-column column" ng-class="{'large-11': true, 'large-15': !true}">
        附件名
    </div>
    <div class="attachment-column column" ng-if="ui.videoType !=='sobey'"
        ng-class="{'large-7': true, 'large-10': !true}">
        大小
    </div>
        <div ng-if="airHelper.canShowAttachmentQuestion(activity) === true" class="attachment-column column large-2">题目</div>
    <div class="attachment-column column large-3">&nbsp;</div>
</div>    <div class="attachment-body">
        <div ng-repeat="upload in uploads">
    <div class="attachment-row preview-able clearfix" ng-if="canPreview(upload) && !upload.deleted && canShowResource(upload, isInstructorView)"
             previewer="{uploads: uploads, currentFile: upload, activity: exam, isAttachment: isAttachment}" reveal-modal="file-previewer" ng-click="downloadBlob(exam, upload, 'view')">



    <div class="attachment-column column large-10" ng-if="upload.type != 'slide'" ng-class="{'large-20':upload.source === 'sobey'}">
        <div ng-if="upload.source == 'auto-generated-pdf'">
            <svg class="file-text-content left">
                <use xlink:href="#file-text-content"></use>
            </svg>
            <span class="file-name-wrapper truncate-text left">
                <span class="file-name" tipsy-literal="[[ upload.name.split('.')[0] ]]">[[ upload.name.split('.')[0] ]]</span>
            </span>
        </div>
        <div ng-if="upload.source !== 'auto-generated-pdf'" class="w-full flex">
            <i class="font font-file-[[fileTypeByExtension(upload)]] left"></i>
            <span class="file-name-wrapper truncate-text left">
                <span class="file-name" tipsy-literal="[[ upload.name ]]" ng-bind="upload.name|fileName"></span>
            </span>
            <span class="file-extension left" ng-bind="upload.name|fileExtension"></span>
        </div>
    </div>
    <div class="attachment-column column large-10" ng-if="upload.type == 'slide'">
        <i class="font font-slide left"></i>
        <span class="file-name-wrapper truncate-text left">
            <span class="file-name" tipsy-literal="[[ upload.title ]]" ng-bind="upload.title|fileName"></span>
        </span>
    </div>
        <div class="attachment-column column attachment-state" ng-if="!upload.deleted && upload.source !== 'sobey'"
            ng-class="{'large-1': true, 'large-5': !true}">
        <span ng-if="!upload.status || upload.status === 'ready' || (upload.status === 'processing' && (upload.type === 'video' || upload.videos)) || upload.status === 'none' || upload.deleted || wpsPreview(upload)">&nbsp;</span>
        <span ng-if="(upload.status === 'failed' || uploadsStatus[upload.id] === 'failed') && !upload.deleted">&nbsp;</span>
        <span ng-if="(upload.status === 'processing' || uploadsStatus[upload.id] === 'processing') && (upload.type != 'video' || !upload.videos) && !upload.deleted && !wpsPreview(upload)">&nbsp;</span>
    </div>
    <div class="attachment-column column attachment-deleted large-5" ng-if="upload.deleted">
        <span>文件已删除</span>
    </div>
    <div class="attachment-column column attachment-size attachment-marked"
         ng-class="{'large-7': true, 'large-10': !true}"
         ng-init="isUploadFailed = (upload.status || uploadsStatus[upload.id]) == 'failed';
                  isUploadProcessing = (upload.status || uploadsStatus[upload.id]) == 'processing';
                  isNotVideo = upload.type != 'video' || !upload.videos;
                  showFileSize = !isUploadFailed && !isUploadProcessing && upload.size >= 0">
        <span ng-if="upload.source == 'LARK'" style="height: 1px;">——</span>
        <span ng-if="upload.source != 'LARK' && showFileSize" ng-bind="upload.size|humanizeBytes"></span>
        <span ng-if="upload.source != 'LARK' && !showFileSize && !upload.deleted">
            <span ng-if="isUploadFailed" class="attachment-state-failed">
                    转码失败
            </span>
            <span ng-if="isUploadProcessing && isNotVideo && !wpsPreview(upload)" class="attachment-state-processing">
                    正在转码中
            </span>
        </span>
        <div ng-if="upload.type=='scorm' && upload.scorm">
            教材大小:<span ng-bind="upload.scorm.files_size|humanizeBytes"></span>
        </div>
        <div ng-if="upload.type=='slide' && upload.duration">
            时长:<span ng-bind="upload.duration | formatTime"></span>
        </div>
    </div>



        <div ng-if="airHelper.canShowAttachmentQuestion(activity) === true" class="attachment-column column large-2">
            <span class="aiQuiz-content">
                [[upload.aiQuiz.subjectsCount || "--"]]
            </span>
        </div>

    <div class="attachment-column column"
         ng-class="{'large-7': true, 'large-5': !true}">
<span class="attachment-operations">
        <div class="horizon">



            <a stop-propagation previewer="{uploads: uploads, currentFile: upload, activity: exam, isAttachment: isAttachment}" reveal-modal="file-previewer"
                tipsy-literal="预览" ng-click="downloadBlob(exam, upload, 'view')"
                ng-if="canPreview(upload) && !upload.deleted && canShowResource(upload, isInstructorView)">
                <i class="font font-table-edit-view-2"></i>
            </a>
        <a ng-click="openSobeyVideo()" ng-if="upload.source==='sobey'">
            <i class="font font-table-edit-view-2"></i>
        </a>
        <a stop-propagation ng-click="deleteFile(upload, subject)" tipsy-literal="删除" ng-hide="['auditing', 'agree'].includes(upload.audit_status)" ng-class="{'delete-btn-disabled': upload.viewCount > 0}">
            <i class="font font-delete"></i>
            <span class="dropdown-item dropdown-item-hide">删除</span>
        </a>
        </div>
</span>    </div>

</div>

<div class="attachment-row clearfix" ng-if="!canPreview(upload) || upload.deleted || !canShowResource(upload, isInstructorView)" ng-click="downloadWeDrive(upload)">


    <div class="attachment-column column large-10" ng-if="upload.type != 'slide'" ng-class="{'large-20':upload.source === 'sobey'}">
        <div ng-if="upload.source == 'auto-generated-pdf'">
            <svg class="file-text-content left">
                <use xlink:href="#file-text-content"></use>
            </svg>
            <span class="file-name-wrapper truncate-text left">
                <span class="file-name" tipsy-literal="[[ upload.name.split('.')[0] ]]">[[ upload.name.split('.')[0] ]]</span>
            </span>
        </div>
        <div ng-if="upload.source !== 'auto-generated-pdf'" class="w-full flex">
            <i class="font font-file-[[fileTypeByExtension(upload)]] left"></i>
            <span class="file-name-wrapper truncate-text left">
                <span class="file-name" tipsy-literal="[[ upload.name ]]" ng-bind="upload.name|fileName"></span>
            </span>
            <span class="file-extension left" ng-bind="upload.name|fileExtension"></span>
        </div>
    </div>
    <div class="attachment-column column large-10" ng-if="upload.type == 'slide'">
        <i class="font font-slide left"></i>
        <span class="file-name-wrapper truncate-text left">
            <span class="file-name" tipsy-literal="[[ upload.title ]]" ng-bind="upload.title|fileName"></span>
        </span>
    </div>
        <div class="attachment-column column attachment-state" ng-if="!upload.deleted && upload.source !== 'sobey'"
            ng-class="{'large-1': true, 'large-5': !true}">
        <span ng-if="!upload.status || upload.status === 'ready' || (upload.status === 'processing' && (upload.type === 'video' || upload.videos)) || upload.status === 'none' || upload.deleted || wpsPreview(upload)">&nbsp;</span>
        <span ng-if="(upload.status === 'failed' || uploadsStatus[upload.id] === 'failed') && !upload.deleted">&nbsp;</span>
        <span ng-if="(upload.status === 'processing' || uploadsStatus[upload.id] === 'processing') && (upload.type != 'video' || !upload.videos) && !upload.deleted && !wpsPreview(upload)">&nbsp;</span>
    </div>
    <div class="attachment-column column attachment-deleted large-5" ng-if="upload.deleted">
        <span>文件已删除</span>
    </div>
    <div class="attachment-column column attachment-size attachment-marked"
         ng-class="{'large-7': true, 'large-10': !true}"
         ng-init="isUploadFailed = (upload.status || uploadsStatus[upload.id]) == 'failed';
                  isUploadProcessing = (upload.status || uploadsStatus[upload.id]) == 'processing';
                  isNotVideo = upload.type != 'video' || !upload.videos;
                  showFileSize = !isUploadFailed && !isUploadProcessing && upload.size >= 0">
        <span ng-if="upload.source == 'LARK'" style="height: 1px;">——</span>
        <span ng-if="upload.source != 'LARK' && showFileSize" ng-bind="upload.size|humanizeBytes"></span>
        <span ng-if="upload.source != 'LARK' && !showFileSize && !upload.deleted">
            <span ng-if="isUploadFailed" class="attachment-state-failed">
                    转码失败
            </span>
            <span ng-if="isUploadProcessing && isNotVideo && !wpsPreview(upload)" class="attachment-state-processing">
                    正在转码中
            </span>
        </span>
        <div ng-if="upload.type=='scorm' && upload.scorm">
            教材大小:<span ng-bind="upload.scorm.files_size|humanizeBytes"></span>
        </div>
        <div ng-if="upload.type=='slide' && upload.duration">
            时长:<span ng-bind="upload.duration | formatTime"></span>
        </div>
    </div>



        <div ng-if="airHelper.canShowAttachmentQuestion(activity) === true" class="attachment-column column large-2">
            <span class="aiQuiz-content">
                [[upload.aiQuiz.subjectsCount || "--"]]
            </span>
        </div>

    <div class="attachment-column column"
         ng-class="{'large-7': true, 'large-5': !true}">
<span class="attachment-operations">
        <div class="horizon">



            <a stop-propagation previewer="{uploads: uploads, currentFile: upload, activity: exam, isAttachment: isAttachment}" reveal-modal="file-previewer"
                tipsy-literal="预览" ng-click="downloadBlob(exam, upload, 'view')"
                ng-if="canPreview(upload) && !upload.deleted && canShowResource(upload, isInstructorView)">
                <i class="font font-table-edit-view-2"></i>
            </a>
        <a ng-click="openSobeyVideo()" ng-if="upload.source==='sobey'">
            <i class="font font-table-edit-view-2"></i>
        </a>
        <a stop-propagation ng-click="deleteFile(upload, subject)" tipsy-literal="删除" ng-hide="['auditing', 'agree'].includes(upload.audit_status)" ng-class="{'delete-btn-disabled': upload.viewCount > 0}">
            <i class="font font-delete"></i>
            <span class="dropdown-item dropdown-item-hide">删除</span>
        </a>
        </div>
</span>    </div>

</div>        </div>
    </div>
</div>    </div>

</div></div>
<div ng-if="subject.type == 'cloze'">
<div class="subject-head" ng-attr-id="[[subject.id]]">
    <div class="summary-title" ng-class="{'required': subject.settings.required}">
<div class="subject-resort-index" ng-hide="ui.editSubjectPage">
    <span ng-if="!subject.parent_id || subject.data.is_random_subject">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>
    <span ng-if="subject.parent_id  && !subject.data.is_random_subject">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>


<div class="subject-resort-index" ng-if="ui.editSubjectPage">
    <span ng-if="!subject.parent_id">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type == 'random'">
        <span ng-bind="getSubjectIndex(parentSubject, $index)"></span>-<span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type != 'random'">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>        <span ng-compile-html="subject.displayedDescription || subject.description | sanitizeHtml"
              class="pre-wrap subject-description simditor-viewer" mathjax></span>
        <span class="require-info" ng-if="subject.settings.required">（必填）</span>
            <span class="random-info" ng-if="subject.data.is_random_subject">随机</span>
        <span class="prompt-message alert" ng-if="subject.updated">题目内容已更新,请重新作答</span>
        <span class="prompt-message alert-required" ng-if="subject.settings.required && subject.not_answered">
            &nbsp;&nbsp;未填写&nbsp;&nbsp;
        </span>
        <span ng-if="subject.unsaved" class="answer-unsaved-reminder">未保存</span>
    </div>
    <div class="summary-sub-title">
        <span ng-bind="subjectTypeMap[subject.type]"></span>
        <span ng-if="!questionnaire">
            (<span ng-bind="subject.getPoint()"></span>
            <span>分)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'fill_in_blank' && !subject.settings.unordered">(请按题目中的空缺顺序依次填写答案)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'matching'">
                (计分规则:
                <span ng-if="subject.score_rule == 'single'">按匹配正确项计分</span>
                <span ng-if="subject.score_rule == 'overall'">有匹配错误项则该题目不得分</span>)
            </span>
        </span>
    </div>
</div></div>
<div ng-if="subject.type === 'matching'">
<div class="subject-head" ng-attr-id="[[subject.id]]">
    <div class="summary-title" ng-class="{'required': subject.settings.required}">
<div class="subject-resort-index" ng-hide="ui.editSubjectPage">
    <span ng-if="!subject.parent_id || subject.data.is_random_subject">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>
    <span ng-if="subject.parent_id  && !subject.data.is_random_subject">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>


<div class="subject-resort-index" ng-if="ui.editSubjectPage">
    <span ng-if="!subject.parent_id">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type == 'random'">
        <span ng-bind="getSubjectIndex(parentSubject, $index)"></span>-<span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type != 'random'">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>        <span ng-compile-html="subject.displayedDescription || subject.description | sanitizeHtml"
              class="pre-wrap subject-description simditor-viewer" mathjax></span>
        <span class="require-info" ng-if="subject.settings.required">（必填）</span>
            <span class="random-info" ng-if="subject.data.is_random_subject">随机</span>
        <span class="prompt-message alert" ng-if="subject.updated">题目内容已更新,请重新作答</span>
        <span class="prompt-message alert-required" ng-if="subject.settings.required && subject.not_answered">
            &nbsp;&nbsp;未填写&nbsp;&nbsp;
        </span>
        <span ng-if="subject.unsaved" class="answer-unsaved-reminder">未保存</span>
    </div>
    <div class="summary-sub-title">
        <span ng-bind="subjectTypeMap[subject.type]"></span>
        <span ng-if="!questionnaire">
            (<span ng-bind="subject.getPoint()"></span>
            <span>分)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'fill_in_blank' && !subject.settings.unordered">(请按题目中的空缺顺序依次填写答案)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'matching'">
                (计分规则:
                <span ng-if="subject.score_rule == 'single'">按匹配正确项计分</span>
                <span ng-if="subject.score_rule == 'overall'">有匹配错误项则该题目不得分</span>)
            </span>
        </span>
    </div>
</div>
<div class="subject-body">
    <div class="subject-answers">
        <div class="matching-answer-box">
            <ul>
                <li>
                    <div class="list-panel panel-desc">提示</div>
                    <div class="line"></div>
                    <div class="list-panel panel-desc">请从右侧拖入合适的答案</div>
                </li>
                <li ng-repeat="subSubject in subject.sub_subjects">
                    <div class="list-panel" ng-init="vueParam={subjectDescription: subSubject.description}">
                        <div vue-wrapper>
                            <match-subject-info :content="subjectDescription" class="desc"></match-subject-info>
                        </div>
                    </div>
                    <div class="line"><span></span></div>
                    <div class="list-panel option"
                        ng-class="{'option-fill' : subSubject.answer_number > 0}"
                        drag-cloneable="matching-dragable" drag-type="to"
                        drag-options="subject" drag-callback="dragAddCallback(subject)" ng-style="{height: subSubject.defaultStyle}">
                        <div class="clone-area drag-area" data-drag-node-id="[[subSubject.answer_number]]" ng-if="subSubject.note">
                            <div class="content-wrapper" ng-init="vueParam={subjectNote: subSubject.note.content}">
                                <div class="icon icon-drag"><i class="font font-activity-drag"></i></div>
                                <div vue-wrapper>
                                    <match-subject-info :content="subjectNote"></match-subject-info>
                                </div>
                            </div>
                        </div>
                    </div>
                </li>
            </ul>
            <div class="answer-pool">
                <div class="head panel-desc">答案池</div>
                <div id="cloneable-source" class="pool" drag-cloneable="matching-dragable" drag-type="from"
                    drag-options="subject" drag-callback="dragAddCallback(subject)">
                    <div class="clone-area drag-area" data-drag-node-id="[[answer.id]]" ng-repeat="answer in subject.options">
                        <div class="content-wrapper" ng-init="vueParam={subjectAnswer: answer.content}">
                            <div class="icon icon-drag"><i class="font font-activity-drag"></i></div>
                            <div vue-wrapper>
                                <match-subject-info :content="subjectAnswer"></match-subject-info>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="drag-trash-[[subject.id]]" class="cloneable-trash">
                    <div class="trash-area" drag-cloneable="matching-dragable" drag-type="trash"
                    drag-options="subject" drag-callback="dragAddCallback(subject)"></div>
                    <i class="font font-move-trash"></i>
                </div>
            </div>
        </div>
    </div>
</div></div>
<div class="paragraph-desc" ng-if="subject.type === 'paragraph_desc'">
    <div class="summary-title mb-4">
        <span class="pre-wrap subject-description simditor-viewer"
            ng-compile-html="subject.description || '暂无题目描述' | sanitizeHtml" mathjax>
        </span>
    </div>
<ul class="media-uploads-paper" ng-init="noPopup = false">
    <li ng-repeat="upload in subject.settings.uploads | filter:uploadWithName">
        <div ng-if="upload.type == 'audio'" simditor-audio id="[[upload.id]]"
        src="[[trustSrc('/api/uploads/' + upload.id + '/in-rich-content?file_key=' + upload.key )]]" name="[[upload.name]]"></div>
        <div ng-if="upload.type === 'video'" exam-video-player upload="upload" no-popup="noPopup"  resolutions="{'ORIGINAL':'原画', 'HD': '1080p', 'VGA': '720p', 'QVGA': '480p'}"
        default-resolution="'HD'"  lang='zh-CN'
         settings="subject.settings"
        >
        </div>

        <div ng-if="upload.enable_origin_text && (canViewCorrectAnswer || canViewAnswerForClassroom || canViewAnswerExplanation)">
            <div class="show-text">
            原文/译文
            <label class="switch">
                <input type="checkbox" class="switch-input" ng-model="upload.show_text"/>
                <span class="switch-label" data-on="" data-off=""></span>
                <span class="switch-handle"></span>
            </label>
            </div>

            <span ng-show="upload.show_text" class="pre-wrap subject-description simditor-viewer origin-text mb-3"
            ng-compile-html="upload.text | sanitizeHtml" mathjax>
            </span>
        </div>
    </li>
</ul></div>            </li>
        </div>
        <div class="subjects" ng-if="!isInstructorView">
            <li class="subject" ng-repeat="subject in subjectsForCurrentTime" ng-if="((!subject.hasValidAnswer && !activity.interaction_activity_attributes.repeat_answer) || activity.interaction_activity_attributes.repeat_answer) && !activity.is_closed">
<div ng-if="subject.isObjective()">
<div class="subject-head" ng-attr-id="[[subject.id]]">
    <div class="summary-title" ng-class="{'required': subject.settings.required}">
<div class="subject-resort-index" ng-hide="ui.editSubjectPage">
    <span ng-if="!subject.parent_id || subject.data.is_random_subject">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>
    <span ng-if="subject.parent_id  && !subject.data.is_random_subject">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>


<div class="subject-resort-index" ng-if="ui.editSubjectPage">
    <span ng-if="!subject.parent_id">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type == 'random'">
        <span ng-bind="getSubjectIndex(parentSubject, $index)"></span>-<span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type != 'random'">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>        <span ng-compile-html="subject.displayedDescription || subject.description | sanitizeHtml"
              class="pre-wrap subject-description simditor-viewer" mathjax></span>
        <span class="require-info" ng-if="subject.settings.required">（必填）</span>
            <span class="random-info" ng-if="subject.data.is_random_subject">随机</span>
        <span class="prompt-message alert" ng-if="subject.updated">题目内容已更新,请重新作答</span>
        <span class="prompt-message alert-required" ng-if="subject.settings.required && subject.not_answered">
            &nbsp;&nbsp;未填写&nbsp;&nbsp;
        </span>
        <span ng-if="subject.unsaved" class="answer-unsaved-reminder">未保存</span>
    </div>
    <div class="summary-sub-title">
        <span ng-bind="subjectTypeMap[subject.type]"></span>
        <span ng-if="!questionnaire">
            (<span ng-bind="subject.getPoint()"></span>
            <span>分)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'fill_in_blank' && !subject.settings.unordered">(请按题目中的空缺顺序依次填写答案)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'matching'">
                (计分规则:
                <span ng-if="subject.score_rule == 'single'">按匹配正确项计分</span>
                <span ng-if="subject.score_rule == 'overall'">有匹配错误项则该题目不得分</span>)
            </span>
        </span>
    </div>
</div><ul class="media-uploads-paper" ng-init="noPopup = false">
    <li ng-repeat="upload in subject.settings.uploads | filter:uploadWithName">
        <div ng-if="upload.type == 'audio'" simditor-audio id="[[upload.id]]"
        src="[[trustSrc('/api/uploads/' + upload.id + '/in-rich-content?file_key=' + upload.key )]]" name="[[upload.name]]"></div>
        <div ng-if="upload.type === 'video'" exam-video-player upload="upload" no-popup="noPopup"  resolutions="{'ORIGINAL':'原画', 'HD': '1080p', 'VGA': '720p', 'QVGA': '480p'}"
        default-resolution="'HD'"  lang='zh-CN'
         settings="subject.settings"
        >
        </div>

        <div ng-if="upload.enable_origin_text && (canViewCorrectAnswer || canViewAnswerForClassroom || canViewAnswerExplanation)">
            <div class="show-text">
            原文/译文
            <label class="switch">
                <input type="checkbox" class="switch-input" ng-model="upload.show_text"/>
                <span class="switch-label" data-on="" data-off=""></span>
                <span class="switch-handle"></span>
            </label>
            </div>

            <span ng-show="upload.show_text" class="pre-wrap subject-description simditor-viewer origin-text mb-3"
            ng-compile-html="upload.text | sanitizeHtml" mathjax>
            </span>
        </div>
    </li>
</ul>
<div class="subject-body">
    <ol class="subject-options">
        <li class="option" ng-class="subject.settings.options_layout"
            ng-style="{width: ui.calcOptionWidth(subject.options, subject.settings.options_layout)}"
            ng-repeat="option in subject.options | orderBy: 'sort'">
            <label ng-class="{'answered-option': option.id == subject.answeredOption}">
                <span class="left">
                    <input ng-if="subject.type=='single_selection' || subject.type=='true_or_false'"
                           type="radio" ng-value="[[option.id]]"
                           ng-model="subject.answeredOption" ng-change="onChangeSubmission(subject)" />
                    <input ng-if="subject.type=='multiple_selection'"
                           type="checkbox"
                           ng-model="option.checked" ng-change="onChangeSubmission(subject)" />
                    <span class="option-index" ng-bind="ui.intToChar($index)"></span><span>.</span>
                </span>

                <div class="option-content">
                    <span ng-compile-html="option.content | sanitizeHtml" class="pre-wrap simditor-viewer" mathjax></span>
                </div>
            </label>
        </li>
    </ol>
</div></div>
<div ng-if="subject.type == 'fill_in_blank'">
<div class="subject-head" ng-attr-id="[[subject.id]]">
    <div class="summary-title" ng-class="{'required': subject.settings.required}">
<div class="subject-resort-index" ng-hide="ui.editSubjectPage">
    <span ng-if="!subject.parent_id || subject.data.is_random_subject">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>
    <span ng-if="subject.parent_id  && !subject.data.is_random_subject">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>


<div class="subject-resort-index" ng-if="ui.editSubjectPage">
    <span ng-if="!subject.parent_id">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type == 'random'">
        <span ng-bind="getSubjectIndex(parentSubject, $index)"></span>-<span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type != 'random'">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>        <span ng-compile-html="subject.displayedDescription || subject.description | sanitizeHtml"
              class="pre-wrap subject-description simditor-viewer" mathjax></span>
        <span class="require-info" ng-if="subject.settings.required">（必填）</span>
            <span class="random-info" ng-if="subject.data.is_random_subject">随机</span>
        <span class="prompt-message alert" ng-if="subject.updated">题目内容已更新,请重新作答</span>
        <span class="prompt-message alert-required" ng-if="subject.settings.required && subject.not_answered">
            &nbsp;&nbsp;未填写&nbsp;&nbsp;
        </span>
        <span ng-if="subject.unsaved" class="answer-unsaved-reminder">未保存</span>
    </div>
    <div class="summary-sub-title">
        <span ng-bind="subjectTypeMap[subject.type]"></span>
        <span ng-if="!questionnaire">
            (<span ng-bind="subject.getPoint()"></span>
            <span>分)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'fill_in_blank' && !subject.settings.unordered">(请按题目中的空缺顺序依次填写答案)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'matching'">
                (计分规则:
                <span ng-if="subject.score_rule == 'single'">按匹配正确项计分</span>
                <span ng-if="subject.score_rule == 'overall'">有匹配错误项则该题目不得分</span>)
            </span>
        </span>
    </div>
</div><ul class="media-uploads-paper" ng-init="noPopup = false">
    <li ng-repeat="upload in subject.settings.uploads | filter:uploadWithName">
        <div ng-if="upload.type == 'audio'" simditor-audio id="[[upload.id]]"
        src="[[trustSrc('/api/uploads/' + upload.id + '/in-rich-content?file_key=' + upload.key )]]" name="[[upload.name]]"></div>
        <div ng-if="upload.type === 'video'" exam-video-player upload="upload" no-popup="noPopup"  resolutions="{'ORIGINAL':'原画', 'HD': '1080p', 'VGA': '720p', 'QVGA': '480p'}"
        default-resolution="'HD'"  lang='zh-CN'
         settings="subject.settings"
        >
        </div>

        <div ng-if="upload.enable_origin_text && (canViewCorrectAnswer || canViewAnswerForClassroom || canViewAnswerExplanation)">
            <div class="show-text">
            原文/译文
            <label class="switch">
                <input type="checkbox" class="switch-input" ng-model="upload.show_text"/>
                <span class="switch-label" data-on="" data-off=""></span>
                <span class="switch-handle"></span>
            </label>
            </div>

            <span ng-show="upload.show_text" class="pre-wrap subject-description simditor-viewer origin-text mb-3"
            ng-compile-html="upload.text | sanitizeHtml" mathjax>
            </span>
        </div>
    </li>
</ul>
<div class="subject-body">
    <div class="subject-answers">
        <ol>
            <li ng-form="answers" class="answer" ng-repeat="answer in subject.answers">
                <span ng-if="subject.answers.length > 1">
                    <span class="sort circle-number" ng-bind-html="$index+1"></span>
                </span>
                <input class="content" type="text" ng-model="answer.content" ng-change="onChangeSubmission(subject)" format-validated />
            </li>
        </ol>
    </div>
</div></div>
<div ng-if="subject.type == 'text'">
    <div class="subject-head">
        <div class="summary-title">
            <span class="pre-wrap subject-description simditor-viewer"
                ng-compile-html="subject.description || '暂无题目描述' | sanitizeHtml" mathjax>
            </span>
        </div>
    </div>
</div>
<div ng-if="subject.type == 'short_answer'">
<div class="subject-head" ng-attr-id="[[subject.id]]">
    <div class="summary-title" ng-class="{'required': subject.settings.required}">
<div class="subject-resort-index" ng-hide="ui.editSubjectPage">
    <span ng-if="!subject.parent_id || subject.data.is_random_subject">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>
    <span ng-if="subject.parent_id  && !subject.data.is_random_subject">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>


<div class="subject-resort-index" ng-if="ui.editSubjectPage">
    <span ng-if="!subject.parent_id">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type == 'random'">
        <span ng-bind="getSubjectIndex(parentSubject, $index)"></span>-<span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type != 'random'">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>        <span ng-compile-html="subject.displayedDescription || subject.description | sanitizeHtml"
              class="pre-wrap subject-description simditor-viewer" mathjax></span>
        <span class="require-info" ng-if="subject.settings.required">（必填）</span>
            <span class="random-info" ng-if="subject.data.is_random_subject">随机</span>
        <span class="prompt-message alert" ng-if="subject.updated">题目内容已更新,请重新作答</span>
        <span class="prompt-message alert-required" ng-if="subject.settings.required && subject.not_answered">
            &nbsp;&nbsp;未填写&nbsp;&nbsp;
        </span>
        <span ng-if="subject.unsaved" class="answer-unsaved-reminder">未保存</span>
    </div>
    <div class="summary-sub-title">
        <span ng-bind="subjectTypeMap[subject.type]"></span>
        <span ng-if="!questionnaire">
            (<span ng-bind="subject.getPoint()"></span>
            <span>分)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'fill_in_blank' && !subject.settings.unordered">(请按题目中的空缺顺序依次填写答案)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'matching'">
                (计分规则:
                <span ng-if="subject.score_rule == 'single'">按匹配正确项计分</span>
                <span ng-if="subject.score_rule == 'overall'">有匹配错误项则该题目不得分</span>)
            </span>
        </span>
    </div>
</div>
<div class="subject-body short-answer">
    <div class="answer-content" ng-init="subject.isFocus = false;">
        <div class="answer-area-container" ng-class="{'is-focus': subject.isFocus}">
            <textarea ng-model="subject.answered_content" ng-change="onChangeSubmission(subject)" ng-trim="false"
                      class="short-answer-take"
                      bind-model="subject"
                      rows="5"
                      clean-font-size-paste
                      sim-editor sim-toolbar="code">
            </textarea>
        </div>
        <div class="left add-attachments" ng-if="!questionnaire && !classroom">
            <span>附件</span>
            <a class="button add-attachment-btn" ng-click="openFileSelectPopup(subject)"
               on-file-selected="addAttachments">
                <i class="font font-file-image"></i>
                <span>上传</span>
            </a>
        </div>
    </div>

    <div class="short-answer-upload-list" ng-init="uploads = (ui.get_subject_attachments && ui.get_subject_attachments(subject)) || subject.attachments" refresh-on="subject.attachments">
<div class="attachments-wrapper" ng-if="uploads.length" stop-propagation check-upload-status>

<div class="attachment-header clearfix">
    <div class="attachment-column column" ng-class="{'large-11': true, 'large-15': !true}">
        附件名
    </div>
    <div class="attachment-column column" ng-if="ui.videoType !=='sobey'"
        ng-class="{'large-7': true, 'large-10': !true}">
        大小
    </div>
        <div ng-if="airHelper.canShowAttachmentQuestion(activity) === true" class="attachment-column column large-2">题目</div>
    <div class="attachment-column column large-3">&nbsp;</div>
</div>    <div class="attachment-body">
        <div ng-repeat="upload in uploads">
    <div class="attachment-row preview-able clearfix" ng-if="canPreview(upload) && !upload.deleted && canShowResource(upload, isInstructorView)"
             previewer="{uploads: uploads, currentFile: upload, activity: exam, isAttachment: isAttachment}" reveal-modal="file-previewer" ng-click="downloadBlob(exam, upload, 'view')">



    <div class="attachment-column column large-10" ng-if="upload.type != 'slide'" ng-class="{'large-20':upload.source === 'sobey'}">
        <div ng-if="upload.source == 'auto-generated-pdf'">
            <svg class="file-text-content left">
                <use xlink:href="#file-text-content"></use>
            </svg>
            <span class="file-name-wrapper truncate-text left">
                <span class="file-name" tipsy-literal="[[ upload.name.split('.')[0] ]]">[[ upload.name.split('.')[0] ]]</span>
            </span>
        </div>
        <div ng-if="upload.source !== 'auto-generated-pdf'" class="w-full flex">
            <i class="font font-file-[[fileTypeByExtension(upload)]] left"></i>
            <span class="file-name-wrapper truncate-text left">
                <span class="file-name" tipsy-literal="[[ upload.name ]]" ng-bind="upload.name|fileName"></span>
            </span>
            <span class="file-extension left" ng-bind="upload.name|fileExtension"></span>
        </div>
    </div>
    <div class="attachment-column column large-10" ng-if="upload.type == 'slide'">
        <i class="font font-slide left"></i>
        <span class="file-name-wrapper truncate-text left">
            <span class="file-name" tipsy-literal="[[ upload.title ]]" ng-bind="upload.title|fileName"></span>
        </span>
    </div>
        <div class="attachment-column column attachment-state" ng-if="!upload.deleted && upload.source !== 'sobey'"
            ng-class="{'large-1': true, 'large-5': !true}">
        <span ng-if="!upload.status || upload.status === 'ready' || (upload.status === 'processing' && (upload.type === 'video' || upload.videos)) || upload.status === 'none' || upload.deleted || wpsPreview(upload)">&nbsp;</span>
        <span ng-if="(upload.status === 'failed' || uploadsStatus[upload.id] === 'failed') && !upload.deleted">&nbsp;</span>
        <span ng-if="(upload.status === 'processing' || uploadsStatus[upload.id] === 'processing') && (upload.type != 'video' || !upload.videos) && !upload.deleted && !wpsPreview(upload)">&nbsp;</span>
    </div>
    <div class="attachment-column column attachment-deleted large-5" ng-if="upload.deleted">
        <span>文件已删除</span>
    </div>
    <div class="attachment-column column attachment-size attachment-marked"
         ng-class="{'large-7': true, 'large-10': !true}"
         ng-init="isUploadFailed = (upload.status || uploadsStatus[upload.id]) == 'failed';
                  isUploadProcessing = (upload.status || uploadsStatus[upload.id]) == 'processing';
                  isNotVideo = upload.type != 'video' || !upload.videos;
                  showFileSize = !isUploadFailed && !isUploadProcessing && upload.size >= 0">
        <span ng-if="upload.source == 'LARK'" style="height: 1px;">——</span>
        <span ng-if="upload.source != 'LARK' && showFileSize" ng-bind="upload.size|humanizeBytes"></span>
        <span ng-if="upload.source != 'LARK' && !showFileSize && !upload.deleted">
            <span ng-if="isUploadFailed" class="attachment-state-failed">
                    转码失败
            </span>
            <span ng-if="isUploadProcessing && isNotVideo && !wpsPreview(upload)" class="attachment-state-processing">
                    正在转码中
            </span>
        </span>
        <div ng-if="upload.type=='scorm' && upload.scorm">
            教材大小:<span ng-bind="upload.scorm.files_size|humanizeBytes"></span>
        </div>
        <div ng-if="upload.type=='slide' && upload.duration">
            时长:<span ng-bind="upload.duration | formatTime"></span>
        </div>
    </div>



        <div ng-if="airHelper.canShowAttachmentQuestion(activity) === true" class="attachment-column column large-2">
            <span class="aiQuiz-content">
                [[upload.aiQuiz.subjectsCount || "--"]]
            </span>
        </div>

    <div class="attachment-column column"
         ng-class="{'large-7': true, 'large-5': !true}">
<span class="attachment-operations">
        <div class="horizon">



            <a stop-propagation previewer="{uploads: uploads, currentFile: upload, activity: exam, isAttachment: isAttachment}" reveal-modal="file-previewer"
                tipsy-literal="预览" ng-click="downloadBlob(exam, upload, 'view')"
                ng-if="canPreview(upload) && !upload.deleted && canShowResource(upload, isInstructorView)">
                <i class="font font-table-edit-view-2"></i>
            </a>
        <a ng-click="openSobeyVideo()" ng-if="upload.source==='sobey'">
            <i class="font font-table-edit-view-2"></i>
        </a>
        <a stop-propagation ng-click="deleteFile(upload, subject)" tipsy-literal="删除" ng-hide="['auditing', 'agree'].includes(upload.audit_status)" ng-class="{'delete-btn-disabled': upload.viewCount > 0}">
            <i class="font font-delete"></i>
            <span class="dropdown-item dropdown-item-hide">删除</span>
        </a>
        </div>
</span>    </div>

</div>

<div class="attachment-row clearfix" ng-if="!canPreview(upload) || upload.deleted || !canShowResource(upload, isInstructorView)" ng-click="downloadWeDrive(upload)">


    <div class="attachment-column column large-10" ng-if="upload.type != 'slide'" ng-class="{'large-20':upload.source === 'sobey'}">
        <div ng-if="upload.source == 'auto-generated-pdf'">
            <svg class="file-text-content left">
                <use xlink:href="#file-text-content"></use>
            </svg>
            <span class="file-name-wrapper truncate-text left">
                <span class="file-name" tipsy-literal="[[ upload.name.split('.')[0] ]]">[[ upload.name.split('.')[0] ]]</span>
            </span>
        </div>
        <div ng-if="upload.source !== 'auto-generated-pdf'" class="w-full flex">
            <i class="font font-file-[[fileTypeByExtension(upload)]] left"></i>
            <span class="file-name-wrapper truncate-text left">
                <span class="file-name" tipsy-literal="[[ upload.name ]]" ng-bind="upload.name|fileName"></span>
            </span>
            <span class="file-extension left" ng-bind="upload.name|fileExtension"></span>
        </div>
    </div>
    <div class="attachment-column column large-10" ng-if="upload.type == 'slide'">
        <i class="font font-slide left"></i>
        <span class="file-name-wrapper truncate-text left">
            <span class="file-name" tipsy-literal="[[ upload.title ]]" ng-bind="upload.title|fileName"></span>
        </span>
    </div>
        <div class="attachment-column column attachment-state" ng-if="!upload.deleted && upload.source !== 'sobey'"
            ng-class="{'large-1': true, 'large-5': !true}">
        <span ng-if="!upload.status || upload.status === 'ready' || (upload.status === 'processing' && (upload.type === 'video' || upload.videos)) || upload.status === 'none' || upload.deleted || wpsPreview(upload)">&nbsp;</span>
        <span ng-if="(upload.status === 'failed' || uploadsStatus[upload.id] === 'failed') && !upload.deleted">&nbsp;</span>
        <span ng-if="(upload.status === 'processing' || uploadsStatus[upload.id] === 'processing') && (upload.type != 'video' || !upload.videos) && !upload.deleted && !wpsPreview(upload)">&nbsp;</span>
    </div>
    <div class="attachment-column column attachment-deleted large-5" ng-if="upload.deleted">
        <span>文件已删除</span>
    </div>
    <div class="attachment-column column attachment-size attachment-marked"
         ng-class="{'large-7': true, 'large-10': !true}"
         ng-init="isUploadFailed = (upload.status || uploadsStatus[upload.id]) == 'failed';
                  isUploadProcessing = (upload.status || uploadsStatus[upload.id]) == 'processing';
                  isNotVideo = upload.type != 'video' || !upload.videos;
                  showFileSize = !isUploadFailed && !isUploadProcessing && upload.size >= 0">
        <span ng-if="upload.source == 'LARK'" style="height: 1px;">——</span>
        <span ng-if="upload.source != 'LARK' && showFileSize" ng-bind="upload.size|humanizeBytes"></span>
        <span ng-if="upload.source != 'LARK' && !showFileSize && !upload.deleted">
            <span ng-if="isUploadFailed" class="attachment-state-failed">
                    转码失败
            </span>
            <span ng-if="isUploadProcessing && isNotVideo && !wpsPreview(upload)" class="attachment-state-processing">
                    正在转码中
            </span>
        </span>
        <div ng-if="upload.type=='scorm' && upload.scorm">
            教材大小:<span ng-bind="upload.scorm.files_size|humanizeBytes"></span>
        </div>
        <div ng-if="upload.type=='slide' && upload.duration">
            时长:<span ng-bind="upload.duration | formatTime"></span>
        </div>
    </div>



        <div ng-if="airHelper.canShowAttachmentQuestion(activity) === true" class="attachment-column column large-2">
            <span class="aiQuiz-content">
                [[upload.aiQuiz.subjectsCount || "--"]]
            </span>
        </div>

    <div class="attachment-column column"
         ng-class="{'large-7': true, 'large-5': !true}">
<span class="attachment-operations">
        <div class="horizon">



            <a stop-propagation previewer="{uploads: uploads, currentFile: upload, activity: exam, isAttachment: isAttachment}" reveal-modal="file-previewer"
                tipsy-literal="预览" ng-click="downloadBlob(exam, upload, 'view')"
                ng-if="canPreview(upload) && !upload.deleted && canShowResource(upload, isInstructorView)">
                <i class="font font-table-edit-view-2"></i>
            </a>
        <a ng-click="openSobeyVideo()" ng-if="upload.source==='sobey'">
            <i class="font font-table-edit-view-2"></i>
        </a>
        <a stop-propagation ng-click="deleteFile(upload, subject)" tipsy-literal="删除" ng-hide="['auditing', 'agree'].includes(upload.audit_status)" ng-class="{'delete-btn-disabled': upload.viewCount > 0}">
            <i class="font font-delete"></i>
            <span class="dropdown-item dropdown-item-hide">删除</span>
        </a>
        </div>
</span>    </div>

</div>        </div>
    </div>
</div>    </div>

</div></div>
<div ng-if="subject.type == 'cloze'">
<div class="subject-head" ng-attr-id="[[subject.id]]">
    <div class="summary-title" ng-class="{'required': subject.settings.required}">
<div class="subject-resort-index" ng-hide="ui.editSubjectPage">
    <span ng-if="!subject.parent_id || subject.data.is_random_subject">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>
    <span ng-if="subject.parent_id  && !subject.data.is_random_subject">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>


<div class="subject-resort-index" ng-if="ui.editSubjectPage">
    <span ng-if="!subject.parent_id">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type == 'random'">
        <span ng-bind="getSubjectIndex(parentSubject, $index)"></span>-<span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type != 'random'">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>        <span ng-compile-html="subject.displayedDescription || subject.description | sanitizeHtml"
              class="pre-wrap subject-description simditor-viewer" mathjax></span>
        <span class="require-info" ng-if="subject.settings.required">（必填）</span>
            <span class="random-info" ng-if="subject.data.is_random_subject">随机</span>
        <span class="prompt-message alert" ng-if="subject.updated">题目内容已更新,请重新作答</span>
        <span class="prompt-message alert-required" ng-if="subject.settings.required && subject.not_answered">
            &nbsp;&nbsp;未填写&nbsp;&nbsp;
        </span>
        <span ng-if="subject.unsaved" class="answer-unsaved-reminder">未保存</span>
    </div>
    <div class="summary-sub-title">
        <span ng-bind="subjectTypeMap[subject.type]"></span>
        <span ng-if="!questionnaire">
            (<span ng-bind="subject.getPoint()"></span>
            <span>分)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'fill_in_blank' && !subject.settings.unordered">(请按题目中的空缺顺序依次填写答案)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'matching'">
                (计分规则:
                <span ng-if="subject.score_rule == 'single'">按匹配正确项计分</span>
                <span ng-if="subject.score_rule == 'overall'">有匹配错误项则该题目不得分</span>)
            </span>
        </span>
    </div>
</div></div>
<div ng-if="subject.type === 'matching'">
<div class="subject-head" ng-attr-id="[[subject.id]]">
    <div class="summary-title" ng-class="{'required': subject.settings.required}">
<div class="subject-resort-index" ng-hide="ui.editSubjectPage">
    <span ng-if="!subject.parent_id || subject.data.is_random_subject">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>
    <span ng-if="subject.parent_id  && !subject.data.is_random_subject">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>


<div class="subject-resort-index" ng-if="ui.editSubjectPage">
    <span ng-if="!subject.parent_id">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type == 'random'">
        <span ng-bind="getSubjectIndex(parentSubject, $index)"></span>-<span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type != 'random'">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>        <span ng-compile-html="subject.displayedDescription || subject.description | sanitizeHtml"
              class="pre-wrap subject-description simditor-viewer" mathjax></span>
        <span class="require-info" ng-if="subject.settings.required">（必填）</span>
            <span class="random-info" ng-if="subject.data.is_random_subject">随机</span>
        <span class="prompt-message alert" ng-if="subject.updated">题目内容已更新,请重新作答</span>
        <span class="prompt-message alert-required" ng-if="subject.settings.required && subject.not_answered">
            &nbsp;&nbsp;未填写&nbsp;&nbsp;
        </span>
        <span ng-if="subject.unsaved" class="answer-unsaved-reminder">未保存</span>
    </div>
    <div class="summary-sub-title">
        <span ng-bind="subjectTypeMap[subject.type]"></span>
        <span ng-if="!questionnaire">
            (<span ng-bind="subject.getPoint()"></span>
            <span>分)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'fill_in_blank' && !subject.settings.unordered">(请按题目中的空缺顺序依次填写答案)</span>
            <span class="sub-title-hint" ng-if="subject.type == 'matching'">
                (计分规则:
                <span ng-if="subject.score_rule == 'single'">按匹配正确项计分</span>
                <span ng-if="subject.score_rule == 'overall'">有匹配错误项则该题目不得分</span>)
            </span>
        </span>
    </div>
</div>
<div class="subject-body">
    <div class="subject-answers">
        <div class="matching-answer-box">
            <ul>
                <li>
                    <div class="list-panel panel-desc">提示</div>
                    <div class="line"></div>
                    <div class="list-panel panel-desc">请从右侧拖入合适的答案</div>
                </li>
                <li ng-repeat="subSubject in subject.sub_subjects">
                    <div class="list-panel" ng-init="vueParam={subjectDescription: subSubject.description}">
                        <div vue-wrapper>
                            <match-subject-info :content="subjectDescription" class="desc"></match-subject-info>
                        </div>
                    </div>
                    <div class="line"><span></span></div>
                    <div class="list-panel option"
                        ng-class="{'option-fill' : subSubject.answer_number > 0}"
                        drag-cloneable="matching-dragable" drag-type="to"
                        drag-options="subject" drag-callback="dragAddCallback(subject)" ng-style="{height: subSubject.defaultStyle}">
                        <div class="clone-area drag-area" data-drag-node-id="[[subSubject.answer_number]]" ng-if="subSubject.note">
                            <div class="content-wrapper" ng-init="vueParam={subjectNote: subSubject.note.content}">
                                <div class="icon icon-drag"><i class="font font-activity-drag"></i></div>
                                <div vue-wrapper>
                                    <match-subject-info :content="subjectNote"></match-subject-info>
                                </div>
                            </div>
                        </div>
                    </div>
                </li>
            </ul>
            <div class="answer-pool">
                <div class="head panel-desc">答案池</div>
                <div id="cloneable-source" class="pool" drag-cloneable="matching-dragable" drag-type="from"
                    drag-options="subject" drag-callback="dragAddCallback(subject)">
                    <div class="clone-area drag-area" data-drag-node-id="[[answer.id]]" ng-repeat="answer in subject.options">
                        <div class="content-wrapper" ng-init="vueParam={subjectAnswer: answer.content}">
                            <div class="icon icon-drag"><i class="font font-activity-drag"></i></div>
                            <div vue-wrapper>
                                <match-subject-info :content="subjectAnswer"></match-subject-info>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="drag-trash-[[subject.id]]" class="cloneable-trash">
                    <div class="trash-area" drag-cloneable="matching-dragable" drag-type="trash"
                    drag-options="subject" drag-callback="dragAddCallback(subject)"></div>
                    <i class="font font-move-trash"></i>
                </div>
            </div>
        </div>
    </div>
</div></div>
<div class="paragraph-desc" ng-if="subject.type === 'paragraph_desc'">
    <div class="summary-title mb-4">
        <span class="pre-wrap subject-description simditor-viewer"
            ng-compile-html="subject.description || '暂无题目描述' | sanitizeHtml" mathjax>
        </span>
    </div>
<ul class="media-uploads-paper" ng-init="noPopup = false">
    <li ng-repeat="upload in subject.settings.uploads | filter:uploadWithName">
        <div ng-if="upload.type == 'audio'" simditor-audio id="[[upload.id]]"
        src="[[trustSrc('/api/uploads/' + upload.id + '/in-rich-content?file_key=' + upload.key )]]" name="[[upload.name]]"></div>
        <div ng-if="upload.type === 'video'" exam-video-player upload="upload" no-popup="noPopup"  resolutions="{'ORIGINAL':'原画', 'HD': '1080p', 'VGA': '720p', 'QVGA': '480p'}"
        default-resolution="'HD'"  lang='zh-CN'
         settings="subject.settings"
        >
        </div>

        <div ng-if="upload.enable_origin_text && (canViewCorrectAnswer || canViewAnswerForClassroom || canViewAnswerExplanation)">
            <div class="show-text">
            原文/译文
            <label class="switch">
                <input type="checkbox" class="switch-input" ng-model="upload.show_text"/>
                <span class="switch-label" data-on="" data-off=""></span>
                <span class="switch-handle"></span>
            </label>
            </div>

            <span ng-show="upload.show_text" class="pre-wrap subject-description simditor-viewer origin-text mb-3"
            ng-compile-html="upload.text | sanitizeHtml" mathjax>
            </span>
        </div>
    </li>
</ul></div>            </li>
        </div>
        <i class="font font-close" ng-click="closeForReplay()"></i>
        <div class="operations interaction-operations">
            <a class="button button-green medium" ng-click="submit()">提交</a>
        </div>
    </div>
</div><div class="subjects-jit-display" ng-if="ui.shouldShowAnswerAtTheCurrentTime">
<div class="exam-paper exam-result"
     ng-init="subjectTypeMap={'single_selection': '单选题', 'multiple_selection': '多选题', 'true_or_false': '判断题'}; isInteraction=true">
    <div class="paper-content">
        <div class="exam-subjects">
            <ol class="subjects-jit-display">
                <li class="subject" ng-repeat="subject in subjectsForCurrentTime" ng-class="subject.type">
                    <div style="display:none;">[[
                        isCorrect = subject.answerState == 1;
                    ]]</div>
<div style="display:none;">[[
    isInstructorViewAndNotSimulatedSubmission = isInstructorView && !submissionData.isSimulated;
    canViewAnswerState = isInstructorViewAndNotSimulatedSubmission || exam.is_announce_answer_time_passed || isInteraction;
    canViewAnswerForInteraction = isInteraction && (isCorrect || activity && !activity.interaction_activity_attributes.repeat_answer);
    canViewAnswerExplanation = ((isInstructorViewAndNotSimulatedSubmission || exam.is_announce_answer_time_passed) && !isInteraction ) || isInteraction;
    canViewCorrectAnswer = ((isInstructorViewAndNotSimulatedSubmission || !!(exam.is_announce_answer_time_passed && exam.announce_answer_type == 'answer_and_explanation')) && !isInteraction) || canViewAnswerForInteraction;
    canViewAnswerForClassroom = classroom && classroom.is_answer_announced;
    canGiveScore = allowExamScoreMark && !submissionData.isSimulated;
]]</div>
<div ng-if="subject.isObjective()">
<div class="subject-head" ng-init="answerState = getSubjectAnswerState(subject, submissionScoreData)" ng-attr-id="[[subject.id]]">
    <div class="summary-title" ng-class="{'required': subject.settings.required}">
<div class="subject-resort-index" ng-hide="ui.editSubjectPage">
    <span ng-if="!subject.parent_id || subject.data.is_random_subject">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>
    <span ng-if="subject.parent_id  && !subject.data.is_random_subject">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>


<div class="subject-resort-index" ng-if="ui.editSubjectPage">
    <span ng-if="!subject.parent_id">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type == 'random'">
        <span ng-bind="getSubjectIndex(parentSubject, $index)"></span>-<span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type != 'random'">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>        <span ng-compile-html="subject.displayedDescription || subject.description || '暂无题目描述' | sanitizeHtml"
            class="pre-wrap subject-description simditor-viewer" mathjax></span>
        <span class="answer-error"
              ng-if="!questionnaire && (canViewAnswerState || canViewAnswerForClassroom)">
            <span ng-if="answerState == -1" class="answer-message tc-tag error">此题未答</span>
            <span ng-if="answerState == 0" class="answer-message tc-tag error">回答错误</span>
            <span ng-if="answerState == 2" class="tc-tag info">部分答对</span>
        </span>
    </div>
    <div class="summary-sub-title">
        <span class="subject-point">
            <span ng-bind="subjectTypeMap[subject.type]"></span>
            <span ng-if="subject.score >= 0 && subject.score !== null && !questionnaire">
                (<span ng-bind="subject.getPoint()"></span>
                <span>分</span>)

                <span class="actual-score" ng-if="(isInstructorView || exam.is_announce_score_time_passed)"
                    ng-init="subject.score_copy = subject.score">
                    <span ng-if="subject.type == 'fill_in_blank' && exam">
                        <span ng-if="canGiveScore"  ng-show="subject.showEdit">
                            <input ng-attr-id="[['input-' + subject.id]]" class="auto-width" name="score"
                                ng-disabled="course.score_published || !canShowOperations(exam)" ng-change="removeError(subject)"
                                esc-press="subject.score_copy" ng-on-change="editScore(subject)"
                                ng-blur="resetSubject(subject)" ng-model="subject.score" maxlength="4" server-validated
                                float-precision="1">
                            </input>
                        </span>
                        <span ng-show="!subject.showEdit">
                            <span ng-bind="subject.score"></span>
                            <span>分</span>
                            <a ng-if="canGiveScore" ng-click="edit(subject)"><i class="font font-edit"></i></a>
                        </span>
                    </span>
                    <span ng-if="subject.type != 'fill_in_blank' || !exam">[[subject.getScore()]]分</span>
                </span>
            </span>
            <span ng-if="!subject.score && subject.score != 0 && !questionnaire">
                (<span ng-bind="subject.getPoint()"></span>
                <span>分</span>)
            </span>
            <span class="sub-title-hint" ng-if="subject.type == 'matching'">
                <span ng-if="subject.score_rule == 'single'">(计分规则:按匹配正确项计分)</span>
                <span ng-if="subject.score_rule == 'overall'">(计分规则:有匹配错误项则该题目不得分)</span>
            </span>
            <span ng-if="isInstructorView && !questionnaire">
<span ng-if="!isQuestionnaire">（难易度:
    <span ng-if="subject.difficulty_level=='none'">中）</span>
    <span ng-if="subject.difficulty_level=='hard'">难）</span>
    <span ng-if="subject.difficulty_level=='medium'">中）</span>
    <span ng-if="subject.difficulty_level=='easy'">易）</span>
</span>            </span>
            <span class="sub-title-hint"
                ng-if="subject.type == 'fill_in_blank' && !allowExamEdit">(请按题目中的空缺顺序依次填写答案)</span>
            <span ng-if="subject.type == 'fill_in_blank' && allowExamEdit" class="error score-error ng-binding"
                ng-style="{'display': 'inline-block'}" ng-bind="subject.error || ''"></span>
        </span>
    </div>
</div><ul class="media-uploads-paper" ng-init="noPopup = false">
    <li ng-repeat="upload in subject.settings.uploads | filter:uploadWithName">
        <div ng-if="upload.type == 'audio'" simditor-audio id="[[upload.id]]"
        src="[[trustSrc('/api/uploads/' + upload.id + '/in-rich-content?file_key=' + upload.key )]]" name="[[upload.name]]"></div>
        <div ng-if="upload.type === 'video'" exam-video-player upload="upload" no-popup="noPopup"  resolutions="{'ORIGINAL':'原画', 'HD': '1080p', 'VGA': '720p', 'QVGA': '480p'}"
        default-resolution="'HD'"  lang='zh-CN'
         settings="subject.settings"
        >
        </div>

        <div ng-if="upload.enable_origin_text && (canViewCorrectAnswer || canViewAnswerForClassroom || canViewAnswerExplanation)">
            <div class="show-text">
            原文/译文
            <label class="switch">
                <input type="checkbox" class="switch-input" ng-model="upload.show_text"/>
                <span class="switch-label" data-on="" data-off=""></span>
                <span class="switch-handle"></span>
            </label>
            </div>

            <span ng-show="upload.show_text" class="pre-wrap subject-description simditor-viewer origin-text mb-3"
            ng-compile-html="upload.text | sanitizeHtml" mathjax>
            </span>
        </div>
    </li>
</ul>
<div class="subject-body">
    <ol class="subject-options">
        <li class="option"
            ng-class="subject.settings.options_layout"
            ng-style="{width: ui.calcOptionWidth(subject.options, subject.settings.options_layout)}"
            ng-repeat="option in subject.options | orderBy: 'sort'">
            <label>
                <span class="left">
                    <input ng-if="subject.type=='single_selection' || subject.type=='true_or_false'"
                           type="radio" ng-checked="option.isChosen"
                           ng-disabled="true"/>
                    <input ng-if="subject.type=='multiple_selection'"
                           type="checkbox" ng-checked="option.isChosen"
                           ng-disabled="true"/>
                    <span class="option-index" ng-bind="ui.intToChar($index)"></span><span>.</span>
                </span>
                <div class="option-content">
                    <span ng-compile-html="option.content | sanitizeHtml"
                          class="pre-wrap simditor-viewer" mathjax></span>
                </div>
            </label>
        </li>
    </ol>
    <div class="subject-message"
        ng-if="!questionnaire && (canViewCorrectAnswer || canViewAnswerForClassroom || canViewAnswerExplanation && (subject.answer_explanation || subject.wrong_explanation))">
        <div class="note" ng-if="isInstructorViewAndNotSimulatedSubmission && subject.settings.show_note">
            <span>备注:&nbsp</span>
            <span ng-bind="subject.note"></span>
        </div>
        <div class="answer-options" ng-class="{'answer-only':isAnswerOnly(subject)}"
             ng-if="canViewCorrectAnswer || canViewAnswerForClassroom">
            <span>正确答案:</span>
            <span ng-bind="ui.getCorrectOptions(subject)"></span>
        </div>
        <div class="explanation" ng-if="canViewAnswerExplanation && subject.answer_explanation && answerState != 0">
            <div class="explanation-label">答案解释:</div>
            <span class="simditor-viewer" ng-compile-html="subject.answer_explanation | sanitizeHtml" mathjax></span>
        </div>
        <div class="explanation" ng-if="canViewAnswerExplanation && subject.wrong_explanation && answerState == 0">
            <div class="explanation-label">答案解释:</div>
            <span class="simditor-viewer" ng-compile-html="subject.wrong_explanation | sanitizeHtml" mathjax></span>
        </div>
    <div class="knowledge-node" ng-if="subject.knowledgeNodes">
        <div class="knowledge-node-label">知识点:</div>
        <div class="node-list">
            <div ng-repeat="node_reference in subject.knowledgeNodes">
                <knowledge-node-tag
                    ng-prop-course_id="node_reference.course_id"
                    ng-prop-node_id="node_reference.knowledge_node.id"
                    ng-prop-content="node_reference.knowledge_node.name"
                    ng-prop-go_to_graph="true"
                    size="medium"
                >
                </knowledge-node-tag>
            </div>
        </div>
    </div>
    </div>
</div></div>
<div ng-if="subject.type == 'fill_in_blank'">
<div class="subject-head" ng-init="answerState = getSubjectAnswerState(subject, submissionScoreData)" ng-attr-id="[[subject.id]]">
    <div class="summary-title" ng-class="{'required': subject.settings.required}">
<div class="subject-resort-index" ng-hide="ui.editSubjectPage">
    <span ng-if="!subject.parent_id || subject.data.is_random_subject">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>
    <span ng-if="subject.parent_id  && !subject.data.is_random_subject">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>


<div class="subject-resort-index" ng-if="ui.editSubjectPage">
    <span ng-if="!subject.parent_id">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type == 'random'">
        <span ng-bind="getSubjectIndex(parentSubject, $index)"></span>-<span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type != 'random'">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>        <span ng-compile-html="subject.displayedDescription || subject.description || '暂无题目描述' | sanitizeHtml"
            class="pre-wrap subject-description simditor-viewer" mathjax></span>
        <span class="answer-error"
              ng-if="!questionnaire && (canViewAnswerState || canViewAnswerForClassroom)">
            <span ng-if="answerState == -1" class="answer-message tc-tag error">此题未答</span>
            <span ng-if="answerState == 0" class="answer-message tc-tag error">回答错误</span>
            <span ng-if="answerState == 2" class="tc-tag info">部分答对</span>
        </span>
    </div>
    <div class="summary-sub-title">
        <span class="subject-point">
            <span ng-bind="subjectTypeMap[subject.type]"></span>
            <span ng-if="subject.score >= 0 && subject.score !== null && !questionnaire">
                (<span ng-bind="subject.getPoint()"></span>
                <span>分</span>)

                <span class="actual-score" ng-if="(isInstructorView || exam.is_announce_score_time_passed)"
                    ng-init="subject.score_copy = subject.score">
                    <span ng-if="subject.type == 'fill_in_blank' && exam">
                        <span ng-if="canGiveScore"  ng-show="subject.showEdit">
                            <input ng-attr-id="[['input-' + subject.id]]" class="auto-width" name="score"
                                ng-disabled="course.score_published || !canShowOperations(exam)" ng-change="removeError(subject)"
                                esc-press="subject.score_copy" ng-on-change="editScore(subject)"
                                ng-blur="resetSubject(subject)" ng-model="subject.score" maxlength="4" server-validated
                                float-precision="1">
                            </input>
                        </span>
                        <span ng-show="!subject.showEdit">
                            <span ng-bind="subject.score"></span>
                            <span>分</span>
                            <a ng-if="canGiveScore" ng-click="edit(subject)"><i class="font font-edit"></i></a>
                        </span>
                    </span>
                    <span ng-if="subject.type != 'fill_in_blank' || !exam">[[subject.getScore()]]分</span>
                </span>
            </span>
            <span ng-if="!subject.score && subject.score != 0 && !questionnaire">
                (<span ng-bind="subject.getPoint()"></span>
                <span>分</span>)
            </span>
            <span class="sub-title-hint" ng-if="subject.type == 'matching'">
                <span ng-if="subject.score_rule == 'single'">(计分规则:按匹配正确项计分)</span>
                <span ng-if="subject.score_rule == 'overall'">(计分规则:有匹配错误项则该题目不得分)</span>
            </span>
            <span ng-if="isInstructorView && !questionnaire">
<span ng-if="!isQuestionnaire">（难易度:
    <span ng-if="subject.difficulty_level=='none'">中）</span>
    <span ng-if="subject.difficulty_level=='hard'">难）</span>
    <span ng-if="subject.difficulty_level=='medium'">中）</span>
    <span ng-if="subject.difficulty_level=='easy'">易）</span>
</span>            </span>
            <span class="sub-title-hint"
                ng-if="subject.type == 'fill_in_blank' && !allowExamEdit">(请按题目中的空缺顺序依次填写答案)</span>
            <span ng-if="subject.type == 'fill_in_blank' && allowExamEdit" class="error score-error ng-binding"
                ng-style="{'display': 'inline-block'}" ng-bind="subject.error || ''"></span>
        </span>
    </div>
</div><ul class="media-uploads-paper" ng-init="noPopup = false">
    <li ng-repeat="upload in subject.settings.uploads | filter:uploadWithName">
        <div ng-if="upload.type == 'audio'" simditor-audio id="[[upload.id]]"
        src="[[trustSrc('/api/uploads/' + upload.id + '/in-rich-content?file_key=' + upload.key )]]" name="[[upload.name]]"></div>
        <div ng-if="upload.type === 'video'" exam-video-player upload="upload" no-popup="noPopup"  resolutions="{'ORIGINAL':'原画', 'HD': '1080p', 'VGA': '720p', 'QVGA': '480p'}"
        default-resolution="'HD'"  lang='zh-CN'
         settings="subject.settings"
        >
        </div>

        <div ng-if="upload.enable_origin_text && (canViewCorrectAnswer || canViewAnswerForClassroom || canViewAnswerExplanation)">
            <div class="show-text">
            原文/译文
            <label class="switch">
                <input type="checkbox" class="switch-input" ng-model="upload.show_text"/>
                <span class="switch-label" data-on="" data-off=""></span>
                <span class="switch-handle"></span>
            </label>
            </div>

            <span ng-show="upload.show_text" class="pre-wrap subject-description simditor-viewer origin-text mb-3"
            ng-compile-html="upload.text | sanitizeHtml" mathjax>
            </span>
        </div>
    </li>
</ul>
<div class="subject-body">
  <div class="answer-content" ng-init="getSubjectAnswerState(subject, submissionScoreData)">
    <ol class="subject-answers">
      <li class="answer" ng-repeat="answer in subject.answers | orderBy: 'sort' track by $index">
        <span ng-if="subject.answers.length > 1">
          <span class="sort circle-number" ng-bind-html="$index+1"></span>
        </span>
        <textarea
          class="content"
          type="text"
          ng-model="answer.content"
          disabled="disabled"
          auto-height-textarea
          format-validated
        ></textarea>
        <div class="answer-error" ng-if="canViewAnswerState">
          <span ng-if="!answer.content" class="answer-message tc-tag error">此题未答</span>
          <span ng-if="answer.content && answer.status == -1 " class="answer-message tc-tag error">
            回答错误
          </span>
        </div>
      </li>
    </ol>
  </div>
  <div
    class="subject-message"
    ng-if="canViewCorrectAnswer || canViewAnswerForClassroom || (canViewAnswerExplanation && subject.answer_explanation)"
  >
    <div class="note" ng-if="isInstructorViewAndNotSimulatedSubmission && subject.settings.show_note">
      <span>备注:&nbsp</span>
      <span ng-bind="subject.note"></span>
    </div>
    <div
      class="answer-options"
      ng-if="canViewCorrectAnswer || canViewAnswerForClassroom"
      ng-class="{'answer-only':isAnswerOnly(subject)}"
    >
      <span>正确答案:</span>
      <div class="row collapse correct_answer" ng-repeat="correctAnswer in subject.correct_answers">
        <span class="sort circle-number" ng-bind-html="$index+1"></span>
        <ul style="display: inline-grid">
          <li><span ng-bind="correctAnswer.content | unescapeHtmlChar"></span></li>
          <li ng-repeat="alternate in correctAnswer.alternates">
            <span ng-bind="alternate.content | unescapeHtmlChar"></span>
          </li>
        </ul>
      </div>
    </div>
    <div class="explanation" ng-if="canViewAnswerExplanation && subject.answer_explanation">
      <div class="explanation-label">答案解释:</div>
      <span class="simditor-viewer" ng-compile-html="subject.answer_explanation | sanitizeHtml" mathjax></span>
    </div>
    <div class="knowledge-node" ng-if="subject.knowledgeNodes">
        <div class="knowledge-node-label">知识点:</div>
        <div class="node-list">
            <div ng-repeat="node_reference in subject.knowledgeNodes">
                <knowledge-node-tag
                    ng-prop-course_id="node_reference.course_id"
                    ng-prop-node_id="node_reference.knowledge_node.id"
                    ng-prop-content="node_reference.knowledge_node.name"
                    ng-prop-go_to_graph="true"
                    size="medium"
                >
                </knowledge-node-tag>
            </div>
        </div>
    </div>
  </div>
</div></div>
<div ng-if="subject.type == 'short_answer'">
<div class="subject-head" ng-init="answerState = getSubjectAnswerState(subject, submissionScoreData)" ng-attr-id="[[subject.id]]">
    <div class="summary-title" ng-class="{'required': subject.settings.required}">
<div class="subject-resort-index" ng-hide="ui.editSubjectPage">
    <span ng-if="!subject.parent_id || subject.data.is_random_subject">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>
    <span ng-if="subject.parent_id  && !subject.data.is_random_subject">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>


<div class="subject-resort-index" ng-if="ui.editSubjectPage">
    <span ng-if="!subject.parent_id">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type == 'random'">
        <span ng-bind="getSubjectIndex(parentSubject, $index)"></span>-<span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type != 'random'">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>        <span ng-compile-html="subject.displayedDescription || subject.description || '暂无题目描述' | sanitizeHtml"
            class="pre-wrap subject-description simditor-viewer" mathjax></span>
        <span class="answer-error"
              ng-if="!questionnaire && (canViewAnswerState || canViewAnswerForClassroom)">
            <span ng-if="answerState == -1" class="answer-message tc-tag error">此题未答</span>
            <span ng-if="answerState == 0" class="answer-message tc-tag error">回答错误</span>
            <span ng-if="answerState == 2" class="tc-tag info">部分答对</span>
        </span>
    </div>
    <div class="summary-sub-title">
        <span class="subject-point">
            <span ng-bind="subjectTypeMap[subject.type]"></span>
            <span ng-if="subject.score >= 0 && subject.score !== null && !questionnaire">
                (<span ng-bind="subject.getPoint()"></span>
                <span>分</span>)

                <span class="actual-score" ng-if="(isInstructorView || exam.is_announce_score_time_passed)"
                    ng-init="subject.score_copy = subject.score">
                    <span ng-if="subject.type == 'fill_in_blank' && exam">
                        <span ng-if="canGiveScore"  ng-show="subject.showEdit">
                            <input ng-attr-id="[['input-' + subject.id]]" class="auto-width" name="score"
                                ng-disabled="course.score_published || !canShowOperations(exam)" ng-change="removeError(subject)"
                                esc-press="subject.score_copy" ng-on-change="editScore(subject)"
                                ng-blur="resetSubject(subject)" ng-model="subject.score" maxlength="4" server-validated
                                float-precision="1">
                            </input>
                        </span>
                        <span ng-show="!subject.showEdit">
                            <span ng-bind="subject.score"></span>
                            <span>分</span>
                            <a ng-if="canGiveScore" ng-click="edit(subject)"><i class="font font-edit"></i></a>
                        </span>
                    </span>
                    <span ng-if="subject.type != 'fill_in_blank' || !exam">[[subject.getScore()]]分</span>
                </span>
            </span>
            <span ng-if="!subject.score && subject.score != 0 && !questionnaire">
                (<span ng-bind="subject.getPoint()"></span>
                <span>分</span>)
            </span>
            <span class="sub-title-hint" ng-if="subject.type == 'matching'">
                <span ng-if="subject.score_rule == 'single'">(计分规则:按匹配正确项计分)</span>
                <span ng-if="subject.score_rule == 'overall'">(计分规则:有匹配错误项则该题目不得分)</span>
            </span>
            <span ng-if="isInstructorView && !questionnaire">
<span ng-if="!isQuestionnaire">（难易度:
    <span ng-if="subject.difficulty_level=='none'">中）</span>
    <span ng-if="subject.difficulty_level=='hard'">难）</span>
    <span ng-if="subject.difficulty_level=='medium'">中）</span>
    <span ng-if="subject.difficulty_level=='easy'">易）</span>
</span>            </span>
            <span class="sub-title-hint"
                ng-if="subject.type == 'fill_in_blank' && !allowExamEdit">(请按题目中的空缺顺序依次填写答案)</span>
            <span ng-if="subject.type == 'fill_in_blank' && allowExamEdit" class="error score-error ng-binding"
                ng-style="{'display': 'inline-block'}" ng-bind="subject.error || ''"></span>
        </span>
    </div>
</div>
<div class="subject-body" ng-init="instructorCommentMaxLen=5000;">
    <div class="answer-content flex">
        <div ng-compile-html="subject.answer | sanitizeHtml"
              class="pre-wrap subject-description simditor-viewer short-answer-view" mathjax>
        </div>
        <div class="operation-bar" ng-if="subject.textPdfUpload">
            <a stop-propagation previewer="{uploads: subject.attachments, currentFile: subject.textPdfUpload, activity: activity, isAttachment: isAttachment}" reveal-modal="file-previewer" class="opt-icon"
               tipsy-literal="预览" ng-click="downloadBlob(activity, subject.textPdfUpload, 'view')"
               ng-if="subject.textPdfUpload.source != 'LARK' &&
                      canPreview(subject.textPdfUpload) &&
                      !subject.textPdfUpload.deleted &&
                      !isInstructorView">
                <i class="font font-table-edit-view"></i>
            </a>
            <!-- 针对特殊source类型 -->
            <a stop-propagation ng-href="/api/uploads/[[subject.textPdfUpload.id]]/blob" class="opt-icon"
               tipsy-literal="下载" ng-click="downloadBlob(activity, subject.textPdfUpload)"
               ng-if="subject.textPdfUpload &&
                      !subject.textPdfUpload.reference_id &&
                      !subject.textPdfUpload.deleted &&
                      subject.textPdfUpload.allow_download &&
                      ['auto-generated-pdf'].includes(subject.textPdfUpload.source) &&
                      canShowResource(subject.textPdfUpload, isInstructorView)">
                <i class="font font-table-edit-download"></i>
            </a>
        </div>
    </div>
    <div ng-init="isViewSubmission = true">
            <div class="short-answer-upload-list"
                 ng-init="uploads = subject.displayAttachments" refresh-on="subject.displayAttachments">
<div class="attachments-wrapper" ng-if="uploads.length" stop-propagation check-upload-status>

<div class="attachment-header clearfix">
    <div class="attachment-column column" ng-class="{'large-11': true, 'large-15': !true}">
        附件名
    </div>
    <div class="attachment-column column" ng-if="ui.videoType !=='sobey'"
        ng-class="{'large-7': true, 'large-10': !true}">
        大小
    </div>
        <div ng-if="airHelper.canShowAttachmentQuestion(activity) === true" class="attachment-column column large-2">题目</div>
    <div class="attachment-column column large-3">&nbsp;</div>
</div>    <div class="attachment-body">
        <div ng-repeat="upload in uploads">
        <div class="attachment-row preview-able clearfix" ng-if="canPreview(upload) && !upload.deleted && canShowResource(upload, isInstructorView)"
             previewer="{uploads: uploads, currentFile: upload, activity: activity, isAttachment: isAttachment}" reveal-modal="file-previewer" ng-click="downloadBlob(activity, upload, 'view')">



    <div class="attachment-column column large-10" ng-if="upload.type != 'slide'" ng-class="{'large-20':upload.source === 'sobey'}">
        <div ng-if="upload.source == 'auto-generated-pdf'">
            <svg class="file-text-content left">
                <use xlink:href="#file-text-content"></use>
            </svg>
            <span class="file-name-wrapper truncate-text left">
                <span class="file-name" tipsy-literal="[[ upload.name.split('.')[0] ]]">[[ upload.name.split('.')[0] ]]</span>
            </span>
        </div>
        <div ng-if="upload.source !== 'auto-generated-pdf'" class="w-full flex">
            <i class="font font-file-[[fileTypeByExtension(upload)]] left"></i>
            <span class="file-name-wrapper truncate-text left">
                <span class="file-name" tipsy-literal="[[ upload.name ]]" ng-bind="upload.name|fileName"></span>
            </span>
            <span class="file-extension left" ng-bind="upload.name|fileExtension"></span>
        </div>
    </div>
    <div class="attachment-column column large-10" ng-if="upload.type == 'slide'">
        <i class="font font-slide left"></i>
        <span class="file-name-wrapper truncate-text left">
            <span class="file-name" tipsy-literal="[[ upload.title ]]" ng-bind="upload.title|fileName"></span>
        </span>
    </div>
        <div class="attachment-column column attachment-state" ng-if="!upload.deleted && upload.source !== 'sobey'"
            ng-class="{'large-1': true, 'large-5': !true}">
        <span ng-if="!upload.status || upload.status === 'ready' || (upload.status === 'processing' && (upload.type === 'video' || upload.videos)) || upload.status === 'none' || upload.deleted || wpsPreview(upload)">&nbsp;</span>
        <span ng-if="(upload.status === 'failed' || uploadsStatus[upload.id] === 'failed') && !upload.deleted">&nbsp;</span>
        <span ng-if="(upload.status === 'processing' || uploadsStatus[upload.id] === 'processing') && (upload.type != 'video' || !upload.videos) && !upload.deleted && !wpsPreview(upload)">&nbsp;</span>
    </div>
    <div class="attachment-column column attachment-deleted large-5" ng-if="upload.deleted">
        <span>文件已删除</span>
    </div>
    <div class="attachment-column column attachment-size attachment-marked"
         ng-class="{'large-7': true, 'large-10': !true}"
         ng-init="isUploadFailed = (upload.status || uploadsStatus[upload.id]) == 'failed';
                  isUploadProcessing = (upload.status || uploadsStatus[upload.id]) == 'processing';
                  isNotVideo = upload.type != 'video' || !upload.videos;
                  showFileSize = !isUploadFailed && !isUploadProcessing && upload.size >= 0">
        <span ng-if="upload.source == 'LARK'" style="height: 1px;">——</span>
        <span ng-if="upload.source != 'LARK' && showFileSize" ng-bind="upload.size|humanizeBytes"></span>
        <span ng-if="upload.source != 'LARK' && !showFileSize && !upload.deleted">
            <span ng-if="isUploadFailed" class="attachment-state-failed">
                    转码失败
            </span>
            <span ng-if="isUploadProcessing && isNotVideo && !wpsPreview(upload)" class="attachment-state-processing">
                    正在转码中
            </span>
        </span>
        <div ng-if="upload.type=='scorm' && upload.scorm">
            教材大小:<span ng-bind="upload.scorm.files_size|humanizeBytes"></span>
        </div>
        <div ng-if="upload.type=='slide' && upload.duration">
            时长:<span ng-bind="upload.duration | formatTime"></span>
        </div>
    </div>



        <div ng-if="airHelper.canShowAttachmentQuestion(activity) === true" class="attachment-column column large-2">
            <span class="aiQuiz-content">
                [[upload.aiQuiz.subjectsCount || "--"]]
            </span>
        </div>

    <div class="attachment-column column"
         ng-class="{'large-7': true, 'large-5': !true}">
<span class="attachment-operations">
        <div class="horizon">



            <a ng-if="canCheckMarked(upload.id)" class="marked-details" ng-click="openMarkedDetail(upload)" stop-propagation>
                查看批注
            </a>
            <a target="_blank" ng-if="upload.source == 'LARK'" ng-href="[[upload.url]]" tipsy-literal="预览">
                <i class="font font-table-edit-view-2"></i>
            </a>
            <a stop-propagation previewer="{uploads: uploads, currentFile: upload, activity: activity, isAttachment: isAttachment}" reveal-modal="file-previewer"
                tipsy-literal="预览" ng-click="downloadBlob(activity, upload, 'view')"
                ng-if="upload.source != 'LARK' && canPreview(upload) && !upload.deleted && canShowResource(upload, isInstructorView) && upload.id > 0">
                <i class="font font-table-edit-view-2"></i>
            </a>
        <a ng-click="openSobeyVideo()" ng-if="upload.source==='sobey'">
            <i class="font font-table-edit-view-2"></i>
        </a>
            <a stop-propagation tipsy-literal="批改"
                ng-click="openEditor(upload.id, subject)"
                ng-if="canEditByPdfEditor(upload) && subject && isInstructorView && !progressUi.inPreview">
                <i class="font font-edit"></i>
                <span class="dropdown-item">批改</span>
            </a>
                <a stop-propagation ng-href="/api/uploads/reference/[[upload.reference_id]]/blob" target="_blank"
                    tipsy-literal="下载" ng-click="downloadBlob(activity, upload)"
                    ng-if="upload.reference_id && !upload.deleted && upload.allow_download && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
                <a stop-propagation ng-href="/api/uploads/[[upload.id]]/blob?preview=true&activity_type=[[activity.type]]" target="_blank"
                    tipsy-literal="下载" ng-click="downloadBlob(activity, upload)"
                    ng-if="!upload.reference_id && !upload.deleted && upload.allow_download && !upload.source && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
                <a stop-propagation ng-href="[[upload.url]]/download" target="_blank"
                    tipsy-literal="下载" ng-click="downloadBlob(activity, upload)"
                    ng-if="upload.source && !['LARK', 'auto-generated-pdf', 'WEDRIVE'].includes(upload.source) && !upload.reference_id && !upload.deleted && upload.allow_download && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
                <!-- 针对特殊source类型 -->
                <a stop-propagation ng-href="/api/uploads/[[upload.id]]/blob"
                    tipsy-literal="下载" ng-click="downloadBlob(activity, upload)"
                    ng-if="!upload.reference_id && !upload.deleted && upload.allow_download && ['auto-generated-pdf'].includes(upload.source) && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
                <a stop-propagation ng-href="/api/wedrive/file/[[upload.fileid]]"
                    tipsy-literal="下载"
                    ng-if="!upload.deleted && upload.allow_download && upload.source == 'WEDRIVE' && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
        </div>
</span>    </div>

</div>

<div class="attachment-row clearfix" ng-if="!canPreview(upload) || upload.deleted || !canShowResource(upload, isInstructorView)" ng-click="downloadWeDrive(upload)">


    <div class="attachment-column column large-10" ng-if="upload.type != 'slide'" ng-class="{'large-20':upload.source === 'sobey'}">
        <div ng-if="upload.source == 'auto-generated-pdf'">
            <svg class="file-text-content left">
                <use xlink:href="#file-text-content"></use>
            </svg>
            <span class="file-name-wrapper truncate-text left">
                <span class="file-name" tipsy-literal="[[ upload.name.split('.')[0] ]]">[[ upload.name.split('.')[0] ]]</span>
            </span>
        </div>
        <div ng-if="upload.source !== 'auto-generated-pdf'" class="w-full flex">
            <i class="font font-file-[[fileTypeByExtension(upload)]] left"></i>
            <span class="file-name-wrapper truncate-text left">
                <span class="file-name" tipsy-literal="[[ upload.name ]]" ng-bind="upload.name|fileName"></span>
            </span>
            <span class="file-extension left" ng-bind="upload.name|fileExtension"></span>
        </div>
    </div>
    <div class="attachment-column column large-10" ng-if="upload.type == 'slide'">
        <i class="font font-slide left"></i>
        <span class="file-name-wrapper truncate-text left">
            <span class="file-name" tipsy-literal="[[ upload.title ]]" ng-bind="upload.title|fileName"></span>
        </span>
    </div>
        <div class="attachment-column column attachment-state" ng-if="!upload.deleted && upload.source !== 'sobey'"
            ng-class="{'large-1': true, 'large-5': !true}">
        <span ng-if="!upload.status || upload.status === 'ready' || (upload.status === 'processing' && (upload.type === 'video' || upload.videos)) || upload.status === 'none' || upload.deleted || wpsPreview(upload)">&nbsp;</span>
        <span ng-if="(upload.status === 'failed' || uploadsStatus[upload.id] === 'failed') && !upload.deleted">&nbsp;</span>
        <span ng-if="(upload.status === 'processing' || uploadsStatus[upload.id] === 'processing') && (upload.type != 'video' || !upload.videos) && !upload.deleted && !wpsPreview(upload)">&nbsp;</span>
    </div>
    <div class="attachment-column column attachment-deleted large-5" ng-if="upload.deleted">
        <span>文件已删除</span>
    </div>
    <div class="attachment-column column attachment-size attachment-marked"
         ng-class="{'large-7': true, 'large-10': !true}"
         ng-init="isUploadFailed = (upload.status || uploadsStatus[upload.id]) == 'failed';
                  isUploadProcessing = (upload.status || uploadsStatus[upload.id]) == 'processing';
                  isNotVideo = upload.type != 'video' || !upload.videos;
                  showFileSize = !isUploadFailed && !isUploadProcessing && upload.size >= 0">
        <span ng-if="upload.source == 'LARK'" style="height: 1px;">——</span>
        <span ng-if="upload.source != 'LARK' && showFileSize" ng-bind="upload.size|humanizeBytes"></span>
        <span ng-if="upload.source != 'LARK' && !showFileSize && !upload.deleted">
            <span ng-if="isUploadFailed" class="attachment-state-failed">
                    转码失败
            </span>
            <span ng-if="isUploadProcessing && isNotVideo && !wpsPreview(upload)" class="attachment-state-processing">
                    正在转码中
            </span>
        </span>
        <div ng-if="upload.type=='scorm' && upload.scorm">
            教材大小:<span ng-bind="upload.scorm.files_size|humanizeBytes"></span>
        </div>
        <div ng-if="upload.type=='slide' && upload.duration">
            时长:<span ng-bind="upload.duration | formatTime"></span>
        </div>
    </div>



        <div ng-if="airHelper.canShowAttachmentQuestion(activity) === true" class="attachment-column column large-2">
            <span class="aiQuiz-content">
                [[upload.aiQuiz.subjectsCount || "--"]]
            </span>
        </div>

    <div class="attachment-column column"
         ng-class="{'large-7': true, 'large-5': !true}">
<span class="attachment-operations">
        <div class="horizon">



            <a ng-if="canCheckMarked(upload.id)" class="marked-details" ng-click="openMarkedDetail(upload)" stop-propagation>
                查看批注
            </a>
            <a target="_blank" ng-if="upload.source == 'LARK'" ng-href="[[upload.url]]" tipsy-literal="预览">
                <i class="font font-table-edit-view-2"></i>
            </a>
            <a stop-propagation previewer="{uploads: uploads, currentFile: upload, activity: activity, isAttachment: isAttachment}" reveal-modal="file-previewer"
                tipsy-literal="预览" ng-click="downloadBlob(activity, upload, 'view')"
                ng-if="upload.source != 'LARK' && canPreview(upload) && !upload.deleted && canShowResource(upload, isInstructorView) && upload.id > 0">
                <i class="font font-table-edit-view-2"></i>
            </a>
        <a ng-click="openSobeyVideo()" ng-if="upload.source==='sobey'">
            <i class="font font-table-edit-view-2"></i>
        </a>
            <a stop-propagation tipsy-literal="批改"
                ng-click="openEditor(upload.id, subject)"
                ng-if="canEditByPdfEditor(upload) && subject && isInstructorView && !progressUi.inPreview">
                <i class="font font-edit"></i>
                <span class="dropdown-item">批改</span>
            </a>
                <a stop-propagation ng-href="/api/uploads/reference/[[upload.reference_id]]/blob" target="_blank"
                    tipsy-literal="下载" ng-click="downloadBlob(activity, upload)"
                    ng-if="upload.reference_id && !upload.deleted && upload.allow_download && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
                <a stop-propagation ng-href="/api/uploads/[[upload.id]]/blob?preview=true&activity_type=[[activity.type]]" target="_blank"
                    tipsy-literal="下载" ng-click="downloadBlob(activity, upload)"
                    ng-if="!upload.reference_id && !upload.deleted && upload.allow_download && !upload.source && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
                <a stop-propagation ng-href="[[upload.url]]/download" target="_blank"
                    tipsy-literal="下载" ng-click="downloadBlob(activity, upload)"
                    ng-if="upload.source && !['LARK', 'auto-generated-pdf', 'WEDRIVE'].includes(upload.source) && !upload.reference_id && !upload.deleted && upload.allow_download && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
                <!-- 针对特殊source类型 -->
                <a stop-propagation ng-href="/api/uploads/[[upload.id]]/blob"
                    tipsy-literal="下载" ng-click="downloadBlob(activity, upload)"
                    ng-if="!upload.reference_id && !upload.deleted && upload.allow_download && ['auto-generated-pdf'].includes(upload.source) && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
                <a stop-propagation ng-href="/api/wedrive/file/[[upload.fileid]]"
                    tipsy-literal="下载"
                    ng-if="!upload.deleted && upload.allow_download && upload.source == 'WEDRIVE' && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
        </div>
</span>    </div>

</div>        </div>
    </div>
</div>            </div>
    </div>

    <div class="subject-message" ng-if="!questionnaire && canViewAnswerExplanation">
        <div class="note" ng-if="isInstructorViewAndNotSimulatedSubmission && subject.settings.show_note">
            <span>备注:&nbsp</span>
            <span ng-bind="subject.note"></span>
        </div>
        <div class="explanation" ng-show="subject.answer_explanation">
            <div class="explanation-label">答案解释:</div>
            <span class="simditor-viewer" ng-compile-html="subject.answer_explanation | sanitizeHtml" mathjax></span>
        </div>
    <div class="knowledge-node" ng-if="subject.knowledgeNodes">
        <div class="knowledge-node-label">知识点:</div>
        <div class="node-list">
            <div ng-repeat="node_reference in subject.knowledgeNodes">
                <knowledge-node-tag
                    ng-prop-course_id="node_reference.course_id"
                    ng-prop-node_id="node_reference.knowledge_node.id"
                    ng-prop-content="node_reference.knowledge_node.name"
                    ng-prop-go_to_graph="true"
                    size="medium"
                >
                </knowledge-node-tag>
            </div>
        </div>
    </div>
    </div>
    <div class="subject-score" ng-if="canGiveScore" ng-init="subject.score_copy = subject.score">
        <span class="field-title">分值:</span>
        <input type="text" name="score" ng-model="subject.score"
               ng-disabled="course.score_published || !canShowOperations(exam)"
               ng-class="{'ng-invalid': subject.error}"
               ng-change="removeError(subject)"
               esc-press="subject.score_copy"
               model-patron="{required: false}"
               submit-callback="autoSaveScore(subject)"
               maxlength="4" float-precision="1" />
        <span class="error score-error" ng-bind="subject.error || ''"></span>
    </div>
    <div class="submission-comment student-view" ng-if="examId && subject.comment && !allowExamEdit">
        <div class="teacher-comment">
            <div class="comment-label">教师评语:</div>
            <span class="comment-content" ng-bind="subject.comment"></span>
        </div>
    </div>
    <div class="submission-comment" ng-if="canGiveScore && examId"
         ng-init="bindLeftCommentLength(subject, instructorCommentMaxLen)">
        <span class="field-title">教师评语:</span>
        <div class="comment-area-container" ng-class="{'is-focus': subject.isFocus}" ng-init="subject.isFocus = false;">
            <textarea class="comment-content" rows="6" name="comment"
                      ng-focus="subject.isFocus=true"
                      ng-blur="subject.isFocus=false"
                      ng-model="subject.comment"
                      ng-disabled="!canShowOperations(exam)"
                      placeholder="您可以在此输入评语"
                      content-length-limit="commentContentExceeded(subject, $exceeded, instructorCommentMaxLen)"
                      content-length-max="[[instructorCommentMaxLen]]"
                      model-patron="{required: false, enterToSubmit: false, bindConvertValue: false}"
                      submit-callback="autoSaveSubmissionComment(subject)">
            </textarea>
            <div class="left-count">
                 <span>[[subject.leftCommentLength]]</span>
            </div>
        </div>
    </div>
    <div ng-if="true">
        <div ng-init="isViewSubmission = true">
            <div class="short-answer-marked-upload-list"
                 ng-init="uploads = subject.marked_attachments; isAttachment = true" refresh-on="subject.marked_attachments">
<div class="attachments-wrapper" ng-if="uploads.length" stop-propagation check-upload-status>
    <span class="field-title">批改附件</span>

<div class="attachment-header clearfix">
    <div class="attachment-column column" ng-class="{'large-11': true, 'large-15': !true}">
        附件名
    </div>
    <div class="attachment-column column" ng-if="ui.videoType !=='sobey'"
        ng-class="{'large-7': true, 'large-10': !true}">
        大小
    </div>
        <div ng-if="airHelper.canShowAttachmentQuestion(activity) === true" class="attachment-column column large-2">题目</div>
    <div class="attachment-column column large-3">&nbsp;</div>
</div>    <div ng-repeat="upload in uploads">
        <div class="attachment-row preview-able clearfix" ng-if="canPreview(upload) && !upload.deleted && canShowResource(upload, isInstructorView)"
             previewer="{uploads: uploads, currentFile: upload, activity: activity, isAttachment: isAttachment}" reveal-modal="file-previewer" ng-click="downloadBlob(activity, upload, 'view')">



    <div class="attachment-column column large-10" ng-if="upload.type != 'slide'" ng-class="{'large-20':upload.source === 'sobey'}">
        <div ng-if="upload.source == 'auto-generated-pdf'">
            <svg class="file-text-content left">
                <use xlink:href="#file-text-content"></use>
            </svg>
            <span class="file-name-wrapper truncate-text left">
                <span class="file-name" tipsy-literal="[[ upload.name.split('.')[0] ]]">[[ upload.name.split('.')[0] ]]</span>
            </span>
        </div>
        <div ng-if="upload.source !== 'auto-generated-pdf'" class="w-full flex">
            <i class="font font-file-[[fileTypeByExtension(upload)]] left"></i>
            <span class="file-name-wrapper truncate-text left">
                <span class="file-name" tipsy-literal="[[ upload.name ]]" ng-bind="upload.name|fileName"></span>
            </span>
            <span class="file-extension left" ng-bind="upload.name|fileExtension"></span>
        </div>
    </div>
    <div class="attachment-column column large-10" ng-if="upload.type == 'slide'">
        <i class="font font-slide left"></i>
        <span class="file-name-wrapper truncate-text left">
            <span class="file-name" tipsy-literal="[[ upload.title ]]" ng-bind="upload.title|fileName"></span>
        </span>
    </div>
        <div class="attachment-column column attachment-state" ng-if="!upload.deleted && upload.source !== 'sobey'"
            ng-class="{'large-1': true, 'large-5': !true}">
        <span ng-if="!upload.status || upload.status === 'ready' || (upload.status === 'processing' && (upload.type === 'video' || upload.videos)) || upload.status === 'none' || upload.deleted || wpsPreview(upload)">&nbsp;</span>
        <span ng-if="(upload.status === 'failed' || uploadsStatus[upload.id] === 'failed') && !upload.deleted">&nbsp;</span>
        <span ng-if="(upload.status === 'processing' || uploadsStatus[upload.id] === 'processing') && (upload.type != 'video' || !upload.videos) && !upload.deleted && !wpsPreview(upload)">&nbsp;</span>
    </div>
    <div class="attachment-column column attachment-deleted large-5" ng-if="upload.deleted">
        <span>文件已删除</span>
    </div>
    <div class="attachment-column column attachment-size attachment-marked"
         ng-class="{'large-7': true, 'large-10': !true}"
         ng-init="isUploadFailed = (upload.status || uploadsStatus[upload.id]) == 'failed';
                  isUploadProcessing = (upload.status || uploadsStatus[upload.id]) == 'processing';
                  isNotVideo = upload.type != 'video' || !upload.videos;
                  showFileSize = !isUploadFailed && !isUploadProcessing && upload.size >= 0">
        <span ng-if="upload.source == 'LARK'" style="height: 1px;">——</span>
        <span ng-if="upload.source != 'LARK' && showFileSize" ng-bind="upload.size|humanizeBytes"></span>
        <span ng-if="upload.source != 'LARK' && !showFileSize && !upload.deleted">
            <span ng-if="isUploadFailed" class="attachment-state-failed">
                    转码失败
            </span>
            <span ng-if="isUploadProcessing && isNotVideo && !wpsPreview(upload)" class="attachment-state-processing">
                    正在转码中
            </span>
        </span>
        <div ng-if="upload.type=='scorm' && upload.scorm">
            教材大小:<span ng-bind="upload.scorm.files_size|humanizeBytes"></span>
        </div>
        <div ng-if="upload.type=='slide' && upload.duration">
            时长:<span ng-bind="upload.duration | formatTime"></span>
        </div>
    </div>



        <div ng-if="airHelper.canShowAttachmentQuestion(activity) === true" class="attachment-column column large-2">
            <span class="aiQuiz-content">
                [[upload.aiQuiz.subjectsCount || "--"]]
            </span>
        </div>

    <div class="attachment-column column"
         ng-class="{'large-7': true, 'large-5': !true}">
<span class="attachment-operations">
        <div class="horizon">



            <a ng-if="canCheckMarked(upload.id)" class="marked-details" ng-click="openMarkedDetail(upload)" stop-propagation>
                查看批注
            </a>
            <a target="_blank" ng-if="upload.source == 'LARK'" ng-href="[[upload.url]]" tipsy-literal="预览">
                <i class="font font-table-edit-view-2"></i>
            </a>
            <a stop-propagation previewer="{uploads: uploads, currentFile: upload, activity: activity, isAttachment: isAttachment}" reveal-modal="file-previewer"
                tipsy-literal="预览" ng-click="downloadBlob(activity, upload, 'view')"
                ng-if="upload.source != 'LARK' && canPreview(upload) && !upload.deleted && canShowResource(upload, isInstructorView) && upload.id > 0">
                <i class="font font-table-edit-view-2"></i>
            </a>
        <a ng-click="openSobeyVideo()" ng-if="upload.source==='sobey'">
            <i class="font font-table-edit-view-2"></i>
        </a>
                <a stop-propagation ng-href="/api/uploads/reference/[[upload.reference_id]]/blob" target="_blank"
                    tipsy-literal="下载" ng-click="downloadBlob(activity, upload)"
                    ng-if="upload.reference_id && !upload.deleted && upload.allow_download && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
                <a stop-propagation ng-href="/api/uploads/[[upload.id]]/blob?preview=true&activity_type=[[activity.type]]" target="_blank"
                    tipsy-literal="下载" ng-click="downloadBlob(activity, upload)"
                    ng-if="!upload.reference_id && !upload.deleted && upload.allow_download && !upload.source && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
                <a stop-propagation ng-href="[[upload.url]]/download" target="_blank"
                    tipsy-literal="下载" ng-click="downloadBlob(activity, upload)"
                    ng-if="upload.source && !['LARK', 'auto-generated-pdf', 'WEDRIVE'].includes(upload.source) && !upload.reference_id && !upload.deleted && upload.allow_download && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
                <!-- 针对特殊source类型 -->
                <a stop-propagation ng-href="/api/uploads/[[upload.id]]/blob"
                    tipsy-literal="下载" ng-click="downloadBlob(activity, upload)"
                    ng-if="!upload.reference_id && !upload.deleted && upload.allow_download && ['auto-generated-pdf'].includes(upload.source) && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
                <a stop-propagation ng-href="/api/wedrive/file/[[upload.fileid]]"
                    tipsy-literal="下载"
                    ng-if="!upload.deleted && upload.allow_download && upload.source == 'WEDRIVE' && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
        </div>
</span>    </div>

</div>

<div class="attachment-row clearfix" ng-if="!canPreview(upload) || upload.deleted || !canShowResource(upload, isInstructorView)" ng-click="downloadWeDrive(upload)">


    <div class="attachment-column column large-10" ng-if="upload.type != 'slide'" ng-class="{'large-20':upload.source === 'sobey'}">
        <div ng-if="upload.source == 'auto-generated-pdf'">
            <svg class="file-text-content left">
                <use xlink:href="#file-text-content"></use>
            </svg>
            <span class="file-name-wrapper truncate-text left">
                <span class="file-name" tipsy-literal="[[ upload.name.split('.')[0] ]]">[[ upload.name.split('.')[0] ]]</span>
            </span>
        </div>
        <div ng-if="upload.source !== 'auto-generated-pdf'" class="w-full flex">
            <i class="font font-file-[[fileTypeByExtension(upload)]] left"></i>
            <span class="file-name-wrapper truncate-text left">
                <span class="file-name" tipsy-literal="[[ upload.name ]]" ng-bind="upload.name|fileName"></span>
            </span>
            <span class="file-extension left" ng-bind="upload.name|fileExtension"></span>
        </div>
    </div>
    <div class="attachment-column column large-10" ng-if="upload.type == 'slide'">
        <i class="font font-slide left"></i>
        <span class="file-name-wrapper truncate-text left">
            <span class="file-name" tipsy-literal="[[ upload.title ]]" ng-bind="upload.title|fileName"></span>
        </span>
    </div>
        <div class="attachment-column column attachment-state" ng-if="!upload.deleted && upload.source !== 'sobey'"
            ng-class="{'large-1': true, 'large-5': !true}">
        <span ng-if="!upload.status || upload.status === 'ready' || (upload.status === 'processing' && (upload.type === 'video' || upload.videos)) || upload.status === 'none' || upload.deleted || wpsPreview(upload)">&nbsp;</span>
        <span ng-if="(upload.status === 'failed' || uploadsStatus[upload.id] === 'failed') && !upload.deleted">&nbsp;</span>
        <span ng-if="(upload.status === 'processing' || uploadsStatus[upload.id] === 'processing') && (upload.type != 'video' || !upload.videos) && !upload.deleted && !wpsPreview(upload)">&nbsp;</span>
    </div>
    <div class="attachment-column column attachment-deleted large-5" ng-if="upload.deleted">
        <span>文件已删除</span>
    </div>
    <div class="attachment-column column attachment-size attachment-marked"
         ng-class="{'large-7': true, 'large-10': !true}"
         ng-init="isUploadFailed = (upload.status || uploadsStatus[upload.id]) == 'failed';
                  isUploadProcessing = (upload.status || uploadsStatus[upload.id]) == 'processing';
                  isNotVideo = upload.type != 'video' || !upload.videos;
                  showFileSize = !isUploadFailed && !isUploadProcessing && upload.size >= 0">
        <span ng-if="upload.source == 'LARK'" style="height: 1px;">——</span>
        <span ng-if="upload.source != 'LARK' && showFileSize" ng-bind="upload.size|humanizeBytes"></span>
        <span ng-if="upload.source != 'LARK' && !showFileSize && !upload.deleted">
            <span ng-if="isUploadFailed" class="attachment-state-failed">
                    转码失败
            </span>
            <span ng-if="isUploadProcessing && isNotVideo && !wpsPreview(upload)" class="attachment-state-processing">
                    正在转码中
            </span>
        </span>
        <div ng-if="upload.type=='scorm' && upload.scorm">
            教材大小:<span ng-bind="upload.scorm.files_size|humanizeBytes"></span>
        </div>
        <div ng-if="upload.type=='slide' && upload.duration">
            时长:<span ng-bind="upload.duration | formatTime"></span>
        </div>
    </div>



        <div ng-if="airHelper.canShowAttachmentQuestion(activity) === true" class="attachment-column column large-2">
            <span class="aiQuiz-content">
                [[upload.aiQuiz.subjectsCount || "--"]]
            </span>
        </div>

    <div class="attachment-column column"
         ng-class="{'large-7': true, 'large-5': !true}">
<span class="attachment-operations">
        <div class="horizon">



            <a ng-if="canCheckMarked(upload.id)" class="marked-details" ng-click="openMarkedDetail(upload)" stop-propagation>
                查看批注
            </a>
            <a target="_blank" ng-if="upload.source == 'LARK'" ng-href="[[upload.url]]" tipsy-literal="预览">
                <i class="font font-table-edit-view-2"></i>
            </a>
            <a stop-propagation previewer="{uploads: uploads, currentFile: upload, activity: activity, isAttachment: isAttachment}" reveal-modal="file-previewer"
                tipsy-literal="预览" ng-click="downloadBlob(activity, upload, 'view')"
                ng-if="upload.source != 'LARK' && canPreview(upload) && !upload.deleted && canShowResource(upload, isInstructorView) && upload.id > 0">
                <i class="font font-table-edit-view-2"></i>
            </a>
        <a ng-click="openSobeyVideo()" ng-if="upload.source==='sobey'">
            <i class="font font-table-edit-view-2"></i>
        </a>
                <a stop-propagation ng-href="/api/uploads/reference/[[upload.reference_id]]/blob" target="_blank"
                    tipsy-literal="下载" ng-click="downloadBlob(activity, upload)"
                    ng-if="upload.reference_id && !upload.deleted && upload.allow_download && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
                <a stop-propagation ng-href="/api/uploads/[[upload.id]]/blob?preview=true&activity_type=[[activity.type]]" target="_blank"
                    tipsy-literal="下载" ng-click="downloadBlob(activity, upload)"
                    ng-if="!upload.reference_id && !upload.deleted && upload.allow_download && !upload.source && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
                <a stop-propagation ng-href="[[upload.url]]/download" target="_blank"
                    tipsy-literal="下载" ng-click="downloadBlob(activity, upload)"
                    ng-if="upload.source && !['LARK', 'auto-generated-pdf', 'WEDRIVE'].includes(upload.source) && !upload.reference_id && !upload.deleted && upload.allow_download && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
                <!-- 针对特殊source类型 -->
                <a stop-propagation ng-href="/api/uploads/[[upload.id]]/blob"
                    tipsy-literal="下载" ng-click="downloadBlob(activity, upload)"
                    ng-if="!upload.reference_id && !upload.deleted && upload.allow_download && ['auto-generated-pdf'].includes(upload.source) && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
                <a stop-propagation ng-href="/api/wedrive/file/[[upload.fileid]]"
                    tipsy-literal="下载"
                    ng-if="!upload.deleted && upload.allow_download && upload.source == 'WEDRIVE' && canShowResource(upload, isInstructorView)">
                    <i class="font font-table-edit-download"></i>
                    <span class="dropdown-item">下载</span>
                </a>
        </div>
</span>    </div>

</div>    </div>
</div>            </div>
        </div>
    </div>
</div></div>
<div ng-if="subject.type == 'matching'">
<div class="subject-head" ng-init="answerState = getSubjectAnswerState(subject, submissionScoreData)" ng-attr-id="[[subject.id]]">
    <div class="summary-title" ng-class="{'required': subject.settings.required}">
<div class="subject-resort-index" ng-hide="ui.editSubjectPage">
    <span ng-if="!subject.parent_id || subject.data.is_random_subject">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>
    <span ng-if="subject.parent_id  && !subject.data.is_random_subject">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>


<div class="subject-resort-index" ng-if="ui.editSubjectPage">
    <span ng-if="!subject.parent_id">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type == 'random'">
        <span ng-bind="getSubjectIndex(parentSubject, $index)"></span>-<span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type != 'random'">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>        <span ng-compile-html="subject.displayedDescription || subject.description || '暂无题目描述' | sanitizeHtml"
            class="pre-wrap subject-description simditor-viewer" mathjax></span>
        <span class="answer-error"
              ng-if="!questionnaire && (canViewAnswerState || canViewAnswerForClassroom)">
            <span ng-if="answerState == -1" class="answer-message tc-tag error">此题未答</span>
            <span ng-if="answerState == 0" class="answer-message tc-tag error">回答错误</span>
            <span ng-if="answerState == 2" class="tc-tag info">部分答对</span>
        </span>
    </div>
    <div class="summary-sub-title">
        <span class="subject-point">
            <span ng-bind="subjectTypeMap[subject.type]"></span>
            <span ng-if="subject.score >= 0 && subject.score !== null && !questionnaire">
                (<span ng-bind="subject.getPoint()"></span>
                <span>分</span>)

                <span class="actual-score" ng-if="(isInstructorView || exam.is_announce_score_time_passed)"
                    ng-init="subject.score_copy = subject.score">
                    <span ng-if="subject.type == 'fill_in_blank' && exam">
                        <span ng-if="canGiveScore"  ng-show="subject.showEdit">
                            <input ng-attr-id="[['input-' + subject.id]]" class="auto-width" name="score"
                                ng-disabled="course.score_published || !canShowOperations(exam)" ng-change="removeError(subject)"
                                esc-press="subject.score_copy" ng-on-change="editScore(subject)"
                                ng-blur="resetSubject(subject)" ng-model="subject.score" maxlength="4" server-validated
                                float-precision="1">
                            </input>
                        </span>
                        <span ng-show="!subject.showEdit">
                            <span ng-bind="subject.score"></span>
                            <span>分</span>
                            <a ng-if="canGiveScore" ng-click="edit(subject)"><i class="font font-edit"></i></a>
                        </span>
                    </span>
                    <span ng-if="subject.type != 'fill_in_blank' || !exam">[[subject.getScore()]]分</span>
                </span>
            </span>
            <span ng-if="!subject.score && subject.score != 0 && !questionnaire">
                (<span ng-bind="subject.getPoint()"></span>
                <span>分</span>)
            </span>
            <span class="sub-title-hint" ng-if="subject.type == 'matching'">
                <span ng-if="subject.score_rule == 'single'">(计分规则:按匹配正确项计分)</span>
                <span ng-if="subject.score_rule == 'overall'">(计分规则:有匹配错误项则该题目不得分)</span>
            </span>
            <span ng-if="isInstructorView && !questionnaire">
<span ng-if="!isQuestionnaire">（难易度:
    <span ng-if="subject.difficulty_level=='none'">中）</span>
    <span ng-if="subject.difficulty_level=='hard'">难）</span>
    <span ng-if="subject.difficulty_level=='medium'">中）</span>
    <span ng-if="subject.difficulty_level=='easy'">易）</span>
</span>            </span>
            <span class="sub-title-hint"
                ng-if="subject.type == 'fill_in_blank' && !allowExamEdit">(请按题目中的空缺顺序依次填写答案)</span>
            <span ng-if="subject.type == 'fill_in_blank' && allowExamEdit" class="error score-error ng-binding"
                ng-style="{'display': 'inline-block'}" ng-bind="subject.error || ''"></span>
        </span>
    </div>
</div>
<div class="subject-body">
    <div class="matching-subject">
        <ul class="matching-list"
            ng-class="subject.settings.options_layout"
            ng-style="{width: ui.calcOptionWidth(subject.options, subject.settings.options_layout)}"
            ng-repeat="sub_subject in subject.sub_subjects | orderBy: 'sort' track by $index">
            <li ng-if="sub_subject.sort == 0">
                <div class="tip-answer">
                    <div>提示</div>
                    <div class="line"></div>
                    <div>答案</div>
                </div>
            </li>
            <li ng-repeat="option in sub_subject.options | orderBy: 'sort'">
                <div ng-if="sub_subject.submittedOptionIds[0] == option.id" ng-init="vueParam={subjectDescription: sub_subject.description, subjectAnswer: option.content}">
                    <div vue-wrapper>
                        <match-subject-info class="tips" :content="subjectDescription"></match-subject-info>
                    </div>
                    <div class="line"><hr/></div>
                    <div vue-wrapper>
                        <match-subject-info class="answer" :content="subjectAnswer"></match-subject-info>
                    </div>
                    <div class="answer-error" ng-if="canViewAnswerState">
                        <span ng-if="sub_subject.correctOptions[0].id != option.id"
                              class="answer-message tc-tag error">回答错误</span>
                    </div>
                </div>
            </li>
            <li ng-if="sub_subject.submittedOptionIds.length == 0">
                <div ng-init="vueParam={subjectDescription: sub_subject.description}">
                    <div vue-wrapper>
                        <match-subject-info class="tips" :content="subjectDescription"></match-subject-info>
                    </div>
                    <div class="line"><hr/></div>
                    <div class="answer" style="height: 48px;"></div>
                    <div class="answer-error" ng-if="canViewAnswerState">
                        <span class="answer-message tc-tag error">此题未答</span>
                    </div>
                </div>
            </li>
        </ul>
    </div>
    <div class="matching-subject" ng-init="getSubjectAnswerState(subject)">
        <div class="correct-answer"
            ng-if="!questionnaire && (canViewCorrectAnswer || canViewAnswerForClassroom || canViewAnswerExplanation && (subject.answer_explanation || subject.wrong_explanation))">
            <div class="note" ng-if="isInstructorViewAndNotSimulatedSubmission && subject.settings.show_note">
                <span>备注:&nbsp</span>
                <span ng-bind="subject.note"></span>
            </div>
            <div class="answer-options" ng-class="{'answer-only':isAnswerOnly(subject)}"
                 ng-if="canViewCorrectAnswer || canViewAnswerForClassroom">
                <span>正确答案:</span>
                 <ul class="matching-list"
                ng-class="subject.settings.options_layout"
                ng-style="{width: ui.calcOptionWidth(subject.options, subject.settings.options_layout)}"
                ng-repeat="sub_subject in subject.sub_subjects | orderBy: 'sort'">

                <li ng-repeat="option in sub_subject.options | orderBy: 'sort'">
                    <div ng-if="sub_subject.correctOptions[0].id == option.id" ng-init="vueParam={subjectDescription: sub_subject.description, subjectAnswer: option.content}">
                        <div vue-wrapper>
                            <match-subject-info class="tips" :content="subjectDescription"></match-subject-info>
                        </div>
                        <div class="line"><hr/></div>
                        <div vue-wrapper>
                            <match-subject-info class="answer answer-bg" :content="subjectAnswer"></match-subject-info>
                        </div>
                        <div></div>
                    </div>
                </li>
            </ul>
            </div>
            <div class="explanation" ng-if="canViewAnswerExplanation && subject.answer_explanation && answerState != 0">
                <div class="explanation-label">答案解释:</div>
                <span class="simditor-viewer" ng-compile-html="subject.answer_explanation | sanitizeHtml" mathjax></span>
            </div>
            <div class="explanation" ng-if="canViewAnswerExplanation && subject.wrong_explanation && answerState == 0">
                <div class="explanation-label">答案解释:</div>
                <span class="simditor-viewer" ng-compile-html="subject.wrong_explanation | sanitizeHtml" mathjax></span>
            </div>
    <div class="knowledge-node" ng-if="subject.knowledgeNodes">
        <div class="knowledge-node-label">知识点:</div>
        <div class="node-list">
            <div ng-repeat="node_reference in subject.knowledgeNodes">
                <knowledge-node-tag
                    ng-prop-course_id="node_reference.course_id"
                    ng-prop-node_id="node_reference.knowledge_node.id"
                    ng-prop-content="node_reference.knowledge_node.name"
                    ng-prop-go_to_graph="true"
                    size="medium"
                >
                </knowledge-node-tag>
            </div>
        </div>
    </div>
        </div>
    </div>
</div></div>
<div ng-if="subject.type == 'cloze'">
<div class="subject-head" ng-attr-id="[[subject.id]]">
    <div class="summary-title">
<div class="subject-resort-index" ng-hide="ui.editSubjectPage">
    <span ng-if="!subject.parent_id || subject.data.is_random_subject">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>
    <span ng-if="subject.parent_id  && !subject.data.is_random_subject">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>


<div class="subject-resort-index" ng-if="ui.editSubjectPage">
    <span ng-if="!subject.parent_id">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type == 'random'">
        <span ng-bind="getSubjectIndex(parentSubject, $index)"></span>-<span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type != 'random'">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>        <span ng-compile-html="subject.description || '暂无题目描述' | sanitizeHtml" class="pre-wrap exam-subject simditor-viewer" mathjax></span>
    </div>
    <div class="summary-sub-title">
        <span class="subject-point">
            <span ng-bind="subjectTypeMap[subject.type]"></span>
            <span ng-if="subject.score >= 0 && !questionnaire">
                (<span ng-bind="subject.getPoint()"></span>
                <span>分</span>)

                <span class="actual-score" ng-if="subject.score !== ''">
                    <span ng-bind="subject.score"></span>
                    <span>分</span>
                </span>
            </span>
            <span ng-if="!subject.score && subject.score != 0 && !questionnaire">
                (<span ng-bind="subject.getPoint()"></span>
                <span>分</span>)
            </span>
        </span>
          <span ng-if="isInstructorView && !questionnaire">
<span ng-if="!isQuestionnaire">（难易度:
    <span ng-if="subject.difficulty_level=='none'">中）</span>
    <span ng-if="subject.difficulty_level=='hard'">难）</span>
    <span ng-if="subject.difficulty_level=='medium'">中）</span>
    <span ng-if="subject.difficulty_level=='easy'">易）</span>
</span>          </span>
    </div>
</div>

<div class="subject-body">
    <ol ng-if="subject.sub_subjects.length > 0" class="cloze-sub-subjects"
        sortable="sub-subject" ng-init="parentSubject = subject">
        <li ng-repeat="subSubject in parentSubject.sub_subjects" class="sub-subject-content">
            <div class="sub-subject" style="display: flex;" ng-init="subject = subSubject">
<div class="subject-resort-index" ng-hide="ui.editSubjectPage">
    <span ng-if="!subject.parent_id || subject.data.is_random_subject">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>
    <span ng-if="subject.parent_id  && !subject.data.is_random_subject">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>


<div class="subject-resort-index" ng-if="ui.editSubjectPage">
    <span ng-if="!subject.parent_id">
        <span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type == 'random'">
        <span ng-bind="getSubjectIndex(parentSubject, $index)"></span>-<span ng-bind="getSubjectIndex(subject, $index)"></span>.
    </span>

    <span ng-if="subject.parent_id && parentSubject.type != 'random'">
        (<span ng-bind="getSubjectIndex(subject, $index)"></span>)
    </span>
</div>                <div class="subject-body">
                    <ol class="subject-options">
                        <li class="option" ng-class="subject.settings.options_layout"
                            ng-style="{width: ui.calcOptionWidth(subject.options, subject.settings.options_layout)}"
                            ng-repeat="option in subject.options | orderBy: 'sort'">
                            <label ng-class="{'answered-option': option.id == subject.answeredOption}">
                                <span class="left">
                                  <input type="radio" ng-checked="option.isChosen" ng-disabled="true"/>
                                  <span class="option-index" ng-bind="ui.intToChar($index)"></span><span>.</span>
                                </span>

                                <div class="option-content">
                                    <span ng-compile-html="option.content | sanitizeHtml" class="pre-wrap simditor-viewer" mathjax></span>
                                </div>
                            </label>
                        </li>
                    </ol>
                </div>
                 <div class="answer-error" ng-if="canViewAnswerState" ng-init="answerState = getSubjectAnswerState(subject)">
                    <span ng-if="answerState == -1" class="answer-message tc-tag error">此题未答</span>
                    <span ng-if="answerState == 0" class="answer-message tc-tag error">回答错误</span>
                </div>
            </div>
        </li>
    </ol>

  <div class="subject-message"
    ng-if="!questionnaire && (canViewCorrectAnswer || canViewAnswerForClassroom || canViewAnswerExplanation && (subject.answer_explanation || subject.wrong_explanation))">
    <div class="note" ng-if="isInstructorViewAndNotSimulatedSubmission && subject.settings.show_note">
        <span>备注:&nbsp</span>
        <span ng-bind="subject.note"></span>
    </div>
    <div class="answer-options"
        ng-if="canViewCorrectAnswer || canViewAnswerForClassroom">
        <span>正确答案:</span>
        <span class="answer-option" ng-repeat="option in subject.correctOptions">
          ([[option.parent.sort + 1]]) [[ui.intToChar(option.sort)]]&nbsp&nbsp&nbsp
        </span>
    </div>
    <div class="explanation" ng-if="canViewAnswerExplanation && subject.answer_explanation && answerState != 0">
       <div class="explanation-label">答案解释:</div>
      <div   class="mathjax-process"ng-compile-html="subject.answer_explanation | sanitizeHtml" mathjax></div>
    </div>
    <div class="knowledge-node" ng-if="subject.knowledgeNodes">
        <div class="knowledge-node-label">知识点:</div>
        <div class="node-list">
            <div ng-repeat="node_reference in subject.knowledgeNodes">
                <knowledge-node-tag
                    ng-prop-course_id="node_reference.course_id"
                    ng-prop-node_id="node_reference.knowledge_node.id"
                    ng-prop-content="node_reference.knowledge_node.name"
                    ng-prop-go_to_graph="true"
                    size="medium"
                >
                </knowledge-node-tag>
            </div>
        </div>
    </div>
  </div>
</div>

</div>
<div ng-if="subject.type === 'paragraph_desc'">
    <div class="summary-title subject-head mb-4">
        <span class="pre-wrap subject-description simditor-viewer"
            ng-compile-html="subject.description || '暂无题目描述' | sanitizeHtml" mathjax>
        </span>
    </div>
<ul class="media-uploads-paper" ng-init="noPopup = false">
    <li ng-repeat="upload in subject.settings.uploads | filter:uploadWithName">
        <div ng-if="upload.type == 'audio'" simditor-audio id="[[upload.id]]"
        src="[[trustSrc('/api/uploads/' + upload.id + '/in-rich-content?file_key=' + upload.key )]]" name="[[upload.name]]"></div>
        <div ng-if="upload.type === 'video'" exam-video-player upload="upload" no-popup="noPopup"  resolutions="{'ORIGINAL':'原画', 'HD': '1080p', 'VGA': '720p', 'QVGA': '480p'}"
        default-resolution="'HD'"  lang='zh-CN'
         settings="subject.settings"
        >
        </div>

        <div ng-if="upload.enable_origin_text && (canViewCorrectAnswer || canViewAnswerForClassroom || canViewAnswerExplanation)">
            <div class="show-text">
            原文/译文
            <label class="switch">
                <input type="checkbox" class="switch-input" ng-model="upload.show_text"/>
                <span class="switch-label" data-on="" data-off=""></span>
                <span class="switch-handle"></span>
            </label>
            </div>

            <span ng-show="upload.show_text" class="pre-wrap subject-description simditor-viewer origin-text mb-3"
            ng-compile-html="upload.text | sanitizeHtml" mathjax>
            </span>
        </div>
    </li>
</ul></div>
<div ng-if="subject.type == 'text'">
    <div class="subject-head">
        <div class="summary-title">
            <span class="pre-wrap subject-description simditor-viewer"
                  ng-compile-html="subject.description || '暂无题目描述' | sanitizeHtml" mathjax>
            </span>
        </div>
    </div>
</div>                </li>
            </ol>
        </div>
    </div>
</div>    <div class="operations interaction-operations">
        <a class="button button-green medium" ng-show="canContinue()"
           ng-click="continue()">继续播放</a>
    </div>
</div>
            </div>
        </div>
    </div>
<div ng-if="upload">
    <div class="interaction-message" ng-if="upload.status == 'ready' && !upload.deleted && ui.isOrgTransferArrears">
        <span class="attachment-delete-info">平台套餐已过期或流量不足，暂无法查看该平台资源</span>
    </div>
    <div class="interaction-message" ng-if="upload.status == 'ready' && upload.deleted">
        <span class="attachment-delete-info">文件已删除</span>
    </div>
    <div class="interaction-message" ng-if="(upload.status != 'ready' && !upload.video_urls) && !upload.deleted">
        <div class="video-in-transcoding-msg" ng-if="upload.status == 'processing'">正在转码中，请稍候</div>
        <div class="video-in-transcoding-msg" ng-if="upload.status == 'failed'">转码失败</div>
    </div>
</div></div>            </div>
            <div ng-if="previewType(upload.type) == 'lesson-resource'" class="content" ng-class="{'has-footer': uploads.length > 1}">
                <div class="lesson-resource-preview">
                    <iframe id="lessonResourceIframe" frameborder="0"
                            ng-src="[[ trustAsResourceUrl(lesson_resource_url) ]]"
                            ng-style="iframeStyle"
                            allowfullscreen width="100%" height="100%">
                    </iframe>
                </div>
            </div>
            <div ng-if="previewType(upload.type) == 'capture'" class="content" ng-class="{'has-footer': uploads.length > 1}">
                <div class="capture-preview">
                    <iframe id="captureIframe" frameborder="0"
                            ng-src="[[ trustAsResourceUrl(capture_url) ]]"
                            ng-style="iframeStyle"
                            allowfullscreen width="100%" height="100%">
                    </iframe>
                </div>
            </div>
        </div>
    </div>
    <div class="file-previewer-nav" ng-if="uploads.length > 1">
        <span class="arrow-wrapper" ng-click="changeFile(currentFileIndex - 1)"><i class="icon font font-arrow-left-middle"></i></span>
    </div>
    <div class="file-previewer-nav right" ng-class="{'side-part': ui.showQuestionPanel || ui.showAiQuizPanel}" ng-if="uploads.length > 1">
        <span class="arrow-wrapper" ng-click="changeFile(currentFileIndex + 1)"><i class="icon font font-arrow-right-middle"></i></span>
    </div>
</div>        </div>

    <div class="pdf-editor-wrapper">
<div id="pdf-editor" ng-controller="PdfEditorController"
     class="pdf-reader-wrapper reveal-modal popup-area" resetable data-reveal data-options="multiple_opened:true">
    <div class="popup-content">
        <div class="pdf-reader-detail">
            <div class="header ">
                <div class="header-content">
                    <span class="owner" ng-show="userName">
                        <span class="avatar default"></span>
                        <span tipsy="student">[[userName]]</span>
                    </span>
                    <span ng-show="fileName" class="file-info" ng-bind="fileName" tipsy="fileName">[[fileName]]</span>
                    <span class="header-right">
                        <span class="score-input-label" ng-if="activityData.type=='homework'">
                            <span class="inter-score score-label">成绩</span> &nbsp;&nbsp;
                            <input name="score" ng-disabled="activityData.uiOfSubmissionList.inInterScoreList && !activityData.uiOfSubmissionList.noRubric"
                                    ng-model="activityData.score"
                                    focus-placeholder="100"
                                    type="text" server-validated maxlength="4" float-precision="1">
                        </span>
                        <span class="save" ng-click="savePdf(activityData.score, true)">
                            <i class="font font-save"></i>
                            <span class="inner">保存批改</span>
                        </span>
                    </span>
                </div>
                <a class="right close" ng-click="openConfirmPopup()"><i class="font font-close"></i></a>
            </div>
            <div class="content" ng-if="activityData.type === 'homework'">
                <div class="file-previewer-nav" ng-if="activityData.uploadsLen > 1">
                    <span class="arrow-wrapper" ng-class="{'disable': isDisableClick(-1)}" ng-click="isDisableClick(-1)||changeFile(-1)"><i class="icon font font-arrow-left-middle"></i></span>
                </div>
                <div class="file-previewer-nav right" ng-if="activityData.uploadsLen > 1">
                    <span class="arrow-wrapper" ng-class="{'disable': isDisableClick(1)}" ng-click="isDisableClick(1)||changeFile(1)"><i class="icon font font-arrow-right-middle"></i></span>
                </div>
                <div ng-show="!canEditByPdfEditorWithType(fileType)" ng-controller="FilePreviewerController" class="preview" >
<div class="file-previewer zooming" ng-if="upload" ng-cloak>
    <div class="bd clearfix">
        <div class="org-transfer-arrears" ng-if="isOrgArrears && ui.urlLoaded">
            <span>平台套餐已过期或流量不足，暂无法查看该平台资源</span>
        </div>
        <div ng-if="viewMode.mode==='normal'" class="reader-wrapper">
            <div ng-if="!isOrgArrears && ui.urlLoaded" class="reader-wrapper" ng-class="{'full-screen': ui.fullScreen}">
                <div class="toolbar" ng-if="(isIE9 || !(upload.type == 'document' && upload.status == 'ready')) && !wpsPreview(upload)">
<div class="toolbar-buttons"
     ng-class="{'pdf-view': upload.type == 'document', 'none-border-toolbar':upload.status != 'ready' || isIE9 || upload.isTextFile }">
    <a title="缩小" ng-click="zoomOut()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-zoom-out"></i>
    </a>
    <span class="separator" ng-if="upload.type == 'image'"></span>
    <a title="放大" ng-click="zoomIn()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-zoom-in"></i>
    </a>
    <a title="逆时针旋转" ng-click="rotateImg()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-rotate"></i>
    </a>
    <a title="复原" ng-click="restoreImg()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-restore"></i>
    </a>
    <a ng-if="forceShowDownloadButton && upload.id && upload.type != 'link' && !upload.isFromKnowledgeGraph"
       ng-href="[['/api/uploads/'+upload.id+'/blob']]" title="下载" target="_blank">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="upload.from_project && upload.allow_download"
       ng-href="[[ '/api/project/'+upload.project_id+'/share-resource/blob?upload_id='+upload.id+'&node_ids='+upload.node_ids+'&reference_id='+upload.ref_id ]]" title="下载"  target="_blank">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="!resource && !manualUrl && !canGuestPreview && upload.id && upload.type != 'link' && upload.status != 'cliping' && upload.status != 'clip_failed' && upload.status != 'uploading' && upload.status !='failed' && (upload.allow_download || (isInMyFileListPage && upload.owner_id == currentUserId)) && !upload.isFromKnowledgeGraph && !upload.from_project"
       ng-href="[[ '/api/uploads/'+upload.id+'/blob' ]]" title="下载" ng-click="downloadBlob(activity, upload)" target="_blank">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.open_scope != 'group' && !resource.share_to_id && resource.allow_download && resource.upload.status != 'uploading'" ng-click="download(resource)" title="下载">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.open_scope == 'group' && resource.allow_download && resource.upload.status != 'uploading'" ng-href="/api/shared-resources/[[resource.id]]/blob" target="_self" title="下载">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.share_to_id && resource.allow_download && resource.upload.status != 'uploading'" ng-href="/api/shared-resources-to/[[resource.id]]/blob" target="_self" title="下载">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a id="downloadManual" ng-if="!resource && manualUrl " ng-href="[[manualUrl]]"
       target="_blank" title="下载" download="manual.pdf">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="(upload.type == 'image' || upload.type == 'document' || upload.type == 'scorm') && upload.status != 'uploading' && upload.status !='failed'" ng-hide="ui.fullScreen" ng-click="enterFullScreen('.file-previewer .reader-wrapper')"
       title="进入全屏">
        <i class="icon icon-file-preview-enter-full-screen"></i>
    </a>
    <a ng-if="(upload.type == 'image' || upload.type == 'document' || upload.type == 'scorm') && upload.status != 'uploading'" ng-show="ui.fullScreen" ng-click="exitFullScreen()"
       title="退出全屏">
        <i class="icon icon-file-preview-exit-full-screen"></i>
    </a>
     <a class="open-in-browser" ng-if="upload.type == 'link'" ng-href="[[ upload.link.url ]]" target="_blank" title="在浏览器中打开">
        <i class="font font-open-in-browser-min"></i>
    </a>
</div>                </div>

                <div class="unsupported" ng-if="(isIE9 && upload.type == 'document') || upload.type == 'file' || upload.type == 'wmpkg'">
                    <div class="icon-resource-type">
                        <i class="font font-file-document big-file-font"></i>
                        <div class="file-info" ng-if="upload.status=='uploading'">正在传输中</div>
                        <div class="file-info">[[ upload.name ]]</div>
                        <div class="file-info"> 暂不支持该文件的预览</div>
                        <div class="file-info" ng-if="upload.type == 'wmpkg'"> 旭联智慧大师文件</div>
                        <div class="file-download-button" ng-if="forceShowDownloadButton || resource.allow_download || (upload.allow_download || upload.allowDownload || (isInMyFileListPage && upload.owner_id == currentUserId)) || (!resource && manualUrl)">
                            <a ng-if="forceShowDownloadButton && upload.id && upload.type != 'link'"
                            ng-href="[['/api/uploads/' + upload.id + '/blob?refer_type=' + upload.referType + '&refer_id=' + upload.referId]]" title="下载文件" target="_blank" class="file-download-content">
                                <i class="font font-download"></i><span>下载文件</span><span class="file-size" ng-bind="upload.size|humanizeBytes"></span>
                            </a>
                            <a ng-if="upload.from_project && (upload.allow_download || upload.allowDownload)"
                                ng-href="[[ '/api/project/'+upload.project_id+'/share-resource/blob?upload_id='+upload.id+'&node_ids='+upload.node_ids+'&reference_id='+upload.ref_id ]]" title="下载文件"  target="_blank" class="file-download-content">
                                <i class="font font-download"></i><span>下载文件</span><span class="file-size" ng-bind="upload.size|humanizeBytes"></span>
                            </a>
                            <a ng-if="!upload.from_project && !resource && !manualUrl && !canGuestPreview && upload.id && upload.type != 'link' && upload.status != 'cliping' && upload.status != 'clip_failed' && upload.status != 'uploading' && upload.status !='failed' && (upload.allow_download || upload.allowDownload || (isInMyFileListPage && upload.owner_id == currentUserId))"
                            ng-href="[[ upload.source === 'RMS'? '/api/uploads/' + upload.id + '/rms-preview' : '/api/uploads/' + upload.id + '/blob?refer_type=' + upload.referType + '&refer_id=' + upload.referId ]]" title="下载文件" ng-click="downloadBlob(activity, upload)" target="_blank" class="file-download-content">
                                <i class="font font-download"></i><span>下载文件</span><span class="file-size" ng-bind="upload.size|humanizeBytes"></span>
                            </a>
                            <a ng-if="resource && resource.open_scope != 'group' && !resource.share_to_id && resource.allow_download && resource.upload.status != 'uploading'" ng-click="download(resource)" title="下载文件" class="file-download-content">
                                <i class="font font-download"></i><span>下载文件</span><span class="file-size" ng-bind="upload.size|humanizeBytes"></span>
                            </a>
                            <a ng-if="resource && resource.open_scope == 'group' && resource.allow_download && resource.upload.status != 'uploading'" ng-href="/api/shared-resources/[[resource.id]]/blob" target="_self" title="下载文件" class="file-download-content">
                                <i class="font font-download"></i><span>下载文件</span><span class="file-size" ng-bind="upload.size|humanizeBytes"></span>
                            </a>
                            <a ng-if="resource && resource.share_to_id && resource.allow_download && resource.upload.status != 'uploading'" ng-href="/api/shared-resources-to/[[resource.id]]/blob" target="_self" title="下载文件" class="file-download-content">
                                <i class="font font-download"></i><span>下载文件</span><span class="file-size" ng-bind="upload.size|humanizeBytes"></span>
                            </a>
                            <a id="downloadManual" ng-if="!resource && manualUrl " ng-href="[[manualUrl]]"
                            target="_blank" title="下载文件" download="manual.pdf" class="file-download-content">
                                <i class="font font-download"></i><span>下载文件</span><span class="file-size" ng-bind="upload.size|humanizeBytes"></span>
                            </a>
                            <a ng-if="upload.source == 'WEDRIVE' && (upload.allow_download || upload.allowDownload)" ng-href="/api/wedrive/file/[[upload.fileid]]" target="_self" title="下载文件" class="file-download-content">
                                <i class="font font-download"></i><span>下载文件</span><span class="file-size" ng-bind="upload.size|humanizeBytes"></span>
                            </a>
                        </div>
                    </div>
                </div>

                <div class="transcode-unready" ng-if="showTranscodeUnreadyTips(upload)">
                    <div class="icon-resource-type">
                        <div ng-if="upload.status == 'file_locked'">
                            <img ng-src="/static/assets/images/large/file_locked-cf8c5024.png" class="icon-file-locked">
                            <div class="file-info"> 抱歉，该文件已进行加密故无法预览，请您下载后查看</div>
                        </div>

                        <i ng-if="upload.status != 'file_locked'" class="font font-file-[[fileTypeByExtension(upload)]] big-file-font"></i>

                        <div class="file-info" ng-if="upload.status=='uploading'">正在传输中</div>
                        <div class="file-info" ng-if="upload.status === 'processing' && uploadStatus[upload.id] === 'processing'"> 正在转码中</div>
                        <div class="file-info" ng-if="upload.status === 'failed' || uploadStatus[upload.id] === 'failed'"> 转码失败</div>
                        <div class="file-info" ng-if="upload.status == 'cliping'"> 剪辑中</div>
                        <div class="file-info" ng-if="upload.status == 'clip_failed'"> 剪輯失敗</div>
                        <div ng-if="upload.type == 'scorm' && upload.status == 'failed'">
                            <div ng-switch="error.status_code">
                                <span ng-switch-when="SCORM101">imsmanifest.xml 文件不存在 (请上传符合 SCORM 1.2 格式的 ZIP 文件)</span>
                                <span ng-switch-when="SCORM102">不支持的 SCORM 格式或版本 (请上传符合 SCORM 1.2 格式的 ZIP 文件)</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="pdf-container"
                     ng-if="!isIE9 && (upload.type == 'document' && upload.status == 'ready' && !upload.isTextFile && !wpsPreview(upload) && fileTypeByExtension(upload) !== 'ofd')">

                    <iframe id='pdf-viewer' width="100%" height='100%' frameborder="0" ng-if="upload.documentUrl"
                        ng-src="[[trustAsResourceUrl(upload.documentUrl)]]" allowfullscreen="true">
                    </iframe>
                    <div ng-if="!aliyunOfficePreview(upload)">
<div class="toolbar-buttons"
     ng-class="{'pdf-view': upload.type == 'document', 'none-border-toolbar':upload.status != 'ready' || isIE9 || upload.isTextFile }">
    <a title="缩小" ng-click="zoomOut()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-zoom-out"></i>
    </a>
    <span class="separator" ng-if="upload.type == 'image'"></span>
    <a title="放大" ng-click="zoomIn()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-zoom-in"></i>
    </a>
    <a title="逆时针旋转" ng-click="rotateImg()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-rotate"></i>
    </a>
    <a title="复原" ng-click="restoreImg()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-restore"></i>
    </a>
    <a ng-if="forceShowDownloadButton && upload.id && upload.type != 'link' && !upload.isFromKnowledgeGraph"
       ng-href="[['/api/uploads/'+upload.id+'/blob']]" title="下载" target="_blank">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="upload.from_project && upload.allow_download"
       ng-href="[[ '/api/project/'+upload.project_id+'/share-resource/blob?upload_id='+upload.id+'&node_ids='+upload.node_ids+'&reference_id='+upload.ref_id ]]" title="下载"  target="_blank">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="!resource && !manualUrl && !canGuestPreview && upload.id && upload.type != 'link' && upload.status != 'cliping' && upload.status != 'clip_failed' && upload.status != 'uploading' && upload.status !='failed' && (upload.allow_download || (isInMyFileListPage && upload.owner_id == currentUserId)) && !upload.isFromKnowledgeGraph && !upload.from_project"
       ng-href="[[ '/api/uploads/'+upload.id+'/blob' ]]" title="下载" ng-click="downloadBlob(activity, upload)" target="_blank">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.open_scope != 'group' && !resource.share_to_id && resource.allow_download && resource.upload.status != 'uploading'" ng-click="download(resource)" title="下载">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.open_scope == 'group' && resource.allow_download && resource.upload.status != 'uploading'" ng-href="/api/shared-resources/[[resource.id]]/blob" target="_self" title="下载">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.share_to_id && resource.allow_download && resource.upload.status != 'uploading'" ng-href="/api/shared-resources-to/[[resource.id]]/blob" target="_self" title="下载">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a id="downloadManual" ng-if="!resource && manualUrl " ng-href="[[manualUrl]]"
       target="_blank" title="下载" download="manual.pdf">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="(upload.type == 'image' || upload.type == 'document' || upload.type == 'scorm') && upload.status != 'uploading' && upload.status !='failed'" ng-hide="ui.fullScreen" ng-click="enterFullScreen('.file-previewer .reader-wrapper')"
       title="进入全屏">
        <i class="icon icon-file-preview-enter-full-screen"></i>
    </a>
    <a ng-if="(upload.type == 'image' || upload.type == 'document' || upload.type == 'scorm') && upload.status != 'uploading'" ng-show="ui.fullScreen" ng-click="exitFullScreen()"
       title="退出全屏">
        <i class="icon icon-file-preview-exit-full-screen"></i>
    </a>
     <a class="open-in-browser" ng-if="upload.type == 'link'" ng-href="[[ upload.link.url ]]" target="_blank" title="在浏览器中打开">
        <i class="font font-open-in-browser-min"></i>
    </a>
</div>                    </div>
                </div>

                <div class="odf-container" style="height: 100%;" ng-if="upload.type == 'document' && upload.status == 'ready' && fileTypeByExtension(upload) === 'ofd'">
                    <iframe id='ofd-viewer' width="100%" height='100%' frameborder="0" ng-if="upload.documentUrl"
                        ng-src="[[trustAsResourceUrl(upload.documentUrl)]]" allowfullscreen="true">
                    </iframe>
                </div>

                <div class="ppt-container"
                     ng-if="wpsPreview(upload)" ng-controller="PreviewModeController">
                    <div id="ppt-viewer" class="ppt-viewer"></div>

<div class="toolbar-buttons"
     ng-class="{'pdf-view': upload.type == 'document', 'none-border-toolbar':upload.status != 'ready' || isIE9 || upload.isTextFile }">
    <a title="缩小" ng-click="zoomOut()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-zoom-out"></i>
    </a>
    <span class="separator" ng-if="upload.type == 'image'"></span>
    <a title="放大" ng-click="zoomIn()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-zoom-in"></i>
    </a>
    <a title="逆时针旋转" ng-click="rotateImg()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-rotate"></i>
    </a>
    <a title="复原" ng-click="restoreImg()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-restore"></i>
    </a>
    <a ng-if="forceShowDownloadButton && upload.id && upload.type != 'link' && !upload.isFromKnowledgeGraph"
       ng-href="[['/api/uploads/'+upload.id+'/blob']]" title="下载" target="_blank">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="upload.from_project && upload.allow_download"
       ng-href="[[ '/api/project/'+upload.project_id+'/share-resource/blob?upload_id='+upload.id+'&node_ids='+upload.node_ids+'&reference_id='+upload.ref_id ]]" title="下载"  target="_blank">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="!resource && !manualUrl && !canGuestPreview && upload.id && upload.type != 'link' && upload.status != 'cliping' && upload.status != 'clip_failed' && upload.status != 'uploading' && upload.status !='failed' && (upload.allow_download || (isInMyFileListPage && upload.owner_id == currentUserId)) && !upload.isFromKnowledgeGraph && !upload.from_project"
       ng-href="[[ '/api/uploads/'+upload.id+'/blob' ]]" title="下载" ng-click="downloadBlob(activity, upload)" target="_blank">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.open_scope != 'group' && !resource.share_to_id && resource.allow_download && resource.upload.status != 'uploading'" ng-click="download(resource)" title="下载">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.open_scope == 'group' && resource.allow_download && resource.upload.status != 'uploading'" ng-href="/api/shared-resources/[[resource.id]]/blob" target="_self" title="下载">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.share_to_id && resource.allow_download && resource.upload.status != 'uploading'" ng-href="/api/shared-resources-to/[[resource.id]]/blob" target="_self" title="下载">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a id="downloadManual" ng-if="!resource && manualUrl " ng-href="[[manualUrl]]"
       target="_blank" title="下载" download="manual.pdf">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="(upload.type == 'image' || upload.type == 'document' || upload.type == 'scorm') && upload.status != 'uploading' && upload.status !='failed'" ng-hide="ui.fullScreen" ng-click="enterFullScreen('.file-previewer .reader-wrapper')"
       title="进入全屏">
        <i class="icon icon-file-preview-enter-full-screen"></i>
    </a>
    <a ng-if="(upload.type == 'image' || upload.type == 'document' || upload.type == 'scorm') && upload.status != 'uploading'" ng-show="ui.fullScreen" ng-click="exitFullScreen()"
       title="退出全屏">
        <i class="icon icon-file-preview-exit-full-screen"></i>
    </a>
     <a class="open-in-browser" ng-if="upload.type == 'link'" ng-href="[[ upload.link.url ]]" target="_blank" title="在浏览器中打开">
        <i class="font font-open-in-browser-min"></i>
    </a>
</div>                </div>

                <div class="txt-file-container" ng-if="upload.type == 'document' && upload.status == 'ready' && upload.isTextFile">
                    <div class="toolbar">
<div class="toolbar-buttons"
     ng-class="{'pdf-view': upload.type == 'document', 'none-border-toolbar':upload.status != 'ready' || isIE9 || upload.isTextFile }">
    <a title="缩小" ng-click="zoomOut()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-zoom-out"></i>
    </a>
    <span class="separator" ng-if="upload.type == 'image'"></span>
    <a title="放大" ng-click="zoomIn()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-zoom-in"></i>
    </a>
    <a title="逆时针旋转" ng-click="rotateImg()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-rotate"></i>
    </a>
    <a title="复原" ng-click="restoreImg()" ng-if="upload.type == 'image' && upload.status != 'uploading'">
        <i class="icon icon-file-preview-restore"></i>
    </a>
    <a ng-if="forceShowDownloadButton && upload.id && upload.type != 'link' && !upload.isFromKnowledgeGraph"
       ng-href="[['/api/uploads/'+upload.id+'/blob']]" title="下载" target="_blank">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="upload.from_project && upload.allow_download"
       ng-href="[[ '/api/project/'+upload.project_id+'/share-resource/blob?upload_id='+upload.id+'&node_ids='+upload.node_ids+'&reference_id='+upload.ref_id ]]" title="下载"  target="_blank">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="!resource && !manualUrl && !canGuestPreview && upload.id && upload.type != 'link' && upload.status != 'cliping' && upload.status != 'clip_failed' && upload.status != 'uploading' && upload.status !='failed' && (upload.allow_download || (isInMyFileListPage && upload.owner_id == currentUserId)) && !upload.isFromKnowledgeGraph && !upload.from_project"
       ng-href="[[ '/api/uploads/'+upload.id+'/blob' ]]" title="下载" ng-click="downloadBlob(activity, upload)" target="_blank">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.open_scope != 'group' && !resource.share_to_id && resource.allow_download && resource.upload.status != 'uploading'" ng-click="download(resource)" title="下载">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.open_scope == 'group' && resource.allow_download && resource.upload.status != 'uploading'" ng-href="/api/shared-resources/[[resource.id]]/blob" target="_self" title="下载">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="resource && resource.share_to_id && resource.allow_download && resource.upload.status != 'uploading'" ng-href="/api/shared-resources-to/[[resource.id]]/blob" target="_self" title="下载">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a id="downloadManual" ng-if="!resource && manualUrl " ng-href="[[manualUrl]]"
       target="_blank" title="下载" download="manual.pdf">
        <i class="icon icon-file-preview-download"></i>
    </a>
    <a ng-if="(upload.type == 'image' || upload.type == 'document' || upload.type == 'scorm') && upload.status != 'uploading' && upload.status !='failed'" ng-hide="ui.fullScreen" ng-click="enterFullScreen('.file-previewer .reader-wrapper')"
       title="进入全屏">
        <i class="icon icon-file-preview-enter-full-screen"></i>
    </a>
    <a ng-if="(upload.type == 'image' || upload.type == 'document' || upload.type == 'scorm') && upload.status != 'uploading'" ng-show="ui.fullScreen" ng-click="exitFullScreen()"
       title="退出全屏">
        <i class="icon icon-file-preview-exit-full-screen"></i>
    </a>
     <a class="open-in-browser" ng-if="upload.type == 'link'" ng-href="[[ upload.link.url ]]" target="_blank" title="在浏览器中打开">
        <i class="font font-open-in-browser-min"></i>
    </a>
</div>                    </div>
                    <div class='txt-file-content pre-wrap' ng-bind="upload.textContent" ng-if='upload.textContent'>
                    </div>
                </div>

                <div class="img-container" ng-if="upload.type == 'image' && upload.source !== 'RMS' && (!upload.status || upload.status == 'ready' || upload.status != 3)">
                    <img ng-cloak ng-if="!isVisitor && !resourceId" ng-src="[[upload.url || '/api/uploads/' + upload.id + '/blob?preview=true&refer_type=' + upload.referType + '&refer_id=' + upload.referId]]">
                    <img ng-cloak ng-if="isVisitor && activity && !upload.source" ng-src="[[upload.url || '/anonymous-api/' + activity.id + '/uploads/' + upload.id + '/blob?preview=true']]">
                    <img ng-cloak ng-if="isVisitor && activity && upload.source" ng-src="[[upload.imageUrl]]">
                    <img ng-cloak ng-if="!activity && resourceId" ng-src="[['/' + apiPrefix + '/shared-resources/' + resourceId + '/preview?preview=true']]">
                </div>
                <div class="img-container" ng-if="upload.type == 'image' && upload.source === 'RMS' && (!upload.status || upload.status == 'ready' || upload.status != 3)">
                    <img ng-cloak ng-if="upload.source === 'RMS'" ng-src="[[upload.imageUrl]]">
                </div>
                <div class="video-container" ng-if="(upload.type == 'video' && upload.video_urls) || (upload.type == 'other' && upload.video_url && upload.status == 'ready')">
                        <div id="video" class="video-player">
                            <div id="wg-video-player"
                                wg-video-player
                                style="height:calc(100% - 16px);overflow: unset;"
                                resolutions="{'ORIGINAL': '原画', 'HD': '1080p', 'VGA': '720p', 'QVGA': '480p'}"
                                default-resolution="'HD'"
                                upload="upload"
                                resource="resource"
                                video-src-type="upload.video_src_type"
                                video-urls="upload.video_urls"
                                download="false"
                                disable-track="true"
                                customize-height="true"
                                org-code="'1'"
                                enable-chapter="false"
                                enable-aisk="false"
                                chapter-permission="upload.chapter_permission"
                                enable-caption="false"
                                caption-permission="upload.caption_permission"
                                enable-topic="false"
                                topic-permission="upload.topic_permission"
                                video-editor-server='https://courses.zju.edu.cn/video-editor'
                                enable-play-rate=True
                                caption-paragraph-split-interval=5000
                                caption-translate-permission="upload.caption_translate_permission"
                            ></div>
                        </div>

                    <div id="cc_video" class="video-player" ng-if="upload.is_cc_video && upload.status == 'ready'"
                         ng-bind-html="upload.play_code | trustAsHtml">
                    </div>
                </div>

                <div class="video-container" ng-if="upload.type == 'other' && upload.page_url && upload.status == 'ready'">
                    <div class="lesson-resource-preview">
                        <iframe id="lessonResourceIframe" frameborder="0"
                                ng-src="[[ trustAsResourceUrl(upload.page_url) ]]"
                                ng-style="iframeStyle"
                                allowfullscreen width="100%" height="100%">
                        </iframe>
                    </div>
                </div>

                <div class="audio-container" ng-if="upload.type == 'audio' && upload.status == 'ready' && audioUrl">
<div class="audio-wrapper" ng-controller="AudioPlayCtrl"
     ng-init="forwardSeekingWarning='教师已设置观看该视频不能快进';init()"
     before-controller="pauseWhenLeavingWindow = false;">
    <div class="music-note" ng-click="togglePlay($event)">
        <i class="font font-music"></i>
    </div>
    <div class="audio-player-wrapper">
        <div class="play">
            <a ng-click="togglePlay($event)">
                <i class="font" ng-class="ui.isPlaying ? 'font-audio-pause' : 'font-audio-play'"></i>
            </a>
        </div>
        <div class="current-time">
            <span class="current">[[ ui.currentTimeStr ]]</span>
        </div>
        <div class="slider-bar"
             ng-mousemove="refreshPos($event)"
             ng-mouseleave="deleteClass()">
            <div class="audio-slider"></div>
            <div class="audio-slider-mask"
                 ng-style="{width: ui.maskWidth + 'px'}"></div>
            <div class="slider-tip" ng-bind="sliderTip ? sliderTip : forwardSeekingWarning"></div>
            <div class="slider-tip-arrow"></div>
            <div class="slider-tip-line"></div>
        </div>
        <div class="time-divider">
            <span>/</span>
        </div>
        <div class="duration">
            <span>[[ ui.durationStr ]]</span>
        </div>
        <div class="download" ng-if="allow_download && !activity.uploads[0].deleted && !upload.source">
            <a ng-href="/api/uploads/[[activity.uploads[0].id]]/blob">
                <i class="font font-audio-download"></i>
            </a>
        </div>
        <div class="download" ng-if="allow_download && !activity.uploads[0].deleted && upload.source">
            <a ng-href="[[upload.url]]/download">
                <i class="font font-audio-download"></i>
            </a>
        </div>
        <div class="description" ng-if="activity.data['description']">
            <i class="font font-audio-desc"></i>
            <div class="desc-content-wrapper">
                <div class="content-detail simditor-viewer" ng-bind-html="activity.data['description']|sanitizeHtml" mathjax></div>
                <div class="content-arrow"></div>
            </div>
        </div>
        <div class="volume">
            <a ng-click="toggleVolume($event)">
                <i ng-class="ui.isMuting ? 'font-audio-volume-off' : 'font-audio-volume'" class="font"></i>
            </a>
            <div class="volume-slider-wrapper">
                <div class="volume-slider-arrow"></div>
                <div class="volume-slider"></div>
            </div>
        </div>
    </div>
    <audio preload="auto" class="audio">
        <source ng-src="[[audioUrl | trustSrc]]">
    </audio>
</div>                </div>

                <div class="swf-container" ng-if="upload.type == 'swf' && (!upload.status || upload.status != 'uploading')">
                    <div class="swf-player">
                        <div class="loading" ng-hide="!ui.swfLoading"></div>
                        <div ng-if="!isVisitor" swf-object id="preview-flash" swf-url="/api/uploads/[[upload.id]]/swf" swf-width="100%"
                             swf-height="525" swf-load="swfLoaded()">
                        </div>
                        <div ng-if="isVisitor && activity" swf-object id="preview-flash" swf-url="/anonymous-api/[[activity.id]]/uploads/[[upload.id]]/swf?preview=true" swf-width="100%"
                             swf-height="525" swf-load="swfLoaded()">
                        </div>
                        <div ng-if="isVisitor && !activity && resourceId" swf-object id="preview-flash" swf-url="/anonymous-api/shared-resources/[[resourceId]]/preview?preview=true" swf-width="100%"
                             swf-height="525" swf-load="swfLoaded()">
                        </div>
                        <div ng-if="!hasFlashPlayer" class="no-flash-player">
                            您还没有安装Flash播放器，请点击
                            <a ng-href="https://get.adobe.com/flashplayer/">这里</a>
                            安装
                        </div>
                    </div>
                </div>

                <div class="scorm-container" ng-if="upload.type == 'scorm' && upload.status == 'ready'">
                    <div class="sco-menu">
                        <span ng-bind="scormManifest.organizations.organization.title"></span>
                        <div ng-show="scormManifest.organizations.organization.item.length > 0"
                             ng-repeat="i1 in scormManifest.organizations.organization.item" class="menu-level1">
<span ng-bind="i1.title" ng-hide="i1.scormUrl"></span>
<a ng-click="viewScorm(i1)" ng-bind="i1.title" class="sco-link" ng-show="i1.scormUrl"></a>

<div ng-show="i1.item" class="menu-level2">
    <span ng-bind="i1.item.title" ng-hide="i1.item.scormUrl"></span>
    <a ng-click="viewScorm(i1.item)" ng-bind="i1.item.title" class="sco-link" ng-show="i1.item.scormUrl"></a>
</div>

<div ng-repeat="i2 in i1.item" class="menu-level2" ng-show="i1.item.length > 0">
    <span ng-bind="i2.title" ng-hide="i2.scormUrl"></span>
    <a ng-click="viewScorm(i2)" ng-bind="i2.title" class="sco-link" ng-show="i2.scormUrl"></a>
    <div ng-repeat="i3 in i2.item" class="menu-level2">
        <span ng-bind="i3.title" ng-hide="i3.scormUrl"></span>
        <a ng-click="viewScorm(i3)" ng-bind="i3.title" class="sco-link" ng-show="i3.scormUrl"></a>
        <div ng-repeat="i4 in i3.item" class="menu-level2">
            <span ng-bind="i4.title" ng-hide="i4.scormUrl"></span>
            <a ng-click="viewScorm(i4)" ng-bind="i4.title" class="sco-link" ng-show="i4.scormUrl"></a>
        </div>
    </div>
</div>                        </div>
                        <div ng-show="scormManifest.organizations.organization.item" class="menu-level1">
                            <span ng-bind="scormManifest.organizations.organization.item.title"
                                  ng-hide="scormManifest.organizations.organization.item.scormUrl"></span>
                            <a ng-click="viewScorm(scormManifest.organizations.organization.item)"
                               ng-bind="scormManifest.organizations.organization.item.title"
                               ng-show="scormManifest.organizations.organization.item.scormUrl"
                               class="sco-link"></a>
                            <div ng-show="scormManifest.organizations.organization.item.item.length > 0"
                                 ng-repeat="i1 in scormManifest.organizations.organization.item.item" class="menu-level1">
<span ng-bind="i1.title" ng-hide="i1.scormUrl"></span>
<a ng-click="viewScorm(i1)" ng-bind="i1.title" class="sco-link" ng-show="i1.scormUrl"></a>

<div ng-show="i1.item" class="menu-level2">
    <span ng-bind="i1.item.title" ng-hide="i1.item.scormUrl"></span>
    <a ng-click="viewScorm(i1.item)" ng-bind="i1.item.title" class="sco-link" ng-show="i1.item.scormUrl"></a>
</div>

<div ng-repeat="i2 in i1.item" class="menu-level2" ng-show="i1.item.length > 0">
    <span ng-bind="i2.title" ng-hide="i2.scormUrl"></span>
    <a ng-click="viewScorm(i2)" ng-bind="i2.title" class="sco-link" ng-show="i2.scormUrl"></a>
    <div ng-repeat="i3 in i2.item" class="menu-level2">
        <span ng-bind="i3.title" ng-hide="i3.scormUrl"></span>
        <a ng-click="viewScorm(i3)" ng-bind="i3.title" class="sco-link" ng-show="i3.scormUrl"></a>
        <div ng-repeat="i4 in i3.item" class="menu-level2">
            <span ng-bind="i4.title" ng-hide="i4.scormUrl"></span>
            <a ng-click="viewScorm(i4)" ng-bind="i4.title" class="sco-link" ng-show="i4.scormUrl"></a>
        </div>
    </div>
</div>                            </div>
                        </div>
                    </div>
                    <div class="sco-viewer">
                        <iframe id='scorm-viewer' frameborder="0" class="scorm-iframe">
                        </iframe>
                    </div>
                </div>
                <div class="evercam-container" ng-if="upload.type == 'evercam' && upload.status == 'ready'">
                    <div class="evercam-viewer">
                        <iframe id='evercam-viewer' frameborder="0" class="evercam-iframe">
                        </iframe>
                    </div>
                </div>
                <div class="link-container" ng-if="upload.type == 'link'">
                    <div class="video-link-previewer" ng-if="upload.link.embedded_url">
                        <iframe id="iframeplayer"
                                ng-src="[[ trustAsResourceUrl(upload.link.embedded_url) ]]"
                                ng-style="iframeStyle"
                                height="100%" width="100%"
                                marginwidth="0" marginheight="0"
                                scrolling="No" frameborder="0"
                                allowfullscreen>
                        </iframe>
                    </div>
                    <div class="link-previewer" ng-if="!upload.link.embedded_url">
                        <div class="icon-resource-type">
                            <i class="font font-open-in-browser big-file-font"></i>
                            <div>
                                <a class="button button-green small" ng-href="[[upload.link.url]]" target="_blank">在浏览器中打开</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class='preview-mode reader-wrapper' ng-if="viewMode.mode==='preview'" ng-controller="PreviewModeController">
            <iframe id='preview-viewer' width="100%" height='100%' frameborder="0"
                ng-src="[[trustAsResourceUrl(previewDataMap[upload.id])]]">
            </iframe>
        </div>
    </div>
</div>                </div>
                <iframe ng-if="canEditByPdfEditorWithType(fileType)" allowfullscreen="allowfullscreen" id="pdfEditorIframe" ng-src="[[documentUrl]]" frameborder="0" width="100%"
                        height="100%" iframeonload="iframeOnload()"></iframe>
            </div>
            <div class="content" ng-if="activityData.type !== 'homework'">
                <div class="file-previewer-nav" ng-if="activityData.uploadsLen > 1 && activityData.type=='exam'">
                    <span class="arrow-wrapper" ng-class="{'disable': isDisableClick(-1)}" ng-click="isDisableClick(-1)||changeFile(-1)"><i class="icon font font-arrow-left-middle"></i></span>
                </div>
                <div class="file-previewer-nav right" ng-if="activityData.uploadsLen > 1 && activityData.type=='exam'">
                    <span class="arrow-wrapper" ng-class="{'disable': isDisableClick(1)}" ng-click="isDisableClick(1)||changeFile(1)"><i class="icon font font-arrow-right-middle"></i></span>
                </div>
                <iframe ng-if="canEditByPdfEditorWithType(fileType)" allowfullscreen="allowfullscreen" id="pdfEditorIframe" ng-src="[[documentUrl]]" frameborder="0" width="100%"
                        height="100%" iframeonload="iframeOnload()"></iframe>
            </div>
        </div>
    </div>
    <div class="popup-close" ng-if="isConfirmPopupOpen">
        <div class="content">
            <div class="popup-header">
                <span>退出</span>
            </div>
            <div class="main-area">
                <span ng-if="isPdfChanged">您的更改尚未保存，确定要离开吗？</span>
                <span ng-if="!isPdfChanged">您确定要离开吗？</span>
            </div>
            <div class="popup-footer">
                <div class="form-buttons">
                    <button type="button" class="button button-green medium"
                            ng-click="exitPdfEditor()">确定</button>
                    <button type="button" class="button button-grey medium"
                            ng-click="cancelExitPdfEditor()">取消</button>
                </div>
            </div>
        </div>
    </div>
    <div class="loader-bg" ng-if="loading">
        <div class="loader"></div>
    </div>
</div>    </div>

<div class="cornerButtonGroup" corner-button-group  ng-init="operateMap={
    ilib:None,
    chatRobot:false,
    feedback:false,
    enableSobot:false,
}"></div>
<div class="corner-main" ng-if="showCornerButton" id="cornBtn" ng-style="{'position':showCornerButton ? 'fixed' :'initial' }">
    <div class="corner-container">
        <div class="button-group no-padding-group" ng-style="{'margin-bottom': backToTopBottom()}" scroll-to-top ng-if="showBackToTopButton">
            <div class="button-background back-up-to-top"></div>
            <i class="icon icon-back-to-top" style="position:relative;left:50%;"></i>
        </div>




    <div ng-if="operateCount > 1">
        <collapse-operation  ng-prop-operate_map="operateMap"></collapse-operation>
    </div>
    </div>
</div>

<script defer src="https://consoles.zju.edu.cn/static/js/wg-apps.js"></script>

<script>
    var languageDict = {
        "zh-CN": "zh-CN",
        "zh-TW": "zh-TW",
        "zh-MO": "zh-TW",
        "en-US": "en",
        "en-GB": "en"
    };
    window.addEventListener("DOMContentLoaded", () => {
      var lang = document.querySelector("html").getAttribute("lang");
      if (window.loadApps) {
        window.loadApps('https://consoles.zju.edu.cn', languageDict[lang], '3240100106');
      } else {
        console.warn('load wg-apps.js failed! window.loadApps is not a function')
      }
    });
</script>

<div id="switch-audio-confirmation-popup" class="reveal-modal popup-area popup-480" data-reveal resetable ng-controller="SwitchAudioPopupController">
    <div class="popup-content">
        <div class="popup-header">
            <span>切换播放音频</span>
            <a class="right" close-popup="switch-audio-confirmation-popup">
                <i class="font font-close"></i>
            </a>
        </div>
        <div class="main-area">
            <div class="message">
                <b>您是否确定执行 <span class="warning-color">［切换播放音频］</span>？</b><br><br>
                <p class="little">
                    正在播放的音频将被强制结束，<br>
                    剩余播放次数： <span ng-bind="currentAudioScope.left_times"></span><br>
                </p>
            </div>
        </div>
        <div class="popup-footer">
            <div class="form-buttons">
                <button type="submit" class="button button-green medium"
                        ng-hide="loading" ng-click="confirm()" close-popup="switch-audio-confirmation-popup">确定</button>
                <button type="button" class="button button-grey medium" close-popup="switch-audio-confirmation-popup">取消</button>
            </div>
        </div>
    </div>
</div>
<div id="switch-video-confirmation-popup" class="reveal-modal popup-area popup-480" data-reveal resetable ng-controller="SwitchVideoPopupController">
    <div class="popup-content">
        <div class="popup-header">
            <span>切换播放视频</span>
            <a class="right" close-popup="switch-video-confirmation-popup" ng-click="closeModal()">
                <i class="font font-close"></i>
            </a>
        </div>
        <div class="main-area">
            <div class="message">
                <b ng-if="currentVideo.type==='switch'">您是否确定执行 <span class="warning-color">［切换播放视频］</span>？</b><br><br>
                <p ng-if="currentVideo.type==='close'">当前视频未播完，确认要关闭吗？</p>
                <p class="little" ng-if="currentVideo.playLimit">
                    <span ng-if="currentVideo.type==='switch'">正在播放的视频将被强制结束，</span><br>
                    剩余播放次数： <span ng-bind="currentVideo.limitTimes"></span><br>
                </p>
            </div>
        </div>
        <div class="popup-footer">
            <div class="form-buttons">
                <button type="submit" class="button button-green medium"
                        ng-hide="loading" ng-click="confirm()" close-popup="switch-video-confirmation-popup">确定</button>
                <button type="button" class="button button-grey medium" close-popup="switch-video-confirmation-popup" ng-click="closeModal()">取消</button>
            </div>
        </div>
    </div>
</div>
<div id="idle-warning-popup" class="reveal-modal popup-area popup-480" resetable data-reveal>
    <div class="popup-content">
        <div class="popup-header">
            <span>温馨提示</span>
            <a class="right" close-popup="idle-warning-popup" onclick="closeIdleWarningPopup();">
                <i class="font font-close"></i>
            </a>
        </div>
        <div class="main-area" ng-switch="ui.wizardStep">
            <div class="message">
                <span>哈啰，您还在屏幕前吗？请勿闲置超过5分钟。系统会判断您已离席，课程访问时长将自动停止计算。</span>
            </div>
        </div>
        <div class="popup-footer card-footer text-center">
            <span>
                <a class="button button-green medium edit-page" close-popup="idle-warning-popup"
                    onclick="closeIdleWarningPopup();">好</a>
            </span>
        </div>
    </div>
</div>
<script>
    const closeIdleWarningPopup = function () {
      window.statisticsSettings.showIdleWarning = false;
      $("#idle-warning-popup").foundation("reveal", "close");
    }
</script>



</body>
</html>